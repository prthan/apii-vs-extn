!function(window){"use strict";var minErrConfig={objectMaxDepth:5,urlErrorParamsEnabled:!0};function errorHandlingConfig(config){if(!isObject(config))return minErrConfig;isDefined(config.objectMaxDepth)&&(minErrConfig.objectMaxDepth=isValidObjectMaxDepth(config.objectMaxDepth)?config.objectMaxDepth:NaN),isDefined(config.urlErrorParamsEnabled)&&isBoolean(config.urlErrorParamsEnabled)&&(minErrConfig.urlErrorParamsEnabled=config.urlErrorParamsEnabled)}function isValidObjectMaxDepth(maxDepth){return isNumber(maxDepth)&&maxDepth>0}function minErr(module,ErrorConstructor){ErrorConstructor=ErrorConstructor||Error;var url="https://errors.angularjs.org/1.8.0/",regex=url.replace(".","\\.")+"[\\s\\S]*",errRegExp=new RegExp(regex,"g");return function(){var paramPrefix,i,code=arguments[0],template=arguments[1],message="["+(module?module+":":"")+code+"] ",templateArgs=sliceArgs(arguments,2).map(function(arg){return toDebugString(arg,minErrConfig.objectMaxDepth)});if(message+=template.replace(/\{\d+\}/g,function(match){var index=+match.slice(1,-1);return index<templateArgs.length?templateArgs[index].replace(errRegExp,""):match}),message+="\n"+url+(module?module+"/":"")+code,minErrConfig.urlErrorParamsEnabled)for(i=0,paramPrefix="?";i<templateArgs.length;i++,paramPrefix="&")message+=paramPrefix+"p"+i+"="+encodeURIComponent(templateArgs[i]);return new ErrorConstructor(message)}}var msie,jqLite,jQuery,angularModule,REGEX_STRING_REGEXP=/^\/(.+)\/([a-z]*)$/,VALIDITY_STATE_PROPERTY="validity",hasOwnProperty=Object.prototype.hasOwnProperty,lowercase=function(string){return isString(string)?string.toLowerCase():string},uppercase=function(string){return isString(string)?string.toUpperCase():string},slice=[].slice,splice=[].splice,push=[].push,toString=Object.prototype.toString,getPrototypeOf=Object.getPrototypeOf,ngMinErr=minErr("ng"),angular=window.angular||(window.angular={}),uid=0;function isArrayLike(obj){if(null==obj||isWindow(obj))return!1;if(isArray(obj)||isString(obj)||jqLite&&obj instanceof jqLite)return!0;var length="length"in Object(obj)&&obj.length;return isNumber(length)&&(length>=0&&length-1 in obj||"function"==typeof obj.item)}function forEach(obj,iterator,context){var key,length;if(obj)if(isFunction(obj))for(key in obj)"prototype"!==key&&"length"!==key&&"name"!==key&&obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);else if(isArray(obj)||isArrayLike(obj)){var isPrimitive="object"!=typeof obj;for(key=0,length=obj.length;key<length;key++)(isPrimitive||key in obj)&&iterator.call(context,obj[key],key,obj)}else if(obj.forEach&&obj.forEach!==forEach)obj.forEach(iterator,context,obj);else if(isBlankObject(obj))for(key in obj)iterator.call(context,obj[key],key,obj);else if("function"==typeof obj.hasOwnProperty)for(key in obj)obj.hasOwnProperty(key)&&iterator.call(context,obj[key],key,obj);else for(key in obj)hasOwnProperty.call(obj,key)&&iterator.call(context,obj[key],key,obj);return obj}function forEachSorted(obj,iterator,context){for(var keys=Object.keys(obj).sort(),i=0;i<keys.length;i++)iterator.call(context,obj[keys[i]],keys[i]);return keys}function reverseParams(iteratorFn){return function(value,key){iteratorFn(key,value)}}function nextUid(){return++uid}function setHashKey(obj,h){h?obj.$$hashKey=h:delete obj.$$hashKey}function baseExtend(dst,objs,deep){for(var h=dst.$$hashKey,i=0,ii=objs.length;i<ii;++i){var obj=objs[i];if(isObject(obj)||isFunction(obj))for(var keys=Object.keys(obj),j=0,jj=keys.length;j<jj;j++){var key=keys[j],src=obj[key];deep&&isObject(src)?isDate(src)?dst[key]=new Date(src.valueOf()):isRegExp(src)?dst[key]=new RegExp(src):src.nodeName?dst[key]=src.cloneNode(!0):isElement(src)?dst[key]=src.clone():"__proto__"!==key&&(isObject(dst[key])||(dst[key]=isArray(src)?[]:{}),baseExtend(dst[key],[src],!0)):dst[key]=src}}return setHashKey(dst,h),dst}function extend(dst){return baseExtend(dst,slice.call(arguments,1),!1)}function merge(dst){return baseExtend(dst,slice.call(arguments,1),!0)}function toInt(str){return parseInt(str,10)}msie=window.document.documentMode;var isNumberNaN=Number.isNaN||function(num){return num!=num};function inherit(parent,extra){return extend(Object.create(parent),extra)}function noop(){}function identity($){return $}function valueFn(value){return function(){return value}}function hasCustomToString(obj){return isFunction(obj.toString)&&obj.toString!==toString}function isUndefined(value){return void 0===value}function isDefined(value){return void 0!==value}function isObject(value){return null!==value&&"object"==typeof value}function isBlankObject(value){return null!==value&&"object"==typeof value&&!getPrototypeOf(value)}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isDate(value){return"[object Date]"===toString.call(value)}function isArray(arr){return Array.isArray(arr)||arr instanceof Array}function isError(value){switch(toString.call(value)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return value instanceof Error}}function isFunction(value){return"function"==typeof value}function isRegExp(value){return"[object RegExp]"===toString.call(value)}function isWindow(obj){return obj&&obj.window===obj}function isScope(obj){return obj&&obj.$evalAsync&&obj.$watch}function isBoolean(value){return"boolean"==typeof value}function isPromiseLike(obj){return obj&&isFunction(obj.then)}noop.$inject=[],identity.$inject=[];var TYPED_ARRAY_REGEXP=/^\[object (?:Uint8|Uint8Clamped|Uint16|Uint32|Int8|Int16|Int32|Float32|Float64)Array]$/;var trim=function(value){return isString(value)?value.trim():value},escapeForRegexp=function(s){return s.replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};function isElement(node){return!(!node||!(node.nodeName||node.prop&&node.attr&&node.find))}function nodeName_(element){return lowercase(element.nodeName||element[0]&&element[0].nodeName)}function includes(array,obj){return-1!==Array.prototype.indexOf.call(array,obj)}function arrayRemove(array,value){var index=array.indexOf(value);return index>=0&&array.splice(index,1),index}function copy(source,destination,maxDepth){var obj,value,stackSource=[],stackDest=[];if(maxDepth=isValidObjectMaxDepth(maxDepth)?maxDepth:NaN,destination){if((value=destination)&&isNumber(value.length)&&TYPED_ARRAY_REGEXP.test(toString.call(value))||(obj=destination,"[object ArrayBuffer]"===toString.call(obj)))throw ngMinErr("cpta","Can't copy! TypedArray destination cannot be mutated.");if(source===destination)throw ngMinErr("cpi","Can't copy! Source and destination are identical.");return isArray(destination)?destination.length=0:forEach(destination,function(value,key){"$$hashKey"!==key&&delete destination[key]}),stackSource.push(source),stackDest.push(destination),copyRecurse(source,destination,maxDepth)}return copyElement(source,maxDepth);function copyRecurse(source,destination,maxDepth){if(--maxDepth<0)return"...";var key,h=destination.$$hashKey;if(isArray(source))for(var i=0,ii=source.length;i<ii;i++)destination.push(copyElement(source[i],maxDepth));else if(isBlankObject(source))for(key in source)destination[key]=copyElement(source[key],maxDepth);else if(source&&"function"==typeof source.hasOwnProperty)for(key in source)source.hasOwnProperty(key)&&(destination[key]=copyElement(source[key],maxDepth));else for(key in source)hasOwnProperty.call(source,key)&&(destination[key]=copyElement(source[key],maxDepth));return setHashKey(destination,h),destination}function copyElement(source,maxDepth){if(!isObject(source))return source;var index=stackSource.indexOf(source);if(-1!==index)return stackDest[index];if(isWindow(source)||isScope(source))throw ngMinErr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");var needsRecurse=!1,destination=function(source){switch(toString.call(source)){case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return new source.constructor(copyElement(source.buffer),source.byteOffset,source.length);case"[object ArrayBuffer]":if(!source.slice){var copied=new ArrayBuffer(source.byteLength);return new Uint8Array(copied).set(new Uint8Array(source)),copied}return source.slice(0);case"[object Boolean]":case"[object Number]":case"[object String]":case"[object Date]":return new source.constructor(source.valueOf());case"[object RegExp]":var re=new RegExp(source.source,source.toString().match(/[^/]*$/)[0]);return re.lastIndex=source.lastIndex,re;case"[object Blob]":return new source.constructor([source],{type:source.type})}if(isFunction(source.cloneNode))return source.cloneNode(!0)}(source);return void 0===destination&&(destination=isArray(source)?[]:Object.create(getPrototypeOf(source)),needsRecurse=!0),stackSource.push(source),stackDest.push(destination),needsRecurse?copyRecurse(source,destination,maxDepth):destination}}function simpleCompare(a,b){return a===b||a!=a&&b!=b}function equals(o1,o2){if(o1===o2)return!0;if(null===o1||null===o2)return!1;if(o1!=o1&&o2!=o2)return!0;var length,key,keySet,t1=typeof o1;if(t1===typeof o2&&"object"===t1){if(!isArray(o1)){if(isDate(o1))return!!isDate(o2)&&simpleCompare(o1.getTime(),o2.getTime());if(isRegExp(o1))return!!isRegExp(o2)&&o1.toString()===o2.toString();if(isScope(o1)||isScope(o2)||isWindow(o1)||isWindow(o2)||isArray(o2)||isDate(o2)||isRegExp(o2))return!1;for(key in keySet=createMap(),o1)if("$"!==key.charAt(0)&&!isFunction(o1[key])){if(!equals(o1[key],o2[key]))return!1;keySet[key]=!0}for(key in o2)if(!(key in keySet)&&"$"!==key.charAt(0)&&isDefined(o2[key])&&!isFunction(o2[key]))return!1;return!0}if(!isArray(o2))return!1;if((length=o1.length)===o2.length){for(key=0;key<length;key++)if(!equals(o1[key],o2[key]))return!1;return!0}}return!1}var csp=function(){if(!isDefined(csp.rules)){var ngCspElement=window.document.querySelector("[ng-csp]")||window.document.querySelector("[data-ng-csp]");if(ngCspElement){var ngCspAttribute=ngCspElement.getAttribute("ng-csp")||ngCspElement.getAttribute("data-ng-csp");csp.rules={noUnsafeEval:!ngCspAttribute||-1!==ngCspAttribute.indexOf("no-unsafe-eval"),noInlineStyle:!ngCspAttribute||-1!==ngCspAttribute.indexOf("no-inline-style")}}else csp.rules={noUnsafeEval:function(){try{return new Function(""),!1}catch(e){return!0}}(),noInlineStyle:!1}}return csp.rules},jq=function(){if(isDefined(jq.name_))return jq.name_;var el,i,prefix,name,ii=ngAttrPrefixes.length;for(i=0;i<ii;++i)if(prefix=ngAttrPrefixes[i],el=window.document.querySelector("["+prefix.replace(":","\\:")+"jq]")){name=el.getAttribute(prefix+"jq");break}return jq.name_=name};function concat(array1,array2,index){return array1.concat(slice.call(array2,index))}function sliceArgs(args,startIndex){return slice.call(args,startIndex||0)}function bind(self,fn){var curryArgs=arguments.length>2?sliceArgs(arguments,2):[];return!isFunction(fn)||fn instanceof RegExp?fn:curryArgs.length?function(){return arguments.length?fn.apply(self,concat(curryArgs,arguments,0)):fn.apply(self,curryArgs)}:function(){return arguments.length?fn.apply(self,arguments):fn.call(self)}}function toJsonReplacer(key,value){var val=value;return"string"==typeof key&&"$"===key.charAt(0)&&"$"===key.charAt(1)?val=void 0:isWindow(value)?val="$WINDOW":value&&window.document===value?val="$DOCUMENT":isScope(value)&&(val="$SCOPE"),val}function toJson(obj,pretty){if(!isUndefined(obj))return isNumber(pretty)||(pretty=pretty?2:null),JSON.stringify(obj,toJsonReplacer,pretty)}function fromJson(json){return isString(json)?JSON.parse(json):json}var ALL_COLONS=/:/g;function timezoneToOffset(timezone,fallback){timezone=timezone.replace(ALL_COLONS,"");var requestedTimezoneOffset=Date.parse("Jan 01, 1970 00:00:00 "+timezone)/6e4;return isNumberNaN(requestedTimezoneOffset)?fallback:requestedTimezoneOffset}function addDateMinutes(date,minutes){return(date=new Date(date.getTime())).setMinutes(date.getMinutes()+minutes),date}function convertTimezoneToLocal(date,timezone,reverse){reverse=reverse?-1:1;var dateTimezoneOffset=date.getTimezoneOffset();return addDateMinutes(date,reverse*(timezoneToOffset(timezone,dateTimezoneOffset)-dateTimezoneOffset))}function startingTag(element){element=jqLite(element).clone().empty();var elemHtml=jqLite("<div></div>").append(element).html();try{return element[0].nodeType===NODE_TYPE_TEXT?lowercase(elemHtml):elemHtml.match(/^(<[^>]+>)/)[1].replace(/^<([\w-]+)/,function(match,nodeName){return"<"+lowercase(nodeName)})}catch(e){return lowercase(elemHtml)}}function tryDecodeURIComponent(value){try{return decodeURIComponent(value)}catch(e){}}function parseKeyValue(keyValue){var obj={};return forEach((keyValue||"").split("&"),function(keyValue){var splitPoint,key,val;keyValue&&(key=keyValue=keyValue.replace(/\+/g,"%20"),-1!==(splitPoint=keyValue.indexOf("="))&&(key=keyValue.substring(0,splitPoint),val=keyValue.substring(splitPoint+1)),isDefined(key=tryDecodeURIComponent(key))&&(val=!isDefined(val)||tryDecodeURIComponent(val),hasOwnProperty.call(obj,key)?isArray(obj[key])?obj[key].push(val):obj[key]=[obj[key],val]:obj[key]=val))}),obj}function encodeUriSegment(val){return encodeUriQuery(val,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function encodeUriQuery(val,pctEncodeSpaces){return encodeURIComponent(val).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,pctEncodeSpaces?"%20":"+")}var ngAttrPrefixes=["ng-","data-ng-","ng:","x-ng-"];var isAutoBootstrapAllowed=function(document){var script=document.currentScript;if(!script)return!0;if(!(script instanceof window.HTMLScriptElement||script instanceof window.SVGScriptElement))return!1;var attributes=script.attributes;return[attributes.getNamedItem("src"),attributes.getNamedItem("href"),attributes.getNamedItem("xlink:href")].every(function(src){if(!src)return!0;if(!src.value)return!1;var link=document.createElement("a");if(link.href=src.value,document.location.origin===link.origin)return!0;switch(link.protocol){case"http:":case"https:":case"ftp:":case"blob:":case"file:":case"data:":return!0;default:return!1}})}(window.document);function angularInit(element,bootstrap){var appElement,module,config={};if(forEach(ngAttrPrefixes,function(prefix){var name=prefix+"app";!appElement&&element.hasAttribute&&element.hasAttribute(name)&&(appElement=element,module=element.getAttribute(name))}),forEach(ngAttrPrefixes,function(prefix){var candidate,name=prefix+"app";!appElement&&(candidate=element.querySelector("["+name.replace(":","\\:")+"]"))&&(appElement=candidate,module=candidate.getAttribute(name))}),appElement){if(!isAutoBootstrapAllowed)return void window.console.error("AngularJS: disabling automatic bootstrap. <script> protocol indicates an extension, document.location.href does not match.");config.strictDi=null!==function(element,ngAttr){var attr,i,ii=ngAttrPrefixes.length;for(i=0;i<ii;++i)if(attr=ngAttrPrefixes[i]+ngAttr,isString(attr=element.getAttribute(attr)))return attr;return null}(appElement,"strict-di"),bootstrap(appElement,module?[module]:[],config)}}function bootstrap(element,modules,config){isObject(config)||(config={});config=extend({strictDi:!1},config);var doBootstrap=function(){if((element=jqLite(element)).injector()){var tag=element[0]===window.document?"document":startingTag(element);throw ngMinErr("btstrpd","App already bootstrapped with this element '{0}'",tag.replace(/</,"&lt;").replace(/>/,"&gt;"))}(modules=modules||[]).unshift(["$provide",function($provide){$provide.value("$rootElement",element)}]),config.debugInfoEnabled&&modules.push(["$compileProvider",function($compileProvider){$compileProvider.debugInfoEnabled(!0)}]),modules.unshift("ng");var injector=createInjector(modules,config.strictDi);return injector.invoke(["$rootScope","$rootElement","$compile","$injector",function(scope,element,compile,injector){scope.$apply(function(){element.data("$injector",injector),compile(element)(scope)})}]),injector},NG_ENABLE_DEBUG_INFO=/^NG_ENABLE_DEBUG_INFO!/,NG_DEFER_BOOTSTRAP=/^NG_DEFER_BOOTSTRAP!/;if(window&&NG_ENABLE_DEBUG_INFO.test(window.name)&&(config.debugInfoEnabled=!0,window.name=window.name.replace(NG_ENABLE_DEBUG_INFO,"")),window&&!NG_DEFER_BOOTSTRAP.test(window.name))return doBootstrap();window.name=window.name.replace(NG_DEFER_BOOTSTRAP,""),angular.resumeBootstrap=function(extraModules){return forEach(extraModules,function(module){modules.push(module)}),doBootstrap()},isFunction(angular.resumeDeferredBootstrap)&&angular.resumeDeferredBootstrap()}function reloadWithDebugInfo(){window.name="NG_ENABLE_DEBUG_INFO!"+window.name,window.location.reload()}function getTestability(rootElement){var injector=angular.element(rootElement).injector();if(!injector)throw ngMinErr("test","no injector found for element argument to getTestability");return injector.get("$$testability")}var SNAKE_CASE_REGEXP=/[A-Z]/g;function snake_case(name,separator){return separator=separator||"_",name.replace(SNAKE_CASE_REGEXP,function(letter,pos){return(pos?separator:"")+letter.toLowerCase()})}var bindJQueryFired=!1;function UNSAFE_restoreLegacyJqLiteXHTMLReplacement(){JQLite.legacyXHTMLReplacement=!0}function assertArg(arg,name,reason){if(!arg)throw ngMinErr("areq","Argument '{0}' is {1}",name||"?",reason||"required");return arg}function assertArgFn(arg,name,acceptArrayAnnotation){return acceptArrayAnnotation&&isArray(arg)&&(arg=arg[arg.length-1]),assertArg(isFunction(arg),name,"not a function, got "+(arg&&"object"==typeof arg?arg.constructor.name||"Object":typeof arg)),arg}function assertNotHasOwnProperty(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}function getBlockNodes(nodes){for(var blockNodes,node=nodes[0],endNode=nodes[nodes.length-1],i=1;node!==endNode&&(node=node.nextSibling);i++)(blockNodes||nodes[i]!==node)&&(blockNodes||(blockNodes=jqLite(slice.call(nodes,0,i))),blockNodes.push(node));return blockNodes||nodes}function createMap(){return Object.create(null)}function stringify(value){if(null==value)return"";switch(typeof value){case"string":break;case"number":value=""+value;break;default:value=!hasCustomToString(value)||isArray(value)||isDate(value)?toJson(value):value.toString()}return value}var NODE_TYPE_ELEMENT=1,NODE_TYPE_TEXT=3,NODE_TYPE_COMMENT=8,NODE_TYPE_DOCUMENT=9,NODE_TYPE_DOCUMENT_FRAGMENT=11;function shallowCopy(src,dst){if(isArray(src)){dst=dst||[];for(var i=0,ii=src.length;i<ii;i++)dst[i]=src[i]}else if(isObject(src))for(var key in dst=dst||{},src)"$"===key.charAt(0)&&"$"===key.charAt(1)||(dst[key]=src[key]);return dst||src}function toDebugString(obj,maxDepth){return"function"==typeof obj?obj.toString().replace(/ \{[\s\S]*$/,""):isUndefined(obj)?"undefined":"string"!=typeof obj?function(obj,maxDepth){var seen=[];return isValidObjectMaxDepth(maxDepth)&&(obj=angular.copy(obj,null,maxDepth)),JSON.stringify(obj,function(key,val){if(isObject(val=toJsonReplacer(key,val))){if(seen.indexOf(val)>=0)return"...";seen.push(val)}return val})}(obj,maxDepth):obj}var version={full:"1.8.0",major:1,minor:8,dot:0,codeName:"nested-vaccination"};JQLite.expando="ng339";var jqCache=JQLite.cache={},jqId=1;JQLite._data=function(node){return this.cache[node[this.expando]]||{}};var DASH_LOWERCASE_REGEXP=/-([a-z])/g,MS_HACK_REGEXP=/^-ms-/,MOUSE_EVENT_MAP={mouseleave:"mouseout",mouseenter:"mouseover"},jqLiteMinErr=minErr("jqLite");function fnCamelCaseReplace(all,letter){return letter.toUpperCase()}function kebabToCamel(name){return name.replace(DASH_LOWERCASE_REGEXP,fnCamelCaseReplace)}var SINGLE_TAG_REGEXP=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/,HTML_REGEXP=/<|&#?\w+;/,TAG_NAME_REGEXP=/<([\w:-]+)/,XHTML_TAG_REGEXP=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,wrapMap={thead:["table"],col:["colgroup","table"],tr:["tbody","table"],td:["tr","tbody","table"]};wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var wrapMapIE9={option:[1,'<select multiple="multiple">',"</select>"],_default:[0,"",""]};for(var key in wrapMap){var wrapMapValueClosing=wrapMap[key],wrapMapValue=wrapMapValueClosing.slice().reverse();wrapMapIE9[key]=[wrapMapValue.length,"<"+wrapMapValue.join("><")+">","</"+wrapMapValueClosing.join("></")+">"]}function jqLiteIsTextNode(html){return!HTML_REGEXP.test(html)}function jqLiteAcceptsData(node){var nodeType=node.nodeType;return nodeType===NODE_TYPE_ELEMENT||!nodeType||nodeType===NODE_TYPE_DOCUMENT}function jqLiteBuildFragment(html,context){var tmp,tag,wrap,finalHtml,i,fragment=context.createDocumentFragment(),nodes=[];if(jqLiteIsTextNode(html))nodes.push(context.createTextNode(html));else{if(tmp=fragment.appendChild(context.createElement("div")),tag=(TAG_NAME_REGEXP.exec(html)||["",""])[1].toLowerCase(),finalHtml=JQLite.legacyXHTMLReplacement?html.replace(XHTML_TAG_REGEXP,"<$1></$2>"):html,msie<10)for(wrap=wrapMapIE9[tag]||wrapMapIE9._default,tmp.innerHTML=wrap[1]+finalHtml+wrap[2],i=wrap[0];i--;)tmp=tmp.firstChild;else{for(i=(wrap=wrapMap[tag]||[]).length;--i>-1;)tmp.appendChild(window.document.createElement(wrap[i])),tmp=tmp.firstChild;tmp.innerHTML=finalHtml}nodes=concat(nodes,tmp.childNodes),(tmp=fragment.firstChild).textContent=""}return fragment.textContent="",fragment.innerHTML="",forEach(nodes,function(node){fragment.appendChild(node)}),fragment}wrapMapIE9.optgroup=wrapMapIE9.option;var jqLiteContains=window.Node.prototype.contains||function(arg){return!!(16&this.compareDocumentPosition(arg))};function JQLite(element){if(element instanceof JQLite)return element;var argIsString,html,context,parsed;if(isString(element)&&(element=trim(element),argIsString=!0),!(this instanceof JQLite)){if(argIsString&&"<"!==element.charAt(0))throw jqLiteMinErr("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new JQLite(element)}argIsString?jqLiteAddNodes(this,(html=element,context=context||window.document,(parsed=SINGLE_TAG_REGEXP.exec(html))?[context.createElement(parsed[1])]:(parsed=jqLiteBuildFragment(html,context))?parsed.childNodes:[])):isFunction(element)?jqLiteReady(element):jqLiteAddNodes(this,element)}function jqLiteClone(element){return element.cloneNode(!0)}function jqLiteDealoc(element,onlyDescendants){!onlyDescendants&&jqLiteAcceptsData(element)&&jqLite.cleanData([element]),element.querySelectorAll&&jqLite.cleanData(element.querySelectorAll("*"))}function isEmptyObject(obj){var name;for(name in obj)return!1;return!0}function removeIfEmptyData(element){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId],events=expandoStore&&expandoStore.events,data=expandoStore&&expandoStore.data;data&&!isEmptyObject(data)||events&&!isEmptyObject(events)||(delete jqCache[expandoId],element.ng339=void 0)}function jqLiteOff(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("offargs","jqLite#off() does not support the `selector` argument");var expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,handle=expandoStore&&expandoStore.handle;if(handle){if(type){var removeHandler=function(type){var listenerFns=events[type];isDefined(fn)&&arrayRemove(listenerFns||[],fn),isDefined(fn)&&listenerFns&&listenerFns.length>0||(element.removeEventListener(type,handle),delete events[type])};forEach(type.split(" "),function(type){removeHandler(type),MOUSE_EVENT_MAP[type]&&removeHandler(MOUSE_EVENT_MAP[type])})}else for(type in events)"$destroy"!==type&&element.removeEventListener(type,handle),delete events[type];removeIfEmptyData(element)}}function jqLiteRemoveData(element,name){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];expandoStore&&(name?delete expandoStore.data[name]:expandoStore.data={},removeIfEmptyData(element))}function jqLiteExpandoStore(element,createIfNecessary){var expandoId=element.ng339,expandoStore=expandoId&&jqCache[expandoId];return createIfNecessary&&!expandoStore&&(element.ng339=expandoId=++jqId,expandoStore=jqCache[expandoId]={events:{},data:{},handle:void 0}),expandoStore}function jqLiteData(element,key,value){if(jqLiteAcceptsData(element)){var prop,isSimpleSetter=isDefined(value),isSimpleGetter=!isSimpleSetter&&key&&!isObject(key),massGetter=!key,expandoStore=jqLiteExpandoStore(element,!isSimpleGetter),data=expandoStore&&expandoStore.data;if(isSimpleSetter)data[kebabToCamel(key)]=value;else{if(massGetter)return data;if(isSimpleGetter)return data&&data[kebabToCamel(key)];for(prop in key)data[kebabToCamel(prop)]=key[prop]}}}function jqLiteHasClass(element,selector){return!!element.getAttribute&&(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+selector+" ")>-1}function jqLiteRemoveClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," "),newClasses=existingClasses;forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),newClasses=newClasses.replace(" "+cssClass+" "," ")}),newClasses!==existingClasses&&element.setAttribute("class",trim(newClasses))}}function jqLiteAddClass(element,cssClasses){if(cssClasses&&element.setAttribute){var existingClasses=(" "+(element.getAttribute("class")||"")+" ").replace(/[\n\t]/g," "),newClasses=existingClasses;forEach(cssClasses.split(" "),function(cssClass){cssClass=trim(cssClass),-1===newClasses.indexOf(" "+cssClass+" ")&&(newClasses+=cssClass+" ")}),newClasses!==existingClasses&&element.setAttribute("class",trim(newClasses))}}function jqLiteAddNodes(root,elements){if(elements)if(elements.nodeType)root[root.length++]=elements;else{var length=elements.length;if("number"==typeof length&&elements.window!==elements){if(length)for(var i=0;i<length;i++)root[root.length++]=elements[i]}else root[root.length++]=elements}}function jqLiteController(element,name){return jqLiteInheritedData(element,"$"+(name||"ngController")+"Controller")}function jqLiteInheritedData(element,name,value){element.nodeType===NODE_TYPE_DOCUMENT&&(element=element.documentElement);for(var names=isArray(name)?name:[name];element;){for(var i=0,ii=names.length;i<ii;i++)if(isDefined(value=jqLite.data(element,names[i])))return value;element=element.parentNode||element.nodeType===NODE_TYPE_DOCUMENT_FRAGMENT&&element.host}}function jqLiteEmpty(element){for(jqLiteDealoc(element,!0);element.firstChild;)element.removeChild(element.firstChild)}function jqLiteRemove(element,keepData){keepData||jqLiteDealoc(element);var parent=element.parentNode;parent&&parent.removeChild(element)}function jqLiteReady(fn){function trigger(){window.document.removeEventListener("DOMContentLoaded",trigger),window.removeEventListener("load",trigger),fn()}"complete"===window.document.readyState?window.setTimeout(fn):(window.document.addEventListener("DOMContentLoaded",trigger),window.addEventListener("load",trigger))}var JQLitePrototype=JQLite.prototype={ready:jqLiteReady,toString:function(){var value=[];return forEach(this,function(e){value.push(""+e)}),"["+value.join(", ")+"]"},eq:function(index){return jqLite(index>=0?this[index]:this[this.length+index])},length:0,push:push,sort:[].sort,splice:[].splice},BOOLEAN_ATTR={};forEach("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(value){BOOLEAN_ATTR[lowercase(value)]=value});var BOOLEAN_ELEMENTS={};forEach("input,select,option,textarea,button,form,details".split(","),function(value){BOOLEAN_ELEMENTS[value]=!0});var ALIASED_ATTR={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern",ngStep:"step"};function getBooleanAttrName(element,name){var booleanAttr=BOOLEAN_ATTR[name.toLowerCase()];return booleanAttr&&BOOLEAN_ELEMENTS[nodeName_(element)]&&booleanAttr}function defaultHandlerWrapper(element,event,handler){handler.call(element,event)}function specialMouseHandlerWrapper(target,event,handler){var related=event.relatedTarget;related&&(related===target||jqLiteContains.call(target,related))||handler.call(target,event)}function $$jqLiteProvider(){this.$get=function(){return extend(JQLite,{hasClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteHasClass(node,classes)},addClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteAddClass(node,classes)},removeClass:function(node,classes){return node.attr&&(node=node[0]),jqLiteRemoveClass(node,classes)}})}}function hashKey(obj,nextUidFn){var key=obj&&obj.$$hashKey;if(key)return"function"==typeof key&&(key=obj.$$hashKey()),key;var objType=typeof obj;return key="function"===objType||"object"===objType&&null!==obj?obj.$$hashKey=objType+":"+(nextUidFn||nextUid)():objType+":"+obj}forEach({data:jqLiteData,removeData:jqLiteRemoveData,hasData:function(node){for(var key in jqCache[node.ng339])return!0;return!1},cleanData:function(nodes){for(var i=0,ii=nodes.length;i<ii;i++)jqLiteRemoveData(nodes[i]),jqLiteOff(nodes[i])}},function(fn,name){JQLite[name]=fn}),forEach({data:jqLiteData,inheritedData:jqLiteInheritedData,scope:function(element){return jqLite.data(element,"$scope")||jqLiteInheritedData(element.parentNode||element,["$isolateScope","$scope"])},isolateScope:function(element){return jqLite.data(element,"$isolateScope")||jqLite.data(element,"$isolateScopeNoTemplate")},controller:jqLiteController,injector:function(element){return jqLiteInheritedData(element,"$injector")},removeAttr:function(element,name){element.removeAttribute(name)},hasClass:jqLiteHasClass,css:function(element,name,value){if(name=function(name){return kebabToCamel(name.replace(MS_HACK_REGEXP,"ms-"))}(name),!isDefined(value))return element.style[name];element.style[name]=value},attr:function(element,name,value){var ret,nodeType=element.nodeType;if(nodeType!==NODE_TYPE_TEXT&&2!==nodeType&&nodeType!==NODE_TYPE_COMMENT&&element.getAttribute){var lowercasedName=lowercase(name),isBooleanAttr=BOOLEAN_ATTR[lowercasedName];if(!isDefined(value))return ret=element.getAttribute(name),isBooleanAttr&&null!==ret&&(ret=lowercasedName),null===ret?void 0:ret;null===value||!1===value&&isBooleanAttr?element.removeAttribute(name):element.setAttribute(name,isBooleanAttr?lowercasedName:value)}},prop:function(element,name,value){if(!isDefined(value))return element[name];element[name]=value},text:function(){return getText.$dv="",getText;function getText(element,value){if(isUndefined(value)){var nodeType=element.nodeType;return nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_TEXT?element.textContent:""}element.textContent=value}}(),val:function(element,value){if(isUndefined(value)){if(element.multiple&&"select"===nodeName_(element)){var result=[];return forEach(element.options,function(option){option.selected&&result.push(option.value||option.text)}),result}return element.value}element.value=value},html:function(element,value){if(isUndefined(value))return element.innerHTML;jqLiteDealoc(element,!0),element.innerHTML=value},empty:jqLiteEmpty},function(fn,name){JQLite.prototype[name]=function(arg1,arg2){var i,key,nodeCount=this.length;if(fn!==jqLiteEmpty&&isUndefined(2===fn.length&&fn!==jqLiteHasClass&&fn!==jqLiteController?arg1:arg2)){if(isObject(arg1)){for(i=0;i<nodeCount;i++)if(fn===jqLiteData)fn(this[i],arg1);else for(key in arg1)fn(this[i],key,arg1[key]);return this}for(var value=fn.$dv,jj=isUndefined(value)?Math.min(nodeCount,1):nodeCount,j=0;j<jj;j++){var nodeValue=fn(this[j],arg1,arg2);value=value?value+nodeValue:nodeValue}return value}for(i=0;i<nodeCount;i++)fn(this[i],arg1,arg2);return this}}),forEach({removeData:jqLiteRemoveData,on:function(element,type,fn,unsupported){if(isDefined(unsupported))throw jqLiteMinErr("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if(jqLiteAcceptsData(element)){var expandoStore=jqLiteExpandoStore(element,!0),events=expandoStore.events,handle=expandoStore.handle;handle||(handle=expandoStore.handle=function(element,events){var eventHandler=function(event,type){event.isDefaultPrevented=function(){return event.defaultPrevented};var eventFns=events[type||event.type],eventFnsLength=eventFns?eventFns.length:0;if(eventFnsLength){if(isUndefined(event.immediatePropagationStopped)){var originalStopImmediatePropagation=event.stopImmediatePropagation;event.stopImmediatePropagation=function(){event.immediatePropagationStopped=!0,event.stopPropagation&&event.stopPropagation(),originalStopImmediatePropagation&&originalStopImmediatePropagation.call(event)}}event.isImmediatePropagationStopped=function(){return!0===event.immediatePropagationStopped};var handlerWrapper=eventFns.specialHandlerWrapper||defaultHandlerWrapper;eventFnsLength>1&&(eventFns=shallowCopy(eventFns));for(var i=0;i<eventFnsLength;i++)event.isImmediatePropagationStopped()||handlerWrapper(element,event,eventFns[i])}};return eventHandler.elem=element,eventHandler}(element,events));for(var types=type.indexOf(" ")>=0?type.split(" "):[type],i=types.length,addHandler=function(type,specialHandlerWrapper,noEventListener){var eventFns=events[type];eventFns||((eventFns=events[type]=[]).specialHandlerWrapper=specialHandlerWrapper,"$destroy"===type||noEventListener||element.addEventListener(type,handle)),eventFns.push(fn)};i--;)type=types[i],MOUSE_EVENT_MAP[type]?(addHandler(MOUSE_EVENT_MAP[type],specialMouseHandlerWrapper),addHandler(type,void 0,!0)):addHandler(type)}},off:jqLiteOff,one:function(element,type,fn){(element=jqLite(element)).on(type,function onFn(){element.off(type,fn),element.off(type,onFn)}),element.on(type,fn)},replaceWith:function(element,replaceNode){var index,parent=element.parentNode;jqLiteDealoc(element),forEach(new JQLite(replaceNode),function(node){index?parent.insertBefore(node,index.nextSibling):parent.replaceChild(node,element),index=node})},children:function(element){var children=[];return forEach(element.childNodes,function(element){element.nodeType===NODE_TYPE_ELEMENT&&children.push(element)}),children},contents:function(element){return element.contentDocument||element.childNodes||[]},append:function(element,node){var nodeType=element.nodeType;if(nodeType===NODE_TYPE_ELEMENT||nodeType===NODE_TYPE_DOCUMENT_FRAGMENT)for(var i=0,ii=(node=new JQLite(node)).length;i<ii;i++){var child=node[i];element.appendChild(child)}},prepend:function(element,node){if(element.nodeType===NODE_TYPE_ELEMENT){var index=element.firstChild;forEach(new JQLite(node),function(child){element.insertBefore(child,index)})}},wrap:function(element,wrapNode){var node,wrapper,parent;node=element,wrapper=jqLite(wrapNode).eq(0).clone()[0],(parent=node.parentNode)&&parent.replaceChild(wrapper,node),wrapper.appendChild(node)},remove:jqLiteRemove,detach:function(element){jqLiteRemove(element,!0)},after:function(element,newElement){var index=element,parent=element.parentNode;if(parent)for(var i=0,ii=(newElement=new JQLite(newElement)).length;i<ii;i++){var node=newElement[i];parent.insertBefore(node,index.nextSibling),index=node}},addClass:jqLiteAddClass,removeClass:jqLiteRemoveClass,toggleClass:function(element,selector,condition){selector&&forEach(selector.split(" "),function(className){var classCondition=condition;isUndefined(classCondition)&&(classCondition=!jqLiteHasClass(element,className)),(classCondition?jqLiteAddClass:jqLiteRemoveClass)(element,className)})},parent:function(element){var parent=element.parentNode;return parent&&parent.nodeType!==NODE_TYPE_DOCUMENT_FRAGMENT?parent:null},next:function(element){return element.nextElementSibling},find:function(element,selector){return element.getElementsByTagName?element.getElementsByTagName(selector):[]},clone:jqLiteClone,triggerHandler:function(element,event,extraParameters){var dummyEvent,eventFnsCopy,handlerArgs,eventName=event.type||event,expandoStore=jqLiteExpandoStore(element),events=expandoStore&&expandoStore.events,eventFns=events&&events[eventName];eventFns&&(dummyEvent={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:noop,type:eventName,target:element},event.type&&(dummyEvent=extend(dummyEvent,event)),eventFnsCopy=shallowCopy(eventFns),handlerArgs=extraParameters?[dummyEvent].concat(extraParameters):[dummyEvent],forEach(eventFnsCopy,function(fn){dummyEvent.isImmediatePropagationStopped()||fn.apply(element,handlerArgs)}))}},function(fn,name){JQLite.prototype[name]=function(arg1,arg2,arg3){for(var value,i=0,ii=this.length;i<ii;i++)isUndefined(value)?isDefined(value=fn(this[i],arg1,arg2,arg3))&&(value=jqLite(value)):jqLiteAddNodes(value,fn(this[i],arg1,arg2,arg3));return isDefined(value)?value:this}}),JQLite.prototype.bind=JQLite.prototype.on,JQLite.prototype.unbind=JQLite.prototype.off;var nanKey=Object.create(null);function NgMapShim(){this._keys=[],this._values=[],this._lastKey=NaN,this._lastIndex=-1}NgMapShim.prototype={_idx:function(key){return key!==this._lastKey&&(this._lastKey=key,this._lastIndex=this._keys.indexOf(key)),this._lastIndex},_transformKey:function(key){return isNumberNaN(key)?nanKey:key},get:function(key){key=this._transformKey(key);var idx=this._idx(key);if(-1!==idx)return this._values[idx]},has:function(key){return key=this._transformKey(key),-1!==this._idx(key)},set:function(key,value){key=this._transformKey(key);var idx=this._idx(key);-1===idx&&(idx=this._lastIndex=this._keys.length),this._keys[idx]=key,this._values[idx]=value},delete:function(key){key=this._transformKey(key);var idx=this._idx(key);return-1!==idx&&(this._keys.splice(idx,1),this._values.splice(idx,1),this._lastKey=NaN,this._lastIndex=-1,!0)}};var NgMap=NgMapShim,$$MapProvider=[function(){this.$get=[function(){return NgMap}]}],ARROW_ARG=/^([^(]+?)=>/,FN_ARGS=/^[^(]*\(\s*([^)]*)\)/m,FN_ARG_SPLIT=/,/,FN_ARG=/^\s*(_?)(\S+?)\1\s*$/,STRIP_COMMENTS=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,$injectorMinErr=minErr("$injector");function stringifyFn(fn){return Function.prototype.toString.call(fn)}function extractArgs(fn){var fnText=stringifyFn(fn).replace(STRIP_COMMENTS,"");return fnText.match(ARROW_ARG)||fnText.match(FN_ARGS)}function createInjector(modulesToLoad,strictDi){strictDi=!0===strictDi;var INSTANTIATING={},providerSuffix="Provider",path=[],loadedModules=new NgMap,providerCache={$provide:{provider:supportObject(provider),factory:supportObject(factory),service:supportObject(function(name,constructor){return factory(name,["$injector",function($injector){return $injector.instantiate(constructor)}])}),value:supportObject(function(name,val){return factory(name,valueFn(val),!1)}),constant:supportObject(function(name,value){assertNotHasOwnProperty(name,"constant"),providerCache[name]=value,instanceCache[name]=value}),decorator:function(serviceName,decorFn){var origProvider=providerInjector.get(serviceName+providerSuffix),orig$get=origProvider.$get;origProvider.$get=function(){var origInstance=instanceInjector.invoke(orig$get,origProvider);return instanceInjector.invoke(decorFn,null,{$delegate:origInstance})}}}},providerInjector=providerCache.$injector=createInternalInjector(providerCache,function(serviceName,caller){throw angular.isString(caller)&&path.push(caller),$injectorMinErr("unpr","Unknown provider: {0}",path.join(" <- "))}),instanceCache={},protoInstanceInjector=createInternalInjector(instanceCache,function(serviceName,caller){var provider=providerInjector.get(serviceName+providerSuffix,caller);return instanceInjector.invoke(provider.$get,provider,void 0,serviceName)}),instanceInjector=protoInstanceInjector;providerCache["$injector"+providerSuffix]={$get:valueFn(protoInstanceInjector)},instanceInjector.modules=providerInjector.modules=createMap();var runBlocks=loadModules(modulesToLoad);return(instanceInjector=protoInstanceInjector.get("$injector")).strictDi=strictDi,forEach(runBlocks,function(fn){fn&&instanceInjector.invoke(fn)}),instanceInjector.loadNewModules=function(mods){forEach(loadModules(mods),function(fn){fn&&instanceInjector.invoke(fn)})},instanceInjector;function supportObject(delegate){return function(key,value){if(!isObject(key))return delegate(key,value);forEach(key,reverseParams(delegate))}}function provider(name,provider_){if(assertNotHasOwnProperty(name,"service"),(isFunction(provider_)||isArray(provider_))&&(provider_=providerInjector.instantiate(provider_)),!provider_.$get)throw $injectorMinErr("pget","Provider '{0}' must define $get factory method.",name);return providerCache[name+providerSuffix]=provider_}function factory(name,factoryFn,enforce){return provider(name,{$get:!1!==enforce?function(name,factory){return function(){var result=instanceInjector.invoke(factory,this);if(isUndefined(result))throw $injectorMinErr("undef","Provider '{0}' must return a value from $get factory method.",name);return result}}(name,factoryFn):factoryFn})}function loadModules(modulesToLoad){assertArg(isUndefined(modulesToLoad)||isArray(modulesToLoad),"modulesToLoad","not an array");var moduleFn,runBlocks=[];return forEach(modulesToLoad,function(module){if(!loadedModules.get(module)){loadedModules.set(module,!0);try{isString(module)?(moduleFn=angularModule(module),instanceInjector.modules[module]=moduleFn,runBlocks=runBlocks.concat(loadModules(moduleFn.requires)).concat(moduleFn._runBlocks),runInvokeQueue(moduleFn._invokeQueue),runInvokeQueue(moduleFn._configBlocks)):isFunction(module)?runBlocks.push(providerInjector.invoke(module)):isArray(module)?runBlocks.push(providerInjector.invoke(module)):assertArgFn(module,"module")}catch(e){throw isArray(module)&&(module=module[module.length-1]),e.message&&e.stack&&-1===e.stack.indexOf(e.message)&&(e=e.message+"\n"+e.stack),$injectorMinErr("modulerr","Failed to instantiate module {0} due to:\n{1}",module,e.stack||e.message||e)}}function runInvokeQueue(queue){var i,ii;for(i=0,ii=queue.length;i<ii;i++){var invokeArgs=queue[i],provider=providerInjector.get(invokeArgs[0]);provider[invokeArgs[1]].apply(provider,invokeArgs[2])}}}),runBlocks}function createInternalInjector(cache,factory){function getService(serviceName,caller){if(cache.hasOwnProperty(serviceName)){if(cache[serviceName]===INSTANTIATING)throw $injectorMinErr("cdep","Circular dependency found: {0}",serviceName+" <- "+path.join(" <- "));return cache[serviceName]}try{return path.unshift(serviceName),cache[serviceName]=INSTANTIATING,cache[serviceName]=factory(serviceName,caller),cache[serviceName]}catch(err){throw cache[serviceName]===INSTANTIATING&&delete cache[serviceName],err}finally{path.shift()}}function injectionArgs(fn,locals,serviceName){for(var args=[],$inject=createInjector.$$annotate(fn,strictDi,serviceName),i=0,length=$inject.length;i<length;i++){var key=$inject[i];if("string"!=typeof key)throw $injectorMinErr("itkn","Incorrect injection token! Expected service name as string, got {0}",key);args.push(locals&&locals.hasOwnProperty(key)?locals[key]:getService(key,serviceName))}return args}return{invoke:function(fn,self,locals,serviceName){"string"==typeof locals&&(serviceName=locals,locals=null);var args=injectionArgs(fn,locals,serviceName);return isArray(fn)&&(fn=fn[fn.length-1]),function(func){if(msie||"function"!=typeof func)return!1;var result=func.$$ngIsClass;return isBoolean(result)||(result=func.$$ngIsClass=/^class\b/.test(stringifyFn(func))),result}(fn)?(args.unshift(null),new(Function.prototype.bind.apply(fn,args))):fn.apply(self,args)},instantiate:function(Type,locals,serviceName){var ctor=isArray(Type)?Type[Type.length-1]:Type,args=injectionArgs(Type,locals,serviceName);return args.unshift(null),new(Function.prototype.bind.apply(ctor,args))},get:getService,annotate:createInjector.$$annotate,has:function(name){return providerCache.hasOwnProperty(name+providerSuffix)||cache.hasOwnProperty(name)}}}}function $AnchorScrollProvider(){var autoScrollingEnabled=!0;this.disableAutoScrolling=function(){autoScrollingEnabled=!1},this.$get=["$window","$location","$rootScope",function($window,$location,$rootScope){var document=$window.document;function scrollTo(elem){if(elem){elem.scrollIntoView();var offset=function(){var offset=scroll.yOffset;if(isFunction(offset))offset=offset();else if(isElement(offset)){var elem=offset[0];offset="fixed"!==$window.getComputedStyle(elem).position?0:elem.getBoundingClientRect().bottom}else isNumber(offset)||(offset=0);return offset}();if(offset){var elemTop=elem.getBoundingClientRect().top;$window.scrollBy(0,elemTop-offset)}}else $window.scrollTo(0,0)}function scroll(hash){var elm,list,result;(hash=isString(hash)?hash:isNumber(hash)?hash.toString():$location.hash())?(elm=document.getElementById(hash))?scrollTo(elm):(list=document.getElementsByName(hash),result=null,Array.prototype.some.call(list,function(element){if("a"===nodeName_(element))return result=element,!0}),(elm=result)?scrollTo(elm):"top"===hash&&scrollTo(null)):scrollTo(null)}return autoScrollingEnabled&&$rootScope.$watch(function(){return $location.hash()},function(newVal,oldVal){var action,win;newVal===oldVal&&""===newVal||(action=function(){$rootScope.$evalAsync(scroll)},"complete"===(win=win||window).document.readyState?win.setTimeout(action):jqLite(win).on("load",action))}),scroll}]}createInjector.$$annotate=function(fn,strictDi,name){var $inject,last;if("function"==typeof fn){if(!($inject=fn.$inject)){if($inject=[],fn.length){if(strictDi)throw isString(name)&&name||(name=fn.name||function(fn){var args=extractArgs(fn);return args?"function("+(args[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}(fn)),$injectorMinErr("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",name);forEach(extractArgs(fn)[1].split(FN_ARG_SPLIT),function(arg){arg.replace(FN_ARG,function(all,underscore,name){$inject.push(name)})})}fn.$inject=$inject}}else isArray(fn)?(assertArgFn(fn[last=fn.length-1],"fn"),$inject=fn.slice(0,last)):assertArgFn(fn,"fn",!0);return $inject};var $animateMinErr=minErr("$animate"),ELEMENT_NODE=1;function mergeClasses(a,b){return a||b?a?b?(isArray(a)&&(a=a.join(" ")),isArray(b)&&(b=b.join(" ")),a+" "+b):a:b:""}function prepareAnimateOptions(options){return isObject(options)?options:{}}var $$CoreAnimateJsProvider=function(){this.$get=noop},$$CoreAnimateQueueProvider=function(){var postDigestQueue=new NgMap,postDigestElements=[];this.$get=["$$AnimateRunner","$rootScope",function($$AnimateRunner,$rootScope){return{enabled:noop,on:noop,off:noop,pin:noop,push:function(element,event,options,domOperation){domOperation&&domOperation(),(options=options||{}).from&&element.css(options.from),options.to&&element.css(options.to),(options.addClass||options.removeClass)&&function(element,add,remove){var data=postDigestQueue.get(element)||{},classesAdded=updateData(data,add,!0),classesRemoved=updateData(data,remove,!1);(classesAdded||classesRemoved)&&(postDigestQueue.set(element,data),postDigestElements.push(element),1===postDigestElements.length&&$rootScope.$$postDigest(handleCSSClassChanges))}(element,options.addClass,options.removeClass);var runner=new $$AnimateRunner;return runner.complete(),runner}};function updateData(data,classes,value){var changed=!1;return classes&&forEach(classes=isString(classes)?classes.split(" "):isArray(classes)?classes:[],function(className){className&&(changed=!0,data[className]=value)}),changed}function handleCSSClassChanges(){forEach(postDigestElements,function(element){var data=postDigestQueue.get(element);if(data){var existing=function(classes){isString(classes)&&(classes=classes.split(" "));var obj=createMap();return forEach(classes,function(klass){klass.length&&(obj[klass]=!0)}),obj}(element.attr("class")),toAdd="",toRemove="";forEach(data,function(status,className){status!==!!existing[className]&&(status?toAdd+=(toAdd.length?" ":"")+className:toRemove+=(toRemove.length?" ":"")+className)}),forEach(element,function(elm){toAdd&&jqLiteAddClass(elm,toAdd),toRemove&&jqLiteRemoveClass(elm,toRemove)}),postDigestQueue.delete(element)}}),postDigestElements.length=0}}]},$AnimateProvider=["$provide",function($provide){var provider=this,classNameFilter=null,customFilter=null;this.$$registeredAnimations=Object.create(null),this.register=function(name,factory){if(name&&"."!==name.charAt(0))throw $animateMinErr("notcsel","Expecting class selector starting with '.' got '{0}'.",name);var key=name+"-animation";provider.$$registeredAnimations[name.substr(1)]=key,$provide.factory(key,factory)},this.customFilter=function(filterFn){return 1===arguments.length&&(customFilter=isFunction(filterFn)?filterFn:null),customFilter},this.classNameFilter=function(expression){if(1===arguments.length&&((classNameFilter=expression instanceof RegExp?expression:null)&&new RegExp("[(\\s|\\/)]ng-animate[(\\s|\\/)]").test(classNameFilter.toString())))throw classNameFilter=null,$animateMinErr("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',"ng-animate");return classNameFilter},this.$get=["$$animateQueue",function($$animateQueue){function domInsert(element,parentElement,afterElement){if(afterElement){var afterNode=function(element){for(var i=0;i<element.length;i++){var elm=element[i];if(elm.nodeType===ELEMENT_NODE)return elm}}(afterElement);!afterNode||afterNode.parentNode||afterNode.previousElementSibling||(afterElement=null)}afterElement?afterElement.after(element):parentElement.prepend(element)}return{on:$$animateQueue.on,off:$$animateQueue.off,pin:$$animateQueue.pin,enabled:$$animateQueue.enabled,cancel:function(runner){runner.cancel&&runner.cancel()},enter:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),domInsert(element,parent=parent||after.parent(),after),$$animateQueue.push(element,"enter",prepareAnimateOptions(options))},move:function(element,parent,after,options){return parent=parent&&jqLite(parent),after=after&&jqLite(after),domInsert(element,parent=parent||after.parent(),after),$$animateQueue.push(element,"move",prepareAnimateOptions(options))},leave:function(element,options){return $$animateQueue.push(element,"leave",prepareAnimateOptions(options),function(){element.remove()})},addClass:function(element,className,options){return(options=prepareAnimateOptions(options)).addClass=mergeClasses(options.addclass,className),$$animateQueue.push(element,"addClass",options)},removeClass:function(element,className,options){return(options=prepareAnimateOptions(options)).removeClass=mergeClasses(options.removeClass,className),$$animateQueue.push(element,"removeClass",options)},setClass:function(element,add,remove,options){return(options=prepareAnimateOptions(options)).addClass=mergeClasses(options.addClass,add),options.removeClass=mergeClasses(options.removeClass,remove),$$animateQueue.push(element,"setClass",options)},animate:function(element,from,to,className,options){return(options=prepareAnimateOptions(options)).from=options.from?extend(options.from,from):from,options.to=options.to?extend(options.to,to):to,className=className||"ng-inline-animate",options.tempClasses=mergeClasses(options.tempClasses,className),$$animateQueue.push(element,"animate",options)}}}]}],$$AnimateAsyncRunFactoryProvider=function(){this.$get=["$$rAF",function($$rAF){var waitQueue=[];function waitForTick(fn){waitQueue.push(fn),waitQueue.length>1||$$rAF(function(){for(var i=0;i<waitQueue.length;i++)waitQueue[i]();waitQueue=[]})}return function(){var passed=!1;return waitForTick(function(){passed=!0}),function(callback){passed?callback():waitForTick(callback)}}}]},$$AnimateRunnerFactoryProvider=function(){this.$get=["$q","$sniffer","$$animateAsyncRun","$$isDocumentHidden","$timeout",function($q,$sniffer,$$animateAsyncRun,$$isDocumentHidden,$timeout){function AnimateRunner(host){this.setHost(host);var rafTick=$$animateAsyncRun();this._doneCallbacks=[],this._tick=function(fn){$$isDocumentHidden()?function(fn){$timeout(fn,0,!1)}(fn):rafTick(fn)},this._state=0}return AnimateRunner.chain=function(chain,callback){var index=0;!function next(){if(index===chain.length)return void callback(!0);chain[index](function(response){!1!==response?(index++,next()):callback(!1)})}()},AnimateRunner.all=function(runners,callback){var count=0,status=!0;function onProgress(response){status=status&&response,++count===runners.length&&callback(status)}forEach(runners,function(runner){runner.done(onProgress)})},AnimateRunner.prototype={setHost:function(host){this.host=host||{}},done:function(fn){2===this._state?fn():this._doneCallbacks.push(fn)},progress:noop,getPromise:function(){if(!this.promise){var self=this;this.promise=$q(function(resolve,reject){self.done(function(status){!1===status?reject():resolve()})})}return this.promise},then:function(resolveHandler,rejectHandler){return this.getPromise().then(resolveHandler,rejectHandler)},catch:function(handler){return this.getPromise().catch(handler)},finally:function(handler){return this.getPromise().finally(handler)},pause:function(){this.host.pause&&this.host.pause()},resume:function(){this.host.resume&&this.host.resume()},end:function(){this.host.end&&this.host.end(),this._resolve(!0)},cancel:function(){this.host.cancel&&this.host.cancel(),this._resolve(!1)},complete:function(response){var self=this;0===self._state&&(self._state=1,self._tick(function(){self._resolve(response)}))},_resolve:function(response){2!==this._state&&(forEach(this._doneCallbacks,function(fn){fn(response)}),this._doneCallbacks.length=0,this._state=2)}},AnimateRunner}]},$CoreAnimateCssProvider=function(){this.$get=["$$rAF","$q","$$AnimateRunner",function($$rAF,$q,$$AnimateRunner){return function(element,initialOptions){var options=initialOptions||{};options.$$prepared||(options=copy(options)),options.cleanupStyles&&(options.from=options.to=null),options.from&&(element.css(options.from),options.from=null);var closed,runner=new $$AnimateRunner;return{start:run,end:run};function run(){return $$rAF(function(){!function(){options.addClass&&(element.addClass(options.addClass),options.addClass=null);options.removeClass&&(element.removeClass(options.removeClass),options.removeClass=null);options.to&&(element.css(options.to),options.to=null)}(),closed||runner.complete(),closed=!0}),runner}}}]};function $BrowserProvider(){this.$get=["$window","$log","$sniffer","$document","$$taskTrackerFactory",function($window,$log,$sniffer,$document,$$taskTrackerFactory){return new function(window,document,$log,$sniffer,$$taskTrackerFactory){var self=this,location=window.location,history=window.history,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,pendingDeferIds={},taskTracker=$$taskTrackerFactory($log);self.isMock=!1,self.$$completeOutstandingRequest=taskTracker.completeTask,self.$$incOutstandingRequestCount=taskTracker.incTaskCount,self.notifyWhenNoOutstandingRequests=taskTracker.notifyWhenNoPendingTasks;var cachedState,lastHistoryState,lastBrowserUrl=location.href,baseElement=document.find("base"),pendingLocation=null,getCurrentState=$sniffer.history?function(){try{return history.state}catch(e){}}:noop;cacheState(),self.url=function(url,replace,state){if(isUndefined(state)&&(state=null),location!==window.location&&(location=window.location),history!==window.history&&(history=window.history),url){var sameState=lastHistoryState===state;if(url=urlResolve(url).href,lastBrowserUrl===url&&(!$sniffer.history||sameState))return self;var sameBase=lastBrowserUrl&&stripHash(lastBrowserUrl)===stripHash(url);return lastBrowserUrl=url,lastHistoryState=state,!$sniffer.history||sameBase&&sameState?(sameBase||(pendingLocation=url),replace?location.replace(url):sameBase?location.hash=function(url){var index=url.indexOf("#");return-1===index?"":url.substr(index)}(url):location.href=url,location.href!==url&&(pendingLocation=url)):(history[replace?"replaceState":"pushState"](state,"",url),cacheState()),pendingLocation&&(pendingLocation=url),self}return function(url){return url.replace(/#$/,"")}(pendingLocation||location.href)},self.state=function(){return cachedState};var urlChangeListeners=[],urlChangeInit=!1;function cacheStateAndFireUrlChange(){pendingLocation=null,fireStateOrUrlChange()}var lastCachedState=null;function cacheState(){equals(cachedState=isUndefined(cachedState=getCurrentState())?null:cachedState,lastCachedState)&&(cachedState=lastCachedState),lastCachedState=cachedState,lastHistoryState=cachedState}function fireStateOrUrlChange(){var prevLastHistoryState=lastHistoryState;cacheState(),lastBrowserUrl===self.url()&&prevLastHistoryState===cachedState||(lastBrowserUrl=self.url(),lastHistoryState=cachedState,forEach(urlChangeListeners,function(listener){listener(self.url(),cachedState)}))}self.onUrlChange=function(callback){return urlChangeInit||($sniffer.history&&jqLite(window).on("popstate",cacheStateAndFireUrlChange),jqLite(window).on("hashchange",cacheStateAndFireUrlChange),urlChangeInit=!0),urlChangeListeners.push(callback),callback},self.$$applicationDestroyed=function(){jqLite(window).off("hashchange popstate",cacheStateAndFireUrlChange)},self.$$checkUrlChange=fireStateOrUrlChange,self.baseHref=function(){var href=baseElement.attr("href");return href?href.replace(/^(https?:)?\/\/[^/]*/,""):""},self.defer=function(fn,delay,taskType){var timeoutId;return delay=delay||0,taskType=taskType||taskTracker.DEFAULT_TASK_TYPE,taskTracker.incTaskCount(taskType),timeoutId=setTimeout(function(){delete pendingDeferIds[timeoutId],taskTracker.completeTask(fn,taskType)},delay),pendingDeferIds[timeoutId]=taskType,timeoutId},self.defer.cancel=function(deferId){if(pendingDeferIds.hasOwnProperty(deferId)){var taskType=pendingDeferIds[deferId];return delete pendingDeferIds[deferId],clearTimeout(deferId),taskTracker.completeTask(noop,taskType),!0}return!1}}($window,$document,$log,$sniffer,$$taskTrackerFactory)}]}function $CacheFactoryProvider(){this.$get=function(){var caches={};function cacheFactory(cacheId,options){if(cacheId in caches)throw minErr("$cacheFactory")("iid","CacheId '{0}' is already taken!",cacheId);var size=0,stats=extend({},options,{id:cacheId}),data=createMap(),capacity=options&&options.capacity||Number.MAX_VALUE,lruHash=createMap(),freshEnd=null,staleEnd=null;return caches[cacheId]={put:function(key,value){if(!isUndefined(value)){if(capacity<Number.MAX_VALUE)refresh(lruHash[key]||(lruHash[key]={key:key}));return key in data||size++,data[key]=value,size>capacity&&this.remove(staleEnd.key),value}},get:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;refresh(lruEntry)}return data[key]},remove:function(key){if(capacity<Number.MAX_VALUE){var lruEntry=lruHash[key];if(!lruEntry)return;lruEntry===freshEnd&&(freshEnd=lruEntry.p),lruEntry===staleEnd&&(staleEnd=lruEntry.n),link(lruEntry.n,lruEntry.p),delete lruHash[key]}key in data&&(delete data[key],size--)},removeAll:function(){data=createMap(),size=0,lruHash=createMap(),freshEnd=staleEnd=null},destroy:function(){data=null,stats=null,lruHash=null,delete caches[cacheId]},info:function(){return extend({},stats,{size:size})}};function refresh(entry){entry!==freshEnd&&(staleEnd?staleEnd===entry&&(staleEnd=entry.n):staleEnd=entry,link(entry.n,entry.p),link(entry,freshEnd),(freshEnd=entry).n=null)}function link(nextEntry,prevEntry){nextEntry!==prevEntry&&(nextEntry&&(nextEntry.p=prevEntry),prevEntry&&(prevEntry.n=nextEntry))}}return cacheFactory.info=function(){var info={};return forEach(caches,function(cache,cacheId){info[cacheId]=cache.info()}),info},cacheFactory.get=function(cacheId){return caches[cacheId]},cacheFactory}}function $TemplateCacheProvider(){this.$get=["$cacheFactory",function($cacheFactory){return $cacheFactory("templates")}]}var $compileMinErr=minErr("$compile");var _UNINITIALIZED_VALUE=new function(){};function $CompileProvider($provide,$$sanitizeUriProvider){var hasDirectives={},Suffix="Directive",COMMENT_DIRECTIVE_REGEXP=/^\s*directive:\s*([\w-]+)\s+(.*)$/,CLASS_DIRECTIVE_REGEXP=/(([\w-]+)(?::([^;]+))?;?)/,ALL_OR_NOTHING_ATTRS=function(str){var i,obj={},items=str.split(",");for(i=0;i<items.length;i++)obj[items[i]]=!0;return obj}("ngSrc,ngSrcset,src,srcset"),REQUIRE_PREFIX_REGEXP=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,EVENT_HANDLER_ATTR_REGEXP=/^(on[a-z]+|formaction)$/,bindingCache=createMap();function parseIsolateBindings(scope,directiveName,isController){var LOCAL_REGEXP=/^([@&]|[=<](\*?))(\??)\s*([\w$]*)$/,bindings=createMap();return forEach(scope,function(definition,scopeName){if((definition=definition.trim())in bindingCache)bindings[scopeName]=bindingCache[definition];else{var match=definition.match(LOCAL_REGEXP);if(!match)throw $compileMinErr("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",directiveName,scopeName,definition,isController?"controller bindings definition":"isolate scope definition");bindings[scopeName]={mode:match[1][0],collection:"*"===match[2],optional:"?"===match[3],attrName:match[4]||scopeName},match[4]&&(bindingCache[definition]=bindings[scopeName])}}),bindings}function parseDirectiveBindings(directive,directiveName){var bindings={isolateScope:null,bindToController:null};if(isObject(directive.scope)&&(!0===directive.bindToController?(bindings.bindToController=parseIsolateBindings(directive.scope,directiveName,!0),bindings.isolateScope={}):bindings.isolateScope=parseIsolateBindings(directive.scope,directiveName,!1)),isObject(directive.bindToController)&&(bindings.bindToController=parseIsolateBindings(directive.bindToController,directiveName,!0)),bindings.bindToController&&!directive.controller)throw $compileMinErr("noctrl","Cannot bind to controller without directive '{0}'s controller.",directiveName);return bindings}this.directive=function registerDirective(name,directiveFactory){return assertArg(name,"name"),assertNotHasOwnProperty(name,"directive"),isString(name)?(!function(name){var letter=name.charAt(0);if(!letter||letter!==lowercase(letter))throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The first character must be a lowercase letter",name);if(name!==name.trim())throw $compileMinErr("baddir","Directive/Component name '{0}' is invalid. The name should not contain leading or trailing whitespaces",name)}(name),assertArg(directiveFactory,"directiveFactory"),hasDirectives.hasOwnProperty(name)||(hasDirectives[name]=[],$provide.factory(name+Suffix,["$injector","$exceptionHandler",function($injector,$exceptionHandler){var directives=[];return forEach(hasDirectives[name],function(directiveFactory,index){try{var directive=$injector.invoke(directiveFactory);isFunction(directive)?directive={compile:valueFn(directive)}:!directive.compile&&directive.link&&(directive.compile=valueFn(directive.link)),directive.priority=directive.priority||0,directive.index=index,directive.name=directive.name||name,directive.require=function(directive){var require=directive.require||directive.controller&&directive.name;return!isArray(require)&&isObject(require)&&forEach(require,function(value,key){var match=value.match(REQUIRE_PREFIX_REGEXP);value.substring(match[0].length)||(require[key]=match[0]+key)}),require}(directive),directive.restrict=function(restrict,name){if(restrict&&(!isString(restrict)||!/[EACM]/.test(restrict)))throw $compileMinErr("badrestrict","Restrict property '{0}' of directive '{1}' is invalid",restrict,name);return restrict||"EA"}(directive.restrict,name),directive.$$moduleName=directiveFactory.$$moduleName,directives.push(directive)}catch(e){$exceptionHandler(e)}}),directives}])),hasDirectives[name].push(directiveFactory)):forEach(name,reverseParams(registerDirective)),this},this.component=function registerComponent(name,options){if(!isString(name))return forEach(name,reverseParams(bind(this,registerComponent))),this;var controller=options.controller||function(){};function factory($injector){function makeInjectable(fn){return isFunction(fn)||isArray(fn)?function(tElement,tAttrs){return $injector.invoke(fn,this,{$element:tElement,$attrs:tAttrs})}:fn}var template=options.template||options.templateUrl?options.template:"",ddo={controller:controller,controllerAs:function(controller,ident){if(ident&&isString(ident))return ident;if(isString(controller)){var match=CNTRL_REG.exec(controller);if(match)return match[3]}}(options.controller)||options.controllerAs||"$ctrl",template:makeInjectable(template),templateUrl:makeInjectable(options.templateUrl),transclude:options.transclude,scope:{},bindToController:options.bindings||{},restrict:"E",require:options.require};return forEach(options,function(val,key){"$"===key.charAt(0)&&(ddo[key]=val)}),ddo}return forEach(options,function(val,key){"$"===key.charAt(0)&&(factory[key]=val,isFunction(controller)&&(controller[key]=val))}),factory.$inject=["$injector"],this.directive(name,factory)},this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.aHrefSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?($$sanitizeUriProvider.imgSrcSanitizationWhitelist(regexp),this):$$sanitizeUriProvider.imgSrcSanitizationWhitelist()};var debugInfoEnabled=!0;this.debugInfoEnabled=function(enabled){return isDefined(enabled)?(debugInfoEnabled=enabled,this):debugInfoEnabled};var strictComponentBindingsEnabled=!1;this.strictComponentBindingsEnabled=function(enabled){return isDefined(enabled)?(strictComponentBindingsEnabled=enabled,this):strictComponentBindingsEnabled};var TTL=10;this.onChangesTtl=function(value){return arguments.length?(TTL=value,this):TTL};var commentDirectivesEnabledConfig=!0;this.commentDirectivesEnabled=function(value){return arguments.length?(commentDirectivesEnabledConfig=value,this):commentDirectivesEnabledConfig};var cssClassDirectivesEnabledConfig=!0;this.cssClassDirectivesEnabled=function(value){return arguments.length?(cssClassDirectivesEnabledConfig=value,this):cssClassDirectivesEnabledConfig};var PROP_CONTEXTS=createMap();this.addPropertySecurityContext=function(elementName,propertyName,ctx){var key=elementName.toLowerCase()+"|"+propertyName.toLowerCase();if(key in PROP_CONTEXTS&&PROP_CONTEXTS[key]!==ctx)throw $compileMinErr("ctxoverride","Property context '{0}.{1}' already set to '{2}', cannot override to '{3}'.",elementName,propertyName,PROP_CONTEXTS[key],ctx);return PROP_CONTEXTS[key]=ctx,this},function(){function registerContext(ctx,values){forEach(values,function(v){PROP_CONTEXTS[v.toLowerCase()]=ctx})}registerContext(SCE_CONTEXTS.HTML,["iframe|srcdoc","*|innerHTML","*|outerHTML"]),registerContext(SCE_CONTEXTS.CSS,["*|style"]),registerContext(SCE_CONTEXTS.URL,["area|href","area|ping","a|href","a|ping","blockquote|cite","body|background","del|cite","input|src","ins|cite","q|cite"]),registerContext(SCE_CONTEXTS.MEDIA_URL,["audio|src","img|src","img|srcset","source|src","source|srcset","track|src","video|src","video|poster"]),registerContext(SCE_CONTEXTS.RESOURCE_URL,["*|formAction","applet|code","applet|codebase","base|href","embed|src","frame|src","form|action","head|profile","html|manifest","iframe|src","link|href","media|src","object|codebase","object|data","script|src"])}(),this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$sce","$animate",function($injector,$interpolate,$exceptionHandler,$templateRequest,$parse,$controller,$rootScope,$sce,$animate){var onChangesQueue,SIMPLE_ATTR_NAME=/^\w/,specialAttrHolder=window.document.createElement("div"),commentDirectivesEnabled=commentDirectivesEnabledConfig,cssClassDirectivesEnabled=cssClassDirectivesEnabledConfig,onChangesTtl=TTL;function flushOnChangesQueue(){try{if(!--onChangesTtl)throw onChangesQueue=void 0,$compileMinErr("infchng","{0} $onChanges() iterations reached. Aborting!\n",TTL);$rootScope.$apply(function(){for(var i=0,ii=onChangesQueue.length;i<ii;++i)try{onChangesQueue[i]()}catch(e){$exceptionHandler(e)}onChangesQueue=void 0})}finally{onChangesTtl++}}function sanitizeSrcset(value,invokeType){if(!value)return value;if(!isString(value))throw $compileMinErr("srcset",'Can\'t pass trusted values to `{0}`: "{1}"',invokeType,value.toString());for(var result="",trimmedSrcset=trim(value),pattern=/\s/.test(trimmedSrcset)?/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/:/(,)/,rawUris=trimmedSrcset.split(pattern),nbrUrisWith2parts=Math.floor(rawUris.length/2),i=0;i<nbrUrisWith2parts;i++){var innerIdx=2*i;result+=$sce.getTrustedMediaUrl(trim(rawUris[innerIdx])),result+=" "+trim(rawUris[innerIdx+1])}var lastTuple=trim(rawUris[2*i]).split(/\s/);return result+=$sce.getTrustedMediaUrl(trim(lastTuple[0])),2===lastTuple.length&&(result+=" "+trim(lastTuple[1])),result}function Attributes(element,attributesToCopy){if(attributesToCopy){var i,l,key,keys=Object.keys(attributesToCopy);for(i=0,l=keys.length;i<l;i++)this[key=keys[i]]=attributesToCopy[key]}else this.$attr={};this.$$element=element}function safeAddClass($element,className){try{$element.addClass(className)}catch(e){}}Attributes.prototype={$normalize:directiveNormalize,$addClass:function(classVal){classVal&&classVal.length>0&&$animate.addClass(this.$$element,classVal)},$removeClass:function(classVal){classVal&&classVal.length>0&&$animate.removeClass(this.$$element,classVal)},$updateClass:function(newClasses,oldClasses){var toAdd=tokenDifference(newClasses,oldClasses);toAdd&&toAdd.length&&$animate.addClass(this.$$element,toAdd);var toRemove=tokenDifference(oldClasses,newClasses);toRemove&&toRemove.length&&$animate.removeClass(this.$$element,toRemove)},$set:function(key,value,writeAttr,attrName){var booleanKey=getBooleanAttrName(this.$$element[0],key),aliasedKey=ALIASED_ATTR[key],observer=key;booleanKey?(this.$$element.prop(key,value),attrName=booleanKey):aliasedKey&&(this[aliasedKey]=value,observer=aliasedKey),this[key]=value,attrName?this.$attr[key]=attrName:(attrName=this.$attr[key])||(this.$attr[key]=attrName=snake_case(key,"-")),"img"===nodeName_(this.$$element)&&"srcset"===key&&(this[key]=value=sanitizeSrcset(value,"$set('srcset', value)")),!1!==writeAttr&&(null===value||isUndefined(value)?this.$$element.removeAttr(attrName):SIMPLE_ATTR_NAME.test(attrName)?booleanKey&&!1===value?this.$$element.removeAttr(attrName):this.$$element.attr(attrName,value):function(element,attrName,value){specialAttrHolder.innerHTML="<span "+attrName+">";var attributes=specialAttrHolder.firstChild.attributes,attribute=attributes[0];attributes.removeNamedItem(attribute.name),attribute.value=value,element.attributes.setNamedItem(attribute)}(this.$$element[0],attrName,value));var $$observers=this.$$observers;$$observers&&forEach($$observers[observer],function(fn){try{fn(value)}catch(e){$exceptionHandler(e)}})},$observe:function(key,fn){var attrs=this,$$observers=attrs.$$observers||(attrs.$$observers=createMap()),listeners=$$observers[key]||($$observers[key]=[]);return listeners.push(fn),$rootScope.$evalAsync(function(){listeners.$$inter||!attrs.hasOwnProperty(key)||isUndefined(attrs[key])||fn(attrs[key])}),function(){arrayRemove(listeners,fn)}}};var startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),denormalizeTemplate="{{"===startSymbol&&"}}"===endSymbol?identity:function(template){return template.replace(/\{\{/g,startSymbol).replace(/}}/g,endSymbol)},NG_PREFIX_BINDING=/^ng(Attr|Prop|On)([A-Z].*)$/,MULTI_ELEMENT_DIR_RE=/^(.+)Start$/;return compile.$$addBindingInfo=debugInfoEnabled?function($element,binding){var bindings=$element.data("$binding")||[];isArray(binding)?bindings=bindings.concat(binding):bindings.push(binding),$element.data("$binding",bindings)}:noop,compile.$$addBindingClass=debugInfoEnabled?function($element){safeAddClass($element,"ng-binding")}:noop,compile.$$addScopeInfo=debugInfoEnabled?function($element,scope,isolated,noTemplate){var dataName=isolated?noTemplate?"$isolateScopeNoTemplate":"$isolateScope":"$scope";$element.data(dataName,scope)}:noop,compile.$$addScopeClass=debugInfoEnabled?function($element,isolated){safeAddClass($element,isolated?"ng-isolate-scope":"ng-scope")}:noop,compile.$$createComment=function(directiveName,comment){var content="";return debugInfoEnabled&&(content=" "+(directiveName||"")+": ",comment&&(content+=comment+" ")),window.document.createComment(content)},compile;function compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){$compileNodes instanceof jqLite||($compileNodes=jqLite($compileNodes));var compositeLinkFn=compileNodes($compileNodes,transcludeFn,$compileNodes,maxPriority,ignoreDirective,previousCompileContext);compile.$$addScopeClass($compileNodes);var namespace=null;return function(scope,cloneConnectFn,options){if(!$compileNodes)throw $compileMinErr("multilink","This element has already been linked.");assertArg(scope,"scope"),previousCompileContext&&previousCompileContext.needsNewScope&&(scope=scope.$parent.$new());var parentElement,node,$linkNode,parentBoundTranscludeFn=(options=options||{}).parentBoundTranscludeFn,transcludeControllers=options.transcludeControllers,futureParentElement=options.futureParentElement;if(parentBoundTranscludeFn&&parentBoundTranscludeFn.$$boundTransclude&&(parentBoundTranscludeFn=parentBoundTranscludeFn.$$boundTransclude),namespace||(node=(parentElement=futureParentElement)&&parentElement[0],namespace=node&&"foreignobject"!==nodeName_(node)&&toString.call(node).match(/SVG/)?"svg":"html"),$linkNode="html"!==namespace?jqLite(wrapTemplate(namespace,jqLite("<div></div>").append($compileNodes).html())):cloneConnectFn?JQLitePrototype.clone.call($compileNodes):$compileNodes,transcludeControllers)for(var controllerName in transcludeControllers)$linkNode.data("$"+controllerName+"Controller",transcludeControllers[controllerName].instance);return compile.$$addScopeInfo($linkNode,scope),cloneConnectFn&&cloneConnectFn($linkNode,scope),compositeLinkFn&&compositeLinkFn(scope,$linkNode,$linkNode,parentBoundTranscludeFn),cloneConnectFn||($compileNodes=compositeLinkFn=null),$linkNode}}function compileNodes(nodeList,transcludeFn,$rootElement,maxPriority,ignoreDirective,previousCompileContext){for(var attrs,directives,nodeLinkFn,childNodes,childLinkFn,linkFnFound,nodeLinkFnFound,linkFns=[],notLiveList=isArray(nodeList)||nodeList instanceof jqLite,i=0;i<nodeList.length;i++)attrs=new Attributes,11===msie&&mergeConsecutiveTextNodes(nodeList,i,notLiveList),(nodeLinkFn=(directives=collectDirectives(nodeList[i],[],attrs,0===i?maxPriority:void 0,ignoreDirective)).length?applyDirectivesToNode(directives,nodeList[i],attrs,transcludeFn,$rootElement,null,[],[],previousCompileContext):null)&&nodeLinkFn.scope&&compile.$$addScopeClass(attrs.$$element),childLinkFn=nodeLinkFn&&nodeLinkFn.terminal||!(childNodes=nodeList[i].childNodes)||!childNodes.length?null:compileNodes(childNodes,nodeLinkFn?(nodeLinkFn.transcludeOnThisElement||!nodeLinkFn.templateOnThisElement)&&nodeLinkFn.transclude:transcludeFn),(nodeLinkFn||childLinkFn)&&(linkFns.push(i,nodeLinkFn,childLinkFn),linkFnFound=!0,nodeLinkFnFound=nodeLinkFnFound||nodeLinkFn),previousCompileContext=null;return linkFnFound?function(scope,nodeList,$rootElement,parentBoundTranscludeFn){var nodeLinkFn,childLinkFn,node,childScope,i,ii,idx,childBoundTranscludeFn,stableNodeList;if(nodeLinkFnFound){var nodeListLength=nodeList.length;for(stableNodeList=new Array(nodeListLength),i=0;i<linkFns.length;i+=3)idx=linkFns[i],stableNodeList[idx]=nodeList[idx]}else stableNodeList=nodeList;for(i=0,ii=linkFns.length;i<ii;)node=stableNodeList[linkFns[i++]],nodeLinkFn=linkFns[i++],childLinkFn=linkFns[i++],nodeLinkFn?(nodeLinkFn.scope?(childScope=scope.$new(),compile.$$addScopeInfo(jqLite(node),childScope)):childScope=scope,childBoundTranscludeFn=nodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,nodeLinkFn.transclude,parentBoundTranscludeFn):!nodeLinkFn.templateOnThisElement&&parentBoundTranscludeFn?parentBoundTranscludeFn:!parentBoundTranscludeFn&&transcludeFn?createBoundTranscludeFn(scope,transcludeFn):null,nodeLinkFn(childLinkFn,childScope,node,$rootElement,childBoundTranscludeFn)):childLinkFn&&childLinkFn(scope,node.childNodes,void 0,parentBoundTranscludeFn)}:null}function mergeConsecutiveTextNodes(nodeList,idx,notLiveList){var sibling,node=nodeList[idx],parent=node.parentNode;if(node.nodeType===NODE_TYPE_TEXT)for(;(sibling=parent?node.nextSibling:nodeList[idx+1])&&sibling.nodeType===NODE_TYPE_TEXT;)node.nodeValue=node.nodeValue+sibling.nodeValue,sibling.parentNode&&sibling.parentNode.removeChild(sibling),notLiveList&&sibling===nodeList[idx+1]&&nodeList.splice(idx+1,1)}function createBoundTranscludeFn(scope,transcludeFn,previousBoundTranscludeFn){function boundTranscludeFn(transcludedScope,cloneFn,controllers,futureParentElement,containingScope){return transcludedScope||((transcludedScope=scope.$new(!1,containingScope)).$$transcluded=!0),transcludeFn(transcludedScope,cloneFn,{parentBoundTranscludeFn:previousBoundTranscludeFn,transcludeControllers:controllers,futureParentElement:futureParentElement})}var boundSlots=boundTranscludeFn.$$slots=createMap();for(var slotName in transcludeFn.$$slots)transcludeFn.$$slots[slotName]?boundSlots[slotName]=createBoundTranscludeFn(scope,transcludeFn.$$slots[slotName],previousBoundTranscludeFn):boundSlots[slotName]=null;return boundTranscludeFn}function collectDirectives(node,directives,attrs,maxPriority,ignoreDirective){var match,nodeName,className,nodeType=node.nodeType,attrsMap=attrs.$attr;switch(nodeType){case NODE_TYPE_ELEMENT:addDirective(directives,directiveNormalize(nodeName=nodeName_(node)),"E",maxPriority,ignoreDirective);for(var attr,name,nName,value,ngPrefixMatch,nAttrs=node.attributes,j=0,jj=nAttrs&&nAttrs.length;j<jj;j++){var multiElementMatch,attrStartName=!1,attrEndName=!1,isNgAttr=!1,isNgProp=!1,isNgEvent=!1;name=(attr=nAttrs[j]).name,value=attr.value,(ngPrefixMatch=(nName=directiveNormalize(name.toLowerCase())).match(NG_PREFIX_BINDING))?(isNgAttr="Attr"===ngPrefixMatch[1],isNgProp="Prop"===ngPrefixMatch[1],isNgEvent="On"===ngPrefixMatch[1],name=name.replace(PREFIX_REGEXP,"").toLowerCase().substr(4+ngPrefixMatch[1].length).replace(/_(.)/g,function(match,letter){return letter.toUpperCase()})):(multiElementMatch=nName.match(MULTI_ELEMENT_DIR_RE))&&directiveIsMultiElement(multiElementMatch[1])&&(attrStartName=name,attrEndName=name.substr(0,name.length-5)+"end",name=name.substr(0,name.length-6)),isNgProp||isNgEvent?(attrs[nName]=value,attrsMap[nName]=attr.name,isNgProp?addPropertyDirective(node,directives,nName,name):addEventDirective(directives,nName,name)):(attrsMap[nName=directiveNormalize(name.toLowerCase())]=name,!isNgAttr&&attrs.hasOwnProperty(nName)||(attrs[nName]=value,getBooleanAttrName(node,nName)&&(attrs[nName]=!0)),addAttrInterpolateDirective(node,directives,value,nName,isNgAttr),addDirective(directives,nName,"A",maxPriority,ignoreDirective,attrStartName,attrEndName))}if("input"===nodeName&&"hidden"===node.getAttribute("type")&&node.setAttribute("autocomplete","off"),!cssClassDirectivesEnabled)break;if(isObject(className=node.className)&&(className=className.animVal),isString(className)&&""!==className)for(;match=CLASS_DIRECTIVE_REGEXP.exec(className);)addDirective(directives,nName=directiveNormalize(match[2]),"C",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[3])),className=className.substr(match.index+match[0].length);break;case NODE_TYPE_TEXT:!function(directives,text){var interpolateFn=$interpolate(text,!0);interpolateFn&&directives.push({priority:0,compile:function(templateNode){var templateNodeParent=templateNode.parent(),hasCompileParent=!!templateNodeParent.length;return hasCompileParent&&compile.$$addBindingClass(templateNodeParent),function(scope,node){var parent=node.parent();hasCompileParent||compile.$$addBindingClass(parent),compile.$$addBindingInfo(parent,interpolateFn.expressions),scope.$watch(interpolateFn,function(value){node[0].nodeValue=value})}}})}(directives,node.nodeValue);break;case NODE_TYPE_COMMENT:if(!commentDirectivesEnabled)break;!function(node,directives,attrs,maxPriority,ignoreDirective){try{var match=COMMENT_DIRECTIVE_REGEXP.exec(node.nodeValue);if(match){var nName=directiveNormalize(match[1]);addDirective(directives,nName,"M",maxPriority,ignoreDirective)&&(attrs[nName]=trim(match[2]))}}catch(e){}}(node,directives,attrs,maxPriority,ignoreDirective)}return directives.sort(byPriority),directives}function groupScan(node,attrStart,attrEnd){var nodes=[],depth=0;if(attrStart&&node.hasAttribute&&node.hasAttribute(attrStart))do{if(!node)throw $compileMinErr("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",attrStart,attrEnd);node.nodeType===NODE_TYPE_ELEMENT&&(node.hasAttribute(attrStart)&&depth++,node.hasAttribute(attrEnd)&&depth--),nodes.push(node),node=node.nextSibling}while(depth>0);else nodes.push(node);return jqLite(nodes)}function groupElementsLinkFnWrapper(linkFn,attrStart,attrEnd){return function(scope,element,attrs,controllers,transcludeFn){return element=groupScan(element[0],attrStart,attrEnd),linkFn(scope,element,attrs,controllers,transcludeFn)}}function compilationGenerator(eager,$compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext){var compiled;return eager?compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext):function(){return compiled||(compiled=compile($compileNodes,transcludeFn,maxPriority,ignoreDirective,previousCompileContext),$compileNodes=transcludeFn=previousCompileContext=null),compiled.apply(this,arguments)}}function applyDirectivesToNode(directives,compileNode,templateAttrs,transcludeFn,jqCollection,originalReplaceDirective,preLinkFns,postLinkFns,previousCompileContext){previousCompileContext=previousCompileContext||{};for(var directive,directiveName,$template,linkFn,directiveValue,terminalPriority=-Number.MAX_VALUE,newScopeDirective=previousCompileContext.newScopeDirective,controllerDirectives=previousCompileContext.controllerDirectives,newIsolateScopeDirective=previousCompileContext.newIsolateScopeDirective,templateDirective=previousCompileContext.templateDirective,nonTlbTranscludeDirective=previousCompileContext.nonTlbTranscludeDirective,hasTranscludeDirective=!1,hasTemplate=!1,hasElementTranscludeDirective=previousCompileContext.hasElementTranscludeDirective,$compileNode=templateAttrs.$$element=jqLite(compileNode),replaceDirective=originalReplaceDirective,childTranscludeFn=transcludeFn,didScanForMultipleTransclusion=!1,mightHaveMultipleTransclusionError=!1,i=0,ii=directives.length;i<ii;i++){var attrStart=(directive=directives[i]).$$start,attrEnd=directive.$$end;if(attrStart&&($compileNode=groupScan(compileNode,attrStart,attrEnd)),$template=void 0,terminalPriority>directive.priority)break;if((directiveValue=directive.scope)&&(directive.templateUrl||(isObject(directiveValue)?(assertNoDuplicate("new/isolated scope",newIsolateScopeDirective||newScopeDirective,directive,$compileNode),newIsolateScopeDirective=directive):assertNoDuplicate("new/isolated scope",newIsolateScopeDirective,directive,$compileNode)),newScopeDirective=newScopeDirective||directive),directiveName=directive.name,!didScanForMultipleTransclusion&&(directive.replace&&(directive.templateUrl||directive.template)||directive.transclude&&!directive.$$tlb)){for(var candidateDirective,scanningIndex=i+1;candidateDirective=directives[scanningIndex++];)if(candidateDirective.transclude&&!candidateDirective.$$tlb||candidateDirective.replace&&(candidateDirective.templateUrl||candidateDirective.template)){mightHaveMultipleTransclusionError=!0;break}didScanForMultipleTransclusion=!0}if(!directive.templateUrl&&directive.controller&&(controllerDirectives=controllerDirectives||createMap(),assertNoDuplicate("'"+directiveName+"' controller",controllerDirectives[directiveName],directive,$compileNode),controllerDirectives[directiveName]=directive),directiveValue=directive.transclude)if(hasTranscludeDirective=!0,directive.$$tlb||(assertNoDuplicate("transclusion",nonTlbTranscludeDirective,directive,$compileNode),nonTlbTranscludeDirective=directive),"element"===directiveValue)hasElementTranscludeDirective=!0,terminalPriority=directive.priority,$template=$compileNode,$compileNode=templateAttrs.$$element=jqLite(compile.$$createComment(directiveName,templateAttrs[directiveName])),compileNode=$compileNode[0],replaceWith(jqCollection,sliceArgs($template),compileNode),childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,terminalPriority,replaceDirective&&replaceDirective.name,{nonTlbTranscludeDirective:nonTlbTranscludeDirective});else{var slots=createMap();if(isObject(directiveValue)){$template=window.document.createDocumentFragment();var slotMap=createMap(),filledSlots=createMap();for(var slotName in forEach(directiveValue,function(elementSelector,slotName){var optional="?"===elementSelector.charAt(0);elementSelector=optional?elementSelector.substring(1):elementSelector,slotMap[elementSelector]=slotName,slots[slotName]=null,filledSlots[slotName]=optional}),forEach($compileNode.contents(),function(node){var slotName=slotMap[directiveNormalize(nodeName_(node))];slotName?(filledSlots[slotName]=!0,slots[slotName]=slots[slotName]||window.document.createDocumentFragment(),slots[slotName].appendChild(node)):$template.appendChild(node)}),forEach(filledSlots,function(filled,slotName){if(!filled)throw $compileMinErr("reqslot","Required transclusion slot `{0}` was not filled.",slotName)}),slots)if(slots[slotName]){var slotCompileNodes=jqLite(slots[slotName].childNodes);slots[slotName]=compilationGenerator(mightHaveMultipleTransclusionError,slotCompileNodes,transcludeFn)}$template=jqLite($template.childNodes)}else $template=jqLite(jqLiteClone(compileNode)).contents();$compileNode.empty(),(childTranscludeFn=compilationGenerator(mightHaveMultipleTransclusionError,$template,transcludeFn,void 0,void 0,{needsNewScope:directive.$$isolateScope||directive.$$newScope})).$$slots=slots}if(directive.template)if(hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directiveValue=isFunction(directive.template)?directive.template($compileNode,templateAttrs):directive.template,directiveValue=denormalizeTemplate(directiveValue),directive.replace){if(replaceDirective=directive,$template=jqLiteIsTextNode(directiveValue)?[]:removeComments(wrapTemplate(directive.templateNamespace,trim(directiveValue))),compileNode=$template[0],1!==$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",directiveName,"");replaceWith(jqCollection,$compileNode,compileNode);var newTemplateAttrs={$attr:{}},templateDirectives=collectDirectives(compileNode,[],newTemplateAttrs),unprocessedDirectives=directives.splice(i+1,directives.length-(i+1));(newIsolateScopeDirective||newScopeDirective)&&markDirectiveScope(templateDirectives,newIsolateScopeDirective,newScopeDirective),directives=directives.concat(templateDirectives).concat(unprocessedDirectives),mergeTemplateAttributes(templateAttrs,newTemplateAttrs),ii=directives.length}else $compileNode.html(directiveValue);if(directive.templateUrl)hasTemplate=!0,assertNoDuplicate("template",templateDirective,directive,$compileNode),templateDirective=directive,directive.replace&&(replaceDirective=directive),nodeLinkFn=compileTemplateUrl(directives.splice(i,directives.length-i),$compileNode,templateAttrs,jqCollection,hasTranscludeDirective&&childTranscludeFn,preLinkFns,postLinkFns,{controllerDirectives:controllerDirectives,newScopeDirective:newScopeDirective!==directive&&newScopeDirective,newIsolateScopeDirective:newIsolateScopeDirective,templateDirective:templateDirective,nonTlbTranscludeDirective:nonTlbTranscludeDirective}),ii=directives.length;else if(directive.compile)try{linkFn=directive.compile($compileNode,templateAttrs,childTranscludeFn);var context=directive.$$originalDirective||directive;isFunction(linkFn)?addLinkFns(null,bind(context,linkFn),attrStart,attrEnd):linkFn&&addLinkFns(bind(context,linkFn.pre),bind(context,linkFn.post),attrStart,attrEnd)}catch(e){$exceptionHandler(e,startingTag($compileNode))}directive.terminal&&(nodeLinkFn.terminal=!0,terminalPriority=Math.max(terminalPriority,directive.priority))}return nodeLinkFn.scope=newScopeDirective&&!0===newScopeDirective.scope,nodeLinkFn.transcludeOnThisElement=hasTranscludeDirective,nodeLinkFn.templateOnThisElement=hasTemplate,nodeLinkFn.transclude=childTranscludeFn,previousCompileContext.hasElementTranscludeDirective=hasElementTranscludeDirective,nodeLinkFn;function addLinkFns(pre,post,attrStart,attrEnd){pre&&(attrStart&&(pre=groupElementsLinkFnWrapper(pre,attrStart,attrEnd)),pre.require=directive.require,pre.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(pre=cloneAndAnnotateFn(pre,{isolateScope:!0})),preLinkFns.push(pre)),post&&(attrStart&&(post=groupElementsLinkFnWrapper(post,attrStart,attrEnd)),post.require=directive.require,post.directiveName=directiveName,(newIsolateScopeDirective===directive||directive.$$isolateScope)&&(post=cloneAndAnnotateFn(post,{isolateScope:!0})),postLinkFns.push(post))}function nodeLinkFn(childLinkFn,scope,linkNode,$rootElement,boundTranscludeFn){var i,ii,linkFn,isolateScope,controllerScope,elementControllers,transcludeFn,$element,attrs,scopeBindingInfo;for(var name in compileNode===linkNode?(attrs=templateAttrs,$element=templateAttrs.$$element):attrs=new Attributes($element=jqLite(linkNode),templateAttrs),controllerScope=scope,newIsolateScopeDirective?isolateScope=scope.$new(!0):newScopeDirective&&(controllerScope=scope.$parent),boundTranscludeFn&&((transcludeFn=function(scope,cloneAttachFn,futureParentElement,slotName){var transcludeControllers;isScope(scope)||(slotName=futureParentElement,futureParentElement=cloneAttachFn,cloneAttachFn=scope,scope=void 0);hasElementTranscludeDirective&&(transcludeControllers=elementControllers);futureParentElement||(futureParentElement=hasElementTranscludeDirective?$element.parent():$element);if(!slotName)return boundTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);var slotTranscludeFn=boundTranscludeFn.$$slots[slotName];if(slotTranscludeFn)return slotTranscludeFn(scope,cloneAttachFn,transcludeControllers,futureParentElement,scopeToChild);if(isUndefined(slotTranscludeFn))throw $compileMinErr("noslot",'No parent directive that requires a transclusion with slot name "{0}". Element: {1}',slotName,startingTag($element))}).$$boundTransclude=boundTranscludeFn,transcludeFn.isSlotFilled=function(slotName){return!!boundTranscludeFn.$$slots[slotName]}),controllerDirectives&&(elementControllers=function($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective){var elementControllers=createMap();for(var controllerKey in controllerDirectives){var directive=controllerDirectives[controllerKey],locals={$scope:directive===newIsolateScopeDirective||directive.$$isolateScope?isolateScope:scope,$element:$element,$attrs:attrs,$transclude:transcludeFn},controller=directive.controller;"@"===controller&&(controller=attrs[directive.name]);var controllerInstance=$controller(controller,locals,!0,directive.controllerAs);elementControllers[directive.name]=controllerInstance,$element.data("$"+directive.name+"Controller",controllerInstance.instance)}return elementControllers}($element,attrs,transcludeFn,controllerDirectives,isolateScope,scope,newIsolateScopeDirective)),newIsolateScopeDirective&&(compile.$$addScopeInfo($element,isolateScope,!0,!(templateDirective&&(templateDirective===newIsolateScopeDirective||templateDirective===newIsolateScopeDirective.$$originalDirective))),compile.$$addScopeClass($element,!0),isolateScope.$$isolateBindings=newIsolateScopeDirective.$$isolateBindings,(scopeBindingInfo=initializeDirectiveBindings(scope,attrs,isolateScope,isolateScope.$$isolateBindings,newIsolateScopeDirective)).removeWatches&&isolateScope.$on("$destroy",scopeBindingInfo.removeWatches)),elementControllers){var controllerDirective=controllerDirectives[name],controller=elementControllers[name],bindings=controllerDirective.$$bindings.bindToController;controller.instance=controller(),$element.data("$"+controllerDirective.name+"Controller",controller.instance),controller.bindingInfo=initializeDirectiveBindings(controllerScope,attrs,controller.instance,bindings,controllerDirective)}for(forEach(controllerDirectives,function(controllerDirective,name){var require=controllerDirective.require;controllerDirective.bindToController&&!isArray(require)&&isObject(require)&&extend(elementControllers[name].instance,getControllers(name,require,$element,elementControllers))}),forEach(elementControllers,function(controller){var controllerInstance=controller.instance;if(isFunction(controllerInstance.$onChanges))try{controllerInstance.$onChanges(controller.bindingInfo.initialChanges)}catch(e){$exceptionHandler(e)}if(isFunction(controllerInstance.$onInit))try{controllerInstance.$onInit()}catch(e){$exceptionHandler(e)}isFunction(controllerInstance.$doCheck)&&(controllerScope.$watch(function(){controllerInstance.$doCheck()}),controllerInstance.$doCheck()),isFunction(controllerInstance.$onDestroy)&&controllerScope.$on("$destroy",function(){controllerInstance.$onDestroy()})}),i=0,ii=preLinkFns.length;i<ii;i++)invokeLinkFn(linkFn=preLinkFns[i],linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);var scopeToChild=scope;for(newIsolateScopeDirective&&(newIsolateScopeDirective.template||null===newIsolateScopeDirective.templateUrl)&&(scopeToChild=isolateScope),childLinkFn&&childLinkFn(scopeToChild,linkNode.childNodes,void 0,boundTranscludeFn),i=postLinkFns.length-1;i>=0;i--)invokeLinkFn(linkFn=postLinkFns[i],linkFn.isolateScope?isolateScope:scope,$element,attrs,linkFn.require&&getControllers(linkFn.directiveName,linkFn.require,$element,elementControllers),transcludeFn);forEach(elementControllers,function(controller){var controllerInstance=controller.instance;isFunction(controllerInstance.$postLink)&&controllerInstance.$postLink()})}}function getControllers(directiveName,require,$element,elementControllers){var value;if(isString(require)){var match=require.match(REQUIRE_PREFIX_REGEXP),name=require.substring(match[0].length),inheritType=match[1]||match[3],optional="?"===match[2];if("^^"===inheritType?$element=$element.parent():value=(value=elementControllers&&elementControllers[name])&&value.instance,!value){var dataName="$"+name+"Controller";value="^^"===inheritType&&$element[0]&&$element[0].nodeType===NODE_TYPE_DOCUMENT?null:inheritType?$element.inheritedData(dataName):$element.data(dataName)}if(!value&&!optional)throw $compileMinErr("ctreq","Controller '{0}', required by directive '{1}', can't be found!",name,directiveName)}else if(isArray(require)){value=[];for(var i=0,ii=require.length;i<ii;i++)value[i]=getControllers(directiveName,require[i],$element,elementControllers)}else isObject(require)&&(value={},forEach(require,function(controller,property){value[property]=getControllers(directiveName,controller,$element,elementControllers)}));return value||null}function markDirectiveScope(directives,isolateScope,newScope){for(var j=0,jj=directives.length;j<jj;j++)directives[j]=inherit(directives[j],{$$isolateScope:isolateScope,$$newScope:newScope})}function addDirective(tDirectives,name,location,maxPriority,ignoreDirective,startAttrName,endAttrName){if(name===ignoreDirective)return null;var match=null;if(hasDirectives.hasOwnProperty(name))for(var directive,directives=$injector.get(name+Suffix),i=0,ii=directives.length;i<ii;i++)if(directive=directives[i],(isUndefined(maxPriority)||maxPriority>directive.priority)&&-1!==directive.restrict.indexOf(location)){if(startAttrName&&(directive=inherit(directive,{$$start:startAttrName,$$end:endAttrName})),!directive.$$bindings){var bindings=directive.$$bindings=parseDirectiveBindings(directive,directive.name);isObject(bindings.isolateScope)&&(directive.$$isolateBindings=bindings.isolateScope)}tDirectives.push(directive),match=directive}return match}function directiveIsMultiElement(name){if(hasDirectives.hasOwnProperty(name))for(var directives=$injector.get(name+Suffix),i=0,ii=directives.length;i<ii;i++)if(directives[i].multiElement)return!0;return!1}function mergeTemplateAttributes(dst,src){var srcAttr=src.$attr,dstAttr=dst.$attr;forEach(dst,function(value,key){"$"!==key.charAt(0)&&(src[key]&&src[key]!==value&&(value.length?value+=("style"===key?";":" ")+src[key]:value=src[key]),dst.$set(key,value,!0,srcAttr[key]))}),forEach(src,function(value,key){dst.hasOwnProperty(key)||"$"===key.charAt(0)||(dst[key]=value,"class"!==key&&"style"!==key&&(dstAttr[key]=srcAttr[key]))})}function compileTemplateUrl(directives,$compileNode,tAttrs,$rootElement,childTranscludeFn,preLinkFns,postLinkFns,previousCompileContext){var afterTemplateNodeLinkFn,afterTemplateChildLinkFn,linkQueue=[],beforeTemplateCompileNode=$compileNode[0],origAsyncDirective=directives.shift(),derivedSyncDirective=inherit(origAsyncDirective,{templateUrl:null,transclude:null,replace:null,$$originalDirective:origAsyncDirective}),templateUrl=isFunction(origAsyncDirective.templateUrl)?origAsyncDirective.templateUrl($compileNode,tAttrs):origAsyncDirective.templateUrl,templateNamespace=origAsyncDirective.templateNamespace;return $compileNode.empty(),$templateRequest(templateUrl).then(function(content){var compileNode,tempTemplateAttrs,$template,childBoundTranscludeFn;if(content=denormalizeTemplate(content),origAsyncDirective.replace){if($template=jqLiteIsTextNode(content)?[]:removeComments(wrapTemplate(templateNamespace,trim(content))),compileNode=$template[0],1!==$template.length||compileNode.nodeType!==NODE_TYPE_ELEMENT)throw $compileMinErr("tplrt","Template for directive '{0}' must have exactly one root element. {1}",origAsyncDirective.name,templateUrl);tempTemplateAttrs={$attr:{}},replaceWith($rootElement,$compileNode,compileNode);var templateDirectives=collectDirectives(compileNode,[],tempTemplateAttrs);isObject(origAsyncDirective.scope)&&markDirectiveScope(templateDirectives,!0),directives=templateDirectives.concat(directives),mergeTemplateAttributes(tAttrs,tempTemplateAttrs)}else compileNode=beforeTemplateCompileNode,$compileNode.html(content);for(directives.unshift(derivedSyncDirective),afterTemplateNodeLinkFn=applyDirectivesToNode(directives,compileNode,tAttrs,childTranscludeFn,$compileNode,origAsyncDirective,preLinkFns,postLinkFns,previousCompileContext),forEach($rootElement,function(node,i){node===compileNode&&($rootElement[i]=$compileNode[0])}),afterTemplateChildLinkFn=compileNodes($compileNode[0].childNodes,childTranscludeFn);linkQueue.length;){var scope=linkQueue.shift(),beforeTemplateLinkNode=linkQueue.shift(),linkRootElement=linkQueue.shift(),boundTranscludeFn=linkQueue.shift(),linkNode=$compileNode[0];if(!scope.$$destroyed){if(beforeTemplateLinkNode!==beforeTemplateCompileNode){var oldClasses=beforeTemplateLinkNode.className;previousCompileContext.hasElementTranscludeDirective&&origAsyncDirective.replace||(linkNode=jqLiteClone(compileNode)),replaceWith(linkRootElement,jqLite(beforeTemplateLinkNode),linkNode),safeAddClass(jqLite(linkNode),oldClasses)}childBoundTranscludeFn=afterTemplateNodeLinkFn.transcludeOnThisElement?createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn):boundTranscludeFn,afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,linkNode,$rootElement,childBoundTranscludeFn)}}linkQueue=null}).catch(function(error){isError(error)&&$exceptionHandler(error)}),function(ignoreChildLinkFn,scope,node,rootElement,boundTranscludeFn){var childBoundTranscludeFn=boundTranscludeFn;scope.$$destroyed||(linkQueue?linkQueue.push(scope,node,rootElement,childBoundTranscludeFn):(afterTemplateNodeLinkFn.transcludeOnThisElement&&(childBoundTranscludeFn=createBoundTranscludeFn(scope,afterTemplateNodeLinkFn.transclude,boundTranscludeFn)),afterTemplateNodeLinkFn(afterTemplateChildLinkFn,scope,node,rootElement,childBoundTranscludeFn)))}}function byPriority(a,b){var diff=b.priority-a.priority;return 0!==diff?diff:a.name!==b.name?a.name<b.name?-1:1:a.index-b.index}function assertNoDuplicate(what,previousDirective,directive,element){function wrapModuleNameIfDefined(moduleName){return moduleName?" (module: "+moduleName+")":""}if(previousDirective)throw $compileMinErr("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",previousDirective.name,wrapModuleNameIfDefined(previousDirective.$$moduleName),directive.name,wrapModuleNameIfDefined(directive.$$moduleName),what,startingTag(element))}function wrapTemplate(type,template){switch(type=lowercase(type||"html")){case"svg":case"math":var wrapper=window.document.createElement("div");return wrapper.innerHTML="<"+type+">"+template+"</"+type+">",wrapper.childNodes[0].childNodes;default:return template}}function sanitizeSrcsetPropertyValue(value){return sanitizeSrcset($sce.valueOf(value),"ng-prop-srcset")}function addPropertyDirective(node,directives,attrName,propName){if(EVENT_HANDLER_ATTR_REGEXP.test(propName))throw $compileMinErr("nodomevents","Property bindings for HTML DOM event properties are disallowed");var nodeName=nodeName_(node),trustedContext=function(nodeName,propNormalizedName){var prop=propNormalizedName.toLowerCase();return PROP_CONTEXTS[nodeName+"|"+prop]||PROP_CONTEXTS["*|"+prop]}(nodeName,propName),sanitizer=identity;"srcset"!==propName||"img"!==nodeName&&"source"!==nodeName?trustedContext&&(sanitizer=$sce.getTrusted.bind($sce,trustedContext)):sanitizer=sanitizeSrcsetPropertyValue,directives.push({priority:100,compile:function(_,attr){var ngPropGetter=$parse(attr[attrName]),ngPropWatch=$parse(attr[attrName],function(val){return $sce.valueOf(val)});return{pre:function(scope,$element){function applyPropValue(){var propValue=ngPropGetter(scope);$element[0][propName]=sanitizer(propValue)}applyPropValue(),scope.$watch(ngPropWatch,applyPropValue)}}}})}function addEventDirective(directives,attrName,eventName){directives.push(createEventDirective($parse,$rootScope,$exceptionHandler,attrName,eventName,!1))}function addAttrInterpolateDirective(node,directives,value,name,isNgAttr){var nodeName=nodeName_(node),trustedContext=function(nodeName,attrNormalizedName){return"srcdoc"===attrNormalizedName?$sce.HTML:"src"===attrNormalizedName||"ngSrc"===attrNormalizedName?-1===["img","video","audio","source","track"].indexOf(nodeName)?$sce.RESOURCE_URL:$sce.MEDIA_URL:"xlinkHref"===attrNormalizedName?"image"===nodeName?$sce.MEDIA_URL:"a"===nodeName?$sce.URL:$sce.RESOURCE_URL:"form"===nodeName&&"action"===attrNormalizedName||"base"===nodeName&&"href"===attrNormalizedName||"link"===nodeName&&"href"===attrNormalizedName?$sce.RESOURCE_URL:"a"!==nodeName||"href"!==attrNormalizedName&&"ngHref"!==attrNormalizedName?void 0:$sce.URL}(nodeName,name),mustHaveExpression=!isNgAttr,allOrNothing=ALL_OR_NOTHING_ATTRS[name]||isNgAttr,interpolateFn=$interpolate(value,mustHaveExpression,trustedContext,allOrNothing);if(interpolateFn){if("multiple"===name&&"select"===nodeName)throw $compileMinErr("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",startingTag(node));if(EVENT_HANDLER_ATTR_REGEXP.test(name))throw $compileMinErr("nodomevents","Interpolations for HTML DOM event attributes are disallowed");directives.push({priority:100,compile:function(){return{pre:function(scope,element,attr){var $$observers=attr.$$observers||(attr.$$observers=createMap()),newValue=attr[name];newValue!==value&&(interpolateFn=newValue&&$interpolate(newValue,!0,trustedContext,allOrNothing),value=newValue),interpolateFn&&(attr[name]=interpolateFn(scope),($$observers[name]||($$observers[name]=[])).$$inter=!0,(attr.$$observers&&attr.$$observers[name].$$scope||scope).$watch(interpolateFn,function(newValue,oldValue){"class"===name&&newValue!==oldValue?attr.$updateClass(newValue,oldValue):attr.$set(name,newValue)}))}}}})}}function replaceWith($rootElement,elementsToRemove,newNode){var i,ii,firstElementToRemove=elementsToRemove[0],removeCount=elementsToRemove.length,parent=firstElementToRemove.parentNode;if($rootElement)for(i=0,ii=$rootElement.length;i<ii;i++)if($rootElement[i]===firstElementToRemove){$rootElement[i++]=newNode;for(var j=i,j2=j+removeCount-1,jj=$rootElement.length;j<jj;j++,j2++)j2<jj?$rootElement[j]=$rootElement[j2]:delete $rootElement[j];$rootElement.length-=removeCount-1,$rootElement.context===firstElementToRemove&&($rootElement.context=newNode);break}parent&&parent.replaceChild(newNode,firstElementToRemove);var fragment=window.document.createDocumentFragment();for(i=0;i<removeCount;i++)fragment.appendChild(elementsToRemove[i]);for(jqLite.hasData(firstElementToRemove)&&(jqLite.data(newNode,jqLite.data(firstElementToRemove)),jqLite(firstElementToRemove).off("$destroy")),jqLite.cleanData(fragment.querySelectorAll("*")),i=1;i<removeCount;i++)delete elementsToRemove[i];elementsToRemove[0]=newNode,elementsToRemove.length=1}function cloneAndAnnotateFn(fn,annotation){return extend(function(){return fn.apply(null,arguments)},fn,annotation)}function invokeLinkFn(linkFn,scope,$element,attrs,controllers,transcludeFn){try{linkFn(scope,$element,attrs,controllers,transcludeFn)}catch(e){$exceptionHandler(e,startingTag($element))}}function strictBindingsCheck(attrName,directiveName){if(strictComponentBindingsEnabled)throw $compileMinErr("missingattr","Attribute '{0}' of '{1}' is non-optional and must be set!",attrName,directiveName)}function initializeDirectiveBindings(scope,attrs,destination,bindings,directive){var changes,removeWatchCollection=[],initialChanges={};function recordChanges(key,currentValue,previousValue){isFunction(destination.$onChanges)&&!simpleCompare(currentValue,previousValue)&&(onChangesQueue||(scope.$$postDigest(flushOnChangesQueue),onChangesQueue=[]),changes||(changes={},onChangesQueue.push(triggerOnChangesHook)),changes[key]&&(previousValue=changes[key].previousValue),changes[key]=new SimpleChange(previousValue,currentValue))}function triggerOnChangesHook(){destination.$onChanges(changes),changes=void 0}return forEach(bindings,function(definition,scopeName){var lastValue,parentGet,parentSet,compare,removeWatch,attrName=definition.attrName,optional=definition.optional;switch(definition.mode){case"@":optional||hasOwnProperty.call(attrs,attrName)||(strictBindingsCheck(attrName,directive.name),destination[scopeName]=attrs[attrName]=void 0),removeWatch=attrs.$observe(attrName,function(value){if(isString(value)||isBoolean(value)){var oldValue=destination[scopeName];recordChanges(scopeName,value,oldValue),destination[scopeName]=value}}),attrs.$$observers[attrName].$$scope=scope,isString(lastValue=attrs[attrName])?destination[scopeName]=$interpolate(lastValue)(scope):isBoolean(lastValue)&&(destination[scopeName]=lastValue),initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]),removeWatchCollection.push(removeWatch);break;case"=":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;strictBindingsCheck(attrName,directive.name),attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;parentGet=$parse(attrs[attrName]),compare=parentGet.literal?equals:simpleCompare,parentSet=parentGet.assign||function(){throw lastValue=destination[scopeName]=parentGet(scope),$compileMinErr("nonassign","Expression '{0}' in attribute '{1}' used with directive '{2}' is non-assignable!",attrs[attrName],attrName,directive.name)},lastValue=destination[scopeName]=parentGet(scope);var parentValueWatch=function(parentValue){return compare(parentValue,destination[scopeName])||(compare(parentValue,lastValue)?parentSet(scope,parentValue=destination[scopeName]):destination[scopeName]=parentValue),lastValue=parentValue};parentValueWatch.$stateful=!0,removeWatch=definition.collection?scope.$watchCollection(attrs[attrName],parentValueWatch):scope.$watch($parse(attrs[attrName],parentValueWatch),null,parentGet.literal),removeWatchCollection.push(removeWatch);break;case"<":if(!hasOwnProperty.call(attrs,attrName)){if(optional)break;strictBindingsCheck(attrName,directive.name),attrs[attrName]=void 0}if(optional&&!attrs[attrName])break;var isLiteral=(parentGet=$parse(attrs[attrName])).literal,initialValue=destination[scopeName]=parentGet(scope);initialChanges[scopeName]=new SimpleChange(_UNINITIALIZED_VALUE,destination[scopeName]),removeWatch=scope[definition.collection?"$watchCollection":"$watch"](parentGet,function(newValue,oldValue){if(oldValue===newValue){if(oldValue===initialValue||isLiteral&&equals(oldValue,initialValue))return;oldValue=initialValue}recordChanges(scopeName,newValue,oldValue),destination[scopeName]=newValue}),removeWatchCollection.push(removeWatch);break;case"&":if(optional||hasOwnProperty.call(attrs,attrName)||strictBindingsCheck(attrName,directive.name),(parentGet=attrs.hasOwnProperty(attrName)?$parse(attrs[attrName]):noop)===noop&&optional)break;destination[scopeName]=function(locals){return parentGet(scope,locals)}}}),{initialChanges:initialChanges,removeWatches:removeWatchCollection.length&&function(){for(var i=0,ii=removeWatchCollection.length;i<ii;++i)removeWatchCollection[i]()}}}}]}function SimpleChange(previous,current){this.previousValue=previous,this.currentValue=current}$CompileProvider.$inject=["$provide","$$sanitizeUriProvider"],SimpleChange.prototype.isFirstChange=function(){return this.previousValue===_UNINITIALIZED_VALUE};var PREFIX_REGEXP=/^((?:x|data)[:\-_])/i,SPECIAL_CHARS_REGEXP=/[:\-_]+(.)/g;function directiveNormalize(name){return name.replace(PREFIX_REGEXP,"").replace(SPECIAL_CHARS_REGEXP,function(_,letter,offset){return offset?letter.toUpperCase():letter})}function tokenDifference(str1,str2){var values="",tokens1=str1.split(/\s+/),tokens2=str2.split(/\s+/);outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token===tokens2[j])continue outer;values+=(values.length>0?" ":"")+token}return values}function removeComments(jqNodes){var i=(jqNodes=jqLite(jqNodes)).length;if(i<=1)return jqNodes;for(;i--;){var node=jqNodes[i];(node.nodeType===NODE_TYPE_COMMENT||node.nodeType===NODE_TYPE_TEXT&&""===node.nodeValue.trim())&&splice.call(jqNodes,i,1)}return jqNodes}var $controllerMinErr=minErr("$controller"),CNTRL_REG=/^(\S+)(\s+as\s+([\w$]+))?$/;function $ControllerProvider(){var controllers={};this.has=function(name){return controllers.hasOwnProperty(name)},this.register=function(name,constructor){assertNotHasOwnProperty(name,"controller"),isObject(name)?extend(controllers,name):controllers[name]=constructor},this.$get=["$injector",function($injector){return function(expression,locals,later,ident){var instance,match,constructor,identifier;if(later=!0===later,ident&&isString(ident)&&(identifier=ident),isString(expression)){if(!(match=expression.match(CNTRL_REG)))throw $controllerMinErr("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",expression);if(constructor=match[1],identifier=identifier||match[3],!(expression=controllers.hasOwnProperty(constructor)?controllers[constructor]:function(obj,path,bindFnToScope){if(!path)return obj;for(var key,keys=path.split("."),lastInstance=obj,len=keys.length,i=0;i<len;i++)key=keys[i],obj&&(obj=(lastInstance=obj)[key]);return!bindFnToScope&&isFunction(obj)?bind(lastInstance,obj):obj}(locals.$scope,constructor,!0)))throw $controllerMinErr("ctrlreg","The controller with the name '{0}' is not registered.",constructor);assertArgFn(expression,constructor,!0)}if(later){var controllerPrototype=(isArray(expression)?expression[expression.length-1]:expression).prototype;return instance=Object.create(controllerPrototype||null),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),extend(function(){var result=$injector.invoke(expression,instance,locals,constructor);return result!==instance&&(isObject(result)||isFunction(result))&&(instance=result,identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name)),instance},{instance:instance,identifier:identifier})}return instance=$injector.instantiate(expression,locals,constructor),identifier&&addIdentifier(locals,identifier,instance,constructor||expression.name),instance};function addIdentifier(locals,identifier,instance,name){if(!locals||!isObject(locals.$scope))throw minErr("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",name,identifier);locals.$scope[identifier]=instance}}]}function $DocumentProvider(){this.$get=["$window",function(window){return jqLite(window.document)}]}function $$IsDocumentHiddenProvider(){this.$get=["$document","$rootScope",function($document,$rootScope){var doc=$document[0],hidden=doc&&doc.hidden;function changeListener(){hidden=doc.hidden}return $document.on("visibilitychange",changeListener),$rootScope.$on("$destroy",function(){$document.off("visibilitychange",changeListener)}),function(){return hidden}}]}function $ExceptionHandlerProvider(){this.$get=["$log",function($log){return function(exception,cause){$log.error.apply($log,arguments)}}]}var $$ForceReflowProvider=function(){this.$get=["$document",function($document){return function(domNode){return domNode?!domNode.nodeType&&domNode instanceof jqLite&&(domNode=domNode[0]):domNode=$document[0].body,domNode.offsetWidth+1}}]},APPLICATION_JSON="application/json",CONTENT_TYPE_APPLICATION_JSON={"Content-Type":APPLICATION_JSON+";charset=utf-8"},JSON_START=/^\[|^\{(?!\{)/,JSON_ENDS={"[":/]$/,"{":/}$/},JSON_PROTECTION_PREFIX=/^\)]\}',?\n/,$httpMinErr=minErr("$http");function serializeValue(v){return isObject(v)?isDate(v)?v.toISOString():toJson(v):v}function $HttpParamSerializerProvider(){this.$get=function(){return function(params){if(!params)return"";var parts=[];return forEachSorted(params,function(value,key){null===value||isUndefined(value)||isFunction(value)||(isArray(value)?forEach(value,function(v){parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(v)))}):parts.push(encodeUriQuery(key)+"="+encodeUriQuery(serializeValue(value))))}),parts.join("&")}}}function $HttpParamSerializerJQLikeProvider(){this.$get=function(){return function(params){if(!params)return"";var parts=[];return function serialize(toSerialize,prefix,topLevel){isArray(toSerialize)?forEach(toSerialize,function(value,index){serialize(value,prefix+"["+(isObject(value)?index:"")+"]")}):isObject(toSerialize)&&!isDate(toSerialize)?forEachSorted(toSerialize,function(value,key){serialize(value,prefix+(topLevel?"":"[")+key+(topLevel?"":"]"))}):(isFunction(toSerialize)&&(toSerialize=toSerialize()),parts.push(encodeUriQuery(prefix)+"="+(null==toSerialize?"":encodeUriQuery(serializeValue(toSerialize)))))}(params,"",!0),parts.join("&")}}}function defaultHttpResponseTransform(data,headers){if(isString(data)){var tempData=data.replace(JSON_PROTECTION_PREFIX,"").trim();if(tempData){var contentType=headers("Content-Type"),hasJsonContentType=contentType&&0===contentType.indexOf(APPLICATION_JSON);if(hasJsonContentType||(jsonStart=(str=tempData).match(JSON_START))&&JSON_ENDS[jsonStart[0]].test(str))try{data=fromJson(tempData)}catch(e){if(!hasJsonContentType)return data;throw $httpMinErr("baddata",'Data must be a valid JSON object. Received: "{0}". Parse error: "{1}"',data,e)}}}var str,jsonStart;return data}function parseHeaders(headers){var i,parsed=createMap();function fillInParsed(key,val){key&&(parsed[key]=parsed[key]?parsed[key]+", "+val:val)}return isString(headers)?forEach(headers.split("\n"),function(line){i=line.indexOf(":"),fillInParsed(lowercase(trim(line.substr(0,i))),trim(line.substr(i+1)))}):isObject(headers)&&forEach(headers,function(headerVal,headerKey){fillInParsed(lowercase(headerKey),trim(headerVal))}),parsed}function headersGetter(headers){var headersObj;return function(name){if(headersObj||(headersObj=parseHeaders(headers)),name){var value=headersObj[lowercase(name)];return void 0===value&&(value=null),value}return headersObj}}function transformData(data,headers,status,fns){return isFunction(fns)?fns(data,headers,status):(forEach(fns,function(fn){data=fn(data,headers,status)}),data)}function isSuccess(status){return 200<=status&&status<300}function $HttpProvider(){var defaults=this.defaults={transformResponse:[defaultHttpResponseTransform],transformRequest:[function(d){return!isObject(d)||(obj=d,"[object File]"===toString.call(obj))||function(obj){return"[object Blob]"===toString.call(obj)}(d)||function(obj){return"[object FormData]"===toString.call(obj)}(d)?d:toJson(d);var obj}],headers:{common:{Accept:"application/json, text/plain, */*"},post:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),put:shallowCopy(CONTENT_TYPE_APPLICATION_JSON),patch:shallowCopy(CONTENT_TYPE_APPLICATION_JSON)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer",jsonpCallbackParam:"callback"},useApplyAsync=!1;this.useApplyAsync=function(value){return isDefined(value)?(useApplyAsync=!!value,this):useApplyAsync};var interceptorFactories=this.interceptors=[],xsrfWhitelistedOrigins=this.xsrfWhitelistedOrigins=[];this.$get=["$browser","$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector","$sce",function($browser,$httpBackend,$$cookieReader,$cacheFactory,$rootScope,$q,$injector,$sce){var defaultCache=$cacheFactory("$http");defaults.paramSerializer=isString(defaults.paramSerializer)?$injector.get(defaults.paramSerializer):defaults.paramSerializer;var reversedInterceptors=[];forEach(interceptorFactories,function(interceptorFactory){reversedInterceptors.unshift(isString(interceptorFactory)?$injector.get(interceptorFactory):$injector.invoke(interceptorFactory))});var parsedAllowedOriginUrls,urlIsAllowedOrigin=(parsedAllowedOriginUrls=[originUrl].concat(xsrfWhitelistedOrigins.map(urlResolve)),function(requestUrl){var parsedUrl=urlResolve(requestUrl);return parsedAllowedOriginUrls.some(urlsAreSameOrigin.bind(null,parsedUrl))});function $http(requestConfig){if(!isObject(requestConfig))throw minErr("$http")("badreq","Http request configuration must be an object.  Received: {0}",requestConfig);if(!isString($sce.valueOf(requestConfig.url)))throw minErr("$http")("badreq","Http request configuration url must be a string or a $sce trusted object.  Received: {0}",requestConfig.url);var config=extend({method:"get",transformRequest:defaults.transformRequest,transformResponse:defaults.transformResponse,paramSerializer:defaults.paramSerializer,jsonpCallbackParam:defaults.jsonpCallbackParam},requestConfig);config.headers=function(config){var defHeaderName,lowercaseDefHeaderName,reqHeaderName,defHeaders=defaults.headers,reqHeaders=extend({},config.headers);defHeaders=extend({},defHeaders.common,defHeaders[lowercase(config.method)]);defaultHeadersIteration:for(defHeaderName in defHeaders){for(reqHeaderName in lowercaseDefHeaderName=lowercase(defHeaderName),reqHeaders)if(lowercase(reqHeaderName)===lowercaseDefHeaderName)continue defaultHeadersIteration;reqHeaders[defHeaderName]=defHeaders[defHeaderName]}return function(headers,config){var headerContent,processedHeaders={};return forEach(headers,function(headerFn,header){isFunction(headerFn)?null!=(headerContent=headerFn(config))&&(processedHeaders[header]=headerContent):processedHeaders[header]=headerFn}),processedHeaders}(reqHeaders,shallowCopy(config))}(requestConfig),config.method=uppercase(config.method),config.paramSerializer=isString(config.paramSerializer)?$injector.get(config.paramSerializer):config.paramSerializer,$browser.$$incOutstandingRequestCount("$http");var requestInterceptors=[],responseInterceptors=[],promise=$q.resolve(config);return forEach(reversedInterceptors,function(interceptor){(interceptor.request||interceptor.requestError)&&requestInterceptors.unshift(interceptor.request,interceptor.requestError),(interceptor.response||interceptor.responseError)&&responseInterceptors.push(interceptor.response,interceptor.responseError)}),promise=(promise=chainInterceptors(promise=(promise=chainInterceptors(promise,requestInterceptors)).then(function(config){var headers=config.headers,reqData=transformData(config.data,headersGetter(headers),void 0,config.transformRequest);isUndefined(reqData)&&forEach(headers,function(value,header){"content-type"===lowercase(header)&&delete headers[header]});isUndefined(config.withCredentials)&&!isUndefined(defaults.withCredentials)&&(config.withCredentials=defaults.withCredentials);return function(config,reqData){var cache,cachedResp,deferred=$q.defer(),promise=deferred.promise,reqHeaders=config.headers,isJsonp="jsonp"===lowercase(config.method),url=config.url;isJsonp?url=$sce.getTrustedResourceUrl(url):isString(url)||(url=$sce.valueOf(url));url=function(url,serializedParams){return serializedParams.length>0&&(url+=(-1===url.indexOf("?")?"?":"&")+serializedParams),url}(url,config.paramSerializer(config.params)),isJsonp&&(url=function(url,cbKey){var parts=url.split("?");if(parts.length>2)throw $httpMinErr("badjsonp",'Illegal use more than one "?", in url, "{1}"',url);return forEach(parseKeyValue(parts[1]),function(value,key){if("JSON_CALLBACK"===value)throw $httpMinErr("badjsonp",'Illegal use of JSON_CALLBACK in url, "{0}"',url);if(key===cbKey)throw $httpMinErr("badjsonp",'Illegal use of callback param, "{0}", in url, "{1}"',cbKey,url)}),url+=(-1===url.indexOf("?")?"?":"&")+cbKey+"=JSON_CALLBACK"}(url,config.jsonpCallbackParam));$http.pendingRequests.push(config),promise.then(removePendingReq,removePendingReq),!config.cache&&!defaults.cache||!1===config.cache||"GET"!==config.method&&"JSONP"!==config.method||(cache=isObject(config.cache)?config.cache:isObject(defaults.cache)?defaults.cache:defaultCache);cache&&(isDefined(cachedResp=cache.get(url))?isPromiseLike(cachedResp)?cachedResp.then(resolvePromiseWithResult,resolvePromiseWithResult):isArray(cachedResp)?resolvePromise(cachedResp[1],cachedResp[0],shallowCopy(cachedResp[2]),cachedResp[3],cachedResp[4]):resolvePromise(cachedResp,200,{},"OK","complete"):cache.put(url,promise));if(isUndefined(cachedResp)){var xsrfValue=urlIsAllowedOrigin(config.url)?$$cookieReader()[config.xsrfCookieName||defaults.xsrfCookieName]:void 0;xsrfValue&&(reqHeaders[config.xsrfHeaderName||defaults.xsrfHeaderName]=xsrfValue),$httpBackend(config.method,url,reqData,function(status,response,headersString,statusText,xhrStatus){cache&&(isSuccess(status)?cache.put(url,[status,response,parseHeaders(headersString),statusText,xhrStatus]):cache.remove(url));function resolveHttpPromise(){resolvePromise(response,status,headersString,statusText,xhrStatus)}useApplyAsync?$rootScope.$applyAsync(resolveHttpPromise):(resolveHttpPromise(),$rootScope.$$phase||$rootScope.$apply())},reqHeaders,config.timeout,config.withCredentials,config.responseType,createApplyHandlers(config.eventHandlers),createApplyHandlers(config.uploadEventHandlers))}return promise;function createApplyHandlers(eventHandlers){if(eventHandlers){var applyHandlers={};return forEach(eventHandlers,function(eventHandler,key){applyHandlers[key]=function(event){function callEventHandler(){eventHandler(event)}useApplyAsync?$rootScope.$applyAsync(callEventHandler):$rootScope.$$phase?callEventHandler():$rootScope.$apply(callEventHandler)}}),applyHandlers}}function resolvePromise(response,status,headers,statusText,xhrStatus){(isSuccess(status=status>=-1?status:0)?deferred.resolve:deferred.reject)({data:response,status:status,headers:headersGetter(headers),config:config,statusText:statusText,xhrStatus:xhrStatus})}function resolvePromiseWithResult(result){resolvePromise(result.data,result.status,shallowCopy(result.headers()),result.statusText,result.xhrStatus)}function removePendingReq(){var idx=$http.pendingRequests.indexOf(config);-1!==idx&&$http.pendingRequests.splice(idx,1)}}(config,reqData).then(transformResponse,transformResponse)}),responseInterceptors)).finally(function(){$browser.$$completeOutstandingRequest(noop,"$http")});function chainInterceptors(promise,interceptors){for(var i=0,ii=interceptors.length;i<ii;){var thenFn=interceptors[i++],rejectFn=interceptors[i++];promise=promise.then(thenFn,rejectFn)}return interceptors.length=0,promise}function transformResponse(response){var resp=extend({},response);return resp.data=transformData(response.data,response.headers,response.status,config.transformResponse),isSuccess(response.status)?resp:$q.reject(resp)}}return $http.pendingRequests=[],function(names){forEach(arguments,function(name){$http[name]=function(url,config){return $http(extend({},config||{},{method:name,url:url}))}})}("get","delete","head","jsonp"),function(name){forEach(arguments,function(name){$http[name]=function(url,data,config){return $http(extend({},config||{},{method:name,url:url,data:data}))}})}("post","put","patch"),$http.defaults=defaults,$http}]}function $xhrFactoryProvider(){this.$get=function(){return function(){return new window.XMLHttpRequest}}}function $HttpBackendProvider(){this.$get=["$browser","$jsonpCallbacks","$document","$xhrFactory",function($browser,$jsonpCallbacks,$document,$xhrFactory){return function($browser,createXhr,$browserDefer,callbacks,rawDocument){return function(method,url,post,callback,headers,timeout,withCredentials,responseType,eventHandlers,uploadEventHandlers){if(url=url||$browser.url(),"jsonp"===lowercase(method))var callbackPath=callbacks.createCallback(url),jsonpDone=function(url,callbackPath,done){url=url.replace("JSON_CALLBACK",callbackPath);var script=rawDocument.createElement("script"),callback=null;return script.type="text/javascript",script.src=url,script.async=!0,callback=function(event){script.removeEventListener("load",callback),script.removeEventListener("error",callback),rawDocument.body.removeChild(script),script=null;var status=-1,text="unknown";event&&("load"!==event.type||callbacks.wasCalled(callbackPath)||(event={type:"error"}),text=event.type,status="error"===event.type?404:200),done&&done(status,text)},script.addEventListener("load",callback),script.addEventListener("error",callback),rawDocument.body.appendChild(script),callback}(url,callbackPath,function(status,text){var response=200===status&&callbacks.getResponse(callbackPath);completeRequest(callback,status,response,"",text,"complete"),callbacks.removeCallback(callbackPath)});else{var xhr=createXhr(method,url),abortedByTimeout=!1;xhr.open(method,url,!0),forEach(headers,function(value,key){isDefined(value)&&xhr.setRequestHeader(key,value)}),xhr.onload=function(){var statusText=xhr.statusText||"",response="response"in xhr?xhr.response:xhr.responseText,status=1223===xhr.status?204:xhr.status;0===status&&(status=response?200:"file"===urlResolve(url).protocol?404:0),completeRequest(callback,status,response,xhr.getAllResponseHeaders(),statusText,"complete")};if(xhr.onerror=function(){completeRequest(callback,-1,null,null,"","error")},xhr.ontimeout=function(){completeRequest(callback,-1,null,null,"","timeout")},xhr.onabort=function(){completeRequest(callback,-1,null,null,"",abortedByTimeout?"timeout":"abort")},forEach(eventHandlers,function(value,key){xhr.addEventListener(key,value)}),forEach(uploadEventHandlers,function(value,key){xhr.upload.addEventListener(key,value)}),withCredentials&&(xhr.withCredentials=!0),responseType)try{xhr.responseType=responseType}catch(e){if("json"!==responseType)throw e}xhr.send(isUndefined(post)?null:post)}if(timeout>0)var timeoutId=$browserDefer(function(){timeoutRequest("timeout")},timeout);else isPromiseLike(timeout)&&timeout.then(function(){timeoutRequest(isDefined(timeout.$$timeoutId)?"timeout":"abort")});function timeoutRequest(reason){abortedByTimeout="timeout"===reason,jsonpDone&&jsonpDone(),xhr&&xhr.abort()}function completeRequest(callback,status,response,headersString,statusText,xhrStatus){isDefined(timeoutId)&&$browserDefer.cancel(timeoutId),jsonpDone=xhr=null,callback(status,response,headersString,statusText,xhrStatus)}}}($browser,$xhrFactory,$browser.defer,$jsonpCallbacks,$document[0])}]}var $interpolateMinErr=angular.$interpolateMinErr=minErr("$interpolate");function $InterpolateProvider(){var startSymbol="{{",endSymbol="}}";this.startSymbol=function(value){return value?(startSymbol=value,this):startSymbol},this.endSymbol=function(value){return value?(endSymbol=value,this):endSymbol},this.$get=["$parse","$exceptionHandler","$sce",function($parse,$exceptionHandler,$sce){var startSymbolLength=startSymbol.length,endSymbolLength=endSymbol.length,escapedStartRegexp=new RegExp(startSymbol.replace(/./g,escape),"g"),escapedEndRegexp=new RegExp(endSymbol.replace(/./g,escape),"g");function escape(ch){return"\\\\\\"+ch}function unescapeText(text){return text.replace(escapedStartRegexp,startSymbol).replace(escapedEndRegexp,endSymbol)}function constantWatchDelegate(scope,listener,objectEquality,constantInterp){var unwatch=scope.$watch(function(scope){return unwatch(),constantInterp(scope)},listener,objectEquality);return unwatch}function $interpolate(text,mustHaveExpression,trustedContext,allOrNothing){var contextAllowsConcatenation=trustedContext===$sce.URL||trustedContext===$sce.MEDIA_URL;if(!text.length||-1===text.indexOf(startSymbol)){if(mustHaveExpression)return;var unescapedText=unescapeText(text);contextAllowsConcatenation&&(unescapedText=$sce.getTrusted(trustedContext,unescapedText));var constantInterp=valueFn(unescapedText);return constantInterp.exp=text,constantInterp.expressions=[],constantInterp.$$watchDelegate=constantWatchDelegate,constantInterp}allOrNothing=!!allOrNothing;for(var startIndex,endIndex,parseFns,exp,singleExpression,index=0,expressions=[],textLength=text.length,concat=[],expressionPositions=[];index<textLength;){if(-1===(startIndex=text.indexOf(startSymbol,index))||-1===(endIndex=text.indexOf(endSymbol,startIndex+startSymbolLength))){index!==textLength&&concat.push(unescapeText(text.substring(index)));break}index!==startIndex&&concat.push(unescapeText(text.substring(index,startIndex))),exp=text.substring(startIndex+startSymbolLength,endIndex),expressions.push(exp),index=endIndex+endSymbolLength,expressionPositions.push(concat.length),concat.push("")}singleExpression=1===concat.length&&1===expressionPositions.length;var interceptor=contextAllowsConcatenation&&singleExpression?void 0:function(value){try{return value=trustedContext&&!contextAllowsConcatenation?$sce.getTrusted(trustedContext,value):$sce.valueOf(value),allOrNothing&&!isDefined(value)?value:stringify(value)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}};if(parseFns=expressions.map(function(exp){return $parse(exp,interceptor)}),!mustHaveExpression||expressions.length){var compute=function(values){for(var i=0,ii=expressions.length;i<ii;i++){if(allOrNothing&&isUndefined(values[i]))return;concat[expressionPositions[i]]=values[i]}return contextAllowsConcatenation?$sce.getTrusted(trustedContext,singleExpression?concat[0]:concat.join("")):(trustedContext&&concat.length>1&&$interpolateMinErr.throwNoconcat(text),concat.join(""))};return extend(function(context){var i=0,ii=expressions.length,values=new Array(ii);try{for(;i<ii;i++)values[i]=parseFns[i](context);return compute(values)}catch(err){$exceptionHandler($interpolateMinErr.interr(text,err))}},{exp:text,expressions:expressions,$$watchDelegate:function(scope,listener){var lastValue;return scope.$watchGroup(parseFns,function(values,oldValues){var currValue=compute(values);listener.call(this,currValue,values!==oldValues?lastValue:currValue,scope),lastValue=currValue})}})}}return $interpolate.startSymbol=function(){return startSymbol},$interpolate.endSymbol=function(){return endSymbol},$interpolate}]}$interpolateMinErr.throwNoconcat=function(text){throw $interpolateMinErr("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",text)},$interpolateMinErr.interr=function(text,err){return $interpolateMinErr("interr","Can't interpolate: {0}\n{1}",text,err.toString())};var $intervalMinErr=minErr("$interval");function $IntervalProvider(){this.$get=["$$intervalFactory","$window",function($$intervalFactory,$window){var intervals={},clearIntervalFn=function(id){$window.clearInterval(id),delete intervals[id]},interval=$$intervalFactory(function(tick,delay,deferred){var id=$window.setInterval(tick,delay);return intervals[id]=deferred,id},clearIntervalFn);return interval.cancel=function(promise){if(!promise)return!1;if(!promise.hasOwnProperty("$$intervalId"))throw $intervalMinErr("badprom","`$interval.cancel()` called with a promise that was not generated by `$interval()`.");if(!intervals.hasOwnProperty(promise.$$intervalId))return!1;var id=promise.$$intervalId,deferred=intervals[id];return markQExceptionHandled(deferred.promise),deferred.reject("canceled"),clearIntervalFn(id),!0},interval}]}function $$IntervalFactoryProvider(){this.$get=["$browser","$q","$$q","$rootScope",function($browser,$q,$$q,$rootScope){return function(setIntervalFn,clearIntervalFn){return function(fn,delay,count,invokeApply){var hasParams=arguments.length>4,args=hasParams?sliceArgs(arguments,4):[],iteration=0,skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;function callback(){hasParams?fn.apply(null,args):fn(iteration)}return count=isDefined(count)?count:0,promise.$$intervalId=setIntervalFn(function(){skipApply?$browser.defer(callback):$rootScope.$evalAsync(callback),deferred.notify(iteration++),count>0&&iteration>=count&&(deferred.resolve(iteration),clearIntervalFn(promise.$$intervalId)),skipApply||$rootScope.$apply()},delay,deferred,skipApply),promise}}}]}var $jsonpCallbacksProvider=function(){this.$get=function(){var callbacks=angular.callbacks,callbackMap={};return{createCallback:function(url){var callbackId="_"+(callbacks.$$counter++).toString(36),callbackPath="angular.callbacks."+callbackId,callback=function(callbackId){var callback=function(data){callback.data=data,callback.called=!0};return callback.id=callbackId,callback}(callbackId);return callbackMap[callbackPath]=callbacks[callbackId]=callback,callbackPath},wasCalled:function(callbackPath){return callbackMap[callbackPath].called},getResponse:function(callbackPath){return callbackMap[callbackPath].data},removeCallback:function(callbackPath){var callback=callbackMap[callbackPath];delete callbacks[callback.id],delete callbackMap[callbackPath]}}}},PATH_MATCH=/^([^?#]*)(\?([^#]*))?(#(.*))?$/,DEFAULT_PORTS={http:80,https:443,ftp:21},$locationMinErr=minErr("$location");function normalizePath(pathValue,searchValue,hashValue){var parts,search=(parts=[],forEach(searchValue,function(value,key){isArray(value)?forEach(value,function(arrayValue){parts.push(encodeUriQuery(key,!0)+(!0===arrayValue?"":"="+encodeUriQuery(arrayValue,!0)))}):parts.push(encodeUriQuery(key,!0)+(!0===value?"":"="+encodeUriQuery(value,!0)))}),parts.length?parts.join("&"):""),hash=hashValue?"#"+encodeUriSegment(hashValue):"";return function(path){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=encodeUriSegment(segments[i].replace(/%2F/g,"/"));return segments.join("/")}(pathValue)+(search?"?"+search:"")+hash}function parseAbsoluteUrl(absoluteUrl,locationObj){var parsedUrl=urlResolve(absoluteUrl);locationObj.$$protocol=parsedUrl.protocol,locationObj.$$host=parsedUrl.hostname,locationObj.$$port=toInt(parsedUrl.port)||DEFAULT_PORTS[parsedUrl.protocol]||null}var DOUBLE_SLASH_REGEX=/^\s*[\\/]{2,}/;function parseAppUrl(url,locationObj,html5Mode){if(DOUBLE_SLASH_REGEX.test(url))throw $locationMinErr("badpath",'Invalid url "{0}".',url);var prefixed="/"!==url.charAt(0);prefixed&&(url="/"+url);var match=urlResolve(url),path=prefixed&&"/"===match.pathname.charAt(0)?match.pathname.substring(1):match.pathname;locationObj.$$path=function(path,html5Mode){for(var segments=path.split("/"),i=segments.length;i--;)segments[i]=decodeURIComponent(segments[i]),html5Mode&&(segments[i]=segments[i].replace(/\//g,"%2F"));return segments.join("/")}(path,html5Mode),locationObj.$$search=parseKeyValue(match.search),locationObj.$$hash=decodeURIComponent(match.hash),locationObj.$$path&&"/"!==locationObj.$$path.charAt(0)&&(locationObj.$$path="/"+locationObj.$$path)}function startsWith(str,search){return str.slice(0,search.length)===search}function stripBaseUrl(base,url){if(startsWith(url,base))return url.substr(base.length)}function stripHash(url){var index=url.indexOf("#");return-1===index?url:url.substr(0,index)}function LocationHtml5Url(appBase,appBaseNoFile,basePrefix){this.$$html5=!0,basePrefix=basePrefix||"",parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var pathUrl=stripBaseUrl(appBaseNoFile,url);if(!isString(pathUrl))throw $locationMinErr("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',url,appBaseNoFile);parseAppUrl(pathUrl,this,!0),this.$$path||(this.$$path="/"),this.$$compose()},this.$$normalizeUrl=function(url){return appBaseNoFile+url.substr(1)},this.$$parseLinkUrl=function(url,relHref){return relHref&&"#"===relHref[0]?(this.hash(relHref.slice(1)),!0):(isDefined(appUrl=stripBaseUrl(appBase,url))?(prevAppUrl=appUrl,rewrittenUrl=basePrefix&&isDefined(appUrl=stripBaseUrl(basePrefix,appUrl))?appBaseNoFile+(stripBaseUrl("/",appUrl)||appUrl):appBase+prevAppUrl):isDefined(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBaseNoFile+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl);var appUrl,prevAppUrl,rewrittenUrl}}function LocationHashbangUrl(appBase,appBaseNoFile,hashPrefix){parseAbsoluteUrl(appBase,this),this.$$parse=function(url){var withoutHashUrl,withoutBaseUrl=stripBaseUrl(appBase,url)||stripBaseUrl(appBaseNoFile,url);isUndefined(withoutBaseUrl)||"#"!==withoutBaseUrl.charAt(0)?this.$$html5?withoutHashUrl=withoutBaseUrl:(withoutHashUrl="",isUndefined(withoutBaseUrl)&&(appBase=url,this.replace())):isUndefined(withoutHashUrl=stripBaseUrl(hashPrefix,withoutBaseUrl))&&(withoutHashUrl=withoutBaseUrl),parseAppUrl(withoutHashUrl,this,!1),this.$$path=function(path,url,base){var firstPathSegmentMatch,windowsFilePathExp=/^\/[A-Z]:(\/.*)/;startsWith(url,base)&&(url=url.replace(base,""));if(windowsFilePathExp.exec(url))return path;return(firstPathSegmentMatch=windowsFilePathExp.exec(path))?firstPathSegmentMatch[1]:path}(this.$$path,withoutHashUrl,appBase),this.$$compose()},this.$$normalizeUrl=function(url){return appBase+(url?hashPrefix+url:"")},this.$$parseLinkUrl=function(url,relHref){return stripHash(appBase)===stripHash(url)&&(this.$$parse(url),!0)}}function LocationHashbangInHtml5Url(appBase,appBaseNoFile,hashPrefix){this.$$html5=!0,LocationHashbangUrl.apply(this,arguments),this.$$parseLinkUrl=function(url,relHref){return relHref&&"#"===relHref[0]?(this.hash(relHref.slice(1)),!0):(appBase===stripHash(url)?rewrittenUrl=url:(appUrl=stripBaseUrl(appBaseNoFile,url))?rewrittenUrl=appBase+hashPrefix+appUrl:appBaseNoFile===url+"/"&&(rewrittenUrl=appBaseNoFile),rewrittenUrl&&this.$$parse(rewrittenUrl),!!rewrittenUrl);var rewrittenUrl,appUrl},this.$$normalizeUrl=function(url){return appBase+hashPrefix+url}}var locationPrototype={$$absUrl:"",$$html5:!1,$$replace:!1,$$compose:function(){this.$$url=normalizePath(this.$$path,this.$$search,this.$$hash),this.$$absUrl=this.$$normalizeUrl(this.$$url),this.$$urlUpdatedByLocation=!0},absUrl:locationGetter("$$absUrl"),url:function(url){if(isUndefined(url))return this.$$url;var match=PATH_MATCH.exec(url);return(match[1]||""===url)&&this.path(decodeURIComponent(match[1])),(match[2]||match[1]||""===url)&&this.search(match[3]||""),this.hash(match[5]||""),this},protocol:locationGetter("$$protocol"),host:locationGetter("$$host"),port:locationGetter("$$port"),path:locationGetterSetter("$$path",function(path){return"/"===(path=null!==path?path.toString():"").charAt(0)?path:"/"+path}),search:function(search,paramValue){switch(arguments.length){case 0:return this.$$search;case 1:if(isString(search)||isNumber(search))search=search.toString(),this.$$search=parseKeyValue(search);else{if(!isObject(search))throw $locationMinErr("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");forEach(search=copy(search,{}),function(value,key){null==value&&delete search[key]}),this.$$search=search}break;default:isUndefined(paramValue)||null===paramValue?delete this.$$search[search]:this.$$search[search]=paramValue}return this.$$compose(),this},hash:locationGetterSetter("$$hash",function(hash){return null!==hash?hash.toString():""}),replace:function(){return this.$$replace=!0,this}};function locationGetter(property){return function(){return this[property]}}function locationGetterSetter(property,preprocess){return function(value){return isUndefined(value)?this[property]:(this[property]=preprocess(value),this.$$compose(),this)}}function $LocationProvider(){var hashPrefix="!",html5Mode={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(prefix){return isDefined(prefix)?(hashPrefix=prefix,this):hashPrefix},this.html5Mode=function(mode){return isBoolean(mode)?(html5Mode.enabled=mode,this):isObject(mode)?(isBoolean(mode.enabled)&&(html5Mode.enabled=mode.enabled),isBoolean(mode.requireBase)&&(html5Mode.requireBase=mode.requireBase),(isBoolean(mode.rewriteLinks)||isString(mode.rewriteLinks))&&(html5Mode.rewriteLinks=mode.rewriteLinks),this):html5Mode},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function($rootScope,$browser,$sniffer,$rootElement,$window){var $location,LocationMode,appBase,url,baseHref=$browser.baseHref(),initialUrl=$browser.url();if(html5Mode.enabled){if(!baseHref&&html5Mode.requireBase)throw $locationMinErr("nobase","$location in HTML5 mode requires a <base> tag to be present!");appBase=(url=initialUrl).substring(0,url.indexOf("/",url.indexOf("//")+2))+(baseHref||"/"),LocationMode=$sniffer.history?LocationHtml5Url:LocationHashbangInHtml5Url}else appBase=stripHash(initialUrl),LocationMode=LocationHashbangUrl;var appBaseNoFile=function(url){return url.substr(0,stripHash(url).lastIndexOf("/")+1)}(appBase);($location=new LocationMode(appBase,appBaseNoFile,"#"+hashPrefix)).$$parseLinkUrl(initialUrl,initialUrl),$location.$$state=$browser.state();var IGNORE_URI_REGEXP=/^\s*(javascript|mailto):/i;function setBrowserUrlWithFallback(url,replace,state){var oldUrl=$location.url(),oldState=$location.$$state;try{$browser.url(url,replace,state),$location.$$state=$browser.state()}catch(e){throw $location.url(oldUrl),$location.$$state=oldState,e}}$rootElement.on("click",function(event){var rewriteLinks=html5Mode.rewriteLinks;if(rewriteLinks&&!event.ctrlKey&&!event.metaKey&&!event.shiftKey&&2!==event.which&&2!==event.button){for(var elm=jqLite(event.target);"a"!==nodeName_(elm[0]);)if(elm[0]===$rootElement[0]||!(elm=elm.parent())[0])return;if(!isString(rewriteLinks)||!isUndefined(elm.attr(rewriteLinks))){var absHref=elm.prop("href"),relHref=elm.attr("href")||elm.attr("xlink:href");isObject(absHref)&&"[object SVGAnimatedString]"===absHref.toString()&&(absHref=urlResolve(absHref.animVal).href),IGNORE_URI_REGEXP.test(absHref)||!absHref||elm.attr("target")||event.isDefaultPrevented()||$location.$$parseLinkUrl(absHref,relHref)&&(event.preventDefault(),$location.absUrl()!==$browser.url()&&$rootScope.$apply())}}}),$location.absUrl()!==initialUrl&&$browser.url($location.absUrl(),!0);var initializing=!0;return $browser.onUrlChange(function(newUrl,newState){startsWith(newUrl,appBaseNoFile)?($rootScope.$evalAsync(function(){var defaultPrevented,oldUrl=$location.absUrl(),oldState=$location.$$state;$location.$$parse(newUrl),$location.$$state=newState,defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,newState,oldState).defaultPrevented,$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState,setBrowserUrlWithFallback(oldUrl,!1,oldState)):(initializing=!1,afterLocationChange(oldUrl,oldState)))}),$rootScope.$$phase||$rootScope.$digest()):$window.location.href=newUrl}),$rootScope.$watch(function(){if(initializing||$location.$$urlUpdatedByLocation){$location.$$urlUpdatedByLocation=!1;var oldUrl=$browser.url(),newUrl=$location.absUrl(),oldState=$browser.state(),currentReplace=$location.$$replace,urlOrStateChanged=!((a=oldUrl)===(b=newUrl)||urlResolve(a).href===urlResolve(b).href)||$location.$$html5&&$sniffer.history&&oldState!==$location.$$state;(initializing||urlOrStateChanged)&&(initializing=!1,$rootScope.$evalAsync(function(){var newUrl=$location.absUrl(),defaultPrevented=$rootScope.$broadcast("$locationChangeStart",newUrl,oldUrl,$location.$$state,oldState).defaultPrevented;$location.absUrl()===newUrl&&(defaultPrevented?($location.$$parse(oldUrl),$location.$$state=oldState):(urlOrStateChanged&&setBrowserUrlWithFallback(newUrl,currentReplace,oldState===$location.$$state?null:$location.$$state),afterLocationChange(oldUrl,oldState)))}))}var a,b;$location.$$replace=!1}),$location;function afterLocationChange(oldUrl,oldState){$rootScope.$broadcast("$locationChangeSuccess",$location.absUrl(),oldUrl,$location.$$state,oldState)}}]}function $LogProvider(){var debug=!0,self=this;this.debugEnabled=function(flag){return isDefined(flag)?(debug=flag,this):debug},this.$get=["$window",function($window){var fn,formatStackTrace=msie||/\bEdge\//.test($window.navigator&&$window.navigator.userAgent);return{log:consoleLog("log"),info:consoleLog("info"),warn:consoleLog("warn"),error:consoleLog("error"),debug:(fn=consoleLog("debug"),function(){debug&&fn.apply(self,arguments)})};function consoleLog(type){var console=$window.console||{},logFn=console[type]||console.log||noop;return function(){var args=[];return forEach(arguments,function(arg){args.push(function(arg){return isError(arg)&&(arg.stack&&formatStackTrace?arg=arg.message&&-1===arg.stack.indexOf(arg.message)?"Error: "+arg.message+"\n"+arg.stack:arg.stack:arg.sourceURL&&(arg=arg.message+"\n"+arg.sourceURL+":"+arg.line)),arg}(arg))}),Function.prototype.apply.call(logFn,console,args)}}}]}forEach([LocationHashbangInHtml5Url,LocationHashbangUrl,LocationHtml5Url],function(Location){Location.prototype=Object.create(locationPrototype),Location.prototype.state=function(state){if(!arguments.length)return this.$$state;if(Location!==LocationHtml5Url||!this.$$html5)throw $locationMinErr("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=isUndefined(state)?null:state,this.$$urlUpdatedByLocation=!0,this}});var $parseMinErr=minErr("$parse"),objectValueOf={}.constructor.prototype.valueOf;function getStringValue(name){return name+""}var OPERATORS=createMap();forEach("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(operator){OPERATORS[operator]=!0});var ESCAPE={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Lexer=function(options){this.options=options};Lexer.prototype={constructor:Lexer,lex:function(text){for(this.text=text,this.index=0,this.tokens=[];this.index<this.text.length;){var ch=this.text.charAt(this.index);if('"'===ch||"'"===ch)this.readString(ch);else if(this.isNumber(ch)||"."===ch&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdentifierStart(this.peekMultichar()))this.readIdent();else if(this.is(ch,"(){}[].,;:?"))this.tokens.push({index:this.index,text:ch}),this.index++;else if(this.isWhitespace(ch))this.index++;else{var ch2=ch+this.peek(),ch3=ch2+this.peek(2),op1=OPERATORS[ch],op2=OPERATORS[ch2],op3=OPERATORS[ch3];if(op1||op2||op3){var token=op3?ch3:op2?ch2:ch;this.tokens.push({index:this.index,text:token,operator:!0}),this.index+=token.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(ch,chars){return-1!==chars.indexOf(ch)},peek:function(i){var num=i||1;return this.index+num<this.text.length&&this.text.charAt(this.index+num)},isNumber:function(ch){return"0"<=ch&&ch<="9"&&"string"==typeof ch},isWhitespace:function(ch){return" "===ch||"\r"===ch||"\t"===ch||"\n"===ch||"\v"===ch||" "===ch},isIdentifierStart:function(ch){return this.options.isIdentifierStart?this.options.isIdentifierStart(ch,this.codePointAt(ch)):this.isValidIdentifierStart(ch)},isValidIdentifierStart:function(ch){return"a"<=ch&&ch<="z"||"A"<=ch&&ch<="Z"||"_"===ch||"$"===ch},isIdentifierContinue:function(ch){return this.options.isIdentifierContinue?this.options.isIdentifierContinue(ch,this.codePointAt(ch)):this.isValidIdentifierContinue(ch)},isValidIdentifierContinue:function(ch,cp){return this.isValidIdentifierStart(ch,cp)||this.isNumber(ch)},codePointAt:function(ch){return 1===ch.length?ch.charCodeAt(0):(ch.charCodeAt(0)<<10)+ch.charCodeAt(1)-56613888},peekMultichar:function(){var ch=this.text.charAt(this.index),peek=this.peek();if(!peek)return ch;var cp1=ch.charCodeAt(0),cp2=peek.charCodeAt(0);return cp1>=55296&&cp1<=56319&&cp2>=56320&&cp2<=57343?ch+peek:ch},isExpOperator:function(ch){return"-"===ch||"+"===ch||this.isNumber(ch)},throwError:function(error,start,end){end=end||this.index;var colStr=isDefined(start)?"s "+start+"-"+this.index+" ["+this.text.substring(start,end)+"]":" "+end;throw $parseMinErr("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",error,colStr,this.text)},readNumber:function(){for(var number="",start=this.index;this.index<this.text.length;){var ch=lowercase(this.text.charAt(this.index));if("."===ch||this.isNumber(ch))number+=ch;else{var peekCh=this.peek();if("e"===ch&&this.isExpOperator(peekCh))number+=ch;else if(this.isExpOperator(ch)&&peekCh&&this.isNumber(peekCh)&&"e"===number.charAt(number.length-1))number+=ch;else{if(!this.isExpOperator(ch)||peekCh&&this.isNumber(peekCh)||"e"!==number.charAt(number.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:start,text:number,constant:!0,value:Number(number)})},readIdent:function(){var start=this.index;for(this.index+=this.peekMultichar().length;this.index<this.text.length;){var ch=this.peekMultichar();if(!this.isIdentifierContinue(ch))break;this.index+=ch.length}this.tokens.push({index:start,text:this.text.slice(start,this.index),identifier:!0})},readString:function(quote){var start=this.index;this.index++;for(var string="",rawString=quote,escape=!1;this.index<this.text.length;){var ch=this.text.charAt(this.index);if(rawString+=ch,escape){if("u"===ch){var hex=this.text.substring(this.index+1,this.index+5);hex.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+hex+"]"),this.index+=4,string+=String.fromCharCode(parseInt(hex,16))}else{string+=ESCAPE[ch]||ch}escape=!1}else if("\\"===ch)escape=!0;else{if(ch===quote)return this.index++,void this.tokens.push({index:start,text:rawString,constant:!0,value:string});string+=ch}this.index++}this.throwError("Unterminated quote",start)}};var AST=function(lexer,options){this.lexer=lexer,this.options=options};function ifDefined(v,d){return void 0!==v?v:d}function plusFn(l,r){return void 0===l?r:void 0===r?l:l+r}AST.Program="Program",AST.ExpressionStatement="ExpressionStatement",AST.AssignmentExpression="AssignmentExpression",AST.ConditionalExpression="ConditionalExpression",AST.LogicalExpression="LogicalExpression",AST.BinaryExpression="BinaryExpression",AST.UnaryExpression="UnaryExpression",AST.CallExpression="CallExpression",AST.MemberExpression="MemberExpression",AST.Identifier="Identifier",AST.Literal="Literal",AST.ArrayExpression="ArrayExpression",AST.Property="Property",AST.ObjectExpression="ObjectExpression",AST.ThisExpression="ThisExpression",AST.LocalsExpression="LocalsExpression",AST.NGValueParameter="NGValueParameter",AST.prototype={ast:function(text){this.text=text,this.tokens=this.lexer.lex(text);var value=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),value},program:function(){for(var body=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&body.push(this.expressionStatement()),!this.expect(";"))return{type:AST.Program,body:body}},expressionStatement:function(){return{type:AST.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var left=this.expression();this.expect("|");)left=this.filter(left);return left},expression:function(){return this.assignment()},assignment:function(){var result=this.ternary();if(this.expect("=")){if(!isAssignable(result))throw $parseMinErr("lval","Trying to assign a value to a non l-value");result={type:AST.AssignmentExpression,left:result,right:this.assignment(),operator:"="}}return result},ternary:function(){var alternate,consequent,test=this.logicalOR();return this.expect("?")&&(alternate=this.expression(),this.consume(":"))?(consequent=this.expression(),{type:AST.ConditionalExpression,test:test,alternate:alternate,consequent:consequent}):test},logicalOR:function(){for(var left=this.logicalAND();this.expect("||");)left={type:AST.LogicalExpression,operator:"||",left:left,right:this.logicalAND()};return left},logicalAND:function(){for(var left=this.equality();this.expect("&&");)left={type:AST.LogicalExpression,operator:"&&",left:left,right:this.equality()};return left},equality:function(){for(var token,left=this.relational();token=this.expect("==","!=","===","!==");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.relational()};return left},relational:function(){for(var token,left=this.additive();token=this.expect("<",">","<=",">=");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.additive()};return left},additive:function(){for(var token,left=this.multiplicative();token=this.expect("+","-");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.multiplicative()};return left},multiplicative:function(){for(var token,left=this.unary();token=this.expect("*","/","%");)left={type:AST.BinaryExpression,operator:token.text,left:left,right:this.unary()};return left},unary:function(){var token;return(token=this.expect("+","-","!"))?{type:AST.UnaryExpression,operator:token.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var primary,next;for(this.expect("(")?(primary=this.filterChain(),this.consume(")")):this.expect("[")?primary=this.arrayDeclaration():this.expect("{")?primary=this.object():this.selfReferential.hasOwnProperty(this.peek().text)?primary=copy(this.selfReferential[this.consume().text]):this.options.literals.hasOwnProperty(this.peek().text)?primary={type:AST.Literal,value:this.options.literals[this.consume().text]}:this.peek().identifier?primary=this.identifier():this.peek().constant?primary=this.constant():this.throwError("not a primary expression",this.peek());next=this.expect("(","[",".");)"("===next.text?(primary={type:AST.CallExpression,callee:primary,arguments:this.parseArguments()},this.consume(")")):"["===next.text?(primary={type:AST.MemberExpression,object:primary,property:this.expression(),computed:!0},this.consume("]")):"."===next.text?primary={type:AST.MemberExpression,object:primary,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return primary},filter:function(baseExpression){for(var args=[baseExpression],result={type:AST.CallExpression,callee:this.identifier(),arguments:args,filter:!0};this.expect(":");)args.push(this.expression());return result},parseArguments:function(){var args=[];if(")"!==this.peekToken().text)do{args.push(this.filterChain())}while(this.expect(","));return args},identifier:function(){var token=this.consume();return token.identifier||this.throwError("is not a valid identifier",token),{type:AST.Identifier,name:token.text}},constant:function(){return{type:AST.Literal,value:this.consume().value}},arrayDeclaration:function(){var elements=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;elements.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:AST.ArrayExpression,elements:elements}},object:function(){var property,properties=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;property={type:AST.Property,kind:"init"},this.peek().constant?(property.key=this.constant(),property.computed=!1,this.consume(":"),property.value=this.expression()):this.peek().identifier?(property.key=this.identifier(),property.computed=!1,this.peek(":")?(this.consume(":"),property.value=this.expression()):property.value=property.key):this.peek("[")?(this.consume("["),property.key=this.expression(),this.consume("]"),property.computed=!0,this.consume(":"),property.value=this.expression()):this.throwError("invalid key",this.peek()),properties.push(property)}while(this.expect(","));return this.consume("}"),{type:AST.ObjectExpression,properties:properties}},throwError:function(msg,token){throw $parseMinErr("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",token.text,msg,token.index+1,this.text,this.text.substring(token.index))},consume:function(e1){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);var token=this.expect(e1);return token||this.throwError("is unexpected, expecting ["+e1+"]",this.peek()),token},peekToken:function(){if(0===this.tokens.length)throw $parseMinErr("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e1,e2,e3,e4){return this.peekAhead(0,e1,e2,e3,e4)},peekAhead:function(i,e1,e2,e3,e4){if(this.tokens.length>i){var token=this.tokens[i],t=token.text;if(t===e1||t===e2||t===e3||t===e4||!e1&&!e2&&!e3&&!e4)return token}return!1},expect:function(e1,e2,e3,e4){var token=this.peek(e1,e2,e3,e4);return!!token&&(this.tokens.shift(),token)},selfReferential:{this:{type:AST.ThisExpression},$locals:{type:AST.LocalsExpression}}};var PURITY_ABSOLUTE=1,PURITY_RELATIVE=2;function findConstantAndWatchExpressions(ast,$filter,parentIsPure){var allConstants,argsToWatch,isStatelessFilter,astIsPure=ast.isPure=function(node,parentIsPure){switch(node.type){case AST.MemberExpression:if(node.computed)return!1;break;case AST.UnaryExpression:return PURITY_ABSOLUTE;case AST.BinaryExpression:return"+"!==node.operator&&PURITY_ABSOLUTE;case AST.CallExpression:return!1}return void 0===parentIsPure?PURITY_RELATIVE:parentIsPure}(ast,parentIsPure);switch(ast.type){case AST.Program:allConstants=!0,forEach(ast.body,function(expr){findConstantAndWatchExpressions(expr.expression,$filter,astIsPure),allConstants=allConstants&&expr.expression.constant}),ast.constant=allConstants;break;case AST.Literal:ast.constant=!0,ast.toWatch=[];break;case AST.UnaryExpression:findConstantAndWatchExpressions(ast.argument,$filter,astIsPure),ast.constant=ast.argument.constant,ast.toWatch=ast.argument.toWatch;break;case AST.BinaryExpression:findConstantAndWatchExpressions(ast.left,$filter,astIsPure),findConstantAndWatchExpressions(ast.right,$filter,astIsPure),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.left.toWatch.concat(ast.right.toWatch);break;case AST.LogicalExpression:findConstantAndWatchExpressions(ast.left,$filter,astIsPure),findConstantAndWatchExpressions(ast.right,$filter,astIsPure),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.ConditionalExpression:findConstantAndWatchExpressions(ast.test,$filter,astIsPure),findConstantAndWatchExpressions(ast.alternate,$filter,astIsPure),findConstantAndWatchExpressions(ast.consequent,$filter,astIsPure),ast.constant=ast.test.constant&&ast.alternate.constant&&ast.consequent.constant,ast.toWatch=ast.constant?[]:[ast];break;case AST.Identifier:ast.constant=!1,ast.toWatch=[ast];break;case AST.MemberExpression:findConstantAndWatchExpressions(ast.object,$filter,astIsPure),ast.computed&&findConstantAndWatchExpressions(ast.property,$filter,astIsPure),ast.constant=ast.object.constant&&(!ast.computed||ast.property.constant),ast.toWatch=ast.constant?[]:[ast];break;case AST.CallExpression:isStatelessFilter=!!ast.filter&&function($filter,filterName){return!$filter(filterName).$stateful}($filter,ast.callee.name),allConstants=isStatelessFilter,argsToWatch=[],forEach(ast.arguments,function(expr){findConstantAndWatchExpressions(expr,$filter,astIsPure),allConstants=allConstants&&expr.constant,argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=isStatelessFilter?argsToWatch:[ast];break;case AST.AssignmentExpression:findConstantAndWatchExpressions(ast.left,$filter,astIsPure),findConstantAndWatchExpressions(ast.right,$filter,astIsPure),ast.constant=ast.left.constant&&ast.right.constant,ast.toWatch=[ast];break;case AST.ArrayExpression:allConstants=!0,argsToWatch=[],forEach(ast.elements,function(expr){findConstantAndWatchExpressions(expr,$filter,astIsPure),allConstants=allConstants&&expr.constant,argsToWatch.push.apply(argsToWatch,expr.toWatch)}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ObjectExpression:allConstants=!0,argsToWatch=[],forEach(ast.properties,function(property){findConstantAndWatchExpressions(property.value,$filter,astIsPure),allConstants=allConstants&&property.value.constant,argsToWatch.push.apply(argsToWatch,property.value.toWatch),property.computed&&(findConstantAndWatchExpressions(property.key,$filter,!1),allConstants=allConstants&&property.key.constant,argsToWatch.push.apply(argsToWatch,property.key.toWatch))}),ast.constant=allConstants,ast.toWatch=argsToWatch;break;case AST.ThisExpression:case AST.LocalsExpression:ast.constant=!1,ast.toWatch=[]}}function getInputs(body){if(1===body.length){var lastExpression=body[0].expression,candidate=lastExpression.toWatch;return 1!==candidate.length?candidate:candidate[0]!==lastExpression?candidate:void 0}}function isAssignable(ast){return ast.type===AST.Identifier||ast.type===AST.MemberExpression}function assignableAST(ast){if(1===ast.body.length&&isAssignable(ast.body[0].expression))return{type:AST.AssignmentExpression,left:ast.body[0].expression,right:{type:AST.NGValueParameter},operator:"="}}function ASTCompiler($filter){this.$filter=$filter}function ASTInterpreter($filter){this.$filter=$filter}function Parser(lexer,$filter,options){this.ast=new AST(lexer,options),this.astCompiler=options.csp?new ASTInterpreter($filter):new ASTCompiler($filter)}function getValueOf(value){return isFunction(value.valueOf)?value.valueOf():objectValueOf.call(value)}function $ParseProvider(){var identStart,identContinue,cache=createMap(),literals={true:!0,false:!1,null:null,undefined:void 0};this.addLiteral=function(literalName,literalValue){literals[literalName]=literalValue},this.setIdentifierFns=function(identifierStart,identifierContinue){return identStart=identifierStart,identContinue=identifierContinue,this},this.$get=["$filter",function($filter){var $parseOptions={csp:csp().noUnsafeEval,literals:copy(literals),isIdentifierStart:isFunction(identStart)&&identStart,isIdentifierContinue:isFunction(identContinue)&&identContinue};return $parse.$$getAst=function(exp){return new Parser(new Lexer($parseOptions),$filter,$parseOptions).getAst(exp).ast},$parse;function $parse(exp,interceptorFn){var parsedExpression,cacheKey;switch(typeof exp){case"string":if(exp=exp.trim(),!(parsedExpression=cache[cacheKey=exp]))parsedExpression=new Parser(new Lexer($parseOptions),$filter,$parseOptions).parse(exp),cache[cacheKey]=addWatchDelegate(parsedExpression);return addInterceptor(parsedExpression,interceptorFn);case"function":return addInterceptor(exp,interceptorFn);default:return addInterceptor(noop,interceptorFn)}}function expressionInputDirtyCheck(newValue,oldValueOfValue,compareObjectIdentity){return null==newValue||null==oldValueOfValue?newValue===oldValueOfValue:!("object"==typeof newValue&&"object"==typeof(newValue=getValueOf(newValue))&&!compareObjectIdentity)&&(newValue===oldValueOfValue||newValue!=newValue&&oldValueOfValue!=oldValueOfValue)}function inputsWatchDelegate(scope,listener,objectEquality,parsedExpression,prettyPrintExpression){var lastResult,inputExpressions=parsedExpression.inputs;if(1===inputExpressions.length){var oldInputValueOf=expressionInputDirtyCheck;return inputExpressions=inputExpressions[0],scope.$watch(function(scope){var newInputValue=inputExpressions(scope);return expressionInputDirtyCheck(newInputValue,oldInputValueOf,inputExpressions.isPure)||(lastResult=parsedExpression(scope,void 0,void 0,[newInputValue]),oldInputValueOf=newInputValue&&getValueOf(newInputValue)),lastResult},listener,objectEquality,prettyPrintExpression)}for(var oldInputValueOfValues=[],oldInputValues=[],i=0,ii=inputExpressions.length;i<ii;i++)oldInputValueOfValues[i]=expressionInputDirtyCheck,oldInputValues[i]=null;return scope.$watch(function(scope){for(var changed=!1,i=0,ii=inputExpressions.length;i<ii;i++){var newInputValue=inputExpressions[i](scope);(changed||(changed=!expressionInputDirtyCheck(newInputValue,oldInputValueOfValues[i],inputExpressions[i].isPure)))&&(oldInputValues[i]=newInputValue,oldInputValueOfValues[i]=newInputValue&&getValueOf(newInputValue))}return changed&&(lastResult=parsedExpression(scope,void 0,void 0,oldInputValues)),lastResult},listener,objectEquality,prettyPrintExpression)}function oneTimeWatchDelegate(scope,listener,objectEquality,parsedExpression,prettyPrintExpression){var unwatch,lastValue,isDone=parsedExpression.literal?isAllDefined:isDefined,exp=parsedExpression.$$intercepted||parsedExpression,post=parsedExpression.$$interceptor||identity,useInputs=parsedExpression.inputs&&!exp.inputs;return oneTimeWatch.literal=parsedExpression.literal,oneTimeWatch.constant=parsedExpression.constant,oneTimeWatch.inputs=parsedExpression.inputs,addWatchDelegate(oneTimeWatch),unwatch=scope.$watch(oneTimeWatch,listener,objectEquality,prettyPrintExpression);function unwatchIfDone(){isDone(lastValue)&&unwatch()}function oneTimeWatch(scope,locals,assign,inputs){return lastValue=useInputs&&inputs?inputs[0]:exp(scope,locals,assign,inputs),isDone(lastValue)&&scope.$$postDigest(unwatchIfDone),post(lastValue)}}function isAllDefined(value){var allDefined=!0;return forEach(value,function(val){isDefined(val)||(allDefined=!1)}),allDefined}function constantWatchDelegate(scope,listener,objectEquality,parsedExpression){var unwatch=scope.$watch(function(scope){return unwatch(),parsedExpression(scope)},listener,objectEquality);return unwatch}function addWatchDelegate(parsedExpression){return parsedExpression.constant?parsedExpression.$$watchDelegate=constantWatchDelegate:parsedExpression.oneTime?parsedExpression.$$watchDelegate=oneTimeWatchDelegate:parsedExpression.inputs&&(parsedExpression.$$watchDelegate=inputsWatchDelegate),parsedExpression}function addInterceptor(parsedExpression,interceptorFn){if(!interceptorFn)return parsedExpression;parsedExpression.$$interceptor&&(interceptorFn=function(first,second){function chainedInterceptor(value){return second(first(value))}return chainedInterceptor.$stateful=first.$stateful||second.$stateful,chainedInterceptor.$$pure=first.$$pure&&second.$$pure,chainedInterceptor}(parsedExpression.$$interceptor,interceptorFn),parsedExpression=parsedExpression.$$intercepted);var useInputs=!1,fn=function(scope,locals,assign,inputs){var value=useInputs&&inputs?inputs[0]:parsedExpression(scope,locals,assign,inputs);return interceptorFn(value)};return fn.$$intercepted=parsedExpression,fn.$$interceptor=interceptorFn,fn.literal=parsedExpression.literal,fn.oneTime=parsedExpression.oneTime,fn.constant=parsedExpression.constant,interceptorFn.$stateful||(useInputs=!parsedExpression.inputs,fn.inputs=parsedExpression.inputs?parsedExpression.inputs:[parsedExpression],interceptorFn.$$pure||(fn.inputs=fn.inputs.map(function(e){return e.isPure===PURITY_RELATIVE?function(s){return e(s)}:e}))),addWatchDelegate(fn)}}]}function $QProvider(){var errorOnUnhandledRejections=!0;this.$get=["$rootScope","$exceptionHandler",function($rootScope,$exceptionHandler){return qFactory(function(callback){$rootScope.$evalAsync(callback)},$exceptionHandler,errorOnUnhandledRejections)}],this.errorOnUnhandledRejections=function(value){return isDefined(value)?(errorOnUnhandledRejections=value,this):errorOnUnhandledRejections}}function $$QProvider(){var errorOnUnhandledRejections=!0;this.$get=["$browser","$exceptionHandler",function($browser,$exceptionHandler){return qFactory(function(callback){$browser.defer(callback)},$exceptionHandler,errorOnUnhandledRejections)}],this.errorOnUnhandledRejections=function(value){return isDefined(value)?(errorOnUnhandledRejections=value,this):errorOnUnhandledRejections}}function qFactory(nextTick,exceptionHandler,errorOnUnhandledRejections){var $qMinErr=minErr("$q",TypeError),queueSize=0,checkQueue=[];function defer(){return new function(){var promise=this.promise=new Promise;this.resolve=function(val){resolvePromise(promise,val)},this.reject=function(reason){rejectPromise(promise,reason)},this.notify=function(progress){notifyPromise(promise,progress)}}}function Promise(){this.$$state={status:0}}function processChecks(){for(;!queueSize&&checkQueue.length;){var toCheck=checkQueue.shift();if(!isStateExceptionHandled(toCheck)){markQStateExceptionHandled(toCheck);var errorMessage="Possibly unhandled rejection: "+toDebugString(toCheck.value);isError(toCheck.value)?exceptionHandler(toCheck.value,errorMessage):exceptionHandler(errorMessage)}}}function scheduleProcessQueue(state){!errorOnUnhandledRejections||state.pending||2!==state.status||isStateExceptionHandled(state)||(0===queueSize&&0===checkQueue.length&&nextTick(processChecks),checkQueue.push(state)),!state.processScheduled&&state.pending&&(state.processScheduled=!0,++queueSize,nextTick(function(){!function(state){var fn,promise,pending;pending=state.pending,state.processScheduled=!1,state.pending=void 0;try{for(var i=0,ii=pending.length;i<ii;++i){markQStateExceptionHandled(state),promise=pending[i][0],fn=pending[i][state.status];try{isFunction(fn)?resolvePromise(promise,fn(state.value)):1===state.status?resolvePromise(promise,state.value):rejectPromise(promise,state.value)}catch(e){rejectPromise(promise,e),e&&!0===e.$$passToExceptionHandler&&exceptionHandler(e)}}}finally{--queueSize,errorOnUnhandledRejections&&0===queueSize&&nextTick(processChecks)}}(state)}))}function resolvePromise(promise,val){promise.$$state.status||(val===promise?$$reject(promise,$qMinErr("qcycle","Expected promise to be resolved with value other than itself '{0}'",val)):function $$resolve(promise,val){var then;var done=!1;try{(isObject(val)||isFunction(val))&&(then=val.then),isFunction(then)?(promise.$$state.status=-1,then.call(val,function doResolve(val){if(done)return;done=!0,function $$resolve(promise,val){var then;var done=!1;try{(isObject(val)||isFunction(val))&&(then=val.then),isFunction(then)?(promise.$$state.status=-1,then.call(val,doResolve,doReject,function(progress){notifyPromise(promise,progress)})):(promise.$$state.value=val,promise.$$state.status=1,scheduleProcessQueue(promise.$$state))}catch(e){doReject(e)}function doResolve(val){done||(done=!0,$$resolve(promise,val))}function doReject(val){done||(done=!0,$$reject(promise,val))}}(promise,val)},doReject,function(progress){notifyPromise(promise,progress)})):(promise.$$state.value=val,promise.$$state.status=1,scheduleProcessQueue(promise.$$state))}catch(e){doReject(e)}function doResolve(val){done||(done=!0,$$resolve(promise,val))}function doReject(val){done||(done=!0,$$reject(promise,val))}}(promise,val))}function rejectPromise(promise,reason){promise.$$state.status||$$reject(promise,reason)}function $$reject(promise,reason){promise.$$state.value=reason,promise.$$state.status=2,scheduleProcessQueue(promise.$$state)}function notifyPromise(promise,progress){var callbacks=promise.$$state.pending;promise.$$state.status<=0&&callbacks&&callbacks.length&&nextTick(function(){for(var callback,result,i=0,ii=callbacks.length;i<ii;i++){result=callbacks[i][0],callback=callbacks[i][3];try{notifyPromise(result,isFunction(callback)?callback(progress):progress)}catch(e){exceptionHandler(e)}}})}function reject(reason){var result=new Promise;return rejectPromise(result,reason),result}function handleCallback(value,resolver,callback){var callbackOutput=null;try{isFunction(callback)&&(callbackOutput=callback())}catch(e){return reject(e)}return isPromiseLike(callbackOutput)?callbackOutput.then(function(){return resolver(value)},reject):resolver(value)}function when(value,callback,errback,progressBack){var result=new Promise;return resolvePromise(result,value),result.then(callback,errback,progressBack)}extend(Promise.prototype,{then:function(onFulfilled,onRejected,progressBack){if(isUndefined(onFulfilled)&&isUndefined(onRejected)&&isUndefined(progressBack))return this;var result=new Promise;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([result,onFulfilled,onRejected,progressBack]),this.$$state.status>0&&scheduleProcessQueue(this.$$state),result},catch:function(callback){return this.then(null,callback)},finally:function(callback,progressBack){return this.then(function(value){return handleCallback(value,resolve,callback)},function(error){return handleCallback(error,reject,callback)},progressBack)}});var resolve=when;function $Q(resolver){if(!isFunction(resolver))throw $qMinErr("norslvr","Expected resolverFn, got '{0}'",resolver);var promise=new Promise;return resolver(function(value){resolvePromise(promise,value)},function(reason){rejectPromise(promise,reason)}),promise}return $Q.prototype=Promise.prototype,$Q.defer=defer,$Q.reject=reject,$Q.when=when,$Q.resolve=resolve,$Q.all=function(promises){var result=new Promise,counter=0,results=isArray(promises)?[]:{};return forEach(promises,function(promise,key){counter++,when(promise).then(function(value){results[key]=value,--counter||resolvePromise(result,results)},function(reason){rejectPromise(result,reason)})}),0===counter&&resolvePromise(result,results),result},$Q.race=function(promises){var deferred=defer();return forEach(promises,function(promise){when(promise).then(deferred.resolve,deferred.reject)}),deferred.promise},$Q}function isStateExceptionHandled(state){return!!state.pur}function markQStateExceptionHandled(state){state.pur=!0}function markQExceptionHandled(q){q.$$state&&markQStateExceptionHandled(q.$$state)}function $$RAFProvider(){this.$get=["$window","$timeout",function($window,$timeout){var requestAnimationFrame=$window.requestAnimationFrame||$window.webkitRequestAnimationFrame,cancelAnimationFrame=$window.cancelAnimationFrame||$window.webkitCancelAnimationFrame||$window.webkitCancelRequestAnimationFrame,rafSupported=!!requestAnimationFrame,raf=rafSupported?function(fn){var id=requestAnimationFrame(fn);return function(){cancelAnimationFrame(id)}}:function(fn){var timer=$timeout(fn,16.66,!1);return function(){$timeout.cancel(timer)}};return raf.supported=rafSupported,raf}]}function $RootScopeProvider(){var TTL=10,$rootScopeMinErr=minErr("$rootScope"),lastDirtyWatch=null,applyAsyncId=null;this.digestTtl=function(value){return arguments.length&&(TTL=value),TTL},this.$get=["$exceptionHandler","$parse","$browser",function($exceptionHandler,$parse,$browser){function destroyChildScope($event){$event.currentScope.$$destroyed=!0}function Scope(){this.$id=nextUid(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$suspended=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}Scope.prototype={constructor:Scope,$new:function(isolate,parent){var child;return parent=parent||this,isolate?(child=new Scope).$root=this.$root:(this.$$ChildScope||(this.$$ChildScope=function(parent){function ChildScope(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=nextUid(),this.$$ChildScope=null,this.$$suspended=!1}return ChildScope.prototype=parent,ChildScope}(this)),child=new this.$$ChildScope),child.$parent=parent,child.$$prevSibling=parent.$$childTail,parent.$$childHead?(parent.$$childTail.$$nextSibling=child,parent.$$childTail=child):parent.$$childHead=parent.$$childTail=child,(isolate||parent!==this)&&child.$on("$destroy",destroyChildScope),child},$watch:function(watchExp,listener,objectEquality,prettyPrintExpression){var get=$parse(watchExp),fn=isFunction(listener)?listener:noop;if(get.$$watchDelegate)return get.$$watchDelegate(this,fn,objectEquality,get,watchExp);var scope=this,array=scope.$$watchers,watcher={fn:fn,last:initWatchVal,get:get,exp:prettyPrintExpression||watchExp,eq:!!objectEquality};return lastDirtyWatch=null,array||((array=scope.$$watchers=[]).$$digestWatchIndex=-1),array.unshift(watcher),array.$$digestWatchIndex++,incrementWatchersCount(this,1),function(){var index=arrayRemove(array,watcher);index>=0&&(incrementWatchersCount(scope,-1),index<array.$$digestWatchIndex&&array.$$digestWatchIndex--),lastDirtyWatch=null}},$watchGroup:function(watchExpressions,listener){var oldValues=new Array(watchExpressions.length),newValues=new Array(watchExpressions.length),deregisterFns=[],self=this,changeReactionScheduled=!1,firstRun=!0;if(!watchExpressions.length){var shouldCall=!0;return self.$evalAsync(function(){shouldCall&&listener(newValues,newValues,self)}),function(){shouldCall=!1}}if(1===watchExpressions.length)return this.$watch(watchExpressions[0],function(value,oldValue,scope){newValues[0]=value,oldValues[0]=oldValue,listener(newValues,value===oldValue?newValues:oldValues,scope)});function watchGroupAction(){changeReactionScheduled=!1;try{firstRun?(firstRun=!1,listener(newValues,newValues,self)):listener(newValues,oldValues,self)}finally{for(var i=0;i<watchExpressions.length;i++)oldValues[i]=newValues[i]}}return forEach(watchExpressions,function(expr,i){var unwatchFn=self.$watch(expr,function(value){newValues[i]=value,changeReactionScheduled||(changeReactionScheduled=!0,self.$evalAsync(watchGroupAction))});deregisterFns.push(unwatchFn)}),function(){for(;deregisterFns.length;)deregisterFns.shift()()}},$watchCollection:function(obj,listener){$watchCollectionInterceptor.$$pure=$parse(obj).literal,$watchCollectionInterceptor.$stateful=!$watchCollectionInterceptor.$$pure;var newValue,oldValue,veryOldValue,self=this,trackVeryOldValue=listener.length>1,changeDetected=0,changeDetector=$parse(obj,$watchCollectionInterceptor),internalArray=[],internalObject={},initRun=!0,oldLength=0;function $watchCollectionInterceptor(_value){var newLength,key,newItem,oldItem;if(!isUndefined(newValue=_value)){if(isObject(newValue))if(isArrayLike(newValue)){oldValue!==internalArray&&(oldLength=(oldValue=internalArray).length=0,changeDetected++),newLength=newValue.length,oldLength!==newLength&&(changeDetected++,oldValue.length=oldLength=newLength);for(var i=0;i<newLength;i++)oldItem=oldValue[i],newItem=newValue[i],oldItem!=oldItem&&newItem!=newItem||oldItem===newItem||(changeDetected++,oldValue[i]=newItem)}else{for(key in oldValue!==internalObject&&(oldValue=internalObject={},oldLength=0,changeDetected++),newLength=0,newValue)hasOwnProperty.call(newValue,key)&&(newLength++,newItem=newValue[key],oldItem=oldValue[key],key in oldValue?oldItem!=oldItem&&newItem!=newItem||oldItem===newItem||(changeDetected++,oldValue[key]=newItem):(oldLength++,oldValue[key]=newItem,changeDetected++));if(oldLength>newLength)for(key in changeDetected++,oldValue)hasOwnProperty.call(newValue,key)||(oldLength--,delete oldValue[key])}else oldValue!==newValue&&(oldValue=newValue,changeDetected++);return changeDetected}}return this.$watch(changeDetector,function(){if(initRun?(initRun=!1,listener(newValue,newValue,self)):listener(newValue,veryOldValue,self),trackVeryOldValue)if(isObject(newValue))if(isArrayLike(newValue)){veryOldValue=new Array(newValue.length);for(var i=0;i<newValue.length;i++)veryOldValue[i]=newValue[i]}else for(var key in veryOldValue={},newValue)hasOwnProperty.call(newValue,key)&&(veryOldValue[key]=newValue[key]);else veryOldValue=newValue})},$digest:function(){var watch,value,last,watchers,dirty,next,current,logIdx,asyncTask,ttl=TTL,target=asyncQueue.length?$rootScope:this,watchLog=[];beginPhase("$digest"),$browser.$$checkUrlChange(),this===$rootScope&&null!==applyAsyncId&&($browser.defer.cancel(applyAsyncId),flushApplyAsync()),lastDirtyWatch=null;do{dirty=!1,current=target;for(var asyncQueuePosition=0;asyncQueuePosition<asyncQueue.length;asyncQueuePosition++){try{(0,(asyncTask=asyncQueue[asyncQueuePosition]).fn)(asyncTask.scope,asyncTask.locals)}catch(e){$exceptionHandler(e)}lastDirtyWatch=null}asyncQueue.length=0;traverseScopesLoop:do{if(watchers=!current.$$suspended&&current.$$watchers)for(watchers.$$digestWatchIndex=watchers.length;watchers.$$digestWatchIndex--;)try{if(watch=watchers[watchers.$$digestWatchIndex])if((value=(0,watch.get)(current))===(last=watch.last)||(watch.eq?equals(value,last):isNumberNaN(value)&&isNumberNaN(last))){if(watch===lastDirtyWatch){dirty=!1;break traverseScopesLoop}}else dirty=!0,lastDirtyWatch=watch,watch.last=watch.eq?copy(value,null):value,(0,watch.fn)(value,last===initWatchVal?value:last,current),ttl<5&&(watchLog[logIdx=4-ttl]||(watchLog[logIdx]=[]),watchLog[logIdx].push({msg:isFunction(watch.exp)?"fn: "+(watch.exp.name||watch.exp.toString()):watch.exp,newVal:value,oldVal:last}))}catch(e){$exceptionHandler(e)}if(!(next=!current.$$suspended&&current.$$watchersCount&&current.$$childHead||current!==target&&current.$$nextSibling))for(;current!==target&&!(next=current.$$nextSibling);)current=current.$parent}while(current=next);if((dirty||asyncQueue.length)&&!ttl--)throw clearPhase(),$rootScopeMinErr("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",TTL,watchLog)}while(dirty||asyncQueue.length);for(clearPhase();postDigestQueuePosition<postDigestQueue.length;)try{postDigestQueue[postDigestQueuePosition++]()}catch(e){$exceptionHandler(e)}postDigestQueue.length=postDigestQueuePosition=0,$browser.$$checkUrlChange()},$suspend:function(){this.$$suspended=!0},$isSuspended:function(){return this.$$suspended},$resume:function(){this.$$suspended=!1},$destroy:function(){if(!this.$$destroyed){var parent=this.$parent;for(var eventName in this.$broadcast("$destroy"),this.$$destroyed=!0,this===$rootScope&&$browser.$$applicationDestroyed(),incrementWatchersCount(this,-this.$$watchersCount),this.$$listenerCount)decrementListenerCount(this,this.$$listenerCount[eventName],eventName);parent&&parent.$$childHead===this&&(parent.$$childHead=this.$$nextSibling),parent&&parent.$$childTail===this&&(parent.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=noop,this.$on=this.$watch=this.$watchGroup=function(){return noop},this.$$listeners={},this.$$nextSibling=null,function cleanUpScope($scope){9===msie&&($scope.$$childHead&&cleanUpScope($scope.$$childHead),$scope.$$nextSibling&&cleanUpScope($scope.$$nextSibling)),$scope.$parent=$scope.$$nextSibling=$scope.$$prevSibling=$scope.$$childHead=$scope.$$childTail=$scope.$root=$scope.$$watchers=null}(this)}},$eval:function(expr,locals){return $parse(expr)(this,locals)},$evalAsync:function(expr,locals){$rootScope.$$phase||asyncQueue.length||$browser.defer(function(){asyncQueue.length&&$rootScope.$digest()},null,"$evalAsync"),asyncQueue.push({scope:this,fn:$parse(expr),locals:locals})},$$postDigest:function(fn){postDigestQueue.push(fn)},$apply:function(expr){try{beginPhase("$apply");try{return this.$eval(expr)}finally{clearPhase()}}catch(e){$exceptionHandler(e)}finally{try{$rootScope.$digest()}catch(e){throw $exceptionHandler(e),e}}},$applyAsync:function(expr){var scope=this;expr&&applyAsyncQueue.push(function(){scope.$eval(expr)}),expr=$parse(expr),null===applyAsyncId&&(applyAsyncId=$browser.defer(function(){$rootScope.$apply(flushApplyAsync)},null,"$applyAsync"))},$on:function(name,listener){var namedListeners=this.$$listeners[name];namedListeners||(this.$$listeners[name]=namedListeners=[]),namedListeners.push(listener);var current=this;do{current.$$listenerCount[name]||(current.$$listenerCount[name]=0),current.$$listenerCount[name]++}while(current=current.$parent);var self=this;return function(){var indexOfListener=namedListeners.indexOf(listener);-1!==indexOfListener&&(delete namedListeners[indexOfListener],decrementListenerCount(self,1,name))}},$emit:function(name,args){var namedListeners,i,length,empty=[],scope=this,stopPropagation=!1,event={name:name,targetScope:scope,stopPropagation:function(){stopPropagation=!0},preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1},listenerArgs=concat([event],arguments,1);do{for(namedListeners=scope.$$listeners[name]||empty,event.currentScope=scope,i=0,length=namedListeners.length;i<length;i++)if(namedListeners[i])try{namedListeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else namedListeners.splice(i,1),i--,length--;if(stopPropagation)break;scope=scope.$parent}while(scope);return event.currentScope=null,event},$broadcast:function(name,args){var current=this,next=this,event={name:name,targetScope:this,preventDefault:function(){event.defaultPrevented=!0},defaultPrevented:!1};if(!this.$$listenerCount[name])return event;for(var listeners,i,length,listenerArgs=concat([event],arguments,1);current=next;){for(event.currentScope=current,i=0,length=(listeners=current.$$listeners[name]||[]).length;i<length;i++)if(listeners[i])try{listeners[i].apply(null,listenerArgs)}catch(e){$exceptionHandler(e)}else listeners.splice(i,1),i--,length--;if(!(next=current.$$listenerCount[name]&&current.$$childHead||current!==this&&current.$$nextSibling))for(;current!==this&&!(next=current.$$nextSibling);)current=current.$parent}return event.currentScope=null,event}};var $rootScope=new Scope,asyncQueue=$rootScope.$$asyncQueue=[],postDigestQueue=$rootScope.$$postDigestQueue=[],applyAsyncQueue=$rootScope.$$applyAsyncQueue=[],postDigestQueuePosition=0;return $rootScope;function beginPhase(phase){if($rootScope.$$phase)throw $rootScopeMinErr("inprog","{0} already in progress",$rootScope.$$phase);$rootScope.$$phase=phase}function clearPhase(){$rootScope.$$phase=null}function incrementWatchersCount(current,count){do{current.$$watchersCount+=count}while(current=current.$parent)}function decrementListenerCount(current,count,name){do{current.$$listenerCount[name]-=count,0===current.$$listenerCount[name]&&delete current.$$listenerCount[name]}while(current=current.$parent)}function initWatchVal(){}function flushApplyAsync(){for(;applyAsyncQueue.length;)try{applyAsyncQueue.shift()()}catch(e){$exceptionHandler(e)}applyAsyncId=null}}]}function $$SanitizeUriProvider(){var aHrefSanitizationWhitelist=/^\s*(https?|s?ftp|mailto|tel|file):/,imgSrcSanitizationWhitelist=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(regexp){return isDefined(regexp)?(aHrefSanitizationWhitelist=regexp,this):aHrefSanitizationWhitelist},this.imgSrcSanitizationWhitelist=function(regexp){return isDefined(regexp)?(imgSrcSanitizationWhitelist=regexp,this):imgSrcSanitizationWhitelist},this.$get=function(){return function(uri,isMediaUrl){var regex=isMediaUrl?imgSrcSanitizationWhitelist:aHrefSanitizationWhitelist,normalizedVal=urlResolve(uri&&uri.trim()).href;return""===normalizedVal||normalizedVal.match(regex)?uri:"unsafe:"+normalizedVal}}}ASTCompiler.prototype={compile:function(ast){var self=this;this.state={nextId:0,filters:{},fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},findConstantAndWatchExpressions(ast,self.$filter);var assignable,extra="";if(this.stage="assign",assignable=assignableAST(ast)){this.state.computing="assign";var result=this.nextId();this.recurse(assignable,result),this.return_(result),extra="fn.assign="+this.generateFunction("assign","s,v,l")}var toWatch=getInputs(ast.body);self.stage="inputs",forEach(toWatch,function(watch,key){var fnKey="fn"+key;self.state[fnKey]={vars:[],body:[],own:{}},self.state.computing=fnKey;var intoId=self.nextId();self.recurse(watch,intoId),self.return_(intoId),self.state.inputs.push({name:fnKey,isPure:watch.isPure}),watch.watchId=key}),this.state.computing="fn",this.stage="main",this.recurse(ast);var fnString='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+extra+this.watchFns()+"return fn;",fn=new Function("$filter","getStringValue","ifDefined","plus",fnString)(this.$filter,getStringValue,ifDefined,plusFn);return this.state=this.stage=void 0,fn},USE:"use",STRICT:"strict",watchFns:function(){var result=[],inputs=this.state.inputs,self=this;return forEach(inputs,function(input){result.push("var "+input.name+"="+self.generateFunction(input.name,"s")),input.isPure&&result.push(input.name,".isPure="+JSON.stringify(input.isPure)+";")}),inputs.length&&result.push("fn.inputs=["+inputs.map(function(i){return i.name}).join(",")+"];"),result.join("")},generateFunction:function(name,params){return"function("+params+"){"+this.varsPrefix(name)+this.body(name)+"};"},filterPrefix:function(){var parts=[],self=this;return forEach(this.state.filters,function(id,filter){parts.push(id+"=$filter("+self.escape(filter)+")")}),parts.length?"var "+parts.join(",")+";":""},varsPrefix:function(section){return this.state[section].vars.length?"var "+this.state[section].vars.join(",")+";":""},body:function(section){return this.state[section].body.join("")},recurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var left,right,args,expression,computed,self=this;if(recursionFn=recursionFn||noop,!skipWatchIdCheck&&isDefined(ast.watchId))return intoId=intoId||this.nextId(),void this.if_("i",this.lazyAssign(intoId,this.computedMember("i",ast.watchId)),this.lazyRecurse(ast,intoId,nameId,recursionFn,create,!0));switch(ast.type){case AST.Program:forEach(ast.body,function(expression,pos){self.recurse(expression.expression,void 0,void 0,function(expr){right=expr}),pos!==ast.body.length-1?self.current().body.push(right,";"):self.return_(right)});break;case AST.Literal:expression=this.escape(ast.value),this.assign(intoId,expression),recursionFn(intoId||expression);break;case AST.UnaryExpression:this.recurse(ast.argument,void 0,void 0,function(expr){right=expr}),expression=ast.operator+"("+this.ifDefined(right,0)+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.BinaryExpression:this.recurse(ast.left,void 0,void 0,function(expr){left=expr}),this.recurse(ast.right,void 0,void 0,function(expr){right=expr}),expression="+"===ast.operator?this.plus(left,right):"-"===ast.operator?this.ifDefined(left,0)+ast.operator+this.ifDefined(right,0):"("+left+")"+ast.operator+"("+right+")",this.assign(intoId,expression),recursionFn(expression);break;case AST.LogicalExpression:intoId=intoId||this.nextId(),self.recurse(ast.left,intoId),self.if_("&&"===ast.operator?intoId:self.not(intoId),self.lazyRecurse(ast.right,intoId)),recursionFn(intoId);break;case AST.ConditionalExpression:intoId=intoId||this.nextId(),self.recurse(ast.test,intoId),self.if_(intoId,self.lazyRecurse(ast.alternate,intoId),self.lazyRecurse(ast.consequent,intoId)),recursionFn(intoId);break;case AST.Identifier:intoId=intoId||this.nextId(),nameId&&(nameId.context="inputs"===self.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",ast.name)+"?l:s"),nameId.computed=!1,nameId.name=ast.name),self.if_("inputs"===self.stage||self.not(self.getHasOwnProperty("l",ast.name)),function(){self.if_("inputs"===self.stage||"s",function(){create&&1!==create&&self.if_(self.isNull(self.nonComputedMember("s",ast.name)),self.lazyAssign(self.nonComputedMember("s",ast.name),"{}")),self.assign(intoId,self.nonComputedMember("s",ast.name))})},intoId&&self.lazyAssign(intoId,self.nonComputedMember("l",ast.name))),recursionFn(intoId);break;case AST.MemberExpression:left=nameId&&(nameId.context=this.nextId())||this.nextId(),intoId=intoId||this.nextId(),self.recurse(ast.object,left,void 0,function(){self.if_(self.notNull(left),function(){ast.computed?(right=self.nextId(),self.recurse(ast.property,right),self.getStringValue(right),create&&1!==create&&self.if_(self.not(self.computedMember(left,right)),self.lazyAssign(self.computedMember(left,right),"{}")),expression=self.computedMember(left,right),self.assign(intoId,expression),nameId&&(nameId.computed=!0,nameId.name=right)):(create&&1!==create&&self.if_(self.isNull(self.nonComputedMember(left,ast.property.name)),self.lazyAssign(self.nonComputedMember(left,ast.property.name),"{}")),expression=self.nonComputedMember(left,ast.property.name),self.assign(intoId,expression),nameId&&(nameId.computed=!1,nameId.name=ast.property.name))},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)},!!create);break;case AST.CallExpression:intoId=intoId||this.nextId(),ast.filter?(right=self.filter(ast.callee.name),args=[],forEach(ast.arguments,function(expr){var argument=self.nextId();self.recurse(expr,argument),args.push(argument)}),expression=right+"("+args.join(",")+")",self.assign(intoId,expression),recursionFn(intoId)):(right=self.nextId(),left={},args=[],self.recurse(ast.callee,right,left,function(){self.if_(self.notNull(right),function(){forEach(ast.arguments,function(expr){self.recurse(expr,ast.constant?void 0:self.nextId(),void 0,function(argument){args.push(argument)})}),expression=left.name?self.member(left.context,left.name,left.computed)+"("+args.join(",")+")":right+"("+args.join(",")+")",self.assign(intoId,expression)},function(){self.assign(intoId,"undefined")}),recursionFn(intoId)}));break;case AST.AssignmentExpression:right=this.nextId(),left={},this.recurse(ast.left,void 0,left,function(){self.if_(self.notNull(left.context),function(){self.recurse(ast.right,right),expression=self.member(left.context,left.name,left.computed)+ast.operator+right,self.assign(intoId,expression),recursionFn(intoId||expression)})},1);break;case AST.ArrayExpression:args=[],forEach(ast.elements,function(expr){self.recurse(expr,ast.constant?void 0:self.nextId(),void 0,function(argument){args.push(argument)})}),expression="["+args.join(",")+"]",this.assign(intoId,expression),recursionFn(intoId||expression);break;case AST.ObjectExpression:args=[],computed=!1,forEach(ast.properties,function(property){property.computed&&(computed=!0)}),computed?(intoId=intoId||this.nextId(),this.assign(intoId,"{}"),forEach(ast.properties,function(property){property.computed?(left=self.nextId(),self.recurse(property.key,left)):left=property.key.type===AST.Identifier?property.key.name:""+property.key.value,right=self.nextId(),self.recurse(property.value,right),self.assign(self.member(intoId,left,property.computed),right)})):(forEach(ast.properties,function(property){self.recurse(property.value,ast.constant?void 0:self.nextId(),void 0,function(expr){args.push(self.escape(property.key.type===AST.Identifier?property.key.name:""+property.key.value)+":"+expr)})}),expression="{"+args.join(",")+"}",this.assign(intoId,expression)),recursionFn(intoId||expression);break;case AST.ThisExpression:this.assign(intoId,"s"),recursionFn(intoId||"s");break;case AST.LocalsExpression:this.assign(intoId,"l"),recursionFn(intoId||"l");break;case AST.NGValueParameter:this.assign(intoId,"v"),recursionFn(intoId||"v")}},getHasOwnProperty:function(element,property){var key=element+"."+property,own=this.current().own;return own.hasOwnProperty(key)||(own[key]=this.nextId(!1,element+"&&("+this.escape(property)+" in "+element+")")),own[key]},assign:function(id,value){if(id)return this.current().body.push(id,"=",value,";"),id},filter:function(filterName){return this.state.filters.hasOwnProperty(filterName)||(this.state.filters[filterName]=this.nextId(!0)),this.state.filters[filterName]},ifDefined:function(id,defaultValue){return"ifDefined("+id+","+this.escape(defaultValue)+")"},plus:function(left,right){return"plus("+left+","+right+")"},return_:function(id){this.current().body.push("return ",id,";")},if_:function(test,alternate,consequent){if(!0===test)alternate();else{var body=this.current().body;body.push("if(",test,"){"),alternate(),body.push("}"),consequent&&(body.push("else{"),consequent(),body.push("}"))}},not:function(expression){return"!("+expression+")"},isNull:function(expression){return expression+"==null"},notNull:function(expression){return expression+"!=null"},nonComputedMember:function(left,right){return/^[$_a-zA-Z][$_a-zA-Z0-9]*$/.test(right)?left+"."+right:left+'["'+right.replace(/[^$_a-zA-Z0-9]/g,this.stringEscapeFn)+'"]'},computedMember:function(left,right){return left+"["+right+"]"},member:function(left,right,computed){return computed?this.computedMember(left,right):this.nonComputedMember(left,right)},getStringValue:function(item){this.assign(item,"getStringValue("+item+")")},lazyRecurse:function(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck){var self=this;return function(){self.recurse(ast,intoId,nameId,recursionFn,create,skipWatchIdCheck)}},lazyAssign:function(id,value){var self=this;return function(){self.assign(id,value)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(c){return"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)},escape:function(value){if(isString(value))return"'"+value.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(isNumber(value))return value.toString();if(!0===value)return"true";if(!1===value)return"false";if(null===value)return"null";if(void 0===value)return"undefined";throw $parseMinErr("esc","IMPOSSIBLE")},nextId:function(skip,init){var id="v"+this.state.nextId++;return skip||this.current().vars.push(id+(init?"="+init:"")),id},current:function(){return this.state[this.state.computing]}},ASTInterpreter.prototype={compile:function(ast){var assignable,assign,self=this;findConstantAndWatchExpressions(ast,self.$filter),(assignable=assignableAST(ast))&&(assign=this.recurse(assignable));var inputs,toWatch=getInputs(ast.body);toWatch&&(inputs=[],forEach(toWatch,function(watch,key){var input=self.recurse(watch);input.isPure=watch.isPure,watch.input=input,inputs.push(input),watch.watchId=key}));var expressions=[];forEach(ast.body,function(expression){expressions.push(self.recurse(expression.expression))});var fn=0===ast.body.length?noop:1===ast.body.length?expressions[0]:function(scope,locals){var lastValue;return forEach(expressions,function(exp){lastValue=exp(scope,locals)}),lastValue};return assign&&(fn.assign=function(scope,value,locals){return assign(scope,locals,value)}),inputs&&(fn.inputs=inputs),fn},recurse:function(ast,context,create){var left,right,args,self=this;if(ast.input)return this.inputs(ast.input,ast.watchId);switch(ast.type){case AST.Literal:return this.value(ast.value,context);case AST.UnaryExpression:return right=this.recurse(ast.argument),this["unary"+ast.operator](right,context);case AST.BinaryExpression:case AST.LogicalExpression:return left=this.recurse(ast.left),right=this.recurse(ast.right),this["binary"+ast.operator](left,right,context);case AST.ConditionalExpression:return this["ternary?:"](this.recurse(ast.test),this.recurse(ast.alternate),this.recurse(ast.consequent),context);case AST.Identifier:return self.identifier(ast.name,context,create);case AST.MemberExpression:return left=this.recurse(ast.object,!1,!!create),ast.computed||(right=ast.property.name),ast.computed&&(right=this.recurse(ast.property)),ast.computed?this.computedMember(left,right,context,create):this.nonComputedMember(left,right,context,create);case AST.CallExpression:return args=[],forEach(ast.arguments,function(expr){args.push(self.recurse(expr))}),ast.filter&&(right=this.$filter(ast.callee.name)),ast.filter||(right=this.recurse(ast.callee,!0)),ast.filter?function(scope,locals,assign,inputs){for(var values=[],i=0;i<args.length;++i)values.push(args[i](scope,locals,assign,inputs));var value=right.apply(void 0,values,inputs);return context?{context:void 0,name:void 0,value:value}:value}:function(scope,locals,assign,inputs){var value,rhs=right(scope,locals,assign,inputs);if(null!=rhs.value){for(var values=[],i=0;i<args.length;++i)values.push(args[i](scope,locals,assign,inputs));value=rhs.value.apply(rhs.context,values)}return context?{value:value}:value};case AST.AssignmentExpression:return left=this.recurse(ast.left,!0,1),right=this.recurse(ast.right),function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs);return lhs.context[lhs.name]=rhs,context?{value:rhs}:rhs};case AST.ArrayExpression:return args=[],forEach(ast.elements,function(expr){args.push(self.recurse(expr))}),function(scope,locals,assign,inputs){for(var value=[],i=0;i<args.length;++i)value.push(args[i](scope,locals,assign,inputs));return context?{value:value}:value};case AST.ObjectExpression:return args=[],forEach(ast.properties,function(property){property.computed?args.push({key:self.recurse(property.key),computed:!0,value:self.recurse(property.value)}):args.push({key:property.key.type===AST.Identifier?property.key.name:""+property.key.value,computed:!1,value:self.recurse(property.value)})}),function(scope,locals,assign,inputs){for(var value={},i=0;i<args.length;++i)args[i].computed?value[args[i].key(scope,locals,assign,inputs)]=args[i].value(scope,locals,assign,inputs):value[args[i].key]=args[i].value(scope,locals,assign,inputs);return context?{value:value}:value};case AST.ThisExpression:return function(scope){return context?{value:scope}:scope};case AST.LocalsExpression:return function(scope,locals){return context?{value:locals}:locals};case AST.NGValueParameter:return function(scope,locals,assign){return context?{value:assign}:assign}}},"unary+":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?+arg:0,context?{value:arg}:arg}},"unary-":function(argument,context){return function(scope,locals,assign,inputs){var arg=argument(scope,locals,assign,inputs);return arg=isDefined(arg)?-arg:-0,context?{value:arg}:arg}},"unary!":function(argument,context){return function(scope,locals,assign,inputs){var arg=!argument(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary+":function(left,right,context){return function(scope,locals,assign,inputs){var arg=plusFn(left(scope,locals,assign,inputs),right(scope,locals,assign,inputs));return context?{value:arg}:arg}},"binary-":function(left,right,context){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs),rhs=right(scope,locals,assign,inputs),arg=(isDefined(lhs)?lhs:0)-(isDefined(rhs)?rhs:0);return context?{value:arg}:arg}},"binary*":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)*right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary/":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)/right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary%":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)%right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary===":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)===right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary==":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)==right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary!=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)!=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary<=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)<=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary>=":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)>=right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary&&":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)&&right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"binary||":function(left,right,context){return function(scope,locals,assign,inputs){var arg=left(scope,locals,assign,inputs)||right(scope,locals,assign,inputs);return context?{value:arg}:arg}},"ternary?:":function(test,alternate,consequent,context){return function(scope,locals,assign,inputs){var arg=test(scope,locals,assign,inputs)?alternate(scope,locals,assign,inputs):consequent(scope,locals,assign,inputs);return context?{value:arg}:arg}},value:function(value,context){return function(){return context?{context:void 0,name:void 0,value:value}:value}},identifier:function(name,context,create){return function(scope,locals,assign,inputs){var base=locals&&name in locals?locals:scope;create&&1!==create&&base&&null==base[name]&&(base[name]={});var value=base?base[name]:void 0;return context?{context:base,name:name,value:value}:value}},computedMember:function(left,right,context,create){return function(scope,locals,assign,inputs){var rhs,value,lhs=left(scope,locals,assign,inputs);return null!=lhs&&(rhs=getStringValue(rhs=right(scope,locals,assign,inputs)),create&&1!==create&&lhs&&!lhs[rhs]&&(lhs[rhs]={}),value=lhs[rhs]),context?{context:lhs,name:rhs,value:value}:value}},nonComputedMember:function(left,right,context,create){return function(scope,locals,assign,inputs){var lhs=left(scope,locals,assign,inputs);create&&1!==create&&lhs&&null==lhs[right]&&(lhs[right]={});var value=null!=lhs?lhs[right]:void 0;return context?{context:lhs,name:right,value:value}:value}},inputs:function(input,watchId){return function(scope,value,locals,inputs){return inputs?inputs[watchId]:input(scope,value,locals)}}},Parser.prototype={constructor:Parser,parse:function(text){var ast=this.getAst(text),fn=this.astCompiler.compile(ast.ast);return fn.literal=function(ast){return 0===ast.body.length||1===ast.body.length&&(ast.body[0].expression.type===AST.Literal||ast.body[0].expression.type===AST.ArrayExpression||ast.body[0].expression.type===AST.ObjectExpression)}(ast.ast),fn.constant=function(ast){return ast.constant}(ast.ast),fn.oneTime=ast.oneTime,fn},getAst:function(exp){var oneTime=!1;return":"===(exp=exp.trim()).charAt(0)&&":"===exp.charAt(1)&&(oneTime=!0,exp=exp.substring(2)),{ast:this.ast.ast(exp),oneTime:oneTime}}};var $sceMinErr=minErr("$sce"),SCE_CONTEXTS={HTML:"html",CSS:"css",MEDIA_URL:"mediaUrl",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},UNDERSCORE_LOWERCASE_REGEXP=/_([a-z])/g;function snakeToCamel(name){return name.replace(UNDERSCORE_LOWERCASE_REGEXP,fnCamelCaseReplace)}function adjustMatchers(matchers){var adjustedMatchers=[];return isDefined(matchers)&&forEach(matchers,function(matcher){adjustedMatchers.push(function(matcher){if("self"===matcher)return matcher;if(isString(matcher)){if(matcher.indexOf("***")>-1)throw $sceMinErr("iwcard","Illegal sequence *** in string matcher.  String: {0}",matcher);return matcher=escapeForRegexp(matcher).replace(/\\\*\\\*/g,".*").replace(/\\\*/g,"[^:/.?&;]*"),new RegExp("^"+matcher+"$")}if(isRegExp(matcher))return new RegExp("^"+matcher.source+"$");throw $sceMinErr("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}(matcher))}),adjustedMatchers}function $SceDelegateProvider(){this.SCE_CONTEXTS=SCE_CONTEXTS;var resourceUrlWhitelist=["self"],resourceUrlBlacklist=[];this.resourceUrlWhitelist=function(value){return arguments.length&&(resourceUrlWhitelist=adjustMatchers(value)),resourceUrlWhitelist},this.resourceUrlBlacklist=function(value){return arguments.length&&(resourceUrlBlacklist=adjustMatchers(value)),resourceUrlBlacklist},this.$get=["$injector","$$sanitizeUri",function($injector,$$sanitizeUri){var htmlSanitizer=function(html){throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")};function matchUrl(matcher,parsedUrl){return"self"===matcher?urlsAreSameOrigin(parsedUrl,originUrl)||function(requestUrl){return urlsAreSameOrigin(requestUrl,function(){if(window.document.baseURI)return window.document.baseURI;baseUrlParsingNode||((baseUrlParsingNode=window.document.createElement("a")).href=".",baseUrlParsingNode=baseUrlParsingNode.cloneNode(!1));return baseUrlParsingNode.href}())}(parsedUrl):!!matcher.exec(parsedUrl.href)}function generateHolderType(Base){var holderType=function(trustedValue){this.$$unwrapTrustedValue=function(){return trustedValue}};return Base&&(holderType.prototype=new Base),holderType.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},holderType.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},holderType}$injector.has("$sanitize")&&(htmlSanitizer=$injector.get("$sanitize"));var trustedValueHolderBase=generateHolderType(),byType={};return byType[SCE_CONTEXTS.HTML]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.CSS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.MEDIA_URL]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.URL]=generateHolderType(byType[SCE_CONTEXTS.MEDIA_URL]),byType[SCE_CONTEXTS.JS]=generateHolderType(trustedValueHolderBase),byType[SCE_CONTEXTS.RESOURCE_URL]=generateHolderType(byType[SCE_CONTEXTS.URL]),{trustAs:function(type,trustedValue){var Constructor=byType.hasOwnProperty(type)?byType[type]:null;if(!Constructor)throw $sceMinErr("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",type,trustedValue);if(null===trustedValue||isUndefined(trustedValue)||""===trustedValue)return trustedValue;if("string"!=typeof trustedValue)throw $sceMinErr("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",type);return new Constructor(trustedValue)},getTrusted:function(type,maybeTrusted){if(null===maybeTrusted||isUndefined(maybeTrusted)||""===maybeTrusted)return maybeTrusted;var constructor=byType.hasOwnProperty(type)?byType[type]:null;if(constructor&&maybeTrusted instanceof constructor)return maybeTrusted.$$unwrapTrustedValue();if(isFunction(maybeTrusted.$$unwrapTrustedValue)&&(maybeTrusted=maybeTrusted.$$unwrapTrustedValue()),type===SCE_CONTEXTS.MEDIA_URL||type===SCE_CONTEXTS.URL)return $$sanitizeUri(maybeTrusted.toString(),type===SCE_CONTEXTS.MEDIA_URL);if(type===SCE_CONTEXTS.RESOURCE_URL){if(function(url){var i,n,parsedUrl=urlResolve(url.toString()),allowed=!1;for(i=0,n=resourceUrlWhitelist.length;i<n;i++)if(matchUrl(resourceUrlWhitelist[i],parsedUrl)){allowed=!0;break}if(allowed)for(i=0,n=resourceUrlBlacklist.length;i<n;i++)if(matchUrl(resourceUrlBlacklist[i],parsedUrl)){allowed=!1;break}return allowed}(maybeTrusted))return maybeTrusted;throw $sceMinErr("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",maybeTrusted.toString())}if(type===SCE_CONTEXTS.HTML)return htmlSanitizer(maybeTrusted);throw $sceMinErr("unsafe","Attempting to use an unsafe value in a safe context.")},valueOf:function(maybeTrusted){return maybeTrusted instanceof trustedValueHolderBase?maybeTrusted.$$unwrapTrustedValue():maybeTrusted}}}]}function $SceProvider(){var enabled=!0;this.enabled=function(value){return arguments.length&&(enabled=!!value),enabled},this.$get=["$parse","$sceDelegate",function($parse,$sceDelegate){if(enabled&&msie<8)throw $sceMinErr("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var sce=shallowCopy(SCE_CONTEXTS);sce.isEnabled=function(){return enabled},sce.trustAs=$sceDelegate.trustAs,sce.getTrusted=$sceDelegate.getTrusted,sce.valueOf=$sceDelegate.valueOf,enabled||(sce.trustAs=sce.getTrusted=function(type,value){return value},sce.valueOf=identity),sce.parseAs=function(type,expr){var parsed=$parse(expr);return parsed.literal&&parsed.constant?parsed:$parse(expr,function(value){return sce.getTrusted(type,value)})};var parse=sce.parseAs,getTrusted=sce.getTrusted,trustAs=sce.trustAs;return forEach(SCE_CONTEXTS,function(enumValue,name){var lName=lowercase(name);sce[snakeToCamel("parse_as_"+lName)]=function(expr){return parse(enumValue,expr)},sce[snakeToCamel("get_trusted_"+lName)]=function(value){return getTrusted(enumValue,value)},sce[snakeToCamel("trust_as_"+lName)]=function(value){return trustAs(enumValue,value)}}),sce}]}function $SnifferProvider(){this.$get=["$window","$document",function($window,$document){var eventSupport={},hasHistoryPushState=!(!($window.nw&&$window.nw.process)&&$window.chrome&&($window.chrome.app&&$window.chrome.app.runtime||!$window.chrome.app&&$window.chrome.runtime&&$window.chrome.runtime.id))&&$window.history&&$window.history.pushState,android=toInt((/android (\d+)/.exec(lowercase(($window.navigator||{}).userAgent))||[])[1]),boxee=/Boxee/i.test(($window.navigator||{}).userAgent),document=$document[0]||{},bodyStyle=document.body&&document.body.style,transitions=!1,animations=!1;return bodyStyle&&(transitions=!!("transition"in bodyStyle||"webkitTransition"in bodyStyle),animations=!!("animation"in bodyStyle||"webkitAnimation"in bodyStyle)),{history:!(!hasHistoryPushState||android<4||boxee),hasEvent:function(event){if("input"===event&&msie)return!1;if(isUndefined(eventSupport[event])){var divElm=document.createElement("div");eventSupport[event]="on"+event in divElm}return eventSupport[event]},csp:csp(),transitions:transitions,animations:animations,android:android}}]}function $$TaskTrackerFactoryProvider(){this.$get=valueFn(function(log){return new function(log){var taskCounts={},taskCallbacks=[],ALL_TASKS_TYPE=this.ALL_TASKS_TYPE="$$all$$",DEFAULT_TASK_TYPE=this.DEFAULT_TASK_TYPE="$$default$$";function getLastCallback(){var cbInfo=taskCallbacks.pop();return cbInfo&&cbInfo.cb}function getLastCallbackForType(taskType){for(var i=taskCallbacks.length-1;i>=0;--i){var cbInfo=taskCallbacks[i];if(cbInfo.type===taskType)return taskCallbacks.splice(i,1),cbInfo.cb}}this.completeTask=function(fn,taskType){taskType=taskType||DEFAULT_TASK_TYPE;try{fn()}finally{!function(taskType){taskCounts[taskType=taskType||DEFAULT_TASK_TYPE]&&(taskCounts[taskType]--,taskCounts[ALL_TASKS_TYPE]--)}(taskType);var countForType=taskCounts[taskType],countForAll=taskCounts[ALL_TASKS_TYPE];if(!countForAll||!countForType)for(var nextCb,getNextCallback=countForAll?getLastCallbackForType:getLastCallback;nextCb=getNextCallback(taskType);)try{nextCb()}catch(e){log.error(e)}}},this.incTaskCount=function(taskType){taskCounts[taskType=taskType||DEFAULT_TASK_TYPE]=(taskCounts[taskType]||0)+1,taskCounts[ALL_TASKS_TYPE]=(taskCounts[ALL_TASKS_TYPE]||0)+1},this.notifyWhenNoPendingTasks=function(callback,taskType){taskCounts[taskType=taskType||ALL_TASKS_TYPE]?taskCallbacks.push({type:taskType,cb:callback}):callback()}}(log)})}var $templateRequestMinErr=minErr("$templateRequest");function $TemplateRequestProvider(){var httpOptions;this.httpOptions=function(val){return val?(httpOptions=val,this):httpOptions},this.$get=["$exceptionHandler","$templateCache","$http","$q","$sce",function($exceptionHandler,$templateCache,$http,$q,$sce){function handleRequestFn(tpl,ignoreRequestError){handleRequestFn.totalPendingRequests++,isString(tpl)&&!isUndefined($templateCache.get(tpl))||(tpl=$sce.getTrustedResourceUrl(tpl));var transformResponse=$http.defaults&&$http.defaults.transformResponse;return isArray(transformResponse)?transformResponse=transformResponse.filter(function(transformer){return transformer!==defaultHttpResponseTransform}):transformResponse===defaultHttpResponseTransform&&(transformResponse=null),$http.get(tpl,extend({cache:$templateCache,transformResponse:transformResponse},httpOptions)).finally(function(){handleRequestFn.totalPendingRequests--}).then(function(response){return $templateCache.put(tpl,response.data)},function(resp){ignoreRequestError||(resp=$templateRequestMinErr("tpload","Failed to load template: {0} (HTTP status: {1} {2})",tpl,resp.status,resp.statusText),$exceptionHandler(resp));return $q.reject(resp)})}return handleRequestFn.totalPendingRequests=0,handleRequestFn}]}function $$TestabilityProvider(){this.$get=["$rootScope","$browser","$location",function($rootScope,$browser,$location){var testability={findBindings:function(element,expression,opt_exactMatch){var matches=[];return forEach(element.getElementsByClassName("ng-binding"),function(binding){var dataBinding=angular.element(binding).data("$binding");dataBinding&&forEach(dataBinding,function(bindingName){opt_exactMatch?new RegExp("(^|\\s)"+escapeForRegexp(expression)+"(\\s|\\||$)").test(bindingName)&&matches.push(binding):-1!==bindingName.indexOf(expression)&&matches.push(binding)})}),matches},findModels:function(element,expression,opt_exactMatch){for(var prefixes=["ng-","data-ng-","ng\\:"],p=0;p<prefixes.length;++p){var selector="["+prefixes[p]+"model"+(opt_exactMatch?"=":"*=")+'"'+expression+'"]',elements=element.querySelectorAll(selector);if(elements.length)return elements}},getLocation:function(){return $location.url()},setLocation:function(url){url!==$location.url()&&($location.url(url),$rootScope.$digest())},whenStable:function(callback){$browser.notifyWhenNoOutstandingRequests(callback)}};return testability}]}var $timeoutMinErr=minErr("$timeout");function $TimeoutProvider(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function($rootScope,$browser,$q,$$q,$exceptionHandler){var deferreds={};function timeout(fn,delay,invokeApply){isFunction(fn)||(invokeApply=delay,delay=fn,fn=noop);var timeoutId,args=sliceArgs(arguments,3),skipApply=isDefined(invokeApply)&&!invokeApply,deferred=(skipApply?$$q:$q).defer(),promise=deferred.promise;return timeoutId=$browser.defer(function(){try{deferred.resolve(fn.apply(null,args))}catch(e){deferred.reject(e),$exceptionHandler(e)}finally{delete deferreds[promise.$$timeoutId]}skipApply||$rootScope.$apply()},delay,"$timeout"),promise.$$timeoutId=timeoutId,deferreds[timeoutId]=deferred,promise}return timeout.cancel=function(promise){if(!promise)return!1;if(!promise.hasOwnProperty("$$timeoutId"))throw $timeoutMinErr("badprom","`$timeout.cancel()` called with a promise that was not generated by `$timeout()`.");if(!deferreds.hasOwnProperty(promise.$$timeoutId))return!1;var id=promise.$$timeoutId,deferred=deferreds[id];return markQExceptionHandled(deferred.promise),deferred.reject("canceled"),delete deferreds[id],$browser.defer.cancel(id)},timeout}]}var baseUrlParsingNode,urlParsingNode=window.document.createElement("a"),originUrl=urlResolve(window.location.href);urlParsingNode.href="http://[::1]";var ipv6InBrackets="[::1]"===urlParsingNode.hostname;function urlResolve(url){if(!isString(url))return url;var href=url;msie&&(urlParsingNode.setAttribute("href",href),href=urlParsingNode.href),urlParsingNode.setAttribute("href",href);var hostname=urlParsingNode.hostname;return!ipv6InBrackets&&hostname.indexOf(":")>-1&&(hostname="["+hostname+"]"),{href:urlParsingNode.href,protocol:urlParsingNode.protocol?urlParsingNode.protocol.replace(/:$/,""):"",host:urlParsingNode.host,search:urlParsingNode.search?urlParsingNode.search.replace(/^\?/,""):"",hash:urlParsingNode.hash?urlParsingNode.hash.replace(/^#/,""):"",hostname:hostname,port:urlParsingNode.port,pathname:"/"===urlParsingNode.pathname.charAt(0)?urlParsingNode.pathname:"/"+urlParsingNode.pathname}}function urlsAreSameOrigin(url1,url2){return url1=urlResolve(url1),url2=urlResolve(url2),url1.protocol===url2.protocol&&url1.host===url2.host}function $WindowProvider(){this.$get=valueFn(window)}function $$CookieReader($document){var rawDocument=$document[0]||{},lastCookies={},lastCookieString="";function safeDecodeURIComponent(str){try{return decodeURIComponent(str)}catch(e){return str}}return function(){var cookieArray,cookie,i,index,name,currentCookieString=function(rawDocument){try{return rawDocument.cookie||""}catch(e){return""}}(rawDocument);if(currentCookieString!==lastCookieString)for(cookieArray=(lastCookieString=currentCookieString).split("; "),lastCookies={},i=0;i<cookieArray.length;i++)(index=(cookie=cookieArray[i]).indexOf("="))>0&&(name=safeDecodeURIComponent(cookie.substring(0,index)),isUndefined(lastCookies[name])&&(lastCookies[name]=safeDecodeURIComponent(cookie.substring(index+1))));return lastCookies}}function $$CookieReaderProvider(){this.$get=$$CookieReader}function $FilterProvider($provide){var suffix="Filter";function register(name,factory){if(isObject(name)){var filters={};return forEach(name,function(filter,key){filters[key]=register(key,filter)}),filters}return $provide.factory(name+suffix,factory)}this.register=register,this.$get=["$injector",function($injector){return function(name){return $injector.get(name+suffix)}}],register("currency",currencyFilter),register("date",dateFilter),register("filter",filterFilter),register("json",jsonFilter),register("limitTo",limitToFilter),register("lowercase",lowercaseFilter),register("number",numberFilter),register("orderBy",orderByFilter),register("uppercase",uppercaseFilter)}function filterFilter(){return function(array,expression,comparator,anyPropertyKey){if(!isArrayLike(array)){if(null==array)return array;throw minErr("filter")("notarray","Expected array but received: {0}",array)}var predicateFn,matchAgainstAnyProp;switch(anyPropertyKey=anyPropertyKey||"$",getTypeForFilter(expression)){case"function":predicateFn=expression;break;case"boolean":case"null":case"number":case"string":matchAgainstAnyProp=!0;case"object":predicateFn=function(expression,comparator,anyPropertyKey,matchAgainstAnyProp){var shouldMatchPrimitives=isObject(expression)&&anyPropertyKey in expression;!0===comparator?comparator=equals:isFunction(comparator)||(comparator=function(actual,expected){return!isUndefined(actual)&&(null===actual||null===expected?actual===expected:!(isObject(expected)||isObject(actual)&&!hasCustomToString(actual))&&(actual=lowercase(""+actual),expected=lowercase(""+expected),-1!==actual.indexOf(expected)))});return function(item){return shouldMatchPrimitives&&!isObject(item)?deepCompare(item,expression[anyPropertyKey],comparator,anyPropertyKey,!1):deepCompare(item,expression,comparator,anyPropertyKey,matchAgainstAnyProp)}}(expression,comparator,anyPropertyKey,matchAgainstAnyProp);break;default:return array}return Array.prototype.filter.call(array,predicateFn)}}function deepCompare(actual,expected,comparator,anyPropertyKey,matchAgainstAnyProp,dontMatchWholeObject){var actualType=getTypeForFilter(actual),expectedType=getTypeForFilter(expected);if("string"===expectedType&&"!"===expected.charAt(0))return!deepCompare(actual,expected.substring(1),comparator,anyPropertyKey,matchAgainstAnyProp);if(isArray(actual))return actual.some(function(item){return deepCompare(item,expected,comparator,anyPropertyKey,matchAgainstAnyProp)});switch(actualType){case"object":var key;if(matchAgainstAnyProp){for(key in actual)if(key.charAt&&"$"!==key.charAt(0)&&deepCompare(actual[key],expected,comparator,anyPropertyKey,!0))return!0;return!dontMatchWholeObject&&deepCompare(actual,expected,comparator,anyPropertyKey,!1)}if("object"===expectedType){for(key in expected){var expectedVal=expected[key];if(!isFunction(expectedVal)&&!isUndefined(expectedVal)){var matchAnyProperty=key===anyPropertyKey;if(!deepCompare(matchAnyProperty?actual:actual[key],expectedVal,comparator,anyPropertyKey,matchAnyProperty,matchAnyProperty))return!1}}return!0}return comparator(actual,expected);case"function":return!1;default:return comparator(actual,expected)}}function getTypeForFilter(val){return null===val?"null":typeof val}$$CookieReader.$inject=["$document"],$FilterProvider.$inject=["$provide"];var MAX_DIGITS=22,DECIMAL_SEP=".",ZERO_CHAR="0";function currencyFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(amount,currencySymbol,fractionSize){isUndefined(currencySymbol)&&(currencySymbol=formats.CURRENCY_SYM),isUndefined(fractionSize)&&(fractionSize=formats.PATTERNS[1].maxFrac);var currencySymbolRe=currencySymbol?/\u00A4/g:/\s*\u00A4\s*/g;return null==amount?amount:formatNumber(amount,formats.PATTERNS[1],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize).replace(currencySymbolRe,currencySymbol)}}function numberFilter($locale){var formats=$locale.NUMBER_FORMATS;return function(number,fractionSize){return null==number?number:formatNumber(number,formats.PATTERNS[0],formats.GROUP_SEP,formats.DECIMAL_SEP,fractionSize)}}function formatNumber(number,pattern,groupSep,decimalSep,fractionSize){if(!isString(number)&&!isNumber(number)||isNaN(number))return"";var parsedNumber,isInfinity=!isFinite(number),isZero=!1,numStr=Math.abs(number)+"",formattedText="";if(isInfinity)formattedText="∞";else{(function(parsedNumber,fractionSize,minFrac,maxFrac){var digits=parsedNumber.d,fractionLen=digits.length-parsedNumber.i,roundAt=(fractionSize=isUndefined(fractionSize)?Math.min(Math.max(minFrac,fractionLen),maxFrac):+fractionSize)+parsedNumber.i,digit=digits[roundAt];if(roundAt>0){digits.splice(Math.max(parsedNumber.i,roundAt));for(var j=roundAt;j<digits.length;j++)digits[j]=0}else{fractionLen=Math.max(0,fractionLen),parsedNumber.i=1,digits.length=Math.max(1,roundAt=fractionSize+1),digits[0]=0;for(var i=1;i<roundAt;i++)digits[i]=0}if(digit>=5)if(roundAt-1<0){for(var k=0;k>roundAt;k--)digits.unshift(0),parsedNumber.i++;digits.unshift(1),parsedNumber.i++}else digits[roundAt-1]++;for(;fractionLen<Math.max(0,fractionSize);fractionLen++)digits.push(0);var carry=digits.reduceRight(function(carry,d,i,digits){return d+=carry,digits[i]=d%10,Math.floor(d/10)},0);carry&&(digits.unshift(carry),parsedNumber.i++)})(parsedNumber=function(numStr){var digits,numberOfIntegerDigits,i,j,zeros,exponent=0;for((numberOfIntegerDigits=numStr.indexOf(DECIMAL_SEP))>-1&&(numStr=numStr.replace(DECIMAL_SEP,"")),(i=numStr.search(/e/i))>0?(numberOfIntegerDigits<0&&(numberOfIntegerDigits=i),numberOfIntegerDigits+=+numStr.slice(i+1),numStr=numStr.substring(0,i)):numberOfIntegerDigits<0&&(numberOfIntegerDigits=numStr.length),i=0;numStr.charAt(i)===ZERO_CHAR;i++);if(i===(zeros=numStr.length))digits=[0],numberOfIntegerDigits=1;else{for(zeros--;numStr.charAt(zeros)===ZERO_CHAR;)zeros--;for(numberOfIntegerDigits-=i,digits=[],j=0;i<=zeros;i++,j++)digits[j]=+numStr.charAt(i)}return numberOfIntegerDigits>MAX_DIGITS&&(digits=digits.splice(0,MAX_DIGITS-1),exponent=numberOfIntegerDigits-1,numberOfIntegerDigits=1),{d:digits,e:exponent,i:numberOfIntegerDigits}}(numStr),fractionSize,pattern.minFrac,pattern.maxFrac);var digits=parsedNumber.d,integerLen=parsedNumber.i,exponent=parsedNumber.e,decimals=[];for(isZero=digits.reduce(function(isZero,d){return isZero&&!d},!0);integerLen<0;)digits.unshift(0),integerLen++;integerLen>0?decimals=digits.splice(integerLen,digits.length):(decimals=digits,digits=[0]);var groups=[];for(digits.length>=pattern.lgSize&&groups.unshift(digits.splice(-pattern.lgSize,digits.length).join(""));digits.length>pattern.gSize;)groups.unshift(digits.splice(-pattern.gSize,digits.length).join(""));digits.length&&groups.unshift(digits.join("")),formattedText=groups.join(groupSep),decimals.length&&(formattedText+=decimalSep+decimals.join("")),exponent&&(formattedText+="e+"+exponent)}return number<0&&!isZero?pattern.negPre+formattedText+pattern.negSuf:pattern.posPre+formattedText+pattern.posSuf}function padNumber(num,digits,trim,negWrap){var neg="";for((num<0||negWrap&&num<=0)&&(negWrap?num=1-num:(num=-num,neg="-")),num=""+num;num.length<digits;)num=ZERO_CHAR+num;return trim&&(num=num.substr(num.length-digits)),neg+num}function dateGetter(name,size,offset,trim,negWrap){return offset=offset||0,function(date){var value=date["get"+name]();return(offset>0||value>-offset)&&(value+=offset),0===value&&-12===offset&&(value=12),padNumber(value,size,trim,negWrap)}}function dateStrGetter(name,shortForm,standAlone){return function(date,formats){var value=date["get"+name]();return formats[uppercase((standAlone?"STANDALONE":"")+(shortForm?"SHORT":"")+name)][value]}}function getFirstThursdayOfYear(year){var dayOfWeekOnFirst=new Date(year,0,1).getDay();return new Date(year,0,(dayOfWeekOnFirst<=4?5:12)-dayOfWeekOnFirst)}function weekGetter(size){return function(date){var datetime,firstThurs=getFirstThursdayOfYear(date.getFullYear()),diff=+(datetime=date,new Date(datetime.getFullYear(),datetime.getMonth(),datetime.getDate()+(4-datetime.getDay())))-+firstThurs;return padNumber(1+Math.round(diff/6048e5),size)}}function eraGetter(date,formats){return date.getFullYear()<=0?formats.ERAS[0]:formats.ERAS[1]}currencyFilter.$inject=["$locale"],numberFilter.$inject=["$locale"];var DATE_FORMATS={yyyy:dateGetter("FullYear",4,0,!1,!0),yy:dateGetter("FullYear",2,0,!0,!0),y:dateGetter("FullYear",1,0,!1,!0),MMMM:dateStrGetter("Month"),MMM:dateStrGetter("Month",!0),MM:dateGetter("Month",2,1),M:dateGetter("Month",1,1),LLLL:dateStrGetter("Month",!1,!0),dd:dateGetter("Date",2),d:dateGetter("Date",1),HH:dateGetter("Hours",2),H:dateGetter("Hours",1),hh:dateGetter("Hours",2,-12),h:dateGetter("Hours",1,-12),mm:dateGetter("Minutes",2),m:dateGetter("Minutes",1),ss:dateGetter("Seconds",2),s:dateGetter("Seconds",1),sss:dateGetter("Milliseconds",3),EEEE:dateStrGetter("Day"),EEE:dateStrGetter("Day",!0),a:function(date,formats){return date.getHours()<12?formats.AMPMS[0]:formats.AMPMS[1]},Z:function(date,formats,offset){var zone=-1*offset,paddedZone=zone>=0?"+":"";return paddedZone+=padNumber(Math[zone>0?"floor":"ceil"](zone/60),2)+padNumber(Math.abs(zone%60),2)},ww:weekGetter(2),w:weekGetter(1),G:eraGetter,GG:eraGetter,GGG:eraGetter,GGGG:function(date,formats){return date.getFullYear()<=0?formats.ERANAMES[0]:formats.ERANAMES[1]}},DATE_FORMATS_SPLIT=/((?:[^yMLdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|L+|d+|H+|h+|m+|s+|a|Z|G+|w+))([\s\S]*)/,NUMBER_STRING=/^-?\d+$/;function dateFilter($locale){var R_ISO8601_STR=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(date,format,timezone){var fn,match,text="",parts=[];if(format=format||"mediumDate",format=$locale.DATETIME_FORMATS[format]||format,isString(date)&&(date=NUMBER_STRING.test(date)?toInt(date):function(string){var match;if(match=string.match(R_ISO8601_STR)){var date=new Date(0),tzHour=0,tzMin=0,dateSetter=match[8]?date.setUTCFullYear:date.setFullYear,timeSetter=match[8]?date.setUTCHours:date.setHours;match[9]&&(tzHour=toInt(match[9]+match[10]),tzMin=toInt(match[9]+match[11])),dateSetter.call(date,toInt(match[1]),toInt(match[2])-1,toInt(match[3]));var h=toInt(match[4]||0)-tzHour,m=toInt(match[5]||0)-tzMin,s=toInt(match[6]||0),ms=Math.round(1e3*parseFloat("0."+(match[7]||0)));return timeSetter.call(date,h,m,s,ms),date}return string}(date)),isNumber(date)&&(date=new Date(date)),!isDate(date)||!isFinite(date.getTime()))return date;for(;format;)(match=DATE_FORMATS_SPLIT.exec(format))?format=(parts=concat(parts,match,1)).pop():(parts.push(format),format=null);var dateTimezoneOffset=date.getTimezoneOffset();return timezone&&(dateTimezoneOffset=timezoneToOffset(timezone,dateTimezoneOffset),date=convertTimezoneToLocal(date,timezone,!0)),forEach(parts,function(value){fn=DATE_FORMATS[value],text+=fn?fn(date,$locale.DATETIME_FORMATS,dateTimezoneOffset):"''"===value?"'":value.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),text}}function jsonFilter(){return function(object,spacing){return isUndefined(spacing)&&(spacing=2),toJson(object,spacing)}}dateFilter.$inject=["$locale"];var lowercaseFilter=valueFn(lowercase),uppercaseFilter=valueFn(uppercase);function limitToFilter(){return function(input,limit,begin){return limit=Math.abs(Number(limit))===1/0?Number(limit):toInt(limit),isNumberNaN(limit)?input:(isNumber(input)&&(input=input.toString()),isArrayLike(input)?(begin=(begin=!begin||isNaN(begin)?0:toInt(begin))<0?Math.max(0,input.length+begin):begin,limit>=0?sliceFn(input,begin,begin+limit):0===begin?sliceFn(input,limit,input.length):sliceFn(input,Math.max(0,begin+limit),begin)):input)}}function sliceFn(input,begin,end){return isString(input)?input.slice(begin,end):slice.call(input,begin,end)}function orderByFilter($parse){return function(array,sortPredicate,reverseOrder,compareFn){if(null==array)return array;if(!isArrayLike(array))throw minErr("orderBy")("notarray","Expected array but received: {0}",array);isArray(sortPredicate)||(sortPredicate=[sortPredicate]),0===sortPredicate.length&&(sortPredicate=["+"]);var predicates=sortPredicate.map(function(predicate){var descending=1,get=identity;if(isFunction(predicate))get=predicate;else if(isString(predicate)&&("+"!==predicate.charAt(0)&&"-"!==predicate.charAt(0)||(descending="-"===predicate.charAt(0)?-1:1,predicate=predicate.substring(1)),""!==predicate&&(get=$parse(predicate)).constant)){var key=get();get=function(value){return value[key]}}return{get:get,descending:descending}}),descending=reverseOrder?-1:1,compare=isFunction(compareFn)?compareFn:defaultCompare,compareValues=Array.prototype.map.call(array,function(value,index){return{value:value,tieBreaker:{value:index,type:"number",index:index},predicateValues:predicates.map(function(predicate){return function(value,index){var type=typeof value;null===value?type="null":"object"===type&&(value=function(value){if(isFunction(value.valueOf)&&isPrimitive(value=value.valueOf()))return value;if(hasCustomToString(value)&&isPrimitive(value=value.toString()))return value;return value}(value));return{value:value,type:type,index:index}}(predicate.get(value),index)})}});return compareValues.sort(function(v1,v2){for(var i=0,ii=predicates.length;i<ii;i++){var result=compare(v1.predicateValues[i],v2.predicateValues[i]);if(result)return result*predicates[i].descending*descending}return(compare(v1.tieBreaker,v2.tieBreaker)||defaultCompare(v1.tieBreaker,v2.tieBreaker))*descending}),array=compareValues.map(function(item){return item.value})};function isPrimitive(value){switch(typeof value){case"number":case"boolean":case"string":return!0;default:return!1}}function defaultCompare(v1,v2){var result=0,type1=v1.type,type2=v2.type;if(type1===type2){var value1=v1.value,value2=v2.value;"string"===type1?(value1=value1.toLowerCase(),value2=value2.toLowerCase()):"object"===type1&&(isObject(value1)&&(value1=v1.index),isObject(value2)&&(value2=v2.index)),value1!==value2&&(result=value1<value2?-1:1)}else result="undefined"===type1?1:"undefined"===type2?-1:"null"===type1?1:"null"===type2?-1:type1<type2?-1:1;return result}}function ngDirective(directive){return isFunction(directive)&&(directive={link:directive}),directive.restrict=directive.restrict||"AC",valueFn(directive)}orderByFilter.$inject=["$parse"];var htmlAnchorDirective=valueFn({restrict:"E",compile:function(element,attr){if(!attr.href&&!attr.xlinkHref)return function(scope,element){if("a"===element[0].nodeName.toLowerCase()){var href="[object SVGAnimatedString]"===toString.call(element.prop("href"))?"xlink:href":"href";element.on("click",function(event){element.attr(href)||event.preventDefault()})}}}}),ngAttributeAliasDirectives={};forEach(BOOLEAN_ATTR,function(propName,attrName){if("multiple"!==propName){var normalized=directiveNormalize("ng-"+attrName),linkFn=defaultLinkFn;"checked"===propName&&(linkFn=function(scope,element,attr){attr.ngModel!==attr[normalized]&&defaultLinkFn(scope,0,attr)}),ngAttributeAliasDirectives[normalized]=function(){return{restrict:"A",priority:100,link:linkFn}}}function defaultLinkFn(scope,element,attr){scope.$watch(attr[normalized],function(value){attr.$set(attrName,!!value)})}}),forEach(ALIASED_ATTR,function(htmlAttr,ngAttr){ngAttributeAliasDirectives[ngAttr]=function(){return{priority:100,link:function(scope,element,attr){if("ngPattern"===ngAttr&&"/"===attr.ngPattern.charAt(0)){var match=attr.ngPattern.match(REGEX_STRING_REGEXP);if(match)return void attr.$set("ngPattern",new RegExp(match[1],match[2]))}scope.$watch(attr[ngAttr],function(value){attr.$set(ngAttr,value)})}}}}),forEach(["src","srcset","href"],function(attrName){var normalized=directiveNormalize("ng-"+attrName);ngAttributeAliasDirectives[normalized]=["$sce",function($sce){return{priority:99,link:function(scope,element,attr){var propName=attrName,name=attrName;"href"===attrName&&"[object SVGAnimatedString]"===toString.call(element.prop("href"))&&(name="xlinkHref",attr.$attr[name]="xlink:href",propName=null),attr.$set(normalized,$sce.getTrustedMediaUrl(attr[normalized])),attr.$observe(normalized,function(value){value?(attr.$set(name,value),msie&&propName&&element.prop(propName,attr[name])):"href"===attrName&&attr.$set(name,null)})}}}]});var nullFormCtrl={$addControl:noop,$getControls:valueFn([]),$$renameControl:function(control,name){control.$name=name},$removeControl:noop,$setValidity:noop,$setDirty:noop,$setPristine:noop,$setSubmitted:noop,$$setSubmitted:noop},PENDING_CLASS="ng-pending";function FormController($element,$attrs,$scope,$animate,$interpolate){this.$$controls=[],this.$error={},this.$$success={},this.$pending=void 0,this.$name=$interpolate($attrs.name||$attrs.ngForm||"")($scope),this.$dirty=!1,this.$pristine=!0,this.$valid=!0,this.$invalid=!1,this.$submitted=!1,this.$$parentForm=nullFormCtrl,this.$$element=$element,this.$$animate=$animate,setupValidity(this)}FormController.$inject=["$element","$attrs","$scope","$animate","$interpolate"],FormController.prototype={$rollbackViewValue:function(){forEach(this.$$controls,function(control){control.$rollbackViewValue()})},$commitViewValue:function(){forEach(this.$$controls,function(control){control.$commitViewValue()})},$addControl:function(control){assertNotHasOwnProperty(control.$name,"input"),this.$$controls.push(control),control.$name&&(this[control.$name]=control),control.$$parentForm=this},$getControls:function(){return shallowCopy(this.$$controls)},$$renameControl:function(control,newName){var oldName=control.$name;this[oldName]===control&&delete this[oldName],this[newName]=control,control.$name=newName},$removeControl:function(control){control.$name&&this[control.$name]===control&&delete this[control.$name],forEach(this.$pending,function(value,name){this.$setValidity(name,null,control)},this),forEach(this.$error,function(value,name){this.$setValidity(name,null,control)},this),forEach(this.$$success,function(value,name){this.$setValidity(name,null,control)},this),arrayRemove(this.$$controls,control),control.$$parentForm=nullFormCtrl},$setDirty:function(){this.$$animate.removeClass(this.$$element,PRISTINE_CLASS),this.$$animate.addClass(this.$$element,DIRTY_CLASS),this.$dirty=!0,this.$pristine=!1,this.$$parentForm.$setDirty()},$setPristine:function(){this.$$animate.setClass(this.$$element,PRISTINE_CLASS,DIRTY_CLASS+" ng-submitted"),this.$dirty=!1,this.$pristine=!0,this.$submitted=!1,forEach(this.$$controls,function(control){control.$setPristine()})},$setUntouched:function(){forEach(this.$$controls,function(control){control.$setUntouched()})},$setSubmitted:function(){for(var rootForm=this;rootForm.$$parentForm&&rootForm.$$parentForm!==nullFormCtrl;)rootForm=rootForm.$$parentForm;rootForm.$$setSubmitted()},$$setSubmitted:function(){this.$$animate.addClass(this.$$element,"ng-submitted"),this.$submitted=!0,forEach(this.$$controls,function(control){control.$$setSubmitted&&control.$$setSubmitted()})}},addSetValidityMethod({clazz:FormController,set:function(object,property,controller){var list=object[property];list?-1===list.indexOf(controller)&&list.push(controller):object[property]=[controller]},unset:function(object,property,controller){var list=object[property];list&&(arrayRemove(list,controller),0===list.length&&delete object[property])}});var formDirectiveFactory=function(isNgForm){return["$timeout","$parse",function($timeout,$parse){return{name:"form",restrict:isNgForm?"EAC":"E",require:["form","^^?form"],controller:FormController,compile:function(formElement,attr){formElement.addClass(PRISTINE_CLASS).addClass(VALID_CLASS);var nameAttr=attr.name?"name":!(!isNgForm||!attr.ngForm)&&"ngForm";return{pre:function(scope,formElement,attr,ctrls){var controller=ctrls[0];if(!("action"in attr)){var handleFormSubmission=function(event){scope.$apply(function(){controller.$commitViewValue(),controller.$setSubmitted()}),event.preventDefault()};formElement[0].addEventListener("submit",handleFormSubmission),formElement.on("$destroy",function(){$timeout(function(){formElement[0].removeEventListener("submit",handleFormSubmission)},0,!1)})}(ctrls[1]||controller.$$parentForm).$addControl(controller);var setter=nameAttr?getSetter(controller.$name):noop;nameAttr&&(setter(scope,controller),attr.$observe(nameAttr,function(newValue){controller.$name!==newValue&&(setter(scope,void 0),controller.$$parentForm.$$renameControl(controller,newValue),(setter=getSetter(controller.$name))(scope,controller))})),formElement.on("$destroy",function(){controller.$$parentForm.$removeControl(controller),setter(scope,void 0),extend(controller,nullFormCtrl)})}}}};function getSetter(expression){return""===expression?$parse('this[""]').assign:$parse(expression).assign||noop}}]},formDirective=formDirectiveFactory(),ngFormDirective=formDirectiveFactory(!0);function setupValidity(instance){instance.$$classCache={},instance.$$classCache[INVALID_CLASS]=!(instance.$$classCache[VALID_CLASS]=instance.$$element.hasClass(VALID_CLASS))}function addSetValidityMethod(context){var clazz=context.clazz,set=context.set,unset=context.unset;function cachedToggleClass(ctrl,className,switchValue){switchValue&&!ctrl.$$classCache[className]?(ctrl.$$animate.addClass(ctrl.$$element,className),ctrl.$$classCache[className]=!0):!switchValue&&ctrl.$$classCache[className]&&(ctrl.$$animate.removeClass(ctrl.$$element,className),ctrl.$$classCache[className]=!1)}function toggleValidationCss(ctrl,validationErrorKey,isValid){validationErrorKey=validationErrorKey?"-"+snake_case(validationErrorKey,"-"):"",cachedToggleClass(ctrl,VALID_CLASS+validationErrorKey,!0===isValid),cachedToggleClass(ctrl,INVALID_CLASS+validationErrorKey,!1===isValid)}clazz.prototype.$setValidity=function(validationErrorKey,state,controller){var combinedState;isUndefined(state)?function(ctrl,name,value,controller){ctrl[name]||(ctrl[name]={});set(ctrl[name],value,controller)}(this,"$pending",validationErrorKey,controller):function(ctrl,name,value,controller){ctrl[name]&&unset(ctrl[name],value,controller);isObjectEmpty(ctrl[name])&&(ctrl[name]=void 0)}(this,"$pending",validationErrorKey,controller),isBoolean(state)?state?(unset(this.$error,validationErrorKey,controller),set(this.$$success,validationErrorKey,controller)):(set(this.$error,validationErrorKey,controller),unset(this.$$success,validationErrorKey,controller)):(unset(this.$error,validationErrorKey,controller),unset(this.$$success,validationErrorKey,controller)),this.$pending?(cachedToggleClass(this,PENDING_CLASS,!0),this.$valid=this.$invalid=void 0,toggleValidationCss(this,"",null)):(cachedToggleClass(this,PENDING_CLASS,!1),this.$valid=isObjectEmpty(this.$error),this.$invalid=!this.$valid,toggleValidationCss(this,"",this.$valid)),toggleValidationCss(this,validationErrorKey,combinedState=this.$pending&&this.$pending[validationErrorKey]?void 0:!this.$error[validationErrorKey]&&(!!this.$$success[validationErrorKey]||null)),this.$$parentForm.$setValidity(validationErrorKey,combinedState,this)}}function isObjectEmpty(obj){if(obj)for(var prop in obj)if(obj.hasOwnProperty(prop))return!1;return!0}var ISO_DATE_REGEXP=/^\d{4,}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+(?:[+-][0-2]\d:[0-5]\d|Z)$/,URL_REGEXP=/^[a-z][a-z\d.+-]*:\/*(?:[^:@]+(?::[^@]+)?@)?(?:[^\s:/?#]+|\[[a-f\d:]+])(?::\d+)?(?:\/[^?#]*)?(?:\?[^#]*)?(?:#.*)?$/i,EMAIL_REGEXP=/^(?=.{1,254}$)(?=.{1,64}@)[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+(\.[-!#$%&'*+/0-9=?A-Z^_`a-z{|}~]+)*@[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?(\.[A-Za-z0-9]([A-Za-z0-9-]{0,61}[A-Za-z0-9])?)*$/,NUMBER_REGEXP=/^\s*(-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,DATE_REGEXP=/^(\d{4,})-(\d{2})-(\d{2})$/,DATETIMELOCAL_REGEXP=/^(\d{4,})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,WEEK_REGEXP=/^(\d{4,})-W(\d\d)$/,MONTH_REGEXP=/^(\d{4,})-(\d\d)$/,TIME_REGEXP=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,PARTIAL_VALIDATION_EVENTS="keydown wheel mousedown",PARTIAL_VALIDATION_TYPES=createMap();forEach("date,datetime-local,month,time,week".split(","),function(type){PARTIAL_VALIDATION_TYPES[type]=!0});var inputType={text:function(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl)},date:createDateInputType("date",DATE_REGEXP,createDateParser(DATE_REGEXP,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":createDateInputType("datetimelocal",DATETIMELOCAL_REGEXP,createDateParser(DATETIMELOCAL_REGEXP,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:createDateInputType("time",TIME_REGEXP,createDateParser(TIME_REGEXP,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:createDateInputType("week",WEEK_REGEXP,function(isoWeek,existingDate){if(isDate(isoWeek))return isoWeek;if(isString(isoWeek)){WEEK_REGEXP.lastIndex=0;var parts=WEEK_REGEXP.exec(isoWeek);if(parts){var year=+parts[1],week=+parts[2],hours=0,minutes=0,seconds=0,milliseconds=0,firstThurs=getFirstThursdayOfYear(year),addDays=7*(week-1);return existingDate&&(hours=existingDate.getHours(),minutes=existingDate.getMinutes(),seconds=existingDate.getSeconds(),milliseconds=existingDate.getMilliseconds()),new Date(year,0,firstThurs.getDate()+addDays,hours,minutes,seconds,milliseconds)}}return NaN},"yyyy-Www"),month:createDateInputType("month",MONTH_REGEXP,createDateParser(MONTH_REGEXP,["yyyy","MM"]),"yyyy-MM"),number:function(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var parsedMinVal;if(badInputChecker(scope,element,attr,ctrl,"number"),numberFormatterParser(ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser),isDefined(attr.min)||attr.ngMin){var minVal=attr.min||$parse(attr.ngMin)(scope);parsedMinVal=parseNumberAttrVal(minVal),ctrl.$validators.min=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(parsedMinVal)||viewValue>=parsedMinVal},attr.$observe("min",function(val){val!==minVal&&(parsedMinVal=parseNumberAttrVal(val),minVal=val,ctrl.$validate())})}if(isDefined(attr.max)||attr.ngMax){var maxVal=attr.max||$parse(attr.ngMax)(scope),parsedMaxVal=parseNumberAttrVal(maxVal);ctrl.$validators.max=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(parsedMaxVal)||viewValue<=parsedMaxVal},attr.$observe("max",function(val){val!==maxVal&&(parsedMaxVal=parseNumberAttrVal(val),maxVal=val,ctrl.$validate())})}if(isDefined(attr.step)||attr.ngStep){var stepVal=attr.step||$parse(attr.ngStep)(scope),parsedStepVal=parseNumberAttrVal(stepVal);ctrl.$validators.step=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(parsedStepVal)||isValidForStep(viewValue,parsedMinVal||0,parsedStepVal)},attr.$observe("step",function(val){val!==stepVal&&(parsedStepVal=parseNumberAttrVal(val),stepVal=val,ctrl.$validate())})}},url:function(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$validators.url=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||URL_REGEXP.test(value)}},email:function(scope,element,attr,ctrl,$sniffer,$browser){baseInputType(scope,element,attr,ctrl,$sniffer,$browser),stringBasedInputType(ctrl),ctrl.$validators.email=function(modelValue,viewValue){var value=modelValue||viewValue;return ctrl.$isEmpty(value)||EMAIL_REGEXP.test(value)}},radio:function(scope,element,attr,ctrl){var doTrim=!attr.ngTrim||"false"!==trim(attr.ngTrim);isUndefined(attr.name)&&element.attr("name",nextUid());element.on("change",function(ev){var value;element[0].checked&&(value=attr.value,doTrim&&(value=trim(value)),ctrl.$setViewValue(value,ev&&ev.type))}),ctrl.$render=function(){var value=attr.value;doTrim&&(value=trim(value)),element[0].checked=value===ctrl.$viewValue},attr.$observe("value",ctrl.$render)},range:function(scope,element,attr,ctrl,$sniffer,$browser){badInputChecker(scope,element,attr,ctrl,"range"),numberFormatterParser(ctrl),baseInputType(scope,element,attr,ctrl,$sniffer,$browser);var supportsRange=ctrl.$$hasNativeValidators&&"range"===element[0].type,minVal=supportsRange?0:void 0,maxVal=supportsRange?100:void 0,stepVal=supportsRange?1:void 0,validity=element[0].validity,hasMinAttr=isDefined(attr.min),hasMaxAttr=isDefined(attr.max),hasStepAttr=isDefined(attr.step),originalRender=ctrl.$render;ctrl.$render=supportsRange&&isDefined(validity.rangeUnderflow)&&isDefined(validity.rangeOverflow)?function(){originalRender(),ctrl.$setViewValue(element.val())}:originalRender,hasMinAttr&&(minVal=parseNumberAttrVal(attr.min),ctrl.$validators.min=supportsRange?function(){return!0}:function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(minVal)||viewValue>=minVal},setInitialValueAndObserver("min",function(val){if(minVal=parseNumberAttrVal(val),isNumberNaN(ctrl.$modelValue))return;if(supportsRange){var elVal=element.val();minVal>elVal&&(elVal=minVal,element.val(elVal)),ctrl.$setViewValue(elVal)}else ctrl.$validate()}));hasMaxAttr&&(maxVal=parseNumberAttrVal(attr.max),ctrl.$validators.max=supportsRange?function(){return!0}:function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(maxVal)||viewValue<=maxVal},setInitialValueAndObserver("max",function(val){if(maxVal=parseNumberAttrVal(val),isNumberNaN(ctrl.$modelValue))return;if(supportsRange){var elVal=element.val();maxVal<elVal&&(element.val(maxVal),elVal=maxVal<minVal?minVal:maxVal),ctrl.$setViewValue(elVal)}else ctrl.$validate()}));hasStepAttr&&(stepVal=parseNumberAttrVal(attr.step),ctrl.$validators.step=supportsRange?function(){return!validity.stepMismatch}:function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(stepVal)||isValidForStep(viewValue,minVal||0,stepVal)},setInitialValueAndObserver("step",function(val){if(stepVal=parseNumberAttrVal(val),isNumberNaN(ctrl.$modelValue))return;supportsRange?ctrl.$viewValue!==element.val()&&ctrl.$setViewValue(element.val()):ctrl.$validate()}));function setInitialValueAndObserver(htmlAttrName,changeFn){element.attr(htmlAttrName,attr[htmlAttrName]);var oldVal=attr[htmlAttrName];attr.$observe(htmlAttrName,function(val){val!==oldVal&&(oldVal=val,changeFn(val))})}},checkbox:function(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){var trueValue=parseConstantExpr($parse,scope,"ngTrueValue",attr.ngTrueValue,!0),falseValue=parseConstantExpr($parse,scope,"ngFalseValue",attr.ngFalseValue,!1);element.on("change",function(ev){ctrl.$setViewValue(element[0].checked,ev&&ev.type)}),ctrl.$render=function(){element[0].checked=ctrl.$viewValue},ctrl.$isEmpty=function(value){return!1===value},ctrl.$formatters.push(function(value){return equals(value,trueValue)}),ctrl.$parsers.push(function(value){return value?trueValue:falseValue})},hidden:noop,button:noop,submit:noop,reset:noop,file:noop};function stringBasedInputType(ctrl){ctrl.$formatters.push(function(value){return ctrl.$isEmpty(value)?value:value.toString()})}function baseInputType(scope,element,attr,ctrl,$sniffer,$browser){var timeout,type=lowercase(element[0].type);if(!$sniffer.android){var composing=!1;element.on("compositionstart",function(){composing=!0}),element.on("compositionupdate",function(ev){(isUndefined(ev.data)||""===ev.data)&&(composing=!1)}),element.on("compositionend",function(){composing=!1,listener()})}var listener=function(ev){if(timeout&&($browser.defer.cancel(timeout),timeout=null),!composing){var value=element.val(),event=ev&&ev.type;"password"===type||attr.ngTrim&&"false"===attr.ngTrim||(value=trim(value)),(ctrl.$viewValue!==value||""===value&&ctrl.$$hasNativeValidators)&&ctrl.$setViewValue(value,event)}};if($sniffer.hasEvent("input"))element.on("input",listener);else{var deferListener=function(ev,input,origValue){timeout||(timeout=$browser.defer(function(){timeout=null,input&&input.value===origValue||listener(ev)}))};element.on("keydown",function(event){var key=event.keyCode;91===key||15<key&&key<19||37<=key&&key<=40||deferListener(event,this,this.value)}),$sniffer.hasEvent("paste")&&element.on("paste cut drop",deferListener)}element.on("change",listener),PARTIAL_VALIDATION_TYPES[type]&&ctrl.$$hasNativeValidators&&type===attr.type&&element.on(PARTIAL_VALIDATION_EVENTS,function(ev){if(!timeout){var validity=this[VALIDITY_STATE_PROPERTY],origBadInput=validity.badInput,origTypeMismatch=validity.typeMismatch;timeout=$browser.defer(function(){timeout=null,validity.badInput===origBadInput&&validity.typeMismatch===origTypeMismatch||listener(ev)})}}),ctrl.$render=function(){var value=ctrl.$isEmpty(ctrl.$viewValue)?"":ctrl.$viewValue;element.val()!==value&&element.val(value)}}function createDateParser(regexp,mapping){return function(iso,previousDate){var parts,map;if(isDate(iso))return iso;if(isString(iso)){if('"'===iso.charAt(0)&&'"'===iso.charAt(iso.length-1)&&(iso=iso.substring(1,iso.length-1)),ISO_DATE_REGEXP.test(iso))return new Date(iso);if(regexp.lastIndex=0,parts=regexp.exec(iso)){parts.shift(),map=previousDate?{yyyy:previousDate.getFullYear(),MM:previousDate.getMonth()+1,dd:previousDate.getDate(),HH:previousDate.getHours(),mm:previousDate.getMinutes(),ss:previousDate.getSeconds(),sss:previousDate.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},forEach(parts,function(part,index){index<mapping.length&&(map[mapping[index]]=+part)});var date=new Date(map.yyyy,map.MM-1,map.dd,map.HH,map.mm,map.ss||0,1e3*map.sss||0);return map.yyyy<100&&date.setFullYear(map.yyyy),date}}return NaN}}function createDateInputType(type,regexp,parseDate,format){return function(scope,element,attr,ctrl,$sniffer,$browser,$filter,$parse){badInputChecker(scope,element,attr,ctrl,type),baseInputType(0,element,attr,ctrl,$sniffer,$browser);var previousDate,previousTimezone,isTimeType="time"===type||"datetimelocal"===type;if(ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:regexp.test(value)?parseDateAndConvertTimeZoneToLocal(value,previousDate):void(ctrl.$$parserName=type)}),ctrl.$formatters.push(function(value){if(value&&!isDate(value))throw ngModelMinErr("datefmt","Expected `{0}` to be a date",value);if(isValidDate(value)){previousDate=value;var timezone=ctrl.$options.getOption("timezone");return timezone&&(previousTimezone=timezone,previousDate=convertTimezoneToLocal(previousDate,timezone,!0)),function(value,timezone){var targetFormat=format;isTimeType&&isString(ctrl.$options.getOption("timeSecondsFormat"))&&(targetFormat=format.replace("ss.sss",ctrl.$options.getOption("timeSecondsFormat")).replace(/:$/,""));var formatted=$filter("date")(value,targetFormat,timezone);isTimeType&&ctrl.$options.getOption("timeStripZeroSeconds")&&(formatted=formatted.replace(/(?::00)?(?:\.000)?$/,""));return formatted}(value,timezone)}return previousDate=null,previousTimezone=null,""}),isDefined(attr.min)||attr.ngMin){var minVal=attr.min||$parse(attr.ngMin)(scope),parsedMinVal=parseObservedDateValue(minVal);ctrl.$validators.min=function(value){return!isValidDate(value)||isUndefined(parsedMinVal)||parseDate(value)>=parsedMinVal},attr.$observe("min",function(val){val!==minVal&&(parsedMinVal=parseObservedDateValue(val),minVal=val,ctrl.$validate())})}if(isDefined(attr.max)||attr.ngMax){var maxVal=attr.max||$parse(attr.ngMax)(scope),parsedMaxVal=parseObservedDateValue(maxVal);ctrl.$validators.max=function(value){return!isValidDate(value)||isUndefined(parsedMaxVal)||parseDate(value)<=parsedMaxVal},attr.$observe("max",function(val){val!==maxVal&&(parsedMaxVal=parseObservedDateValue(val),maxVal=val,ctrl.$validate())})}function isValidDate(value){return value&&!(value.getTime&&value.getTime()!=value.getTime())}function parseObservedDateValue(val){return isDefined(val)&&!isDate(val)?parseDateAndConvertTimeZoneToLocal(val)||void 0:val}function parseDateAndConvertTimeZoneToLocal(value,previousDate){var timezone=ctrl.$options.getOption("timezone");previousTimezone&&previousTimezone!==timezone&&(previousDate=addDateMinutes(previousDate,timezoneToOffset(previousTimezone)));var parsedDate=parseDate(value,previousDate);return!isNaN(parsedDate)&&timezone&&(parsedDate=convertTimezoneToLocal(parsedDate,timezone)),parsedDate}}}function badInputChecker(scope,element,attr,ctrl,parserName){var node=element[0];(ctrl.$$hasNativeValidators=isObject(node.validity))&&ctrl.$parsers.push(function(value){var validity=element.prop(VALIDITY_STATE_PROPERTY)||{};if(!validity.badInput&&!validity.typeMismatch)return value;ctrl.$$parserName=parserName})}function numberFormatterParser(ctrl){ctrl.$parsers.push(function(value){return ctrl.$isEmpty(value)?null:NUMBER_REGEXP.test(value)?parseFloat(value):void(ctrl.$$parserName="number")}),ctrl.$formatters.push(function(value){if(!ctrl.$isEmpty(value)){if(!isNumber(value))throw ngModelMinErr("numfmt","Expected `{0}` to be a number",value);value=value.toString()}return value})}function parseNumberAttrVal(val){return isDefined(val)&&!isNumber(val)&&(val=parseFloat(val)),isNumberNaN(val)?void 0:val}function isNumberInteger(num){return(0|num)===num}function countDecimals(num){var numString=num.toString(),decimalSymbolIndex=numString.indexOf(".");if(-1===decimalSymbolIndex){if(-1<num&&num<1){var match=/e-(\d+)$/.exec(numString);if(match)return Number(match[1])}return 0}return numString.length-decimalSymbolIndex-1}function isValidForStep(viewValue,stepBase,step){var value=Number(viewValue),isNonIntegerValue=!isNumberInteger(value),isNonIntegerStepBase=!isNumberInteger(stepBase),isNonIntegerStep=!isNumberInteger(step);if(isNonIntegerValue||isNonIntegerStepBase||isNonIntegerStep){var valueDecimals=isNonIntegerValue?countDecimals(value):0,stepBaseDecimals=isNonIntegerStepBase?countDecimals(stepBase):0,stepDecimals=isNonIntegerStep?countDecimals(step):0,decimalCount=Math.max(valueDecimals,stepBaseDecimals,stepDecimals),multiplier=Math.pow(10,decimalCount);value*=multiplier,stepBase*=multiplier,step*=multiplier,isNonIntegerValue&&(value=Math.round(value)),isNonIntegerStepBase&&(stepBase=Math.round(stepBase)),isNonIntegerStep&&(step=Math.round(step))}return(value-stepBase)%step==0}function parseConstantExpr($parse,context,name,expression,fallback){var parseFn;if(isDefined(expression)){if(!(parseFn=$parse(expression)).constant)throw ngModelMinErr("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",name,expression);return parseFn(context)}return fallback}var inputDirective=["$browser","$sniffer","$filter","$parse",function($browser,$sniffer,$filter,$parse){return{restrict:"E",require:["?ngModel"],link:{pre:function(scope,element,attr,ctrls){ctrls[0]&&(inputType[lowercase(attr.type)]||inputType.text)(scope,element,attr,ctrls[0],$sniffer,$browser,$filter,$parse)}}}}],hiddenInputBrowserCacheDirective=function(){var valueProperty={configurable:!0,enumerable:!1,get:function(){return this.getAttribute("value")||""},set:function(val){this.setAttribute("value",val)}};return{restrict:"E",priority:200,compile:function(_,attr){if("hidden"===lowercase(attr.type))return{pre:function(scope,element,attr,ctrls){var node=element[0];node.parentNode&&node.parentNode.insertBefore(node,node.nextSibling),Object.defineProperty&&Object.defineProperty(node,"value",valueProperty)}}}}},CONSTANT_VALUE_REGEXP=/^(true|false|\d+)$/,ngValueDirective=function(){function updateElementValue(element,attr,value){var propValue=isDefined(value)?value:9===msie?"":null;element.prop("value",propValue),attr.$set("value",value)}return{restrict:"A",priority:100,compile:function(tpl,tplAttr){return CONSTANT_VALUE_REGEXP.test(tplAttr.ngValue)?function(scope,elm,attr){updateElementValue(elm,attr,scope.$eval(attr.ngValue))}:function(scope,elm,attr){scope.$watch(attr.ngValue,function(value){updateElementValue(elm,attr,value)})}}}},ngBindDirective=["$compile",function($compile){return{restrict:"AC",compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBind),element=element[0],scope.$watch(attr.ngBind,function(value){element.textContent=stringify(value)})}}}}],ngBindTemplateDirective=["$interpolate","$compile",function($interpolate,$compile){return{compile:function(templateElement){return $compile.$$addBindingClass(templateElement),function(scope,element,attr){var interpolateFn=$interpolate(element.attr(attr.$attr.ngBindTemplate));$compile.$$addBindingInfo(element,interpolateFn.expressions),element=element[0],attr.$observe("ngBindTemplate",function(value){element.textContent=isUndefined(value)?"":value})}}}}],ngBindHtmlDirective=["$sce","$parse","$compile",function($sce,$parse,$compile){return{restrict:"A",compile:function(tElement,tAttrs){var ngBindHtmlGetter=$parse(tAttrs.ngBindHtml),ngBindHtmlWatch=$parse(tAttrs.ngBindHtml,function(val){return $sce.valueOf(val)});return $compile.$$addBindingClass(tElement),function(scope,element,attr){$compile.$$addBindingInfo(element,attr.ngBindHtml),scope.$watch(ngBindHtmlWatch,function(){var value=ngBindHtmlGetter(scope);element.html($sce.getTrustedHtml(value)||"")})}}}}],ngChangeDirective=valueFn({restrict:"A",require:"ngModel",link:function(scope,element,attr,ctrl){ctrl.$viewChangeListeners.push(function(){scope.$eval(attr.ngChange)})}});function classDirective(name,selector){var indexWatchExpression;return name="ngClass"+name,["$parse",function($parse){return{restrict:"AC",link:function(scope,element,attr){var oldClassString,classCounts=element.data("$classCounts"),oldModulo=!0;function digestClassCounts(classArray,count){var classesToUpdate=[];return forEach(classArray,function(className){(count>0||classCounts[className])&&(classCounts[className]=(classCounts[className]||0)+count,classCounts[className]===+(count>0)&&classesToUpdate.push(className))}),classesToUpdate.join(" ")}classCounts||(classCounts=createMap(),element.data("$classCounts",classCounts)),"ngClass"!==name&&(indexWatchExpression||(indexWatchExpression=$parse("$index",function($index){return 1&$index})),scope.$watch(indexWatchExpression,function(newModulo){newModulo===selector?(classString=digestClassCounts(split(classString=oldClassString),1),attr.$addClass(classString)):function(classString){classString=digestClassCounts(split(classString),-1),attr.$removeClass(classString)}(oldClassString);var classString;oldModulo=newModulo})),scope.$watch($parse(attr[name],toClassString),function(newClassString){oldModulo===selector&&function(oldClassString,newClassString){var oldClassArray=split(oldClassString),newClassArray=split(newClassString),toRemoveArray=arrayDifference(oldClassArray,newClassArray),toAddArray=arrayDifference(newClassArray,oldClassArray),toRemoveString=digestClassCounts(toRemoveArray,-1),toAddString=digestClassCounts(toAddArray,1);attr.$addClass(toAddString),attr.$removeClass(toRemoveString)}(oldClassString,newClassString);oldClassString=newClassString})}}}];function arrayDifference(tokens1,tokens2){if(!tokens1||!tokens1.length)return[];if(!tokens2||!tokens2.length)return tokens1;var values=[];outer:for(var i=0;i<tokens1.length;i++){for(var token=tokens1[i],j=0;j<tokens2.length;j++)if(token===tokens2[j])continue outer;values.push(token)}return values}function split(classString){return classString&&classString.split(" ")}function toClassString(classValue){if(!classValue)return classValue;var classString=classValue;return isArray(classValue)?classString=classValue.map(toClassString).join(" "):isObject(classValue)?classString=Object.keys(classValue).filter(function(key){return classValue[key]}).join(" "):isString(classValue)||(classString=classValue+""),classString}}var ngClassDirective=classDirective("",!0),ngClassOddDirective=classDirective("Odd",0),ngClassEvenDirective=classDirective("Even",1),ngCloakDirective=ngDirective({compile:function(element,attr){attr.$set("ngCloak",void 0),element.removeClass("ng-cloak")}}),ngControllerDirective=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ngEventDirectives={},forceAsyncEvents={blur:!0,focus:!0};function createEventDirective($parse,$rootScope,$exceptionHandler,directiveName,eventName,forceAsync){return{restrict:"A",compile:function($element,attr){var fn=$parse(attr[directiveName]);return function(scope,element){element.on(eventName,function(event){var callback=function(){fn(scope,{$event:event})};if($rootScope.$$phase)if(forceAsync)scope.$evalAsync(callback);else try{callback()}catch(error){$exceptionHandler(error)}else scope.$apply(callback)})}}}}forEach("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(eventName){var directiveName=directiveNormalize("ng-"+eventName);ngEventDirectives[directiveName]=["$parse","$rootScope","$exceptionHandler",function($parse,$rootScope,$exceptionHandler){return createEventDirective($parse,$rootScope,$exceptionHandler,directiveName,eventName,forceAsyncEvents[eventName])}]});var ngIfDirective=["$animate","$compile",function($animate,$compile){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function($scope,$element,$attr,ctrl,$transclude){var block,childScope,previousElements;$scope.$watch($attr.ngIf,function(value){value?childScope||$transclude(function(clone,newScope){childScope=newScope,clone[clone.length++]=$compile.$$createComment("end ngIf",$attr.ngIf),block={clone:clone},$animate.enter(clone,$element.parent(),$element)}):(previousElements&&(previousElements.remove(),previousElements=null),childScope&&(childScope.$destroy(),childScope=null),block&&(previousElements=getBlockNodes(block.clone),$animate.leave(previousElements).done(function(response){!1!==response&&(previousElements=null)}),block=null))})}}}],ngIncludeDirective=["$templateRequest","$anchorScroll","$animate",function($templateRequest,$anchorScroll,$animate){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:angular.noop,compile:function(element,attr){var srcExp=attr.ngInclude||attr.src,onloadExp=attr.onload||"",autoScrollExp=attr.autoscroll;return function(scope,$element,$attr,ctrl,$transclude){var currentScope,previousElement,currentElement,changeCounter=0,cleanupLastIncludeContent=function(){previousElement&&(previousElement.remove(),previousElement=null),currentScope&&(currentScope.$destroy(),currentScope=null),currentElement&&($animate.leave(currentElement).done(function(response){!1!==response&&(previousElement=null)}),previousElement=currentElement,currentElement=null)};scope.$watch(srcExp,function(src){var afterAnimation=function(response){!1===response||!isDefined(autoScrollExp)||autoScrollExp&&!scope.$eval(autoScrollExp)||$anchorScroll()},thisChangeId=++changeCounter;src?($templateRequest(src,!0).then(function(response){if(!scope.$$destroyed&&thisChangeId===changeCounter){var newScope=scope.$new();ctrl.template=response;var clone=$transclude(newScope,function(clone){cleanupLastIncludeContent(),$animate.enter(clone,null,$element).done(afterAnimation)});currentElement=clone,(currentScope=newScope).$emit("$includeContentLoaded",src),scope.$eval(onloadExp)}},function(){scope.$$destroyed||thisChangeId===changeCounter&&(cleanupLastIncludeContent(),scope.$emit("$includeContentError",src))}),scope.$emit("$includeContentRequested",src)):(cleanupLastIncludeContent(),ctrl.template=null)})}}}}],ngIncludeFillContentDirective=["$compile",function($compile){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(scope,$element,$attr,ctrl){if(toString.call($element[0]).match(/SVG/))return $element.empty(),void $compile(jqLiteBuildFragment(ctrl.template,window.document).childNodes)(scope,function(clone){$element.append(clone)},{futureParentElement:$element});$element.html(ctrl.template),$compile($element.contents())(scope)}}}],ngInitDirective=ngDirective({priority:450,compile:function(){return{pre:function(scope,element,attrs){scope.$eval(attrs.ngInit)}}}}),ngListDirective=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(scope,element,attr,ctrl){var ngList=attr.ngList||", ",trimValues="false"!==attr.ngTrim,separator=trimValues?trim(ngList):ngList;ctrl.$parsers.push(function(viewValue){if(!isUndefined(viewValue)){var list=[];return viewValue&&forEach(viewValue.split(separator),function(value){value&&list.push(trimValues?trim(value):value)}),list}}),ctrl.$formatters.push(function(value){if(isArray(value))return value.join(ngList)}),ctrl.$isEmpty=function(value){return!value||!value.length}}}},VALID_CLASS="ng-valid",INVALID_CLASS="ng-invalid",PRISTINE_CLASS="ng-pristine",DIRTY_CLASS="ng-dirty",ngModelMinErr=minErr("ngModel");function NgModelController($scope,$exceptionHandler,$attr,$element,$parse,$animate,$timeout,$q,$interpolate){var ctrl;this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=void 0,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=void 0,this.$name=$interpolate($attr.name||"",!1)($scope),this.$$parentForm=nullFormCtrl,this.$options=defaultModelOptions,this.$$updateEvents="",this.$$updateEventHandler=this.$$updateEventHandler.bind(this),this.$$parsedNgModel=$parse($attr.ngModel),this.$$parsedNgModelAssign=this.$$parsedNgModel.assign,this.$$ngModelGet=this.$$parsedNgModel,this.$$ngModelSet=this.$$parsedNgModelAssign,this.$$pendingDebounce=null,this.$$parserValid=void 0,this.$$parserName="parse",this.$$currentValidationRunId=0,this.$$scope=$scope,this.$$rootScope=$scope.$root,this.$$attr=$attr,this.$$element=$element,this.$$animate=$animate,this.$$timeout=$timeout,this.$$parse=$parse,this.$$q=$q,this.$$exceptionHandler=$exceptionHandler,setupValidity(this),(ctrl=this).$$scope.$watch(function(scope){var modelValue=ctrl.$$ngModelGet(scope);return modelValue===ctrl.$modelValue||ctrl.$modelValue!=ctrl.$modelValue&&modelValue!=modelValue||ctrl.$$setModelValue(modelValue),modelValue})}NgModelController.$inject=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$q","$interpolate"],NgModelController.prototype={$$initGetterSetters:function(){if(this.$options.getOption("getterSetter")){var invokeModelGetter=this.$$parse(this.$$attr.ngModel+"()"),invokeModelSetter=this.$$parse(this.$$attr.ngModel+"($$$p)");this.$$ngModelGet=function($scope){var modelValue=this.$$parsedNgModel($scope);return isFunction(modelValue)&&(modelValue=invokeModelGetter($scope)),modelValue},this.$$ngModelSet=function($scope,newValue){isFunction(this.$$parsedNgModel($scope))?invokeModelSetter($scope,{$$$p:newValue}):this.$$parsedNgModelAssign($scope,newValue)}}else if(!this.$$parsedNgModel.assign)throw ngModelMinErr("nonassign","Expression '{0}' is non-assignable. Element: {1}",this.$$attr.ngModel,startingTag(this.$$element))},$render:noop,$isEmpty:function(value){return isUndefined(value)||""===value||null===value||value!=value},$$updateEmptyClasses:function(value){this.$isEmpty(value)?(this.$$animate.removeClass(this.$$element,"ng-not-empty"),this.$$animate.addClass(this.$$element,"ng-empty")):(this.$$animate.removeClass(this.$$element,"ng-empty"),this.$$animate.addClass(this.$$element,"ng-not-empty"))},$setPristine:function(){this.$dirty=!1,this.$pristine=!0,this.$$animate.removeClass(this.$$element,DIRTY_CLASS),this.$$animate.addClass(this.$$element,PRISTINE_CLASS)},$setDirty:function(){this.$dirty=!0,this.$pristine=!1,this.$$animate.removeClass(this.$$element,PRISTINE_CLASS),this.$$animate.addClass(this.$$element,DIRTY_CLASS),this.$$parentForm.$setDirty()},$setUntouched:function(){this.$touched=!1,this.$untouched=!0,this.$$animate.setClass(this.$$element,"ng-untouched","ng-touched")},$setTouched:function(){this.$touched=!0,this.$untouched=!1,this.$$animate.setClass(this.$$element,"ng-touched","ng-untouched")},$rollbackViewValue:function(){this.$$timeout.cancel(this.$$pendingDebounce),this.$viewValue=this.$$lastCommittedViewValue,this.$render()},$validate:function(){if(!isNumberNaN(this.$modelValue)){var viewValue=this.$$lastCommittedViewValue,modelValue=this.$$rawModelValue,prevValid=this.$valid,prevModelValue=this.$modelValue,allowInvalid=this.$options.getOption("allowInvalid"),that=this;this.$$runValidators(modelValue,viewValue,function(allValid){allowInvalid||prevValid===allValid||(that.$modelValue=allValid?modelValue:void 0,that.$modelValue!==prevModelValue&&that.$$writeModelToScope())})}},$$runValidators:function(modelValue,viewValue,doneCallback){this.$$currentValidationRunId++;var validatorPromises,allValid,localValidationRunId=this.$$currentValidationRunId,that=this;(function(){var errorKey=that.$$parserName;if(!isUndefined(that.$$parserValid))return that.$$parserValid||(forEach(that.$validators,function(v,name){setValidity(name,null)}),forEach(that.$asyncValidators,function(v,name){setValidity(name,null)})),setValidity(errorKey,that.$$parserValid),that.$$parserValid;setValidity(errorKey,null);return!0})()?!function(){var syncValidatorsValid=!0;if(forEach(that.$validators,function(validator,name){var result=Boolean(validator(modelValue,viewValue));syncValidatorsValid=syncValidatorsValid&&result,setValidity(name,result)}),!syncValidatorsValid)return forEach(that.$asyncValidators,function(v,name){setValidity(name,null)}),!1;return!0}()?validationDone(!1):(validatorPromises=[],allValid=!0,forEach(that.$asyncValidators,function(validator,name){var promise=validator(modelValue,viewValue);if(!isPromiseLike(promise))throw ngModelMinErr("nopromise","Expected asynchronous validator to return a promise but got '{0}' instead.",promise);setValidity(name,void 0),validatorPromises.push(promise.then(function(){setValidity(name,!0)},function(){allValid=!1,setValidity(name,!1)}))}),validatorPromises.length?that.$$q.all(validatorPromises).then(function(){validationDone(allValid)},noop):validationDone(!0)):validationDone(!1);function setValidity(name,isValid){localValidationRunId===that.$$currentValidationRunId&&that.$setValidity(name,isValid)}function validationDone(allValid){localValidationRunId===that.$$currentValidationRunId&&doneCallback(allValid)}},$commitViewValue:function(){var viewValue=this.$viewValue;this.$$timeout.cancel(this.$$pendingDebounce),(this.$$lastCommittedViewValue!==viewValue||""===viewValue&&this.$$hasNativeValidators)&&(this.$$updateEmptyClasses(viewValue),this.$$lastCommittedViewValue=viewValue,this.$pristine&&this.$setDirty(),this.$$parseAndValidate())},$$parseAndValidate:function(){var modelValue=this.$$lastCommittedViewValue,that=this;if(this.$$parserValid=!isUndefined(modelValue)||void 0,this.$setValidity(this.$$parserName,null),this.$$parserName="parse",this.$$parserValid)for(var i=0;i<this.$parsers.length;i++)if(isUndefined(modelValue=this.$parsers[i](modelValue))){this.$$parserValid=!1;break}isNumberNaN(this.$modelValue)&&(this.$modelValue=this.$$ngModelGet(this.$$scope));var prevModelValue=this.$modelValue,allowInvalid=this.$options.getOption("allowInvalid");function writeToModelIfNeeded(){that.$modelValue!==prevModelValue&&that.$$writeModelToScope()}this.$$rawModelValue=modelValue,allowInvalid&&(this.$modelValue=modelValue,writeToModelIfNeeded()),this.$$runValidators(modelValue,this.$$lastCommittedViewValue,function(allValid){allowInvalid||(that.$modelValue=allValid?modelValue:void 0,writeToModelIfNeeded())})},$$writeModelToScope:function(){this.$$ngModelSet(this.$$scope,this.$modelValue),forEach(this.$viewChangeListeners,function(listener){try{listener()}catch(e){this.$$exceptionHandler(e)}},this)},$setViewValue:function(value,trigger){this.$viewValue=value,this.$options.getOption("updateOnDefault")&&this.$$debounceViewValueCommit(trigger)},$$debounceViewValueCommit:function(trigger){var debounceDelay=this.$options.getOption("debounce");isNumber(debounceDelay[trigger])?debounceDelay=debounceDelay[trigger]:isNumber(debounceDelay.default)&&-1===this.$options.getOption("updateOn").indexOf(trigger)?debounceDelay=debounceDelay.default:isNumber(debounceDelay["*"])&&(debounceDelay=debounceDelay["*"]),this.$$timeout.cancel(this.$$pendingDebounce);var that=this;debounceDelay>0?this.$$pendingDebounce=this.$$timeout(function(){that.$commitViewValue()},debounceDelay):this.$$rootScope.$$phase?this.$commitViewValue():this.$$scope.$apply(function(){that.$commitViewValue()})},$overrideModelOptions:function(options){this.$options=this.$options.createChild(options),this.$$setUpdateOnEvents()},$processModelValue:function(){var viewValue=this.$$format();this.$viewValue!==viewValue&&(this.$$updateEmptyClasses(viewValue),this.$viewValue=this.$$lastCommittedViewValue=viewValue,this.$render(),this.$$runValidators(this.$modelValue,this.$viewValue,noop))},$$format:function(){for(var formatters=this.$formatters,idx=formatters.length,viewValue=this.$modelValue;idx--;)viewValue=formatters[idx](viewValue);return viewValue},$$setModelValue:function(modelValue){this.$modelValue=this.$$rawModelValue=modelValue,this.$$parserValid=void 0,this.$processModelValue()},$$setUpdateOnEvents:function(){this.$$updateEvents&&this.$$element.off(this.$$updateEvents,this.$$updateEventHandler),this.$$updateEvents=this.$options.getOption("updateOn"),this.$$updateEvents&&this.$$element.on(this.$$updateEvents,this.$$updateEventHandler)},$$updateEventHandler:function(ev){this.$$debounceViewValueCommit(ev&&ev.type)}},addSetValidityMethod({clazz:NgModelController,set:function(object,property){object[property]=!0},unset:function(object,property){delete object[property]}});var defaultModelOptions,ngModelDirective=["$rootScope",function($rootScope){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:NgModelController,priority:1,compile:function(element){return element.addClass(PRISTINE_CLASS).addClass("ng-untouched").addClass(VALID_CLASS),{pre:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0],formCtrl=ctrls[1]||modelCtrl.$$parentForm,optionsCtrl=ctrls[2];optionsCtrl&&(modelCtrl.$options=optionsCtrl.$options),modelCtrl.$$initGetterSetters(),formCtrl.$addControl(modelCtrl),attr.$observe("name",function(newValue){modelCtrl.$name!==newValue&&modelCtrl.$$parentForm.$$renameControl(modelCtrl,newValue)}),scope.$on("$destroy",function(){modelCtrl.$$parentForm.$removeControl(modelCtrl)})},post:function(scope,element,attr,ctrls){var modelCtrl=ctrls[0];function setTouched(){modelCtrl.$setTouched()}modelCtrl.$$setUpdateOnEvents(),element.on("blur",function(){modelCtrl.$touched||($rootScope.$$phase?scope.$evalAsync(setTouched):scope.$apply(setTouched))})}}}}}],DEFAULT_REGEXP=/(\s+|^)default(\s+|$)/;function ModelOptions(options){this.$$options=options}ModelOptions.prototype={getOption:function(name){return this.$$options[name]},createChild:function(options){var inheritAll=!1;return forEach(options=extend({},options),function(option,key){"$inherit"===option?"*"===key?inheritAll=!0:(options[key]=this.$$options[key],"updateOn"===key&&(options.updateOnDefault=this.$$options.updateOnDefault)):"updateOn"===key&&(options.updateOnDefault=!1,options[key]=trim(option.replace(DEFAULT_REGEXP,function(){return options.updateOnDefault=!0," "})))},this),inheritAll&&(delete options["*"],defaults(options,this.$$options)),defaults(options,defaultModelOptions.$$options),new ModelOptions(options)}},defaultModelOptions=new ModelOptions({updateOn:"",updateOnDefault:!0,debounce:0,getterSetter:!1,allowInvalid:!1,timezone:null});var ngModelOptionsDirective=function(){function NgModelOptionsController($attrs,$scope){this.$$attrs=$attrs,this.$$scope=$scope}return NgModelOptionsController.$inject=["$attrs","$scope"],NgModelOptionsController.prototype={$onInit:function(){var parentOptions=this.parentCtrl?this.parentCtrl.$options:defaultModelOptions,modelOptionsDefinition=this.$$scope.$eval(this.$$attrs.ngModelOptions);this.$options=parentOptions.createChild(modelOptionsDefinition)}},{restrict:"A",priority:10,require:{parentCtrl:"?^^ngModelOptions"},bindToController:!0,controller:NgModelOptionsController}};function defaults(dst,src){forEach(src,function(value,key){isDefined(dst[key])||(dst[key]=value)})}var ngNonBindableDirective=ngDirective({terminal:!0,priority:1e3}),ngOptionsMinErr=minErr("ngOptions"),NG_OPTIONS_REGEXP=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([$\w][$\w]*)|(?:\(\s*([$\w][$\w]*)\s*,\s*([$\w][$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,ngOptionsDirective=["$compile","$document","$parse",function($compile,$document,$parse){var optionTemplate=window.document.createElement("option"),optGroupTemplate=window.document.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","ngModel"],link:{pre:function(scope,selectElement,attr,ctrls){ctrls[0].registerOption=noop},post:function(scope,selectElement,attr,ctrls){for(var selectCtrl=ctrls[0],ngModelCtrl=ctrls[1],multiple=attr.multiple,i=0,children=selectElement.children(),ii=children.length;i<ii;i++)if(""===children[i].value){selectCtrl.hasEmptyOption=!0,selectCtrl.emptyOption=children.eq(i);break}selectElement.empty();var options,providedEmptyOption=!!selectCtrl.emptyOption;jqLite(optionTemplate.cloneNode(!1)).val("?");var ngOptions=function(optionsExp,selectElement,scope){var match=optionsExp.match(NG_OPTIONS_REGEXP);if(!match)throw ngOptionsMinErr("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",optionsExp,startingTag(selectElement));var valueName=match[5]||match[7],keyName=match[6],selectAs=/ as /.test(match[0])&&match[1],trackBy=match[9],valueFn=$parse(match[2]?match[1]:valueName),viewValueFn=selectAs&&$parse(selectAs)||valueFn,trackByFn=trackBy&&$parse(trackBy),getTrackByValueFn=trackBy?function(value,locals){return trackByFn(scope,locals)}:function(value){return hashKey(value)},getTrackByValue=function(value,key){return getTrackByValueFn(value,getLocals(value,key))},displayFn=$parse(match[2]||match[1]),groupByFn=$parse(match[3]||""),disableWhenFn=$parse(match[4]||""),valuesFn=$parse(match[8]),locals={},getLocals=keyName?function(value,key){return locals[keyName]=key,locals[valueName]=value,locals}:function(value){return locals[valueName]=value,locals};function Option(selectValue,viewValue,label,group,disabled){this.selectValue=selectValue,this.viewValue=viewValue,this.label=label,this.group=group,this.disabled=disabled}function getOptionValuesKeys(optionValues){var optionValuesKeys;if(!keyName&&isArrayLike(optionValues))optionValuesKeys=optionValues;else for(var itemKey in optionValuesKeys=[],optionValues)optionValues.hasOwnProperty(itemKey)&&"$"!==itemKey.charAt(0)&&optionValuesKeys.push(itemKey);return optionValuesKeys}return{trackBy:trackBy,getTrackByValue:getTrackByValue,getWatchables:$parse(valuesFn,function(optionValues){for(var watchedArray=[],optionValuesKeys=getOptionValuesKeys(optionValues=optionValues||[]),optionValuesLength=optionValuesKeys.length,index=0;index<optionValuesLength;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),selectValue=getTrackByValueFn(value,locals);if(watchedArray.push(selectValue),match[2]||match[1]){var label=displayFn(scope,locals);watchedArray.push(label)}if(match[4]){var disableWhen=disableWhenFn(scope,locals);watchedArray.push(disableWhen)}}return watchedArray}),getOptions:function(){for(var optionItems=[],selectValueMap={},optionValues=valuesFn(scope)||[],optionValuesKeys=getOptionValuesKeys(optionValues),optionValuesLength=optionValuesKeys.length,index=0;index<optionValuesLength;index++){var key=optionValues===optionValuesKeys?index:optionValuesKeys[index],value=optionValues[key],locals=getLocals(value,key),viewValue=viewValueFn(scope,locals),selectValue=getTrackByValueFn(viewValue,locals),optionItem=new Option(selectValue,viewValue,displayFn(scope,locals),groupByFn(scope,locals),disableWhenFn(scope,locals));optionItems.push(optionItem),selectValueMap[selectValue]=optionItem}return{items:optionItems,selectValueMap:selectValueMap,getOptionFromViewValue:function(value){return selectValueMap[getTrackByValue(value)]},getViewValueFromOption:function(option){return trackBy?copy(option.viewValue):option.viewValue}}}}}(attr.ngOptions,selectElement,scope),listFragment=$document[0].createDocumentFragment();function addOptionElement(option,parent){var optionElement=optionTemplate.cloneNode(!1);parent.appendChild(optionElement),function(option,element){option.element=element,element.disabled=option.disabled,option.label!==element.label&&(element.label=option.label,element.textContent=option.label),element.value=option.selectValue}(option,optionElement)}function getAndUpdateSelectedOption(viewValue){var option=options.getOptionFromViewValue(viewValue),element=option&&option.element;return element&&!element.selected&&(element.selected=!0),option}selectCtrl.generateUnknownOptionValue=function(val){return"?"},multiple?(selectCtrl.writeValue=function(values){if(options){var selectedOptions=values&&values.map(getAndUpdateSelectedOption)||[];options.items.forEach(function(option){option.element.selected&&!includes(selectedOptions,option)&&(option.element.selected=!1)})}},selectCtrl.readValue=function(){var selections=[];return forEach(selectElement.val()||[],function(value){var option=options.selectValueMap[value];option&&!option.disabled&&selections.push(options.getViewValueFromOption(option))}),selections},ngOptions.trackBy&&scope.$watchCollection(function(){if(isArray(ngModelCtrl.$viewValue))return ngModelCtrl.$viewValue.map(function(value){return ngOptions.getTrackByValue(value)})},function(){ngModelCtrl.$render()})):(selectCtrl.writeValue=function(value){if(options){var selectedOption=selectElement[0].options[selectElement[0].selectedIndex],option=options.getOptionFromViewValue(value);selectedOption&&selectedOption.removeAttribute("selected"),option?(selectElement[0].value!==option.selectValue&&(selectCtrl.removeUnknownOption(),selectElement[0].value=option.selectValue,option.element.selected=!0),option.element.setAttribute("selected","selected")):selectCtrl.selectUnknownOrEmptyOption(value)}},selectCtrl.readValue=function(){var selectedOption=options.selectValueMap[selectElement.val()];return selectedOption&&!selectedOption.disabled?(selectCtrl.unselectEmptyOption(),selectCtrl.removeUnknownOption(),options.getViewValueFromOption(selectedOption)):null},ngOptions.trackBy&&scope.$watch(function(){return ngOptions.getTrackByValue(ngModelCtrl.$viewValue)},function(){ngModelCtrl.$render()})),providedEmptyOption&&($compile(selectCtrl.emptyOption)(scope),selectElement.prepend(selectCtrl.emptyOption),selectCtrl.emptyOption[0].nodeType===NODE_TYPE_COMMENT?(selectCtrl.hasEmptyOption=!1,selectCtrl.registerOption=function(optionScope,optionEl){""===optionEl.val()&&(selectCtrl.hasEmptyOption=!0,selectCtrl.emptyOption=optionEl,selectCtrl.emptyOption.removeClass("ng-scope"),ngModelCtrl.$render(),optionEl.on("$destroy",function(){var needsRerender=selectCtrl.$isEmptyOptionSelected();selectCtrl.hasEmptyOption=!1,selectCtrl.emptyOption=void 0,needsRerender&&ngModelCtrl.$render()}))}):selectCtrl.emptyOption.removeClass("ng-scope")),scope.$watchCollection(ngOptions.getWatchables,function(){var previousValue=options&&selectCtrl.readValue();if(options)for(var i=options.items.length-1;i>=0;i--){var option=options.items[i];isDefined(option.group)?jqLiteRemove(option.element.parentNode):jqLiteRemove(option.element)}var groupElementMap={};if((options=ngOptions.getOptions()).items.forEach(function(option){var groupElement;isDefined(option.group)?((groupElement=groupElementMap[option.group])||(groupElement=optGroupTemplate.cloneNode(!1),listFragment.appendChild(groupElement),groupElement.label=null===option.group?"null":option.group,groupElementMap[option.group]=groupElement),addOptionElement(option,groupElement)):addOptionElement(option,listFragment)}),selectElement[0].appendChild(listFragment),ngModelCtrl.$render(),!ngModelCtrl.$isEmpty(previousValue)){var nextValue=selectCtrl.readValue(),isNotPrimitive=ngOptions.trackBy||multiple;(isNotPrimitive?equals(previousValue,nextValue):previousValue===nextValue)||(ngModelCtrl.$setViewValue(nextValue),ngModelCtrl.$render())}})}}}}],ngPluralizeDirective=["$locale","$interpolate","$log",function($locale,$interpolate,$log){var BRACE=/{}/g,IS_WHEN=/^when(Minus)?(.+)$/;return{link:function(scope,element,attr){var lastCount,numberExp=attr.count,whenExp=attr.$attr.when&&element.attr(attr.$attr.when),offset=attr.offset||0,whens=scope.$eval(whenExp)||{},whensExpFns={},startSymbol=$interpolate.startSymbol(),endSymbol=$interpolate.endSymbol(),braceReplacement=startSymbol+numberExp+"-"+offset+endSymbol,watchRemover=angular.noop;function updateElementText(newText){element.text(newText||"")}forEach(attr,function(expression,attributeName){var tmpMatch=IS_WHEN.exec(attributeName);if(tmpMatch){var whenKey=(tmpMatch[1]?"-":"")+lowercase(tmpMatch[2]);whens[whenKey]=element.attr(attr.$attr[attributeName])}}),forEach(whens,function(expression,key){whensExpFns[key]=$interpolate(expression.replace(BRACE,braceReplacement))}),scope.$watch(numberExp,function(newVal){var count=parseFloat(newVal),countIsNaN=isNumberNaN(count);if(countIsNaN||count in whens||(count=$locale.pluralCat(count-offset)),!(count===lastCount||countIsNaN&&isNumberNaN(lastCount))){watchRemover();var whenExpFn=whensExpFns[count];isUndefined(whenExpFn)?(null!=newVal&&$log.debug("ngPluralize: no rule defined for '"+count+"' in "+whenExp),watchRemover=noop,updateElementText()):watchRemover=scope.$watch(whenExpFn,updateElementText),lastCount=count}})}}}],ngRefMinErr=minErr("ngRef"),ngRefDirective=["$parse",function($parse){return{priority:-1,restrict:"A",compile:function(tElement,tAttrs){var controllerName=directiveNormalize(nodeName_(tElement)),getter=$parse(tAttrs.ngRef),setter=getter.assign||function(){throw ngRefMinErr("nonassign",'Expression in ngRef="{0}" is non-assignable!',tAttrs.ngRef)};return function(scope,element,attrs){var refValue;if(attrs.hasOwnProperty("ngRefRead")){if("$element"===attrs.ngRefRead)refValue=element;else if(!(refValue=element.data("$"+attrs.ngRefRead+"Controller")))throw ngRefMinErr("noctrl",'The controller for ngRefRead="{0}" could not be found on ngRef="{1}"',attrs.ngRefRead,tAttrs.ngRef)}else refValue=element.data("$"+controllerName+"Controller");setter(scope,refValue=refValue||element),element.on("$destroy",function(){getter(scope)===refValue&&setter(scope,null)})}}}}],ngRepeatDirective=["$parse","$animate","$compile",function($parse,$animate,$compile){var ngRepeatMinErr=minErr("ngRepeat"),updateScope=function(scope,index,valueIdentifier,value,keyIdentifier,key,arrayLength){scope[valueIdentifier]=value,keyIdentifier&&(scope[keyIdentifier]=key),scope.$index=index,scope.$first=0===index,scope.$last=index===arrayLength-1,scope.$middle=!(scope.$first||scope.$last),scope.$odd=!(scope.$even=0==(1&index))},getBlockStart=function(block){return block.clone[0]},getBlockEnd=function(block){return block.clone[block.clone.length-1]},trackByIdArrayFn=function($scope,key,value){return hashKey(value)},trackByIdObjFn=function($scope,key){return key};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function($element,$attr){var expression=$attr.ngRepeat,ngRepeatEndComment=$compile.$$createComment("end ngRepeat",expression),match=expression.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!match)throw ngRepeatMinErr("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",expression);var lhs=match[1],rhs=match[2],aliasAs=match[3],trackByExp=match[4];if(!(match=lhs.match(/^(?:(\s*[$\w]+)|\(\s*([$\w]+)\s*,\s*([$\w]+)\s*\))$/)))throw ngRepeatMinErr("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",lhs);var trackByIdExpFn,valueIdentifier=match[3]||match[1],keyIdentifier=match[2];if(aliasAs&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(aliasAs)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(aliasAs)))throw ngRepeatMinErr("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",aliasAs);if(trackByExp){var hashFnLocals={$id:hashKey},trackByExpGetter=$parse(trackByExp);trackByIdExpFn=function($scope,key,value,index){return keyIdentifier&&(hashFnLocals[keyIdentifier]=key),hashFnLocals[valueIdentifier]=value,hashFnLocals.$index=index,trackByExpGetter($scope,hashFnLocals)}}return function($scope,$element,$attr,ctrl,$transclude){var lastBlockMap=createMap();$scope.$watchCollection(rhs,function(collection){var index,length,nextNode,collectionLength,key,value,trackById,trackByIdFn,collectionKeys,block,nextBlockOrder,elementsToRemove,previousNode=$element[0],nextBlockMap=createMap();if(aliasAs&&($scope[aliasAs]=collection),isArrayLike(collection))collectionKeys=collection,trackByIdFn=trackByIdExpFn||trackByIdArrayFn;else for(var itemKey in trackByIdFn=trackByIdExpFn||trackByIdObjFn,collectionKeys=[],collection)hasOwnProperty.call(collection,itemKey)&&"$"!==itemKey.charAt(0)&&collectionKeys.push(itemKey);for(collectionLength=collectionKeys.length,nextBlockOrder=new Array(collectionLength),index=0;index<collectionLength;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],trackById=trackByIdFn($scope,key,value,index),lastBlockMap[trackById])block=lastBlockMap[trackById],delete lastBlockMap[trackById],nextBlockMap[trackById]=block,nextBlockOrder[index]=block;else{if(nextBlockMap[trackById])throw forEach(nextBlockOrder,function(block){block&&block.scope&&(lastBlockMap[block.id]=block)}),ngRepeatMinErr("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",expression,trackById,value);nextBlockOrder[index]={id:trackById,scope:void 0,clone:void 0},nextBlockMap[trackById]=!0}for(var blockKey in hashFnLocals&&(hashFnLocals[valueIdentifier]=void 0),lastBlockMap){if(elementsToRemove=getBlockNodes((block=lastBlockMap[blockKey]).clone),$animate.leave(elementsToRemove),elementsToRemove[0].parentNode)for(index=0,length=elementsToRemove.length;index<length;index++)elementsToRemove[index].$$NG_REMOVED=!0;block.scope.$destroy()}for(index=0;index<collectionLength;index++)if(key=collection===collectionKeys?index:collectionKeys[index],value=collection[key],(block=nextBlockOrder[index]).scope){nextNode=previousNode;do{nextNode=nextNode.nextSibling}while(nextNode&&nextNode.$$NG_REMOVED);getBlockStart(block)!==nextNode&&$animate.move(getBlockNodes(block.clone),null,previousNode),previousNode=getBlockEnd(block),updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)}else $transclude(function(clone,scope){block.scope=scope;var endNode=ngRepeatEndComment.cloneNode(!1);clone[clone.length++]=endNode,$animate.enter(clone,null,previousNode),previousNode=endNode,block.clone=clone,nextBlockMap[block.id]=block,updateScope(block.scope,index,valueIdentifier,value,keyIdentifier,key,collectionLength)});lastBlockMap=nextBlockMap})}}}}],ngShowDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngShow,function(value){$animate[value?"removeClass":"addClass"](element,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],ngHideDirective=["$animate",function($animate){return{restrict:"A",multiElement:!0,link:function(scope,element,attr){scope.$watch(attr.ngHide,function(value){$animate[value?"addClass":"removeClass"](element,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],ngStyleDirective=ngDirective(function(scope,element,attr){scope.$watchCollection(attr.ngStyle,function(newStyles,oldStyles){oldStyles&&newStyles!==oldStyles&&forEach(oldStyles,function(val,style){element.css(style,"")}),newStyles&&element.css(newStyles)})}),ngSwitchDirective=["$animate","$compile",function($animate,$compile){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(scope,element,attr,ngSwitchController){var watchExpr=attr.ngSwitch||attr.on,selectedTranscludes=[],selectedElements=[],previousLeaveAnimations=[],selectedScopes=[],spliceFactory=function(array,index){return function(response){!1!==response&&array.splice(index,1)}};scope.$watch(watchExpr,function(value){for(var i,ii;previousLeaveAnimations.length;)$animate.cancel(previousLeaveAnimations.pop());for(i=0,ii=selectedScopes.length;i<ii;++i){var selected=getBlockNodes(selectedElements[i].clone);selectedScopes[i].$destroy(),(previousLeaveAnimations[i]=$animate.leave(selected)).done(spliceFactory(previousLeaveAnimations,i))}selectedElements.length=0,selectedScopes.length=0,(selectedTranscludes=ngSwitchController.cases["!"+value]||ngSwitchController.cases["?"])&&forEach(selectedTranscludes,function(selectedTransclude){selectedTransclude.transclude(function(caseElement,selectedScope){selectedScopes.push(selectedScope);var anchor=selectedTransclude.element;caseElement[caseElement.length++]=$compile.$$createComment("end ngSwitchWhen");var block={clone:caseElement};selectedElements.push(block),$animate.enter(caseElement,anchor.parent(),anchor)})})})}}}],ngSwitchWhenDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attrs,ctrl,$transclude){forEach(attrs.ngSwitchWhen.split(attrs.ngSwitchWhenSeparator).sort().filter(function(element,index,array){return array[index-1]!==element}),function(whenCase){ctrl.cases["!"+whenCase]=ctrl.cases["!"+whenCase]||[],ctrl.cases["!"+whenCase].push({transclude:$transclude,element:element})})}}),ngSwitchDefaultDirective=ngDirective({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(scope,element,attr,ctrl,$transclude){ctrl.cases["?"]=ctrl.cases["?"]||[],ctrl.cases["?"].push({transclude:$transclude,element:element})}}),ngTranscludeMinErr=minErr("ngTransclude"),ngTranscludeDirective=["$compile",function($compile){return{restrict:"EAC",compile:function(tElement){var fallbackLinkFn=$compile(tElement.contents());return tElement.empty(),function($scope,$element,$attrs,controller,$transclude){if(!$transclude)throw ngTranscludeMinErr("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",startingTag($element));$attrs.ngTransclude===$attrs.$attr.ngTransclude&&($attrs.ngTransclude="");var slotName=$attrs.ngTransclude||$attrs.ngTranscludeSlot;function useFallbackContent(){fallbackLinkFn($scope,function(clone){$element.append(clone)})}$transclude(function(clone,transcludedScope){clone.length&&function(nodes){for(var i=0,ii=nodes.length;i<ii;i++){var node=nodes[i];if(node.nodeType!==NODE_TYPE_TEXT||node.nodeValue.trim())return!0}}(clone)?$element.append(clone):(useFallbackContent(),transcludedScope.$destroy())},null,slotName),slotName&&!$transclude.isSlotFilled(slotName)&&useFallbackContent()}}}}],scriptDirective=["$templateCache",function($templateCache){return{restrict:"E",terminal:!0,compile:function(element,attr){if("text/ng-template"===attr.type){var templateUrl=attr.id,text=element[0].text;$templateCache.put(templateUrl,text)}}}}],noopNgModelController={$setViewValue:noop,$render:noop};function setOptionSelectedStatus(optionEl,value){optionEl.prop("selected",value),optionEl.attr("selected",value)}var SelectController=["$element","$scope",function($element,$scope){var self=this,optionsMap=new NgMap;self.selectValueMap={},self.ngModelCtrl=noopNgModelController,self.multiple=!1,self.unknownOption=jqLite(window.document.createElement("option")),self.hasEmptyOption=!1,self.emptyOption=void 0,self.renderUnknownOption=function(val){var unknownVal=self.generateUnknownOptionValue(val);self.unknownOption.val(unknownVal),$element.prepend(self.unknownOption),setOptionSelectedStatus(self.unknownOption,!0),$element.val(unknownVal)},self.updateUnknownOption=function(val){var unknownVal=self.generateUnknownOptionValue(val);self.unknownOption.val(unknownVal),setOptionSelectedStatus(self.unknownOption,!0),$element.val(unknownVal)},self.generateUnknownOptionValue=function(val){return"? "+hashKey(val)+" ?"},self.removeUnknownOption=function(){self.unknownOption.parent()&&self.unknownOption.remove()},self.selectEmptyOption=function(){self.emptyOption&&($element.val(""),setOptionSelectedStatus(self.emptyOption,!0))},self.unselectEmptyOption=function(){self.hasEmptyOption&&setOptionSelectedStatus(self.emptyOption,!1)},$scope.$on("$destroy",function(){self.renderUnknownOption=noop}),self.readValue=function(){var val=$element.val(),realVal=val in self.selectValueMap?self.selectValueMap[val]:val;return self.hasOption(realVal)?realVal:null},self.writeValue=function(value){var currentlySelectedOption=$element[0].options[$element[0].selectedIndex];if(currentlySelectedOption&&setOptionSelectedStatus(jqLite(currentlySelectedOption),!1),self.hasOption(value)){self.removeUnknownOption();var hashedVal=hashKey(value);$element.val(hashedVal in self.selectValueMap?hashedVal:value);var selectedOption=$element[0].options[$element[0].selectedIndex];setOptionSelectedStatus(jqLite(selectedOption),!0)}else self.selectUnknownOrEmptyOption(value)},self.addOption=function(value,element){if(element[0].nodeType!==NODE_TYPE_COMMENT){assertNotHasOwnProperty(value,'"option value"'),""===value&&(self.hasEmptyOption=!0,self.emptyOption=element);var count=optionsMap.get(value)||0;optionsMap.set(value,count+1),scheduleRender()}},self.removeOption=function(value){var count=optionsMap.get(value);count&&(1===count?(optionsMap.delete(value),""===value&&(self.hasEmptyOption=!1,self.emptyOption=void 0)):optionsMap.set(value,count-1))},self.hasOption=function(value){return!!optionsMap.get(value)},self.$hasEmptyOption=function(){return self.hasEmptyOption},self.$isUnknownOptionSelected=function(){return $element[0].options[0]===self.unknownOption[0]},self.$isEmptyOptionSelected=function(){return self.hasEmptyOption&&$element[0].options[$element[0].selectedIndex]===self.emptyOption[0]},self.selectUnknownOrEmptyOption=function(value){null==value&&self.emptyOption?(self.removeUnknownOption(),self.selectEmptyOption()):self.unknownOption.parent().length?self.updateUnknownOption(value):self.renderUnknownOption(value)};var renderScheduled=!1;function scheduleRender(){renderScheduled||(renderScheduled=!0,$scope.$$postDigest(function(){renderScheduled=!1,self.ngModelCtrl.$render()}))}var updateScheduled=!1;function scheduleViewValueUpdate(renderAfter){updateScheduled||(updateScheduled=!0,$scope.$$postDigest(function(){$scope.$$destroyed||(updateScheduled=!1,self.ngModelCtrl.$setViewValue(self.readValue()),renderAfter&&self.ngModelCtrl.$render())}))}self.registerOption=function(optionScope,optionElement,optionAttrs,interpolateValueFn,interpolateTextFn){var oldVal,hashedVal;optionAttrs.$attr.ngValue?optionAttrs.$observe("value",function(newVal){var removal,previouslySelected=optionElement.prop("selected");isDefined(hashedVal)&&(self.removeOption(oldVal),delete self.selectValueMap[hashedVal],removal=!0),hashedVal=hashKey(newVal),oldVal=newVal,self.selectValueMap[hashedVal]=newVal,self.addOption(newVal,optionElement),optionElement.attr("value",hashedVal),removal&&previouslySelected&&scheduleViewValueUpdate()}):interpolateValueFn?optionAttrs.$observe("value",function(newVal){var removal;self.readValue();var previouslySelected=optionElement.prop("selected");isDefined(oldVal)&&(self.removeOption(oldVal),removal=!0),oldVal=newVal,self.addOption(newVal,optionElement),removal&&previouslySelected&&scheduleViewValueUpdate()}):interpolateTextFn?optionScope.$watch(interpolateTextFn,function(newVal,oldVal){optionAttrs.$set("value",newVal);var previouslySelected=optionElement.prop("selected");oldVal!==newVal&&self.removeOption(oldVal),self.addOption(newVal,optionElement),oldVal&&previouslySelected&&scheduleViewValueUpdate()}):self.addOption(optionAttrs.value,optionElement);optionAttrs.$observe("disabled",function(newVal){("true"===newVal||newVal&&optionElement.prop("selected"))&&(self.multiple?scheduleViewValueUpdate(!0):(self.ngModelCtrl.$setViewValue(null),self.ngModelCtrl.$render()))}),optionElement.on("$destroy",function(){var currentValue=self.readValue(),removeValue=optionAttrs.value;self.removeOption(removeValue),scheduleRender(),(self.multiple&&currentValue&&-1!==currentValue.indexOf(removeValue)||currentValue===removeValue)&&scheduleViewValueUpdate(!0)})}}],selectDirective=function(){return{restrict:"E",require:["select","?ngModel"],controller:SelectController,priority:1,link:{pre:function(scope,element,attr,ctrls){var selectCtrl=ctrls[0],ngModelCtrl=ctrls[1];if(!ngModelCtrl)return void(selectCtrl.registerOption=noop);if(selectCtrl.ngModelCtrl=ngModelCtrl,element.on("change",function(){selectCtrl.removeUnknownOption(),scope.$apply(function(){ngModelCtrl.$setViewValue(selectCtrl.readValue())})}),attr.multiple){selectCtrl.multiple=!0,selectCtrl.readValue=function(){var array=[];return forEach(element.find("option"),function(option){if(option.selected&&!option.disabled){var val=option.value;array.push(val in selectCtrl.selectValueMap?selectCtrl.selectValueMap[val]:val)}}),array},selectCtrl.writeValue=function(value){forEach(element.find("option"),function(option){var shouldBeSelected=!!value&&(includes(value,option.value)||includes(value,selectCtrl.selectValueMap[option.value])),currentlySelected=option.selected;shouldBeSelected!==currentlySelected&&setOptionSelectedStatus(jqLite(option),shouldBeSelected)})};var lastView,lastViewRef=NaN;scope.$watch(function(){lastViewRef!==ngModelCtrl.$viewValue||equals(lastView,ngModelCtrl.$viewValue)||(lastView=shallowCopy(ngModelCtrl.$viewValue),ngModelCtrl.$render()),lastViewRef=ngModelCtrl.$viewValue}),ngModelCtrl.$isEmpty=function(value){return!value||0===value.length}}},post:function(scope,element,attrs,ctrls){var ngModelCtrl=ctrls[1];if(!ngModelCtrl)return;var selectCtrl=ctrls[0];ngModelCtrl.$render=function(){selectCtrl.writeValue(ngModelCtrl.$viewValue)}}}}},optionDirective=["$interpolate",function($interpolate){return{restrict:"E",priority:100,compile:function(element,attr){var interpolateValueFn,interpolateTextFn;return isDefined(attr.ngValue)||(isDefined(attr.value)?interpolateValueFn=$interpolate(attr.value,!0):(interpolateTextFn=$interpolate(element.text(),!0))||attr.$set("value",element.text())),function(scope,element,attr){var parent=element.parent(),selectCtrl=parent.data("$selectController")||parent.parent().data("$selectController");selectCtrl&&selectCtrl.registerOption(scope,element,attr,interpolateValueFn,interpolateTextFn)}}}}],requiredDirective=["$parse",function($parse){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var value=attr.hasOwnProperty("required")||$parse(attr.ngRequired)(scope);attr.ngRequired||(attr.required=!0),ctrl.$validators.required=function(modelValue,viewValue){return!value||!ctrl.$isEmpty(viewValue)},attr.$observe("required",function(newVal){value!==newVal&&(value=newVal,ctrl.$validate())})}}}}],patternDirective=["$parse",function($parse){return{restrict:"A",require:"?ngModel",compile:function(tElm,tAttr){var patternExp,parseFn;return tAttr.ngPattern&&(patternExp=tAttr.ngPattern,parseFn="/"===tAttr.ngPattern.charAt(0)&&REGEX_STRING_REGEXP.test(tAttr.ngPattern)?function(){return tAttr.ngPattern}:$parse(tAttr.ngPattern)),function(scope,elm,attr,ctrl){if(ctrl){var attrVal=attr.pattern;attr.ngPattern?attrVal=parseFn(scope):patternExp=attr.pattern;var regexp=parsePatternAttr(attrVal,patternExp,elm);attr.$observe("pattern",function(newVal){var oldRegexp=regexp;regexp=parsePatternAttr(newVal,patternExp,elm),(oldRegexp&&oldRegexp.toString())!==(regexp&&regexp.toString())&&ctrl.$validate()}),ctrl.$validators.pattern=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||isUndefined(regexp)||regexp.test(viewValue)}}}}}}],maxlengthDirective=["$parse",function($parse){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var maxlength=attr.maxlength||$parse(attr.ngMaxlength)(scope),maxlengthParsed=parseLength(maxlength);attr.$observe("maxlength",function(value){maxlength!==value&&(maxlengthParsed=parseLength(value),maxlength=value,ctrl.$validate())}),ctrl.$validators.maxlength=function(modelValue,viewValue){return maxlengthParsed<0||ctrl.$isEmpty(viewValue)||viewValue.length<=maxlengthParsed}}}}}],minlengthDirective=["$parse",function($parse){return{restrict:"A",require:"?ngModel",link:function(scope,elm,attr,ctrl){if(ctrl){var minlength=attr.minlength||$parse(attr.ngMinlength)(scope),minlengthParsed=parseLength(minlength)||-1;attr.$observe("minlength",function(value){minlength!==value&&(minlengthParsed=parseLength(value)||-1,minlength=value,ctrl.$validate())}),ctrl.$validators.minlength=function(modelValue,viewValue){return ctrl.$isEmpty(viewValue)||viewValue.length>=minlengthParsed}}}}}];function parsePatternAttr(regex,patternExp,elm){if(regex){if(isString(regex)&&(regex=new RegExp("^"+regex+"$")),!regex.test)throw minErr("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",patternExp,regex,startingTag(elm));return regex}}function parseLength(val){var intVal=toInt(val);return isNumberNaN(intVal)?-1:intVal}window.angular.bootstrap?window.console&&console.log("WARNING: Tried to load AngularJS more than once."):(!function(){var originalCleanData;if(!bindJQueryFired){var jqName=jq();(jQuery=isUndefined(jqName)?window.jQuery:jqName?window[jqName]:void 0)&&jQuery.fn.on?(jqLite=jQuery,extend(jQuery.fn,{scope:JQLitePrototype.scope,isolateScope:JQLitePrototype.isolateScope,controller:JQLitePrototype.controller,injector:JQLitePrototype.injector,inheritedData:JQLitePrototype.inheritedData})):jqLite=JQLite,originalCleanData=jqLite.cleanData,jqLite.cleanData=function(elems){for(var events,elem,i=0;null!=(elem=elems[i]);i++)(events=(jqLite._data(elem)||{}).events)&&events.$destroy&&jqLite(elem).triggerHandler("$destroy");originalCleanData(elems)},angular.element=jqLite,bindJQueryFired=!0}}(),function(angular){extend(angular,{errorHandlingConfig:errorHandlingConfig,bootstrap:bootstrap,copy:copy,extend:extend,merge:merge,equals:equals,element:jqLite,forEach:forEach,injector:createInjector,noop:noop,bind:bind,toJson:toJson,fromJson:fromJson,identity:identity,isUndefined:isUndefined,isDefined:isDefined,isString:isString,isFunction:isFunction,isObject:isObject,isNumber:isNumber,isElement:isElement,isArray:isArray,version:version,isDate:isDate,callbacks:{$$counter:0},getTestability:getTestability,reloadWithDebugInfo:reloadWithDebugInfo,UNSAFE_restoreLegacyJqLiteXHTMLReplacement:UNSAFE_restoreLegacyJqLiteXHTMLReplacement,$$minErr:minErr,$$csp:csp,$$encodeUriSegment:encodeUriSegment,$$encodeUriQuery:encodeUriQuery,$$lowercase:lowercase,$$stringify:stringify,$$uppercase:uppercase}),(angularModule=function(window){var $injectorMinErr=minErr("$injector"),ngMinErr=minErr("ng");function ensure(obj,name,factory){return obj[name]||(obj[name]=factory())}var angular=ensure(window,"angular",Object);return angular.$$minErr=angular.$$minErr||minErr,ensure(angular,"module",function(){var modules={};return function(name,requires,configFn){var info={};return function(name,context){if("hasOwnProperty"===name)throw ngMinErr("badname","hasOwnProperty is not a valid {0} name",context)}(name,"module"),requires&&modules.hasOwnProperty(name)&&(modules[name]=null),ensure(modules,name,function(){if(!requires)throw $injectorMinErr("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",name);var invokeQueue=[],configBlocks=[],runBlocks=[],config=invokeLater("$injector","invoke","push",configBlocks),moduleInstance={_invokeQueue:invokeQueue,_configBlocks:configBlocks,_runBlocks:runBlocks,info:function(value){if(isDefined(value)){if(!isObject(value))throw ngMinErr("aobj","Argument '{0}' must be an object","value");return info=value,this}return info},requires:requires,name:name,provider:invokeLaterAndSetModuleName("$provide","provider"),factory:invokeLaterAndSetModuleName("$provide","factory"),service:invokeLaterAndSetModuleName("$provide","service"),value:invokeLater("$provide","value"),constant:invokeLater("$provide","constant","unshift"),decorator:invokeLaterAndSetModuleName("$provide","decorator",configBlocks),animation:invokeLaterAndSetModuleName("$animateProvider","register"),filter:invokeLaterAndSetModuleName("$filterProvider","register"),controller:invokeLaterAndSetModuleName("$controllerProvider","register"),directive:invokeLaterAndSetModuleName("$compileProvider","directive"),component:invokeLaterAndSetModuleName("$compileProvider","component"),config:config,run:function(block){return runBlocks.push(block),this}};return configFn&&config(configFn),moduleInstance;function invokeLater(provider,method,insertMethod,queue){return queue||(queue=invokeQueue),function(){return queue[insertMethod||"push"]([provider,method,arguments]),moduleInstance}}function invokeLaterAndSetModuleName(provider,method,queue){return queue||(queue=invokeQueue),function(recipeName,factoryFunction){return factoryFunction&&isFunction(factoryFunction)&&(factoryFunction.$$moduleName=name),queue.push([provider,method,arguments]),moduleInstance}}})}})}(window))("ng",["ngLocale"],["$provide",function($provide){$provide.provider({$$sanitizeUri:$$SanitizeUriProvider}),$provide.provider("$compile",$CompileProvider).directive({a:htmlAnchorDirective,input:inputDirective,textarea:inputDirective,form:formDirective,script:scriptDirective,select:selectDirective,option:optionDirective,ngBind:ngBindDirective,ngBindHtml:ngBindHtmlDirective,ngBindTemplate:ngBindTemplateDirective,ngClass:ngClassDirective,ngClassEven:ngClassEvenDirective,ngClassOdd:ngClassOddDirective,ngCloak:ngCloakDirective,ngController:ngControllerDirective,ngForm:ngFormDirective,ngHide:ngHideDirective,ngIf:ngIfDirective,ngInclude:ngIncludeDirective,ngInit:ngInitDirective,ngNonBindable:ngNonBindableDirective,ngPluralize:ngPluralizeDirective,ngRef:ngRefDirective,ngRepeat:ngRepeatDirective,ngShow:ngShowDirective,ngStyle:ngStyleDirective,ngSwitch:ngSwitchDirective,ngSwitchWhen:ngSwitchWhenDirective,ngSwitchDefault:ngSwitchDefaultDirective,ngOptions:ngOptionsDirective,ngTransclude:ngTranscludeDirective,ngModel:ngModelDirective,ngList:ngListDirective,ngChange:ngChangeDirective,pattern:patternDirective,ngPattern:patternDirective,required:requiredDirective,ngRequired:requiredDirective,minlength:minlengthDirective,ngMinlength:minlengthDirective,maxlength:maxlengthDirective,ngMaxlength:maxlengthDirective,ngValue:ngValueDirective,ngModelOptions:ngModelOptionsDirective}).directive({ngInclude:ngIncludeFillContentDirective,input:hiddenInputBrowserCacheDirective}).directive(ngAttributeAliasDirectives).directive(ngEventDirectives),$provide.provider({$anchorScroll:$AnchorScrollProvider,$animate:$AnimateProvider,$animateCss:$CoreAnimateCssProvider,$$animateJs:$$CoreAnimateJsProvider,$$animateQueue:$$CoreAnimateQueueProvider,$$AnimateRunner:$$AnimateRunnerFactoryProvider,$$animateAsyncRun:$$AnimateAsyncRunFactoryProvider,$browser:$BrowserProvider,$cacheFactory:$CacheFactoryProvider,$controller:$ControllerProvider,$document:$DocumentProvider,$$isDocumentHidden:$$IsDocumentHiddenProvider,$exceptionHandler:$ExceptionHandlerProvider,$filter:$FilterProvider,$$forceReflow:$$ForceReflowProvider,$interpolate:$InterpolateProvider,$interval:$IntervalProvider,$$intervalFactory:$$IntervalFactoryProvider,$http:$HttpProvider,$httpParamSerializer:$HttpParamSerializerProvider,$httpParamSerializerJQLike:$HttpParamSerializerJQLikeProvider,$httpBackend:$HttpBackendProvider,$xhrFactory:$xhrFactoryProvider,$jsonpCallbacks:$jsonpCallbacksProvider,$location:$LocationProvider,$log:$LogProvider,$parse:$ParseProvider,$rootScope:$RootScopeProvider,$q:$QProvider,$$q:$$QProvider,$sce:$SceProvider,$sceDelegate:$SceDelegateProvider,$sniffer:$SnifferProvider,$$taskTrackerFactory:$$TaskTrackerFactoryProvider,$templateCache:$TemplateCacheProvider,$templateRequest:$TemplateRequestProvider,$$testability:$$TestabilityProvider,$timeout:$TimeoutProvider,$window:$WindowProvider,$$rAF:$$RAFProvider,$$jqLite:$$jqLiteProvider,$$Map:$$MapProvider,$$cookieReader:$$CookieReaderProvider})}]).info({angularVersion:"1.8.0"})}(angular),angular.module("ngLocale",[],["$provide",function($provide){var PLURAL_CATEGORY_ONE="one",PLURAL_CATEGORY_OTHER="other";$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],STANDALONEMONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"en-us",localeID:"en_US",pluralCat:function(n,opt_precision){var i=0|n,vf=function(n,opt_precision){var v=opt_precision;void 0===v&&(v=Math.min(function(n){var i=(n+="").indexOf(".");return-1==i?0:n.length-i-1}(n),3));var base=Math.pow(10,v);return{v:v,f:(n*base|0)%base}}(n,opt_precision);return 1==i&&0==vf.v?PLURAL_CATEGORY_ONE:PLURAL_CATEGORY_OTHER}})}]),jqLite(function(){angularInit(window.document,bootstrap)}))}(window),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend(window.angular.element("<style>").text('@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}')),function(window,angular){"use strict";var bind,extend,forEach,isArray,isDefined,lowercase,noop,nodeContains,htmlParser,htmlSanitizeWriter,$sanitizeMinErr=angular.$$minErr("$sanitize");angular.module("ngSanitize",[]).provider("$sanitize",function(){var hasBeenInstantiated=!1,svgEnabled=!1;this.$get=["$$sanitizeUri",function($$sanitizeUri){return hasBeenInstantiated=!0,svgEnabled&&extend(validElements,svgElements),function(html){var buf=[];return htmlParser(html,htmlSanitizeWriter(buf,function(uri,isImage){return!/^unsafe:/.test($$sanitizeUri(uri,isImage))})),buf.join("")}}],this.enableSvg=function(enableSvg){return isDefined(enableSvg)?(svgEnabled=enableSvg,this):svgEnabled},this.addValidElements=function(elements){return hasBeenInstantiated||(isArray(elements)&&(elements={htmlElements:elements}),addElementsTo(svgElements,elements.svgElements),addElementsTo(voidElements,elements.htmlVoidElements),addElementsTo(validElements,elements.htmlVoidElements),addElementsTo(validElements,elements.htmlElements)),this},this.addValidAttrs=function(attrs){return hasBeenInstantiated||extend(validAttrs,arrayToMap(attrs,!0)),this},bind=angular.bind,extend=angular.extend,forEach=angular.forEach,isArray=angular.isArray,isDefined=angular.isDefined,lowercase=angular.$$lowercase,noop=angular.noop,htmlParser=function(html,handler){null===html||void 0===html?html="":"string"!=typeof html&&(html=""+html);var inertBodyElement=getInertBodyElement(html);if(!inertBodyElement)return"";var mXSSAttempts=5;do{if(0===mXSSAttempts)throw $sanitizeMinErr("uinput","Failed to sanitize html because the input is unstable");mXSSAttempts--,html=inertBodyElement.innerHTML,inertBodyElement=getInertBodyElement(html)}while(html!==inertBodyElement.innerHTML);for(var node=inertBodyElement.firstChild;node;){switch(node.nodeType){case 1:handler.start(node.nodeName.toLowerCase(),attrToMap(node.attributes));break;case 3:handler.chars(node.textContent)}var nextNode;if(!((nextNode=node.firstChild)||(1===node.nodeType&&handler.end(node.nodeName.toLowerCase()),nextNode=getNonDescendant("nextSibling",node))))for(;null==nextNode&&(node=getNonDescendant("parentNode",node))!==inertBodyElement;)nextNode=getNonDescendant("nextSibling",node),1===node.nodeType&&handler.end(node.nodeName.toLowerCase());node=nextNode}for(;node=inertBodyElement.firstChild;)inertBodyElement.removeChild(node)},htmlSanitizeWriter=function(buf,uriValidator){var ignoreCurrentElement=!1,out=bind(buf,buf.push);return{start:function(tag,attrs){tag=lowercase(tag),!ignoreCurrentElement&&blockedElements[tag]&&(ignoreCurrentElement=tag),ignoreCurrentElement||!0!==validElements[tag]||(out("<"),out(tag),forEach(attrs,function(value,key){var lkey=lowercase(key),isImage="img"===tag&&"src"===lkey||"background"===lkey;!0!==validAttrs[lkey]||!0===uriAttrs[lkey]&&!uriValidator(value,isImage)||(out(" "),out(key),out('="'),out(encodeEntities(value)),out('"'))}),out(">"))},end:function(tag){tag=lowercase(tag),ignoreCurrentElement||!0!==validElements[tag]||!0===voidElements[tag]||(out("</"),out(tag),out(">")),tag==ignoreCurrentElement&&(ignoreCurrentElement=!1)},chars:function(chars){ignoreCurrentElement||out(encodeEntities(chars))}}},nodeContains=window.Node.prototype.contains||function(arg){return!!(16&this.compareDocumentPosition(arg))};var SURROGATE_PAIR_REGEXP=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,NON_ALPHANUMERIC_REGEXP=/([^#-~ |!])/g,voidElements=stringToMap("area,br,col,hr,img,wbr"),optionalEndTagBlockElements=stringToMap("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),optionalEndTagInlineElements=stringToMap("rp,rt"),optionalEndTagElements=extend({},optionalEndTagInlineElements,optionalEndTagBlockElements),blockElements=extend({},optionalEndTagBlockElements,stringToMap("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),inlineElements=extend({},optionalEndTagInlineElements,stringToMap("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),svgElements=stringToMap("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),blockedElements=stringToMap("script,style"),validElements=extend({},voidElements,blockElements,inlineElements,optionalEndTagElements),uriAttrs=stringToMap("background,cite,href,longdesc,src,xlink:href,xml:base"),htmlAttrs=stringToMap("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),svgAttrs=stringToMap("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),validAttrs=extend({},uriAttrs,svgAttrs,htmlAttrs);function stringToMap(str,lowercaseKeys){return arrayToMap(str.split(","),lowercaseKeys)}function arrayToMap(items,lowercaseKeys){var i,obj={};for(i=0;i<items.length;i++)obj[lowercaseKeys?lowercase(items[i]):items[i]]=!0;return obj}function addElementsTo(elementsMap,newElements){newElements&&newElements.length&&extend(elementsMap,arrayToMap(newElements))}var getInertBodyElement=function(window,document){var inertDocument;if(!document||!document.implementation)throw $sanitizeMinErr("noinert","Can't create an inert html document");var inertBodyElement=((inertDocument=document.implementation.createHTMLDocument("inert")).documentElement||inertDocument.getDocumentElement()).querySelector("body");return inertBodyElement.innerHTML='<svg><g onload="this.parentNode.remove()"></g></svg>',inertBodyElement.querySelector("svg")?(inertBodyElement.innerHTML='<svg><p><style><img src="</style><img src=x onerror=alert(1)//">',inertBodyElement.querySelector("svg img")?function(html){html="<remove></remove>"+html;try{var body=(new window.DOMParser).parseFromString(html,"text/html").body;return body.firstChild.remove(),body}catch(e){return}}:function(html){return inertBodyElement.innerHTML=html,document.documentMode&&stripCustomNsAttrs(inertBodyElement),inertBodyElement}):function(html){html="<remove></remove>"+html;try{html=encodeURI(html)}catch(e){return}var xhr=new window.XMLHttpRequest;xhr.responseType="document",xhr.open("GET","data:text/html;charset=utf-8,"+html,!1),xhr.send(null);var body=xhr.response.body;return body.firstChild.remove(),body}}(window,window.document);function attrToMap(attrs){for(var map={},i=0,ii=attrs.length;i<ii;i++){var attr=attrs[i];map[attr.name]=attr.value}return map}function encodeEntities(value){return value.replace(/&/g,"&amp;").replace(SURROGATE_PAIR_REGEXP,function(value){return"&#"+(1024*(value.charCodeAt(0)-55296)+(value.charCodeAt(1)-56320)+65536)+";"}).replace(NON_ALPHANUMERIC_REGEXP,function(value){return"&#"+value.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function stripCustomNsAttrs(node){for(;node;){if(node.nodeType===window.Node.ELEMENT_NODE)for(var attrs=node.attributes,i=0,l=attrs.length;i<l;i++){var attrNode=attrs[i],attrName=attrNode.name.toLowerCase();"xmlns:ns1"!==attrName&&0!==attrName.lastIndexOf("ns1:",0)||(node.removeAttributeNode(attrNode),i--,l--)}var nextNode=node.firstChild;nextNode&&stripCustomNsAttrs(nextNode),node=getNonDescendant("nextSibling",node)}}function getNonDescendant(propName,node){var nextNode=node[propName];if(nextNode&&nodeContains.call(node,nextNode))throw $sanitizeMinErr("elclob","Failed to sanitize html because the element is clobbered: {0}",node.outerHTML||node.outerText);return nextNode}}).info({angularVersion:"1.8.0"}),angular.module("ngSanitize").filter("linky",["$sanitize",function($sanitize){var LINKY_URL_REGEXP=/((s?ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,MAILTO_REGEXP=/^mailto:/i,linkyMinErr=angular.$$minErr("linky"),isDefined=angular.isDefined,isFunction=angular.isFunction,isObject=angular.isObject,isString=angular.isString;return function(text,target,attributes){if(null==text||""===text)return text;if(!isString(text))throw linkyMinErr("notstring","Expected string but received: {0}",text);for(var match,url,i,attributesFn=isFunction(attributes)?attributes:isObject(attributes)?function(){return attributes}:function(){return{}},raw=text,html=[];match=raw.match(LINKY_URL_REGEXP);)url=match[0],match[2]||match[4]||(url=(match[3]?"http://":"mailto:")+url),i=match.index,addText(raw.substr(0,i)),addLink(url,match[0].replace(MAILTO_REGEXP,"")),raw=raw.substring(i+match[0].length);return addText(raw),$sanitize(html.join(""));function addText(text){var chars,buf;text&&html.push((chars=text,htmlSanitizeWriter(buf=[],noop).chars(chars),buf.join("")))}function addLink(url,text){var key,linkAttributes=attributesFn(url);for(key in html.push("<a "),linkAttributes)html.push(key+'="'+linkAttributes[key]+'" ');!isDefined(target)||"target"in linkAttributes||html.push('target="',target,'" '),html.push('href="',url.replace(/"/g,"&quot;"),'">'),addText(text),html.push("</a>")}}}])}(window,window.angular),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global=global||self).Fuse=factory()}(this,function(){"use strict";function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread2(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function isArray(value){return Array.isArray?Array.isArray(value):"[object Array]"===getTag(value)}var INFINITY=1/0;function toString(value){return null==value?"":function(value){if("string"==typeof value)return value;var result=value+"";return"0"==result&&1/value==-INFINITY?"-0":result}(value)}function isString(value){return"string"==typeof value}function isNumber(value){return"number"==typeof value}function isBoolean(value){return!0===value||!1===value||function(value){return isObject(value)&&null!==value}(value)&&"[object Boolean]"==getTag(value)}function isObject(value){return"object"===_typeof(value)}function isDefined(value){return void 0!==value&&null!==value}function isBlank(value){return!value.trim().length}function getTag(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":Object.prototype.toString.call(value)}var LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY=function(key){return"Invalid value for key ".concat(key)},PATTERN_LENGTH_TOO_LARGE=function(max){return"Pattern length exceeds max of ".concat(max,".")},MISSING_KEY_PROPERTY=function(name){return"Missing ".concat(name," property in key")},INVALID_KEY_WEIGHT_VALUE=function(key){return"Property 'weight' in key '".concat(key,"' must be a positive integer")},hasOwn=Object.prototype.hasOwnProperty,KeyStore=function(){function KeyStore(keys){var _this=this;_classCallCheck(this,KeyStore),this._keys=[],this._keyMap={};var totalWeight=0;keys.forEach(function(key){var obj=createKey(key);totalWeight+=obj.weight,_this._keys.push(obj),_this._keyMap[obj.id]=obj,totalWeight+=obj.weight}),this._keys.forEach(function(key){key.weight/=totalWeight})}return _createClass(KeyStore,[{key:"get",value:function(keyId){return this._keyMap[keyId]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),KeyStore}();function createKey(key){var path=null,id=null,src=null,weight=1;if(isString(key)||isArray(key))src=key,path=createKeyPath(key),id=createKeyId(key);else{if(!hasOwn.call(key,"name"))throw new Error(MISSING_KEY_PROPERTY("name"));var name=key.name;if(src=name,hasOwn.call(key,"weight")&&(weight=key.weight)<=0)throw new Error(INVALID_KEY_WEIGHT_VALUE(name));path=createKeyPath(name),id=createKeyId(name)}return{path:path,id:id,weight:weight,src:src}}function createKeyPath(key){return isArray(key)?key:key.split(".")}function createKeyId(key){return isArray(key)?key.join("."):key}var Config=_objectSpread2({},{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(a,b){return a.score===b.score?a.idx<b.idx?-1:1:a.score<b.score?-1:1}},{},{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},{},{location:0,threshold:.6,distance:100},{},{useExtendedSearch:!1,getFn:function(obj,path){var list=[],arr=!1;return function deepGet(obj,path,index){if(path[index]){var value=obj[path[index]];if(!isDefined(value))return;if(index===path.length-1&&(isString(value)||isNumber(value)||isBoolean(value)))list.push(toString(value));else if(isArray(value)){arr=!0;for(var i=0,len=value.length;i<len;i+=1)deepGet(value[i],path,index+1)}else path.length&&deepGet(value,path,index+1)}else list.push(obj)}(obj,isString(path)?path.split("."):path,0),arr?list:list[0]},ignoreLocation:!1,ignoreFieldNorm:!1}),SPACE=/[^ ]+/g;var FuseIndex=function(){function FuseIndex(){var _ref$getFn=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).getFn,getFn=void 0===_ref$getFn?Config.getFn:_ref$getFn;_classCallCheck(this,FuseIndex),this.norm=function(){var mantissa=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,cache=new Map;return{get:function(value){var numTokens=value.match(SPACE).length;if(cache.has(numTokens))return cache.get(numTokens);var n=parseFloat((1/Math.sqrt(numTokens)).toFixed(mantissa));return cache.set(numTokens,n),n},clear:function(){cache.clear()}}}(3),this.getFn=getFn,this.isCreated=!1,this.setIndexRecords()}return _createClass(FuseIndex,[{key:"setSources",value:function(){var docs=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.docs=docs}},{key:"setIndexRecords",value:function(){var records=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.records=records}},{key:"setKeys",value:function(){var _this=this,keys=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.keys=keys,this._keysMap={},keys.forEach(function(key,idx){_this._keysMap[key.id]=idx})}},{key:"create",value:function(){var _this2=this;!this.isCreated&&this.docs.length&&(this.isCreated=!0,isString(this.docs[0])?this.docs.forEach(function(doc,docIndex){_this2._addString(doc,docIndex)}):this.docs.forEach(function(doc,docIndex){_this2._addObject(doc,docIndex)}),this.norm.clear())}},{key:"add",value:function(doc){var idx=this.size();isString(doc)?this._addString(doc,idx):this._addObject(doc,idx)}},{key:"removeAt",value:function(idx){this.records.splice(idx,1);for(var i=idx,len=this.size();i<len;i+=1)this.records[i].i-=1}},{key:"getValueForItemAtKeyId",value:function(item,keyId){return item[this._keysMap[keyId]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(doc,docIndex){if(isDefined(doc)&&!isBlank(doc)){var record={v:doc,i:docIndex,n:this.norm.get(doc)};this.records.push(record)}}},{key:"_addObject",value:function(doc,docIndex){var _this3=this,record={i:docIndex,$:{}};this.keys.forEach(function(key,keyIndex){var value=_this3.getFn(doc,key.path);if(isDefined(value))if(isArray(value))!function(){for(var subRecords=[],stack=[{nestedArrIndex:-1,value:value}];stack.length;){var _stack$pop=stack.pop(),nestedArrIndex=_stack$pop.nestedArrIndex,_value=_stack$pop.value;if(isDefined(_value))if(isString(_value)&&!isBlank(_value)){var subRecord={v:_value,i:nestedArrIndex,n:_this3.norm.get(_value)};subRecords.push(subRecord)}else isArray(_value)&&_value.forEach(function(item,k){stack.push({nestedArrIndex:k,value:item})})}record.$[keyIndex]=subRecords}();else if(!isBlank(value)){var subRecord={v:value,n:_this3.norm.get(value)};record.$[keyIndex]=subRecord}}),this.records.push(record)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),FuseIndex}();function createIndex(keys,docs){var _ref2$getFn=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).getFn,getFn=void 0===_ref2$getFn?Config.getFn:_ref2$getFn,myIndex=new FuseIndex({getFn:getFn});return myIndex.setKeys(keys.map(createKey)),myIndex.setSources(docs),myIndex.create(),myIndex}function transformMatches(result,data){var matches=result.matches;data.matches=[],isDefined(matches)&&matches.forEach(function(match){if(isDefined(match.indices)&&match.indices.length){var obj={indices:match.indices,value:match.value};match.key&&(obj.key=match.key.src),match.idx>-1&&(obj.refIndex=match.idx),data.matches.push(obj)}})}function transformScore(result,data){data.score=result.score}function computeScore(pattern){var _ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref$errors=_ref.errors,errors=void 0===_ref$errors?0:_ref$errors,_ref$currentLocation=_ref.currentLocation,currentLocation=void 0===_ref$currentLocation?0:_ref$currentLocation,_ref$expectedLocation=_ref.expectedLocation,expectedLocation=void 0===_ref$expectedLocation?0:_ref$expectedLocation,_ref$distance=_ref.distance,distance=void 0===_ref$distance?Config.distance:_ref$distance,_ref$ignoreLocation=_ref.ignoreLocation,ignoreLocation=void 0===_ref$ignoreLocation?Config.ignoreLocation:_ref$ignoreLocation,accuracy=errors/pattern.length;if(ignoreLocation)return accuracy;var proximity=Math.abs(expectedLocation-currentLocation);return distance?accuracy+proximity/distance:proximity?1:accuracy}var MAX_BITS=32;function search(text,pattern,patternAlphabet){var _ref=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},_ref$location=_ref.location,location=void 0===_ref$location?Config.location:_ref$location,_ref$distance=_ref.distance,distance=void 0===_ref$distance?Config.distance:_ref$distance,_ref$threshold=_ref.threshold,threshold=void 0===_ref$threshold?Config.threshold:_ref$threshold,_ref$findAllMatches=_ref.findAllMatches,findAllMatches=void 0===_ref$findAllMatches?Config.findAllMatches:_ref$findAllMatches,_ref$minMatchCharLeng=_ref.minMatchCharLength,minMatchCharLength=void 0===_ref$minMatchCharLeng?Config.minMatchCharLength:_ref$minMatchCharLeng,_ref$includeMatches=_ref.includeMatches,includeMatches=void 0===_ref$includeMatches?Config.includeMatches:_ref$includeMatches,_ref$ignoreLocation=_ref.ignoreLocation,ignoreLocation=void 0===_ref$ignoreLocation?Config.ignoreLocation:_ref$ignoreLocation;if(pattern.length>MAX_BITS)throw new Error(PATTERN_LENGTH_TOO_LARGE(MAX_BITS));for(var index,patternLen=pattern.length,textLen=text.length,expectedLocation=Math.max(0,Math.min(location,textLen)),currentThreshold=threshold,bestLocation=expectedLocation,computeMatches=minMatchCharLength>1||includeMatches,matchMask=computeMatches?Array(textLen):[];(index=text.indexOf(pattern,bestLocation))>-1;){var score=computeScore(pattern,{currentLocation:index,expectedLocation:expectedLocation,distance:distance,ignoreLocation:ignoreLocation});if(currentThreshold=Math.min(score,currentThreshold),bestLocation=index+patternLen,computeMatches)for(var i=0;i<patternLen;)matchMask[index+i]=1,i+=1}bestLocation=-1;for(var lastBitArr=[],finalScore=1,binMax=patternLen+textLen,mask=1<<patternLen-1,_i=0;_i<patternLen;_i+=1){for(var binMin=0,binMid=binMax;binMin<binMid;){computeScore(pattern,{errors:_i,currentLocation:expectedLocation+binMid,expectedLocation:expectedLocation,distance:distance,ignoreLocation:ignoreLocation})<=currentThreshold?binMin=binMid:binMax=binMid,binMid=Math.floor((binMax-binMin)/2+binMin)}binMax=binMid;var start=Math.max(1,expectedLocation-binMid+1),finish=findAllMatches?textLen:Math.min(expectedLocation+binMid,textLen)+patternLen,bitArr=Array(finish+2);bitArr[finish+1]=(1<<_i)-1;for(var j=finish;j>=start;j-=1){var currentLocation=j-1,charMatch=patternAlphabet[text.charAt(currentLocation)];if(computeMatches&&(matchMask[currentLocation]=+!!charMatch),bitArr[j]=(bitArr[j+1]<<1|1)&charMatch,_i&&(bitArr[j]|=(lastBitArr[j+1]|lastBitArr[j])<<1|1|lastBitArr[j+1]),bitArr[j]&mask&&(finalScore=computeScore(pattern,{errors:_i,currentLocation:currentLocation,expectedLocation:expectedLocation,distance:distance,ignoreLocation:ignoreLocation}))<=currentThreshold){if(currentThreshold=finalScore,(bestLocation=currentLocation)<=expectedLocation)break;start=Math.max(1,2*expectedLocation-bestLocation)}}if(computeScore(pattern,{errors:_i+1,currentLocation:expectedLocation,expectedLocation:expectedLocation,distance:distance,ignoreLocation:ignoreLocation})>currentThreshold)break;lastBitArr=bitArr}var result={isMatch:bestLocation>=0,score:Math.max(.001,finalScore)};if(computeMatches){var indices=function(){for(var matchmask=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],minMatchCharLength=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Config.minMatchCharLength,indices=[],start=-1,end=-1,i=0,len=matchmask.length;i<len;i+=1){var match=matchmask[i];match&&-1===start?start=i:match||-1===start||((end=i-1)-start+1>=minMatchCharLength&&indices.push([start,end]),start=-1)}return matchmask[i-1]&&i-start>=minMatchCharLength&&indices.push([start,i-1]),indices}(matchMask,minMatchCharLength);indices.length?includeMatches&&(result.indices=indices):result.isMatch=!1}return result}var BitapSearch=function(){function BitapSearch(pattern){var _this=this,_ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref$location=_ref.location,location=void 0===_ref$location?Config.location:_ref$location,_ref$threshold=_ref.threshold,threshold=void 0===_ref$threshold?Config.threshold:_ref$threshold,_ref$distance=_ref.distance,distance=void 0===_ref$distance?Config.distance:_ref$distance,_ref$includeMatches=_ref.includeMatches,includeMatches=void 0===_ref$includeMatches?Config.includeMatches:_ref$includeMatches,_ref$findAllMatches=_ref.findAllMatches,findAllMatches=void 0===_ref$findAllMatches?Config.findAllMatches:_ref$findAllMatches,_ref$minMatchCharLeng=_ref.minMatchCharLength,minMatchCharLength=void 0===_ref$minMatchCharLeng?Config.minMatchCharLength:_ref$minMatchCharLeng,_ref$isCaseSensitive=_ref.isCaseSensitive,isCaseSensitive=void 0===_ref$isCaseSensitive?Config.isCaseSensitive:_ref$isCaseSensitive,_ref$ignoreLocation=_ref.ignoreLocation,ignoreLocation=void 0===_ref$ignoreLocation?Config.ignoreLocation:_ref$ignoreLocation;if(_classCallCheck(this,BitapSearch),this.options={location:location,threshold:threshold,distance:distance,includeMatches:includeMatches,findAllMatches:findAllMatches,minMatchCharLength:minMatchCharLength,isCaseSensitive:isCaseSensitive,ignoreLocation:ignoreLocation},this.pattern=isCaseSensitive?pattern:pattern.toLowerCase(),this.chunks=[],this.pattern.length){var addChunk=function(pattern,startIndex){_this.chunks.push({pattern:pattern,alphabet:function(pattern){for(var mask={},i=0,len=pattern.length;i<len;i+=1){var char=pattern.charAt(i);mask[char]=(mask[char]||0)|1<<len-i-1}return mask}(pattern),startIndex:startIndex})},len=this.pattern.length;if(len>MAX_BITS){for(var i=0,remainder=len%MAX_BITS,end=len-remainder;i<end;)addChunk(this.pattern.substr(i,MAX_BITS),i),i+=MAX_BITS;if(remainder){var startIndex=len-MAX_BITS;addChunk(this.pattern.substr(startIndex),startIndex)}}else addChunk(this.pattern,0)}}return _createClass(BitapSearch,[{key:"searchIn",value:function(text){var _this$options=this.options,isCaseSensitive=_this$options.isCaseSensitive,includeMatches=_this$options.includeMatches;if(isCaseSensitive||(text=text.toLowerCase()),this.pattern===text){var _result={isMatch:!0,score:0};return includeMatches&&(_result.indices=[[0,text.length-1]]),_result}var _this$options2=this.options,location=_this$options2.location,distance=_this$options2.distance,threshold=_this$options2.threshold,findAllMatches=_this$options2.findAllMatches,minMatchCharLength=_this$options2.minMatchCharLength,ignoreLocation=_this$options2.ignoreLocation,allIndices=[],totalScore=0,hasMatches=!1;this.chunks.forEach(function(_ref2){var pattern=_ref2.pattern,alphabet=_ref2.alphabet,startIndex=_ref2.startIndex,_search=search(text,pattern,alphabet,{location:location+startIndex,distance:distance,threshold:threshold,findAllMatches:findAllMatches,minMatchCharLength:minMatchCharLength,includeMatches:includeMatches,ignoreLocation:ignoreLocation}),isMatch=_search.isMatch,score=_search.score,indices=_search.indices;isMatch&&(hasMatches=!0),totalScore+=score,isMatch&&indices&&(allIndices=[].concat(_toConsumableArray(allIndices),_toConsumableArray(indices)))});var result={isMatch:hasMatches,score:hasMatches?totalScore/this.chunks.length:1};return hasMatches&&includeMatches&&(result.indices=allIndices),result}}]),BitapSearch}(),BaseMatch=function(){function BaseMatch(pattern){_classCallCheck(this,BaseMatch),this.pattern=pattern}return _createClass(BaseMatch,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(pattern){return getMatch(pattern,this.multiRegex)}},{key:"isSingleMatch",value:function(pattern){return getMatch(pattern,this.singleRegex)}}]),BaseMatch}();function getMatch(pattern,exp){var matches=pattern.match(exp);return matches?matches[1]:null}var ExactMatch=function(_BaseMatch){_inherits(ExactMatch,BaseMatch);var _super=_createSuper(ExactMatch);function ExactMatch(pattern){return _classCallCheck(this,ExactMatch),_super.call(this,pattern)}return _createClass(ExactMatch,[{key:"search",value:function(text){var isMatch=text===this.pattern;return{isMatch:isMatch,score:isMatch?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),ExactMatch}(),InverseExactMatch=function(_BaseMatch){_inherits(InverseExactMatch,BaseMatch);var _super=_createSuper(InverseExactMatch);function InverseExactMatch(pattern){return _classCallCheck(this,InverseExactMatch),_super.call(this,pattern)}return _createClass(InverseExactMatch,[{key:"search",value:function(text){var isMatch=-1===text.indexOf(this.pattern);return{isMatch:isMatch,score:isMatch?0:1,indices:[0,text.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),InverseExactMatch}(),PrefixExactMatch=function(_BaseMatch){_inherits(PrefixExactMatch,BaseMatch);var _super=_createSuper(PrefixExactMatch);function PrefixExactMatch(pattern){return _classCallCheck(this,PrefixExactMatch),_super.call(this,pattern)}return _createClass(PrefixExactMatch,[{key:"search",value:function(text){var isMatch=text.startsWith(this.pattern);return{isMatch:isMatch,score:isMatch?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),PrefixExactMatch}(),InversePrefixExactMatch=function(_BaseMatch){_inherits(InversePrefixExactMatch,BaseMatch);var _super=_createSuper(InversePrefixExactMatch);function InversePrefixExactMatch(pattern){return _classCallCheck(this,InversePrefixExactMatch),_super.call(this,pattern)}return _createClass(InversePrefixExactMatch,[{key:"search",value:function(text){var isMatch=!text.startsWith(this.pattern);return{isMatch:isMatch,score:isMatch?0:1,indices:[0,text.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),InversePrefixExactMatch}(),SuffixExactMatch=function(_BaseMatch){_inherits(SuffixExactMatch,BaseMatch);var _super=_createSuper(SuffixExactMatch);function SuffixExactMatch(pattern){return _classCallCheck(this,SuffixExactMatch),_super.call(this,pattern)}return _createClass(SuffixExactMatch,[{key:"search",value:function(text){var isMatch=text.endsWith(this.pattern);return{isMatch:isMatch,score:isMatch?0:1,indices:[text.length-this.pattern.length,text.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),SuffixExactMatch}(),InverseSuffixExactMatch=function(_BaseMatch){_inherits(InverseSuffixExactMatch,BaseMatch);var _super=_createSuper(InverseSuffixExactMatch);function InverseSuffixExactMatch(pattern){return _classCallCheck(this,InverseSuffixExactMatch),_super.call(this,pattern)}return _createClass(InverseSuffixExactMatch,[{key:"search",value:function(text){var isMatch=!text.endsWith(this.pattern);return{isMatch:isMatch,score:isMatch?0:1,indices:[0,text.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),InverseSuffixExactMatch}(),FuzzyMatch=function(_BaseMatch){_inherits(FuzzyMatch,BaseMatch);var _super=_createSuper(FuzzyMatch);function FuzzyMatch(pattern){var _this,_ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref$location=_ref.location,location=void 0===_ref$location?Config.location:_ref$location,_ref$threshold=_ref.threshold,threshold=void 0===_ref$threshold?Config.threshold:_ref$threshold,_ref$distance=_ref.distance,distance=void 0===_ref$distance?Config.distance:_ref$distance,_ref$includeMatches=_ref.includeMatches,includeMatches=void 0===_ref$includeMatches?Config.includeMatches:_ref$includeMatches,_ref$findAllMatches=_ref.findAllMatches,findAllMatches=void 0===_ref$findAllMatches?Config.findAllMatches:_ref$findAllMatches,_ref$minMatchCharLeng=_ref.minMatchCharLength,minMatchCharLength=void 0===_ref$minMatchCharLeng?Config.minMatchCharLength:_ref$minMatchCharLeng,_ref$isCaseSensitive=_ref.isCaseSensitive,isCaseSensitive=void 0===_ref$isCaseSensitive?Config.isCaseSensitive:_ref$isCaseSensitive;return _classCallCheck(this,FuzzyMatch),(_this=_super.call(this,pattern))._bitapSearch=new BitapSearch(pattern,{location:location,threshold:threshold,distance:distance,includeMatches:includeMatches,findAllMatches:findAllMatches,minMatchCharLength:minMatchCharLength,isCaseSensitive:isCaseSensitive}),_this}return _createClass(FuzzyMatch,[{key:"search",value:function(text){return this._bitapSearch.searchIn(text)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),FuzzyMatch}(),IncludeMatch=function(_BaseMatch){_inherits(IncludeMatch,BaseMatch);var _super=_createSuper(IncludeMatch);function IncludeMatch(pattern){return _classCallCheck(this,IncludeMatch),_super.call(this,pattern)}return _createClass(IncludeMatch,[{key:"search",value:function(text){for(var index,location=0,indices=[],patternLen=this.pattern.length;(index=text.indexOf(this.pattern,location))>-1;)location=index+patternLen,indices.push([index,location-1]);var isMatch=!!indices.length;return{isMatch:isMatch,score:isMatch?1:0,indices:indices}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),IncludeMatch}(),searchers=[ExactMatch,IncludeMatch,PrefixExactMatch,InversePrefixExactMatch,InverseSuffixExactMatch,SuffixExactMatch,InverseExactMatch,FuzzyMatch],searchersLen=searchers.length,SPACE_RE=/ +(?=([^\"]*\"[^\"]*\")*[^\"]*$)/,OR_TOKEN="|";var MultiMatchSet=new Set([FuzzyMatch.type,IncludeMatch.type]),ExtendedSearch=function(){function ExtendedSearch(pattern){var _ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref$isCaseSensitive=_ref.isCaseSensitive,isCaseSensitive=void 0===_ref$isCaseSensitive?Config.isCaseSensitive:_ref$isCaseSensitive,_ref$includeMatches=_ref.includeMatches,includeMatches=void 0===_ref$includeMatches?Config.includeMatches:_ref$includeMatches,_ref$minMatchCharLeng=_ref.minMatchCharLength,minMatchCharLength=void 0===_ref$minMatchCharLeng?Config.minMatchCharLength:_ref$minMatchCharLeng,_ref$findAllMatches=_ref.findAllMatches,findAllMatches=void 0===_ref$findAllMatches?Config.findAllMatches:_ref$findAllMatches,_ref$location=_ref.location,location=void 0===_ref$location?Config.location:_ref$location,_ref$threshold=_ref.threshold,threshold=void 0===_ref$threshold?Config.threshold:_ref$threshold,_ref$distance=_ref.distance,distance=void 0===_ref$distance?Config.distance:_ref$distance;_classCallCheck(this,ExtendedSearch),this.query=null,this.options={isCaseSensitive:isCaseSensitive,includeMatches:includeMatches,minMatchCharLength:minMatchCharLength,findAllMatches:findAllMatches,location:location,threshold:threshold,distance:distance},this.pattern=isCaseSensitive?pattern:pattern.toLowerCase(),this.query=function(pattern){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return pattern.split(OR_TOKEN).map(function(item){for(var query=item.trim().split(SPACE_RE).filter(function(item){return item&&!!item.trim()}),results=[],i=0,len=query.length;i<len;i+=1){for(var queryItem=query[i],found=!1,idx=-1;!found&&++idx<searchersLen;){var searcher=searchers[idx],token=searcher.isMultiMatch(queryItem);token&&(results.push(new searcher(token,options)),found=!0)}if(!found)for(idx=-1;++idx<searchersLen;){var _searcher=searchers[idx],_token=_searcher.isSingleMatch(queryItem);if(_token){results.push(new _searcher(_token,options));break}}}return results})}(this.pattern,this.options)}return _createClass(ExtendedSearch,[{key:"searchIn",value:function(text){var query=this.query;if(!query)return{isMatch:!1,score:1};var _this$options=this.options,includeMatches=_this$options.includeMatches;text=_this$options.isCaseSensitive?text:text.toLowerCase();for(var numMatches=0,allIndices=[],totalScore=0,i=0,qLen=query.length;i<qLen;i+=1){var searchers=query[i];allIndices.length=0,numMatches=0;for(var j=0,pLen=searchers.length;j<pLen;j+=1){var searcher=searchers[j],_searcher$search=searcher.search(text),isMatch=_searcher$search.isMatch,indices=_searcher$search.indices,score=_searcher$search.score;if(!isMatch){totalScore=0,numMatches=0,allIndices.length=0;break}if(numMatches+=1,totalScore+=score,includeMatches){var type=searcher.constructor.type;MultiMatchSet.has(type)?allIndices=[].concat(_toConsumableArray(allIndices),_toConsumableArray(indices)):allIndices.push(indices)}}if(numMatches){var result={isMatch:!0,score:totalScore/numMatches};return includeMatches&&(result.indices=allIndices),result}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(_,options){return options.useExtendedSearch}}]),ExtendedSearch}(),registeredSearchers=[];function createSearcher(pattern,options){for(var i=0,len=registeredSearchers.length;i<len;i+=1){var searcherClass=registeredSearchers[i];if(searcherClass.condition(pattern,options))return new searcherClass(pattern,options)}return new BitapSearch(pattern,options)}var LogicalOperator_AND="$and",LogicalOperator_OR="$or",KeyType={PATH:"$path",PATTERN:"$val"},isExpression=function(query){return!(!query[LogicalOperator_AND]&&!query[LogicalOperator_OR])},isPath=function(query){return!!query[KeyType.PATH]},isLeaf=function(query){return!isArray(query)&&isObject(query)&&!isExpression(query)},convertToExplicit=function(query){return _defineProperty({},LogicalOperator_AND,Object.keys(query).map(function(key){return _defineProperty({},key,query[key])}))};function parse(query,options){var _ref3$auto=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).auto,auto=void 0===_ref3$auto||_ref3$auto;return isExpression(query)||(query=convertToExplicit(query)),function next(query){var keys=Object.keys(query),isQueryPath=isPath(query);if(!isQueryPath&&keys.length>1&&!isExpression(query))return next(convertToExplicit(query));if(isLeaf(query)){var key=isQueryPath?query[KeyType.PATH]:keys[0],pattern=isQueryPath?query[KeyType.PATTERN]:query[key];if(!isString(pattern))throw new Error(LOGICAL_SEARCH_INVALID_QUERY_FOR_KEY(key));var obj={keyId:createKeyId(key),pattern:pattern};return auto&&(obj.searcher=createSearcher(pattern,options)),obj}var node={children:[],operator:keys[0]};return keys.forEach(function(key){var value=query[key];isArray(value)&&value.forEach(function(item){node.children.push(next(item))})}),node}(query)}var Fuse=function(){function Fuse(docs){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},index=arguments.length>2?arguments[2]:void 0;_classCallCheck(this,Fuse),this.options=_objectSpread2({},Config,{},options),this.options.useExtendedSearch,this._keyStore=new KeyStore(this.options.keys),this.setCollection(docs,index)}return _createClass(Fuse,[{key:"setCollection",value:function(docs,index){if(this._docs=docs,index&&!(index instanceof FuseIndex))throw new Error("Incorrect 'index' type");this._myIndex=index||createIndex(this.options.keys,this._docs,{getFn:this.options.getFn})}},{key:"add",value:function(doc){isDefined(doc)&&(this._docs.push(doc),this._myIndex.add(doc))}},{key:"remove",value:function(){for(var predicate=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!1},results=[],i=0,len=this._docs.length;i<len;i+=1){var doc=this._docs[i];predicate(doc,i)&&(this.removeAt(i),i-=1,results.push(doc))}return results}},{key:"removeAt",value:function(idx){this._docs.splice(idx,1),this._myIndex.removeAt(idx)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(query){var _ref$limit=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).limit,limit=void 0===_ref$limit?-1:_ref$limit,_this$options=this.options,includeMatches=_this$options.includeMatches,includeScore=_this$options.includeScore,shouldSort=_this$options.shouldSort,sortFn=_this$options.sortFn,ignoreFieldNorm=_this$options.ignoreFieldNorm,results=isString(query)?isString(this._docs[0])?this._searchStringList(query):this._searchObjectList(query):this._searchLogical(query);return function(results,_ref8){var _ref8$ignoreFieldNorm=_ref8.ignoreFieldNorm,ignoreFieldNorm=void 0===_ref8$ignoreFieldNorm?Config.ignoreFieldNorm:_ref8$ignoreFieldNorm;results.forEach(function(result){var totalScore=1;result.matches.forEach(function(_ref9){var key=_ref9.key,norm=_ref9.norm,score=_ref9.score,weight=key?key.weight:null;totalScore*=Math.pow(0===score&&weight?Number.EPSILON:score,(weight||1)*(ignoreFieldNorm?1:norm))}),result.score=totalScore})}(results,{ignoreFieldNorm:ignoreFieldNorm}),shouldSort&&results.sort(sortFn),isNumber(limit)&&limit>-1&&(results=results.slice(0,limit)),function(results,docs){var _ref10=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_ref10$includeMatches=_ref10.includeMatches,includeMatches=void 0===_ref10$includeMatches?Config.includeMatches:_ref10$includeMatches,_ref10$includeScore=_ref10.includeScore,includeScore=void 0===_ref10$includeScore?Config.includeScore:_ref10$includeScore,transformers=[];includeMatches&&transformers.push(transformMatches);includeScore&&transformers.push(transformScore);return results.map(function(result){var idx=result.idx,data={item:docs[idx],refIndex:idx};return transformers.length&&transformers.forEach(function(transformer){transformer(result,data)}),data})}(results,this._docs,{includeMatches:includeMatches,includeScore:includeScore})}},{key:"_searchStringList",value:function(query){var searcher=createSearcher(query,this.options),results=[];return this._myIndex.records.forEach(function(_ref2){var text=_ref2.v,idx=_ref2.i,norm=_ref2.n;if(isDefined(text)){var _searcher$searchIn=searcher.searchIn(text),isMatch=_searcher$searchIn.isMatch,score=_searcher$searchIn.score,indices=_searcher$searchIn.indices;isMatch&&results.push({item:text,idx:idx,matches:[{score:score,value:text,norm:norm,indices:indices}]})}}),results}},{key:"_searchLogical",value:function(query){var _this=this,expression=parse(query,this.options),resultMap={},results=[];return this._myIndex.records.forEach(function(_ref3){var item=_ref3.$,idx=_ref3.i;if(isDefined(item)){var expResults=function evaluate(node,item,idx){if(!node.children){var keyId=node.keyId,searcher=node.searcher,matches=_this._findMatches({key:_this._keyStore.get(keyId),value:_this._myIndex.getValueForItemAtKeyId(item,keyId),searcher:searcher});return matches&&matches.length?[{idx:idx,item:item,matches:matches}]:[]}switch(node.operator){case LogicalOperator_AND:for(var res=[],i=0,len=node.children.length;i<len;i+=1){var result=evaluate(node.children[i],item,idx);if(!result.length)return[];res.push.apply(res,_toConsumableArray(result))}return res;case LogicalOperator_OR:for(var _res=[],_i=0,_len=node.children.length;_i<_len;_i+=1){var _result=evaluate(node.children[_i],item,idx);if(_result.length){_res.push.apply(_res,_toConsumableArray(_result));break}}return _res}}(expression,item,idx);expResults.length&&(resultMap[idx]||(resultMap[idx]={idx:idx,item:item,matches:[]},results.push(resultMap[idx])),expResults.forEach(function(_ref4){var _resultMap$idx$matche,matches=_ref4.matches;(_resultMap$idx$matche=resultMap[idx].matches).push.apply(_resultMap$idx$matche,_toConsumableArray(matches))}))}}),results}},{key:"_searchObjectList",value:function(query){var _this2=this,searcher=createSearcher(query,this.options),_this$_myIndex=this._myIndex,keys=_this$_myIndex.keys,results=[];return _this$_myIndex.records.forEach(function(_ref5){var item=_ref5.$,idx=_ref5.i;if(isDefined(item)){var matches=[];keys.forEach(function(key,keyIndex){matches.push.apply(matches,_toConsumableArray(_this2._findMatches({key:key,value:item[keyIndex],searcher:searcher})))}),matches.length&&results.push({idx:idx,item:item,matches:matches})}}),results}},{key:"_findMatches",value:function(_ref6){var key=_ref6.key,value=_ref6.value,searcher=_ref6.searcher;if(!isDefined(value))return[];var matches=[];if(isArray(value))value.forEach(function(_ref7){var text=_ref7.v,idx=_ref7.i,norm=_ref7.n;if(isDefined(text)){var _searcher$searchIn2=searcher.searchIn(text),isMatch=_searcher$searchIn2.isMatch,score=_searcher$searchIn2.score,indices=_searcher$searchIn2.indices;isMatch&&matches.push({score:score,key:key,value:text,idx:idx,norm:norm,indices:indices})}});else{var text=value.v,norm=value.n,_searcher$searchIn3=searcher.searchIn(text),isMatch=_searcher$searchIn3.isMatch,score=_searcher$searchIn3.score,indices=_searcher$searchIn3.indices;isMatch&&matches.push({score:score,key:key,value:text,norm:norm,indices:indices})}return matches}}]),Fuse}();return Fuse.version="6.4.1",Fuse.createIndex=createIndex,Fuse.parseIndex=function(data){var _ref3$getFn=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getFn,getFn=void 0===_ref3$getFn?Config.getFn:_ref3$getFn,keys=data.keys,records=data.records,myIndex=new FuseIndex({getFn:getFn});return myIndex.setKeys(keys),myIndex.setIndexRecords(records),myIndex},Fuse.config=Config,Fuse.parseQuery=parse,function(){registeredSearchers.push.apply(registeredSearchers,arguments)}(ExtendedSearch),Fuse}),function(global,factory){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){"use strict";var arr=[],getProto=Object.getPrototypeOf,slice=arr.slice,flat=arr.flat?function(array){return arr.flat.call(array)}:function(array){return arr.concat.apply([],array)},push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),support={},isFunction=function(obj){return"function"==typeof obj&&"number"!=typeof obj.nodeType},isWindow=function(obj){return null!=obj&&obj===obj.window},document=window.document,preservedScriptAttributes={type:!0,src:!0,nonce:!0,noModule:!0};function DOMEval(code,node,doc){var i,val,script=(doc=doc||document).createElement("script");if(script.text=code,node)for(i in preservedScriptAttributes)(val=node[i]||node.getAttribute&&node.getAttribute(i))&&script.setAttribute(i,val);doc.head.appendChild(script).parentNode.removeChild(script)}function toType(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj}var jQuery=function(selector,context){return new jQuery.fn.init(selector,context)};function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=toType(obj);return!isFunction(obj)&&!isWindow(obj)&&("array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj)}jQuery.fn=jQuery.prototype={jquery:"3.5.1",constructor:jQuery,length:0,toArray:function(){return slice.call(this)},get:function(num){return null==num?slice.call(this):num<0?this[num+this.length]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(jQuery.grep(this,function(_elem,i){return(i+1)%2}))},odd:function(){return this.pushStack(jQuery.grep(this,function(_elem,i){return i%2}))},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)copy=options[name],"__proto__"!==name&&target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))?(src=target[name],clone=copyIsArray&&!Array.isArray(src)?[]:copyIsArray||jQuery.isPlainObject(src)?src:{},copyIsArray=!1,target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isPlainObject:function(obj){var proto,Ctor;return!(!obj||"[object Object]"!==toString.call(obj))&&(!(proto=getProto(obj))||"function"==typeof(Ctor=hasOwn.call(proto,"constructor")&&proto.constructor)&&fnToString.call(Ctor)===ObjectFunctionString)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},globalEval:function(code,options,doc){DOMEval(code,{nonce:options&&options.nonce},doc)},each:function(obj,callback){var length,i=0;if(isArrayLike(obj))for(length=obj.length;i<length&&!1!==callback.call(obj[i],i,obj[i]);i++);else for(i in obj)if(!1===callback.call(obj[i],i,obj[i]))break;return obj},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var matches=[],i=0,length=elems.length,callbackExpect=!invert;i<length;i++)!callback(elems[i],i)!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems))for(length=elems.length;i<length;i++)null!=(value=callback(elems[i],i,arg))&&ret.push(value);else for(i in elems)null!=(value=callback(elems[i],i,arg))&&ret.push(value);return flat(ret)},guid:1,support:support}),"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(_i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),nonnativeSelectorCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,pushNative=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\[\\da-fA-F]{1,6}"+whitespace+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rdescend=new RegExp(whitespace+"|>"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rhtml=/HTML$/i,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\[\\da-fA-F]{1,6}"+whitespace+"?|\\\\([^\\r\\n\\f])","g"),funescape=function(escape,nonHex){var high="0x"+escape.slice(1)-65536;return nonHex||(high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320))},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){return asCodePoint?"\0"===ch?"�":ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" ":"\\"+ch},unloadHandler=function(){setDocument()},inDisabledFieldset=addCombinator(function(elem){return!0===elem.disabled&&"fieldset"===elem.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){pushNative.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;if(results=results||[],"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&(setDocument(context),context=context||document,documentIsHTML)){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m)return results.push(elem),results}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&!nonnativeSelectorCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))&&(1!==nodeType||"object"!==context.nodeName.toLowerCase())){if(newSelector=selector,newContext=context,1===nodeType&&(rdescend.test(selector)||rcombinators.test(selector))){for((newContext=rsibling.test(selector)&&testContext(context.parentNode)||context)===context&&support.scope||((nid=context.getAttribute("id"))?nid=nid.replace(rcssescape,fcssescape):context.setAttribute("id",nid=expando)),i=(groups=tokenize(selector)).length;i--;)groups[i]=(nid?"#"+nid:":scope")+" "+toSelector(groups[i]);newSelector=groups.join(",")}try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){nonnativeSelectorCache(selector,!0)}finally{nid===expando&&context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];return function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el)}catch(e){return!1}finally{el.parentNode&&el.parentNode.removeChild(el),el=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){return"input"===elem.nodeName.toLowerCase()&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}function createDisabledPseudo(disabled){return function(elem){return"form"in elem?elem.parentNode&&!1===elem.disabled?"label"in elem?"label"in elem.parentNode?elem.parentNode.disabled===disabled:elem.disabled===disabled:elem.isDisabled===disabled||elem.isDisabled!==!disabled&&inDisabledFieldset(elem)===disabled:elem.disabled===disabled:"label"in elem&&elem.disabled===disabled}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&void 0!==context.getElementsByTagName&&context}for(i in support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var namespace=elem.namespaceURI,docElem=(elem.ownerDocument||elem).documentElement;return!rhtml.test(namespace||docElem&&docElem.nodeName||"HTML")},setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;return doc!=document&&9===doc.nodeType&&doc.documentElement?(docElem=(document=doc).documentElement,documentIsHTML=!isXML(document),preferredDoc!=document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow&&(subWindow.addEventListener?subWindow.addEventListener("unload",unloadHandler,!1):subWindow.attachEvent&&subWindow.attachEvent("onunload",unloadHandler)),support.scope=assert(function(el){return docElem.appendChild(el).appendChild(document.createElement("div")),void 0!==el.querySelectorAll&&!el.querySelectorAll(":scope fieldset div").length}),support.attributes=assert(function(el){return el.className="i",!el.getAttribute("className")}),support.getElementsByTagName=assert(function(el){return el.appendChild(document.createComment("")),!el.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(el){return docElem.appendChild(el).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length}),support.getById?(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[]}}):(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=void 0!==elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem];for(elems=context.getElementsByName(id),i=0;elem=elems[i++];)if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem]}return[]}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return void 0!==context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(void 0!==context.getElementsByClassName&&documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(el){var input;docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>",el.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),el.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),el.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),(input=document.createElement("input")).setAttribute("name",""),el.appendChild(input),el.querySelectorAll("[name='']").length||rbuggyQSA.push("\\["+whitespace+"*name"+whitespace+"*="+whitespace+"*(?:''|\"\")"),el.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),el.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]"),el.querySelectorAll("\\\f"),rbuggyQSA.push("[\\r\\n\\f]")}),assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden"),el.appendChild(input).setAttribute("name","D"),el.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),2!==el.querySelectorAll(":enabled").length&&rbuggyQSA.push(":enabled",":disabled"),docElem.appendChild(el).disabled=!0,2!==el.querySelectorAll(":disabled").length&&rbuggyQSA.push(":enabled",":disabled"),el.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(el){support.disconnectedMatch=matches.call(el,"*"),matches.call(el,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare||(1&(compare=(a.ownerDocument||a)==(b.ownerDocument||b)?a.compareDocumentPosition(b):1)||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a==document||a.ownerDocument==preferredDoc&&contains(preferredDoc,a)?-1:b==document||b.ownerDocument==preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a==document?-1:b==document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]==preferredDoc?-1:bp[i]==preferredDoc?1:0},document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if(setDocument(elem),support.matchesSelector&&documentIsHTML&&!nonnativeSelectorCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){nonnativeSelectorCache(expr,!0)}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!=document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!=document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape)},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},(Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||void 0!==elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,_argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,_context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(diff=(nodeIndex=(cache=(uniqueCache=(outerCache=(node=parent)[expando]||(node[expando]={}))[node.uniqueID]||(outerCache[node.uniqueID]={}))[type]||[])[0]===dirruns&&cache[1])&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(diff=nodeIndex=(cache=(uniqueCache=(outerCache=(node=elem)[expando]||(node[expando]={}))[node.uniqueID]||(outerCache[node.uniqueID]={}))[type]||[])[0]===dirruns&&cache[1]),!1===diff)for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&((uniqueCache=(outerCache=node[expando]||(node[expando]={}))[node.uniqueID]||(outerCache[node.uniqueID]={}))[type]=[dirruns,diff]),node!==elem)););return(diff-=last)===first||diff%first==0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)seed[idx=indexOf(seed,matched[i])]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,_context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,_context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return(elemLang=elemLang.toLowerCase())===lang||0===elemLang.indexOf(lang+"-")}while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:createDisabledPseudo(!1),disabled:createDisabledPseudo(!0),checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,!0===elem.selected},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(_matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(_matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument>length?length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}}).pseudos.nth=Expr.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=createButtonPseudo(i);function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&"parentNode"===key,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml);return!1}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(uniqueCache=(outerCache=elem[expando]||(elem[expando]={}))[elem.uniqueID]||(outerCache[elem.uniqueID]={}),skip&&skip===elem.nodeName.toLowerCase())elem=elem[dir]||elem;else{if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(uniqueCache[key]=newCache,newCache[2]=matcher(elem,context,xml))return!0}return!1}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||function(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if((matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches))[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){for(type in matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length)),Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)(cached=matcherFromTokens(match[i]))[expando]?setMatchers.push(cached):elementMatchers.push(cached);(cached=compilerCache(selector,function(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context==document||context||outermost);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0,context||elem.ownerDocument==document||(setDocument(elem),xml=!documentIsHTML);matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}(elementMatchers,setMatchers))).selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if((tokens=match[0]=match[0].slice(0)).length>2&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(!(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0]))return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),!(selector=seed.length&&toSelector(tokens)))return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),support.sortDetached=assert(function(el){return 1&el.compareDocumentPosition(document.createElement("fieldset"))}),assert(function(el){return el.innerHTML="<a href='#'></a>","#"===el.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(el){return el.innerHTML="<input/>",el.firstChild.setAttribute("value",""),""===el.firstChild.getAttribute("value")})||addHandle("value",function(elem,_name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(el){return null==el.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return!0===elem[name]?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains,jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext;function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()}var rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function winnow(elements,qualifier,not){return isFunction(qualifier)?jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not}):qualifier.nodeType?jQuery.grep(elements,function(elem){return elem===qualifier!==not}):"string"!=typeof qualifier?jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not}):jQuery.filter(qualifier,elements,not)}jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(ret=this.pushStack([]),i=0;i<len;i++)jQuery.find(selector,self[i],ret);return len>1?jQuery.uniqueSort(ret):ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,"string"==typeof selector){if(!(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector))||!match[1]&&context)return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return(elem=document.getElementById(match[2]))&&(this[0]=elem,this.length=1),this}return selector.nodeType?(this[0]=selector,this.length=1,this):isFunction(selector)?void 0!==root.ready?root.ready(selector):selector(jQuery):jQuery.makeArray(selector,this)}).prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;i<l;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets="string"!=typeof selectors&&jQuery(selectors);if(!rneedsContext.test(selectors))for(;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(targets?targets.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,_i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,_i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,_i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return null!=elem.contentDocument&&getProto(elem.contentDocument)?elem.contentDocument:(nodeName(elem,"template")&&(elem=elem.content||elem),jQuery.merge([],elem.childNodes))}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;function Identity(v){return v}function Thrower(ex){throw ex}function adoptValue(value,resolve,reject,noValue){var method;try{value&&isFunction(method=value.promise)?method.call(value).done(resolve).fail(reject):value&&isFunction(method=value.then)?method.call(value,resolve,reject):resolve.apply(void 0,[value].slice(noValue))}catch(value){reject.apply(void 0,[value])}}jQuery.Callbacks=function(options){options="string"==typeof options?function(options){var object={};return jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=!0}),object}(options):jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){for(locked=locked||options.once,fired=firing=!0;queue.length;firingIndex=-1)for(memory=queue.shift();++firingIndex<list.length;)!1===list[firingIndex].apply(memory[0],memory[1])&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);options.memory||(memory=!1),firing=!1,locked&&(list=memory?[]:"")},self={add:function(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==toType(arg)&&add(arg)})}(arguments),memory&&!firing&&fire()),this},remove:function(){return jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),index<=firingIndex&&firingIndex--}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0},empty:function(){return list&&(list=[]),this},disable:function(){return locked=queue=[],list=memory="",this},disabled:function(){return!list},lock:function(){return locked=queue=[],memory||firing||(list=memory=""),this},locked:function(){return!!locked},fireWith:function(context,args){return locked||(args=[context,(args=args||[]).slice?args.slice():args],queue.push(args),firing||fire()),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},catch:function(fn){return promise.then(null,fn)},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(_i,tuple){var fn=isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this,fn?[returned]:arguments)})}),fns=null}).promise()},then:function(onFulfilled,onRejected,onProgress){var maxDepth=0;function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(!(depth<maxDepth)){if((returned=handler.apply(that,args))===deferred.promise())throw new TypeError("Thenable self-resolution");then=returned&&("object"==typeof returned||"function"==typeof returned)&&returned.then,isFunction(then)?special?then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special)):(maxDepth++,then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))):(handler!==Identity&&(that=void 0,args=[returned]),(special||deferred.resolveWith)(that,args))}},process=special?mightThrow:function(){try{mightThrow()}catch(e){jQuery.Deferred.exceptionHook&&jQuery.Deferred.exceptionHook(e,process.stackTrace),depth+1>=maxDepth&&(handler!==Thrower&&(that=void 0,args=[e]),deferred.rejectWith(that,args))}};depth?process():(jQuery.Deferred.getStackHook&&(process.stackTrace=jQuery.Deferred.getStackHook()),window.setTimeout(process))}}return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith)),tuples[1][3].add(resolve(0,newDefer,isFunction(onFulfilled)?onFulfilled:Identity)),tuples[2][3].add(resolve(0,newDefer,isFunction(onRejected)?onRejected:Thrower))}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[3-i][2].disable,tuples[3-i][3].disable,tuples[0][2].lock,tuples[0][3].lock),list.add(tuple[3].fire),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?void 0:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this,resolveValues[i]=arguments.length>1?slice.call(arguments):value,--remaining||master.resolveWith(resolveContexts,resolveValues)}};if(remaining<=1&&(adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining),"pending"===master.state()||isFunction(resolveValues[i]&&resolveValues[i].then)))return master.then();for(;i--;)adoptValue(resolveValues[i],updateFunc(i),master.reject);return master.promise()}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){window.console&&window.console.warn&&error&&rerrorNames.test(error.name)&&window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack)},jQuery.readyException=function(error){window.setTimeout(function(){throw error})};var readyList=jQuery.Deferred();function completed(){document.removeEventListener("DOMContentLoaded",completed),window.removeEventListener("load",completed),jQuery.ready()}jQuery.fn.ready=function(fn){return readyList.then(fn).catch(function(error){jQuery.readyException(error)}),this},jQuery.extend({isReady:!1,readyWait:1,ready:function(wait){(!0===wait?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,!0!==wait&&--jQuery.readyWait>0||readyList.resolveWith(document,[jQuery]))}}),jQuery.ready.then=readyList.then,"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed),window.addEventListener("load",completed));var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===toType(key))for(i in chainable=!0,key)access(elems,fn,i,key[i],!0,emptyGet,raw);else if(void 0!==value&&(chainable=!0,isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,_key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet},rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g;function fcamelCase(_all,letter){return letter.toUpperCase()}function camelCase(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)}var acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};function Data(){this.expando=jQuery.expando+Data.uid++}Data.uid=1,Data.prototype={cache:function(owner){var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value},set:function(owner,data,value){var prop,cache=this.cache(owner);if("string"==typeof data)cache[camelCase(data)]=value;else for(prop in data)cache[camelCase(prop)]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][camelCase(key)]},access:function(owner,key,value){return void 0===key||key&&"string"==typeof key&&void 0===value?this.get(owner,key):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,cache=owner[this.expando];if(void 0!==cache){if(void 0!==key){i=(key=Array.isArray(key)?key.map(camelCase):(key=camelCase(key))in cache?[key]:key.match(rnothtmlwhite)||[]).length;for(;i--;)delete cache[key[i]]}(void 0===key||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$&").toLowerCase(),"string"==typeof(data=elem.getAttribute(name))){try{data=function(data){return"true"===data||"false"!==data&&("null"===data?null:data===+data+""?+data:rbrace.test(data)?JSON.parse(data):data)}(data)}catch(e){}dataUser.set(elem,key,data)}else data=void 0;return data}jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=dataUser.get(elem),1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&0===(name=attrs[i].name).indexOf("data-")&&(name=camelCase(name.slice(5)),dataAttr(elem,name,data[name]));dataPriv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data;if(elem&&void 0===value)return void 0!==(data=dataUser.get(elem,key))?data:void 0!==(data=dataAttr(elem,key))?data:void 0;this.each(function(){dataUser.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=dataPriv.get(elem,type),data&&(!queue||Array.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type);"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,function(){jQuery.dequeue(elem,type)},hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)(tmp=dataPriv.get(elements[i],type+"queueHooks"))&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],documentElement=document.documentElement,isAttached=function(elem){return jQuery.contains(elem.ownerDocument,elem)},composed={composed:!0};documentElement.getRootNode&&(isAttached=function(elem){return jQuery.contains(elem.ownerDocument,elem)||elem.getRootNode(composed)===elem.ownerDocument});var isHiddenWithinTree=function(elem,el){return"none"===(elem=el||elem).style.display||""===elem.style.display&&isAttached(elem)&&"none"===jQuery.css(elem,"display")};function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=elem.nodeType&&(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){for(initial/=2,unit=unit||initialInUnit[3],initialInUnit=+initial||1;maxIterations--;)jQuery.style(elem,prop,initialInUnit+unit),(1-scale)*(1-(scale=currentValue()/initial||.5))<=0&&(maxIterations=0),initialInUnit/=scale;initialInUnit*=2,jQuery.style(elem,prop,initialInUnit+unit),valueParts=valueParts||[]}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted}var defaultDisplayMap={};function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];return display||(temp=doc.body.appendChild(doc.createElement(nodeName)),display=jQuery.css(temp,"display"),temp.parentNode.removeChild(temp),"none"===display&&(display="block"),defaultDisplayMap[nodeName]=display,display)}function showHide(elements,show){for(var display,elem,values=[],index=0,length=elements.length;index<length;index++)(elem=elements[index]).style&&(display=elem.style.display,show?("none"===display&&(values[index]=dataPriv.get(elem,"display")||null,values[index]||(elem.style.display="")),""===elem.style.display&&isHiddenWithinTree(elem)&&(values[index]=getDefaultDisplay(elem))):"none"!==display&&(values[index]="none",dataPriv.set(elem,"display",display)));for(index=0;index<length;index++)null!=values[index]&&(elements[index].style.display=values[index]);return elements}jQuery.fn.extend({show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHiddenWithinTree(this)?jQuery(this).show():jQuery(this).hide()})}});var div,input,rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,rscriptType=/^$|^module$|\/(?:java|ecma)script/i;div=document.createDocumentFragment().appendChild(document.createElement("div")),(input=document.createElement("input")).setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue,div.innerHTML="<option></option>",support.option=!!div.lastChild;var wrapMap={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function getAll(context,tag){var ret;return ret=void 0!==context.getElementsByTagName?context.getElementsByTagName(tag||"*"):void 0!==context.querySelectorAll?context.querySelectorAll(tag||"*"):[],void 0===tag||tag&&nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;i<l;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td,support.option||(wrapMap.optgroup=wrapMap.option=[1,"<select multiple='multiple'>","</select>"]);var rhtml=/<|&#?\w+;/;function buildFragment(elems,context,scripts,selection,ignored){for(var elem,tmp,tag,wrap,attached,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;i<l;i++)if((elem=elems[i])||0===elem)if("object"===toType(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),(tmp=fragment.firstChild).textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if(selection&&jQuery.inArray(elem,selection)>-1)ignored&&ignored.push(elem);else if(attached=isAttached(elem),tmp=getAll(fragment.appendChild(elem),"script"),attached&&setGlobalEval(tmp),scripts)for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment}var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;function returnTrue(){return!0}function returnFalse(){return!1}function expectSync(elem,type){return elem===function(){try{return document.activeElement}catch(err){}}()==("focus"===type)}function on(elem,types,selector,data,fn,one){var origFn,type;if("object"==typeof types){for(type in"string"!=typeof selector&&(data=data||selector,selector=void 0),types)on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),!1===fn)fn=returnFalse;else if(!fn)return elem;return 1===one&&(origFn=fn,(fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)}).guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function leverageNative(el,type,expectSync){expectSync?(dataPriv.set(el,type,!1),jQuery.event.add(el,type,{namespace:!1,handler:function(event){var notAsync,result,saved=dataPriv.get(this,type);if(1&event.isTrigger&&this[type]){if(saved.length)(jQuery.event.special[type]||{}).delegateType&&event.stopPropagation();else if(saved=slice.call(arguments),dataPriv.set(this,type,saved),notAsync=expectSync(this,type),this[type](),saved!==(result=dataPriv.get(this,type))||notAsync?dataPriv.set(this,type,!1):result={},saved!==result)return event.stopImmediatePropagation(),event.preventDefault(),result.value}else saved.length&&(dataPriv.set(this,type,{value:jQuery.event.trigger(jQuery.extend(saved[0],jQuery.Event.prototype),saved.slice(1),this)}),event.stopImmediatePropagation())}})):void 0===dataPriv.get(el,type)&&jQuery.event.add(el,type,returnTrue)}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(acceptData(elem))for(handler.handler&&(handler=(handleObjIn=handler).handler,selector=handleObjIn.selector),selector&&jQuery.find.matchesSelector(documentElement,selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events=Object.create(null)),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return void 0!==jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),t=(types=(types||"").match(rnothtmlwhite)||[""]).length;t--;)type=origType=(tmp=rtypenamespace.exec(types[t])||[])[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||((handlers=events[type]=[]).delegateCount=0,special.setup&&!1!==special.setup.call(elem,data,namespaces,eventHandle)||elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(elemData&&(events=elemData.events)){for(t=(types=(types||"").match(rnothtmlwhite)||[""]).length;t--;)if(type=origType=(tmp=rtypenamespace.exec(types[t])||[])[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},handlers=events[type=(selector?special.delegateType:special.bindType)||type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&!1!==special.teardown.call(elem,namespaces,elemData.handle)||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(nativeEvent){var i,j,ret,matched,handleObj,handlerQueue,args=new Array(arguments.length),event=jQuery.event.fix(nativeEvent),handlers=(dataPriv.get(this,"events")||Object.create(null))[event.type]||[],special=jQuery.event.special[event.type]||{};for(args[0]=event,i=1;i<arguments.length;i++)args[i]=arguments[i];if(event.delegateTarget=this,!special.preDispatch||!1!==special.preDispatch.call(this,event)){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.rnamespace&&!1!==handleObj.namespace&&!event.rnamespace.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,void 0!==(ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args))&&!1===(event.result=ret)&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!("click"===event.type&&event.button>=1))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&("click"!==event.type||!0!==cur.disabled)){for(matchedHandlers=[],matchedSelectors={},i=0;i<delegateCount;i++)void 0===matchedSelectors[sel=(handleObj=handlers[i]).selector+" "]&&(matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length),matchedSelectors[sel]&&matchedHandlers.push(handleObj);matchedHandlers.length&&handlerQueue.push({elem:cur,handlers:matchedHandlers})}return cur=this,delegateCount<handlers.length&&handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)}),handlerQueue},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:!0,configurable:!0,get:isFunction(hook)?function(){if(this.originalEvent)return hook(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[name]},set:function(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value:value})}})},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent)},special:{load:{noBubble:!0},click:{setup:function(data){var el=this||data;return rcheckableType.test(el.type)&&el.click&&nodeName(el,"input")&&leverageNative(el,"click",returnTrue),!1},trigger:function(data){var el=this||data;return rcheckableType.test(el.type)&&el.click&&nodeName(el,"input")&&leverageNative(el,"click"),!0},_default:function(event){var target=event.target;return rcheckableType.test(target.type)&&target.click&&nodeName(target,"input")&&dataPriv.get(target,"click")||nodeName(target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)},jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&!1===src.returnValue?returnTrue:returnFalse,this.target=src.target&&3===src.target.nodeType?src.target.parentNode:src.target,this.currentTarget=src.currentTarget,this.relatedTarget=src.relatedTarget):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||Date.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(event){var button=event.button;return null==event.which&&rkeyEvent.test(event.type)?null!=event.charCode?event.charCode:event.keyCode:!event.which&&void 0!==button&&rmouseEvent.test(event.type)?1&button?1:2&button?3:4&button?2:0:event.which}},jQuery.event.addProp),jQuery.each({focus:"focusin",blur:"focusout"},function(type,delegateType){jQuery.event.special[type]={setup:function(){return leverageNative(this,type,expectSync),!1},trigger:function(){return leverageNative(this,type),!0},delegateType:delegateType}}),jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===this||jQuery.contains(this,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return!1!==selector&&"function"!=typeof selector||(fn=selector,selector=void 0),!1===fn&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function manipulationTarget(elem,content){return nodeName(elem,"table")&&nodeName(11!==content.nodeType?content:content.firstChild,"tr")&&jQuery(elem).children("tbody")[0]||elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){return"true/"===(elem.type||"").slice(0,5)?elem.type=elem.type.slice(5):elem.removeAttribute("type"),elem}function cloneCopyEvent(src,dest){var i,l,type,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)&&(events=dataPriv.get(src).events))for(type in dataPriv.remove(dest,"handle events"),events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i]);dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur))}}function domManip(collection,args,callback,ignored){args=flat(args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],valueIsFunction=isFunction(value);if(valueIsFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);valueIsFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored)});if(l&&(first=(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored)).firstChild,1===fragment.childNodes.length&&(fragment=first),first||ignored)){for(hasScripts=(scripts=jQuery.map(getAll(fragment,"script"),disableScript)).length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src&&"module"!==(node.type||"").toLowerCase()?jQuery._evalUrl&&!node.noModule&&jQuery._evalUrl(node.src,{nonce:node.nonce||node.getAttribute("nonce")},doc):DOMEval(node.textContent.replace(rcleanScript,""),node,doc))}return collection}function remove(elem,selector,keepData){for(var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;null!=(node=nodes[i]);i++)keepData||1!==node.nodeType||jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&isAttached(node)&&setGlobalEval(getAll(node,"script")),node.parentNode.removeChild(node));return elem}jQuery.extend({htmlPrefilter:function(html){return html},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,src,dest,nodeName,clone=elem.cloneNode(!0),inPage=isAttached(elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),i=0,l=(srcElements=getAll(elem)).length;i<l;i++)src=srcElements[i],dest=destElements[i],void 0,"input"===(nodeName=dest.nodeName.toLowerCase())&&rcheckableType.test(src.type)?dest.checked=src.checked:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;i<l;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return(destElements=getAll(clone,"script")).length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},cleanData:function(elems){for(var data,elem,type,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}}),jQuery.fn.extend({detach:function(selector){return remove(this,selector,!0)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||manipulationTarget(this,elem).appendChild(elem)})},prepend:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++)1===(elem=this[i]||{}).nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;jQuery.inArray(this,ignored)<0&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this))},ignored)}}),jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem)},swap=function(elem,options,callback){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];for(name in ret=callback.call(elem),options)elem.style[name]=old[name];return ret},rboxStyle=new RegExp(cssExpand.join("|"),"i");function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return(computed=computed||getStyles(elem))&&(""!==(ret=computed.getPropertyValue(name)||computed[name])||isAttached(elem)||(ret=jQuery.style(elem,name)),!support.pixelBoxStyles()&&rnumnonpx.test(ret)&&rboxStyle.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){if(!conditionFn())return(this.get=hookFn).apply(this,arguments);delete this.get}}}!function(){function computeStyleTests(){if(div){container.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",div.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",documentElement.appendChild(container).appendChild(div);var divStyle=window.getComputedStyle(div);pixelPositionVal="1%"!==divStyle.top,reliableMarginLeftVal=12===roundPixelMeasures(divStyle.marginLeft),div.style.right="60%",pixelBoxStylesVal=36===roundPixelMeasures(divStyle.right),boxSizingReliableVal=36===roundPixelMeasures(divStyle.width),div.style.position="absolute",scrollboxSizeVal=12===roundPixelMeasures(div.offsetWidth/3),documentElement.removeChild(container),div=null}}function roundPixelMeasures(measure){return Math.round(parseFloat(measure))}var pixelPositionVal,boxSizingReliableVal,scrollboxSizeVal,pixelBoxStylesVal,reliableTrDimensionsVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,jQuery.extend(support,{boxSizingReliable:function(){return computeStyleTests(),boxSizingReliableVal},pixelBoxStyles:function(){return computeStyleTests(),pixelBoxStylesVal},pixelPosition:function(){return computeStyleTests(),pixelPositionVal},reliableMarginLeft:function(){return computeStyleTests(),reliableMarginLeftVal},scrollboxSize:function(){return computeStyleTests(),scrollboxSizeVal},reliableTrDimensions:function(){var table,tr,trChild,trStyle;return null==reliableTrDimensionsVal&&(table=document.createElement("table"),tr=document.createElement("tr"),trChild=document.createElement("div"),table.style.cssText="position:absolute;left:-11111px",tr.style.height="1px",trChild.style.height="9px",documentElement.appendChild(table).appendChild(tr).appendChild(trChild),trStyle=window.getComputedStyle(tr),reliableTrDimensionsVal=parseInt(trStyle.height)>3,documentElement.removeChild(table)),reliableTrDimensionsVal}}))}();var cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style,vendorProps={};function finalPropName(name){var final=jQuery.cssProps[name]||vendorProps[name];return final||(name in emptyStyle?name:vendorProps[name]=function(name){for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;)if((name=cssPrefixes[i]+capName)in emptyStyle)return name}(name)||name)}var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"};function setPositiveNumber(_elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function boxModelAdjustment(elem,dimension,box,isBorderBox,styles,computedVal){var i="width"===dimension?1:0,extra=0,delta=0;if(box===(isBorderBox?"border":"content"))return 0;for(;i<4;i+=2)"margin"===box&&(delta+=jQuery.css(elem,box+cssExpand[i],!0,styles)),isBorderBox?("content"===box&&(delta-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==box&&(delta-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(delta+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==box?delta+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles):extra+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles));return!isBorderBox&&computedVal>=0&&(delta+=Math.max(0,Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-computedVal-delta-extra-.5))||0),delta}function getWidthOrHeight(elem,dimension,extra){var styles=getStyles(elem),isBorderBox=(!support.boxSizingReliable()||extra)&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),valueIsBorderBox=isBorderBox,val=curCSS(elem,dimension,styles),offsetProp="offset"+dimension[0].toUpperCase()+dimension.slice(1);if(rnumnonpx.test(val)){if(!extra)return val;val="auto"}return(!support.boxSizingReliable()&&isBorderBox||!support.reliableTrDimensions()&&nodeName(elem,"tr")||"auto"===val||!parseFloat(val)&&"inline"===jQuery.css(elem,"display",!1,styles))&&elem.getClientRects().length&&(isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles),(valueIsBorderBox=offsetProp in elem)&&(val=elem[offsetProp])),(val=parseFloat(val)||0)+boxModelAdjustment(elem,dimension,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles,val)+"px"}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;if(isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];"string"===(type=typeof value)&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type="number"),null!=value&&value==value&&("number"!==type||isCustomProp||(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(isCustomProp?style.setProperty(name,value):style[name]=value))}},css:function(elem,name,extra,styles){var val,num,hooks,origName=camelCase(name);return rcustomProp.test(name)||(name=finalPropName(origName)),(hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName])&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),!0===extra||isFinite(num)?num||0:val):val}}),jQuery.each(["height","width"],function(_i,dimension){jQuery.cssHooks[dimension]={get:function(elem,computed,extra){if(computed)return!rdisplayswap.test(jQuery.css(elem,"display"))||elem.getClientRects().length&&elem.getBoundingClientRect().width?getWidthOrHeight(elem,dimension,extra):swap(elem,cssShow,function(){return getWidthOrHeight(elem,dimension,extra)})},set:function(elem,value,extra){var matches,styles=getStyles(elem),scrollboxSizeBuggy=!support.scrollboxSize()&&"absolute"===styles.position,isBorderBox=(scrollboxSizeBuggy||extra)&&"border-box"===jQuery.css(elem,"boxSizing",!1,styles),subtract=extra?boxModelAdjustment(elem,dimension,extra,isBorderBox,styles):0;return isBorderBox&&scrollboxSizeBuggy&&(subtract-=Math.ceil(elem["offset"+dimension[0].toUpperCase()+dimension.slice(1)]-parseFloat(styles[dimension])-boxModelAdjustment(elem,dimension,"border",!1,styles)-.5)),subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")&&(elem.style[dimension]=value,value=jQuery.css(elem,dimension)),setPositiveNumber(0,value,subtract)}}}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed)return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px"}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},"margin"!==prefix&&(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return 1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop]?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,""))&&"auto"!==result?result:0},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1!==tween.elem.nodeType||!jQuery.cssHooks[tween.prop]&&null==tween.elem.style[finalPropName(tween.prop)]?tween.elem[tween.prop]=tween.now:jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;function schedule(){inProgress&&(!1===document.hidden&&window.requestAnimationFrame?window.requestAnimationFrame(schedule):window.setTimeout(schedule,jQuery.fx.interval),jQuery.fx.tick())}function createFxNow(){return window.setTimeout(function(){fxNow=void 0}),fxNow=Date.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)attrs["margin"+(which=cssExpand[i])]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),percent=1-(remaining/animation.duration||0),index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(length||deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(!function(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(easing=specialEasing[name=camelCase(index)],value=props[index],Array.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),(hooks=jQuery.cssHooks[name])&&"expand"in hooks)for(index in value=hooks.expand(value),delete props[name],value)index in props||(props[index]=value[index],specialEasing[index]=easing);else specialEasing[name]=easing}(props,animation.opts.specialEasing);index<length;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts))return isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=result.stop.bind(result)),result;return jQuery.map(props,createTween,animation),isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation}jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween}]},tweener:function(props,callback){isFunction(props)?(callback=props,props=["*"]):props=props.match(rnothtmlwhite);for(var prop,index=0,length=props.length;index<length;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback)},prefilters:[function(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");for(prop in opts.queue||(null==(hooks=jQuery._queueHooks(elem,"fx")).unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})})),props)if(value=props[prop],rfxtypes.test(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if((propTween=!jQuery.isEmptyObject(props))||!jQuery.isEmptyObject(orig))for(prop in isBox&&1===elem.nodeType&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],null==(restoreDisplay=dataShow&&dataShow.display)&&(restoreDisplay=dataPriv.get(elem,"display")),"none"===(display=jQuery.css(elem,"display"))&&(restoreDisplay?display=restoreDisplay:(showHide([elem],!0),restoreDisplay=elem.style.display||restoreDisplay,display=jQuery.css(elem,"display"),showHide([elem]))),("inline"===display||"inline-block"===display&&null!=restoreDisplay)&&"none"===jQuery.css(elem,"float")&&(propTween||(anim.done(function(){style.display=restoreDisplay}),null==restoreDisplay&&(display=style.display,restoreDisplay="none"===display?"":display)),style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]})),propTween=!1,orig)propTween||(dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay}),toggle&&(dataShow.hidden=!hidden),hidden&&showHide([elem],!0),anim.done(function(){for(prop in hidden||showHide([elem]),dataPriv.remove(elem,"fxshow"),orig)jQuery.style(elem,prop,orig[prop])})),propTween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=propTween.start,hidden&&(propTween.end=propTween.start,propTween.start=0))}],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!isFunction(easing)&&easing};return jQuery.fx.off?opt.duration=0:"number"!=typeof opt.duration&&(opt.duration in jQuery.fx.speeds?opt.duration=jQuery.fx.speeds[opt.duration]:opt.duration=jQuery.fx.speeds._default),null!=opt.queue&&!0!==opt.queue||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||!1===optall.queue?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return!1!==type&&(type=type||"fx"),this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(_i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=Date.now();i<timers.length;i++)(timer=timers[i])()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){inProgress||(inProgress=!0,schedule())},jQuery.fx.stop=function(){inProgress=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx&&jQuery.fx.speeds[time]||time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})},function(){var input=document.createElement("input"),opt=document.createElement("select").appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,(input=document.createElement("input")).value="t",input.type="radio",support.radioValue="t"===input.value}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return void 0===elem.getAttribute?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)),void 0!==value?null===value?void jQuery.removeAttr(elem,name):hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:null==(ret=jQuery.find.attr(elem,name))?void 0:ret)},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)elem.removeAttribute(name)}}),boolHook={set:function(elem,value,name){return!1===value?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(_i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();return isXML||(handle=attrHandle[lowercaseName],attrHandle[lowercaseName]=ret,ret=null!=getter(elem,name,isXML)?lowercaseName:null,attrHandle[lowercaseName]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;function stripAndCollapse(value){return(value.match(rnothtmlwhite)||[]).join(" ")}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function classesToArray(value){return Array.isArray(value)?value:"string"==typeof value&&value.match(rnothtmlwhite)||[]}jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return 1===nType&&jQuery.isXMLDoc(elem)||(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null},set:function(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex)}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if((classes=classesToArray(value)).length)for(;elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");curValue!==(finalValue=stripAndCollapse(cur))&&elem.setAttribute("class",finalValue)}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if((classes=classesToArray(value)).length)for(;elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>-1;)cur=cur.replace(" "+clazz+" "," ");curValue!==(finalValue=stripAndCollapse(cur))&&elem.setAttribute("class",finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value,isValidValue="string"===type||Array.isArray(value);return"boolean"==typeof stateVal&&isValidValue?stateVal?this.addClass(value):this.removeClass(value):isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if(isValidValue)for(i=0,self=jQuery(this),classNames=classesToArray(value);className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else void 0!==value&&"boolean"!==type||((className=getClass(this))&&dataPriv.set(this,"__className__",className),this.setAttribute&&this.setAttribute("class",className||!1===value?"":dataPriv.get(this,"__className__")||""))})},hasClass:function(selector){var className,elem,i=0;for(className=" "+selector+" ";elem=this[i++];)if(1===elem.nodeType&&(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className)>-1)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,valueIsFunction,elem=this[0];return arguments.length?(valueIsFunction=isFunction(value),this.each(function(i){var val;1===this.nodeType&&(null==(val=valueIsFunction?value.call(this,i,jQuery(this).val()):value)?val="":"number"==typeof val?val+="":Array.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),(hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()])&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))})):elem?(hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()])&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:"string"==typeof(ret=elem.value)?ret.replace(rreturn,""):null==ret?"":ret:void 0}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:stripAndCollapse(jQuery.text(elem))}},select:{get:function(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type,values=one?null:[],max=one?index+1:options.length;for(i=index<0?max:one?index:0;i<max;i++)if(((option=options[i]).selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)((option=options[i]).selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(Array.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})}),support.focusin="onfocusin"in window;var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,stopPropagationCallback=function(e){e.stopPropagation()};jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,lastElement,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=lastElement=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>-1&&(type=(namespaces=type.split(".")).shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,(event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event)).isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||!1!==special.trigger.apply(elem,data))){if(!onlyHandlers&&!special.noBubble&&!isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)lastElement=cur,event.type=i>1?bubbleType:special.bindType||type,(handle=(dataPriv.get(cur,"events")||Object.create(null))[event.type]&&dataPriv.get(cur,"handle"))&&handle.apply(cur,data),(handle=ontype&&cur[ontype])&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),!1===event.result&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&!1!==special._default.apply(eventPath.pop(),data)||!acceptData(elem)||ontype&&isFunction(elem[type])&&!isWindow(elem)&&((tmp=elem[ontype])&&(elem[ontype]=null),jQuery.event.triggered=type,event.isPropagationStopped()&&lastElement.addEventListener(type,stopPropagationCallback),elem[type](),event.isPropagationStopped()&&lastElement.removeEventListener(type,stopPropagationCallback),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem)}}),jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}}),support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this.document||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this.document||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix))}}});var location=window.location,nonce={guid:Date.now()},rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=void 0}return xml&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v&&null!=v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==toType(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(null==value?"":value)};if(null==a)return"";if(Array.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(_i,elem){var val=jQuery(this).val();return null==val?null:Array.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});var r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=structure===transports;function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()+" "]=(responseHeaders[match[1].toLowerCase()+" "]||[]).concat(match[2]);match=responseHeaders[key.toLowerCase()+" "]}return null==match?null:match.join(", ")},getAllResponseHeaders:function(){return completed?responseHeadersString:null},setRequestHeader:function(name,value){return null==completed&&(name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return null==completed&&(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(completed)jqXHR.always(map[jqXHR.status]);else for(code in map)statusCode[code]=[statusCode[code],map[code]];return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR),s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""],null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}if(s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),completed)return jqXHR;for(i in(fireGlobals=jQuery.event&&s.global)&&0==jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url.replace(rhash,""),s.hasContent?s.data&&s.processData&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&(s.data=s.data.replace(r20,"+")):(uncached=s.url.slice(cacheURL.length),s.data&&(s.processData||"string"==typeof s.data)&&(cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),!1===s.cache&&(cacheURL=cacheURL.replace(rantiCache,"$1"),uncached=(rquery.test(cacheURL)?"&":"?")+"_="+nonce.guid+++uncached),s.url=cacheURL+uncached),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&!1!==s.contentType||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]),s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(!1===s.beforeSend.call(callbackContext,jqXHR,s)||completed))return jqXHR.abort();if(strAbort="abort",completeDeferred.add(s.complete),jqXHR.done(s.success),jqXHR.fail(s.error),transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),completed)return jqXHR;s.async&&s.timeout>0&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{completed=!1,transport.send(requestHeaders,done)}catch(e){if(completed)throw e;done(-1,e)}}else done(-1,"No Transport");function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;completed||(completed=!0,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&status<300||304===status,responses&&(response=function(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}if(finalDataType)return finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]}(s,jqXHR,responses)),!isSuccess&&jQuery.inArray("script",s.dataTypes)>-1&&(s.converters["text script"]=function(){}),response=function(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(!(conv=converters[prev+" "+current]||converters["* "+current]))for(conv2 in converters)if((tmp=conv2.split(" "))[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){!0===conv?conv=converters[conv2]:!0!==converters[conv2]&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(!0!==conv)if(conv&&s.throws)response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&((modified=jqXHR.getResponseHeader("Last-Modified"))&&(jQuery.lastModified[cacheURL]=modified),(modified=jqXHR.getResponseHeader("etag"))&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,isSuccess=!(error=response.error))):(error=statusText,!status&&statusText||(statusText="error",status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(_i,method){jQuery[method]=function(url,data,callback,type){return isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}}),jQuery.ajaxPrefilter(function(s){var i;for(i in s.headers)"content-type"===i.toLowerCase()&&(s.contentType=s.headers[i]||"")}),jQuery._evalUrl=function(url,options,doc){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(response){jQuery.globalEval(response,options,doc)}})},jQuery.fn.extend({wrapAll:function(html){var wrap;return this[0]&&(isFunction(html)&&(html=html.call(this[0])),wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this},wrapInner:function(html){return isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var htmlIsFunction=isFunction(html);return this.each(function(i){jQuery(this).wrapAll(htmlIsFunction?html.call(this,i):html)})},unwrap:function(selector){return this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes)}),this}}),jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem)},jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length)},jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain)return{send:function(headers,complete){var i,xhr=options.xhr();if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];for(i in options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest"),headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.ontimeout=xhr.onreadystatechange=null,"abort"===type?xhr.abort():"error"===type?"number"!=typeof xhr.status?complete(0,"error"):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()))}},xhr.onload=callback(),errorCallback=xhr.onerror=xhr.ontimeout=callback("error"),void 0!==xhr.onabort?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){callback&&errorCallback()})},callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}}),jQuery.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){var script,callback;if(s.crossDomain||s.scriptAttrs)return{send:function(_,complete){script=jQuery("<script>").attr(s.scriptAttrs||{}).prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}});var body,oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce.guid++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=!1!==s.jsonp&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):!1!==s.jsonp&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),support.createHTMLDocument=((body=document.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===body.childNodes.length),jQuery.parseHTML=function(data,context,keepScripts){return"string"!=typeof data?[]:("boolean"==typeof context&&(keepScripts=context,context=!1),context||(support.createHTMLDocument?((base=(context=document.implementation.createHTMLDocument("")).createElement("base")).href=document.location.href,context.head.appendChild(base)):context=document),parsed=rsingleTag.exec(data),scripts=!keepScripts&&[],parsed?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes)));var base,parsed,scripts},jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");return off>-1&&(selector=stripAndCollapse(url.slice(off)),url=url.slice(0,off)),isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})}),this},jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length},jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1?(curTop=(curPosition=curElem.position()).top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):("number"==typeof props.top&&(props.top+="px"),"number"==typeof props.left&&(props.left+="px"),curElem.css(props))}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var rect,win,elem=this[0];return elem?elem.getClientRects().length?(rect=elem.getBoundingClientRect(),win=elem.ownerDocument.defaultView,{top:rect.top+win.pageYOffset,left:rect.left+win.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var offsetParent,offset,doc,elem=this[0],parentOffset={top:0,left:0};if("fixed"===jQuery.css(elem,"position"))offset=elem.getBoundingClientRect();else{for(offset=this.offset(),doc=elem.ownerDocument,offsetParent=elem.offsetParent||doc.documentElement;offsetParent&&(offsetParent===doc.body||offsetParent===doc.documentElement)&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.parentNode;offsetParent&&offsetParent!==elem&&1===offsetParent.nodeType&&((parentOffset=jQuery(offsetParent).offset()).top+=jQuery.css(offsetParent,"borderTopWidth",!0),parentOffset.left+=jQuery.css(offsetParent,"borderLeftWidth",!0))}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;if(isWindow(elem)?win=elem:9===elem.nodeType&&(win=elem.defaultView),void 0===val)return win?win[prop]:elem[method];win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val},method,val,arguments.length)}}),jQuery.each(["top","left"],function(_i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(!0===margin||!0===value?"margin":"border");return access(this,function(elem,type,value){var doc;return isWindow(elem)?0===funcName.indexOf("outer")?elem["inner"+name]:elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable)}})}),jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(_i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}}),jQuery.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(_i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});var rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;jQuery.proxy=function(fn,context){var tmp,args,proxy;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),isFunction(fn))return args=slice.call(arguments,2),(proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))}).guid=fn.guid=fn.guid||jQuery.guid++,proxy},jQuery.holdReady=function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},jQuery.isArray=Array.isArray,jQuery.parseJSON=JSON.parse,jQuery.nodeName=nodeName,jQuery.isFunction=isFunction,jQuery.isWindow=isWindow,jQuery.camelCase=camelCase,jQuery.type=toType,jQuery.now=Date.now,jQuery.isNumeric=function(obj){var type=jQuery.type(obj);return("number"===type||"string"===type)&&!isNaN(obj-parseFloat(obj))},jQuery.trim=function(text){return null==text?"":(text+"").replace(rtrim,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},void 0===noGlobal&&(window.jQuery=window.$=jQuery),jQuery}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global=global||self).Konva=factory()}(this,function(){"use strict";var PI_OVER_180=Math.PI/180;var _parseUA=function(userAgent){var ua=userAgent.toLowerCase(),match=/(chrome)[ /]([\w.]+)/.exec(ua)||/(webkit)[ /]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ /]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[],mobile=!!userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i),ieMobile=!!userAgent.match(/IEMobile/i);return{browser:match[1]||"",version:match[2]||"0",isIE:function(ua){var msie=ua.indexOf("msie ");if(msie>0)return parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10);if(ua.indexOf("trident/")>0){var rv=ua.indexOf("rv:");return parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)}var edge=ua.indexOf("edge/");return edge>0&&parseInt(ua.substring(edge+5,ua.indexOf(".",edge)),10)}(ua),mobile:mobile,ieMobile:ieMobile}},glob="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:{},Konva={_global:glob,version:"7.0.3",isBrowser:"undefined"!=typeof window&&("[object Window]"==={}.toString.call(window)||"[object global]"==={}.toString.call(window)),isUnminified:/param/.test(function(param){}.toString()),dblClickWindow:400,getAngle:function(angle){return Konva.angleDeg?angle*PI_OVER_180:angle},enableTrace:!1,_pointerEventsEnabled:!1,hitOnDragEnabled:!1,captureTouchEventsEnabled:!1,listenClickTap:!1,inDblClickWindow:!1,pixelRatio:void 0,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging:function(){return Konva.DD.isDragging},isDragReady:function(){return!!Konva.DD.node},UA:_parseUA(glob.navigator&&glob.navigator.userAgent||""),document:glob.document,_injectGlobal:function(Konva){glob.Konva=Konva},_parseUA:_parseUA},_NODES_REGISTRY={},_registerNode=function(NodeClass){_NODES_REGISTRY[NodeClass.prototype.getClassName()]=NodeClass,Konva[NodeClass.prototype.getClassName()]=NodeClass},Collection=function(){function Collection(){}return Collection.toCollection=function(arr){var n,collection=new Collection,len=arr.length;for(n=0;n<len;n++)collection.push(arr[n]);return collection},Collection._mapMethod=function(methodName){Collection.prototype[methodName]=function(){var i,len=this.length,args=[].slice.call(arguments);for(i=0;i<len;i++)this[i][methodName].apply(this[i],args);return this}},Collection.mapMethods=function(constructor){var prot=constructor.prototype;for(var methodName in prot)Collection._mapMethod(methodName)},Collection}();Collection.prototype=[],Collection.prototype.each=function(func){for(var n=0;n<this.length;n++)func(this[n],n)},Collection.prototype.toArray=function(){var n,arr=[],len=this.length;for(n=0;n<len;n++)arr.push(this[n]);return arr};var Transform=function(){function Transform(m){void 0===m&&(m=[1,0,0,1,0,0]),this.dirty=!1,this.m=m&&m.slice()||[1,0,0,1,0,0]}return Transform.prototype.reset=function(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0},Transform.prototype.copy=function(){return new Transform(this.m)},Transform.prototype.copyInto=function(tr){tr.m[0]=this.m[0],tr.m[1]=this.m[1],tr.m[2]=this.m[2],tr.m[3]=this.m[3],tr.m[4]=this.m[4],tr.m[5]=this.m[5]},Transform.prototype.point=function(point){var m=this.m;return{x:m[0]*point.x+m[2]*point.y+m[4],y:m[1]*point.x+m[3]*point.y+m[5]}},Transform.prototype.translate=function(x,y){return this.m[4]+=this.m[0]*x+this.m[2]*y,this.m[5]+=this.m[1]*x+this.m[3]*y,this},Transform.prototype.scale=function(sx,sy){return this.m[0]*=sx,this.m[1]*=sx,this.m[2]*=sy,this.m[3]*=sy,this},Transform.prototype.rotate=function(rad){var c=Math.cos(rad),s=Math.sin(rad),m11=this.m[0]*c+this.m[2]*s,m12=this.m[1]*c+this.m[3]*s,m21=this.m[0]*-s+this.m[2]*c,m22=this.m[1]*-s+this.m[3]*c;return this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22,this},Transform.prototype.getTranslation=function(){return{x:this.m[4],y:this.m[5]}},Transform.prototype.skew=function(sx,sy){var m11=this.m[0]+this.m[2]*sy,m12=this.m[1]+this.m[3]*sy,m21=this.m[2]+this.m[0]*sx,m22=this.m[3]+this.m[1]*sx;return this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22,this},Transform.prototype.multiply=function(matrix){var m11=this.m[0]*matrix.m[0]+this.m[2]*matrix.m[1],m12=this.m[1]*matrix.m[0]+this.m[3]*matrix.m[1],m21=this.m[0]*matrix.m[2]+this.m[2]*matrix.m[3],m22=this.m[1]*matrix.m[2]+this.m[3]*matrix.m[3],dx=this.m[0]*matrix.m[4]+this.m[2]*matrix.m[5]+this.m[4],dy=this.m[1]*matrix.m[4]+this.m[3]*matrix.m[5]+this.m[5];return this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22,this.m[4]=dx,this.m[5]=dy,this},Transform.prototype.invert=function(){var d=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),m0=this.m[3]*d,m1=-this.m[1]*d,m2=-this.m[2]*d,m3=this.m[0]*d,m4=d*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),m5=d*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=m0,this.m[1]=m1,this.m[2]=m2,this.m[3]=m3,this.m[4]=m4,this.m[5]=m5,this},Transform.prototype.getMatrix=function(){return this.m},Transform.prototype.setAbsolutePosition=function(x,y){var m0=this.m[0],m1=this.m[1],m2=this.m[2],m3=this.m[3],m4=this.m[4],yt=(m0*(y-this.m[5])-m1*(x-m4))/(m0*m3-m1*m2),xt=(x-m4-m2*yt)/m0;return this.translate(xt,yt)},Transform.prototype.decompose=function(){var a=this.m[0],b=this.m[1],c=this.m[2],d=this.m[3],delta=a*d-b*c,result={x:this.m[4],y:this.m[5],rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!=a||0!=b){var r=Math.sqrt(a*a+b*b);result.rotation=b>0?Math.acos(a/r):-Math.acos(a/r),result.scaleX=r,result.scaleY=delta/r,result.skewX=(a*c+b*d)/delta,result.skewY=0}else if(0!=c||0!=d){var s=Math.sqrt(c*c+d*d);result.rotation=Math.PI/2-(d>0?Math.acos(-c/s):-Math.acos(c/s)),result.scaleX=delta/s,result.scaleY=s,result.skewX=0,result.skewY=(a*c+b*d)/delta}return result.rotation=Util._getRotation(result.rotation),result},Transform}(),PI_OVER_DEG180=Math.PI/180,DEG180_OVER_PI=180/Math.PI,COLORS={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},RGB_REGEX=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,animQueue=[],Util={_isElement:function(obj){return!(!obj||1!=obj.nodeType)},_isFunction:function(obj){return!!(obj&&obj.constructor&&obj.call&&obj.apply)},_isPlainObject:function(obj){return!!obj&&obj.constructor===Object},_isArray:function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},_isNumber:function(obj){return"[object Number]"===Object.prototype.toString.call(obj)&&!isNaN(obj)&&isFinite(obj)},_isString:function(obj){return"[object String]"===Object.prototype.toString.call(obj)},_isBoolean:function(obj){return"[object Boolean]"===Object.prototype.toString.call(obj)},isObject:function(val){return val instanceof Object},isValidSelector:function(selector){if("string"!=typeof selector)return!1;var firstChar=selector[0];return"#"===firstChar||"."===firstChar||firstChar===firstChar.toUpperCase()},_sign:function(number){return 0===number?0:number>0?1:-1},requestAnimFrame:function(callback){animQueue.push(callback),1===animQueue.length&&requestAnimationFrame(function(){var queue=animQueue;animQueue=[],queue.forEach(function(cb){cb()})})},createCanvasElement:function(){var canvas=document.createElement("canvas");try{canvas.style=canvas.style||{}}catch(e){}return canvas},createImageElement:function(){return document.createElement("img")},_isInDocument:function(el){for(;el=el.parentNode;)if(el==document)return!0;return!1},_simplifyArray:function(arr){var n,val,retArr=[],len=arr.length,util=Util;for(n=0;n<len;n++)val=arr[n],util._isNumber(val)?val=Math.round(1e3*val)/1e3:util._isString(val)||(val=val.toString()),retArr.push(val);return retArr},_urlToImage:function(url,callback){var imageObj=new glob.Image;imageObj.onload=function(){callback(imageObj)},imageObj.src=url},_rgbToHex:function(r,g,b){return((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1)},_hexToRgb:function(hex){hex=hex.replace("#","");var bigint=parseInt(hex,16);return{r:bigint>>16&255,g:bigint>>8&255,b:255&bigint}},getRandomColor:function(){for(var randColor=(16777215*Math.random()<<0).toString(16);randColor.length<6;)randColor="0"+randColor;return"#"+randColor},get:function(val,def){return void 0===val?def:val},getRGB:function(color){var rgb;return color in COLORS?{r:(rgb=COLORS[color])[0],g:rgb[1],b:rgb[2]}:"#"===color[0]?this._hexToRgb(color.substring(1)):"rgb("===color.substr(0,4)?(rgb=RGB_REGEX.exec(color.replace(/ /g,"")),{r:parseInt(rgb[1],10),g:parseInt(rgb[2],10),b:parseInt(rgb[3],10)}):{r:0,g:0,b:0}},colorToRGBA:function(str){return str=str||"black",Util._namedColorToRBA(str)||Util._hex3ColorToRGBA(str)||Util._hex6ColorToRGBA(str)||Util._rgbColorToRGBA(str)||Util._rgbaColorToRGBA(str)||Util._hslColorToRGBA(str)},_namedColorToRBA:function(str){var c=COLORS[str.toLowerCase()];return c?{r:c[0],g:c[1],b:c[2],a:1}:null},_rgbColorToRGBA:function(str){if(0===str.indexOf("rgb(")){var parts=(str=str.match(/rgb\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:parts[0],g:parts[1],b:parts[2],a:1}}},_rgbaColorToRGBA:function(str){if(0===str.indexOf("rgba(")){var parts=(str=str.match(/rgba\(([^)]+)\)/)[1]).split(/ *, */).map(Number);return{r:parts[0],g:parts[1],b:parts[2],a:parts[3]}}},_hex6ColorToRGBA:function(str){if("#"===str[0]&&7===str.length)return{r:parseInt(str.slice(1,3),16),g:parseInt(str.slice(3,5),16),b:parseInt(str.slice(5,7),16),a:1}},_hex3ColorToRGBA:function(str){if("#"===str[0]&&4===str.length)return{r:parseInt(str[1]+str[1],16),g:parseInt(str[2]+str[2],16),b:parseInt(str[3]+str[3],16),a:1}},_hslColorToRGBA:function(str){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(str)){var _a=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(str),hsl=(_a[0],_a.slice(1)),h=Number(hsl[0])/360,s=Number(hsl[1])/100,l=Number(hsl[2])/100,t2=void 0,t3=void 0,val=void 0;if(0===s)return val=255*l,{r:Math.round(val),g:Math.round(val),b:Math.round(val),a:1};for(var t1=2*l-(t2=l<.5?l*(1+s):l+s-l*s),rgb=[0,0,0],i=0;i<3;i++)(t3=h+1/3*-(i-1))<0&&t3++,t3>1&&t3--,val=6*t3<1?t1+6*(t2-t1)*t3:2*t3<1?t2:3*t3<2?t1+(t2-t1)*(2/3-t3)*6:t1,rgb[i]=255*val;return{r:Math.round(rgb[0]),g:Math.round(rgb[1]),b:Math.round(rgb[2]),a:1}}},haveIntersection:function(r1,r2){return!(r2.x>r1.x+r1.width||r2.x+r2.width<r1.x||r2.y>r1.y+r1.height||r2.y+r2.height<r1.y)},cloneObject:function(obj){var retObj={};for(var key in obj)this._isPlainObject(obj[key])?retObj[key]=this.cloneObject(obj[key]):this._isArray(obj[key])?retObj[key]=this.cloneArray(obj[key]):retObj[key]=obj[key];return retObj},cloneArray:function(arr){return arr.slice(0)},_degToRad:function(deg){return deg*PI_OVER_DEG180},_radToDeg:function(rad){return rad*DEG180_OVER_PI},_getRotation:function(radians){return Konva.angleDeg?Util._radToDeg(radians):radians},_capitalize:function(str){return str.charAt(0).toUpperCase()+str.slice(1)},throw:function(str){throw new Error("Konva error: "+str)},error:function(str){console.error("Konva error: "+str)},warn:function(str){Konva.showWarnings&&console.warn("Konva warning: "+str)},extend:function(child,parent){function Ctor(){this.constructor=child}Ctor.prototype=parent.prototype;var oldProto=child.prototype;for(var key in child.prototype=new Ctor,oldProto)oldProto.hasOwnProperty(key)&&(child.prototype[key]=oldProto[key]);child.__super__=parent.prototype,child.super=parent},_getControlPoints:function(x0,y0,x1,y1,x2,y2,t){var d01=Math.sqrt(Math.pow(x1-x0,2)+Math.pow(y1-y0,2)),d12=Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2)),fa=t*d01/(d01+d12),fb=t*d12/(d01+d12);return[x1-fa*(x2-x0),y1-fa*(y2-y0),x1+fb*(x2-x0),y1+fb*(y2-y0)]},_expandPoints:function(p,tension){var n,cp,len=p.length,allPoints=[];for(n=2;n<len-2;n+=2)cp=Util._getControlPoints(p[n-2],p[n-1],p[n],p[n+1],p[n+2],p[n+3],tension),allPoints.push(cp[0]),allPoints.push(cp[1]),allPoints.push(p[n]),allPoints.push(p[n+1]),allPoints.push(cp[2]),allPoints.push(cp[3]);return allPoints},each:function(obj,func){for(var key in obj)func(key,obj[key])},_inRange:function(val,left,right){return left<=val&&val<right},_getProjectionToSegment:function(x1,y1,x2,y2,x3,y3){var x,y,dist,pd2=(x1-x2)*(x1-x2)+(y1-y2)*(y1-y2);if(0==pd2)x=x1,y=y1,dist=(x3-x2)*(x3-x2)+(y3-y2)*(y3-y2);else{var u=((x3-x1)*(x2-x1)+(y3-y1)*(y2-y1))/pd2;u<0?(x=x1,y=y1,dist=(x1-x3)*(x1-x3)+(y1-y3)*(y1-y3)):u>1?(x=x2,y=y2,dist=(x2-x3)*(x2-x3)+(y2-y3)*(y2-y3)):dist=((x=x1+u*(x2-x1))-x3)*(x-x3)+((y=y1+u*(y2-y1))-y3)*(y-y3)}return[x,y,dist]},_getProjectionToLine:function(pt,line,isClosed){var pc=Util.cloneObject(pt),dist=Number.MAX_VALUE;return line.forEach(function(p1,i){if(isClosed||i!==line.length-1){var p2=line[(i+1)%line.length],proj=Util._getProjectionToSegment(p1.x,p1.y,p2.x,p2.y,pt.x,pt.y),px=proj[0],py=proj[1],pdist=proj[2];pdist<dist&&(pc.x=px,pc.y=py,dist=pdist)}}),pc},_prepareArrayForTween:function(startArray,endArray,isClosed){var n,start=[],end=[];if(startArray.length>endArray.length){var temp=endArray;endArray=startArray,startArray=temp}for(n=0;n<startArray.length;n+=2)start.push({x:startArray[n],y:startArray[n+1]});for(n=0;n<endArray.length;n+=2)end.push({x:endArray[n],y:endArray[n+1]});var newStart=[];return end.forEach(function(point){var pr=Util._getProjectionToLine(point,start,isClosed);newStart.push(pr.x),newStart.push(pr.y)}),newStart},_prepareToStringify:function(obj){var desc;for(var key in obj.visitedByCircularReferenceRemoval=!0,obj)if(obj.hasOwnProperty(key)&&obj[key]&&"object"==typeof obj[key])if(desc=Object.getOwnPropertyDescriptor(obj,key),obj[key].visitedByCircularReferenceRemoval||Util._isElement(obj[key])){if(!desc.configurable)return null;delete obj[key]}else if(null===Util._prepareToStringify(obj[key])){if(!desc.configurable)return null;delete obj[key]}return delete obj.visitedByCircularReferenceRemoval,obj},_assign:function(target,source){for(var key in source)target[key]=source[key];return target},_getFirstPointerId:function(evt){return evt.touches?evt.changedTouches[0].identifier:999}};function _formatValue(val){return Util._isString(val)?'"'+val+'"':"[object Number]"===Object.prototype.toString.call(val)?val:Util._isBoolean(val)?val:Object.prototype.toString.call(val)}function RGBComponent(val){return val>255?255:val<0?0:Math.round(val)}function getNumberValidator(){if(Konva.isUnminified)return function(val,attr){return Util._isNumber(val)||Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a number.'),val}}function getNumberOrAutoValidator(){if(Konva.isUnminified)return function(val,attr){return Util._isNumber(val)||"auto"===val||Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a number or "auto".'),val}}function getStringValidator(){if(Konva.isUnminified)return function(val,attr){return Util._isString(val)||Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a string.'),val}}function getBooleanValidator(){if(Konva.isUnminified)return function(val,attr){return!0===val||!1===val||Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a boolean.'),val}}var Factory={addGetterSetter:function(constructor,attr,def,validator,after){Factory.addGetter(constructor,attr,def),Factory.addSetter(constructor,attr,validator,after),Factory.addOverloadedGetterSetter(constructor,attr)},addGetter:function(constructor,attr,def){var method="get"+Util._capitalize(attr);constructor.prototype[method]=constructor.prototype[method]||function(){var val=this.attrs[attr];return void 0===val?def:val}},addSetter:function(constructor,attr,validator,after){var method="set"+Util._capitalize(attr);constructor.prototype[method]||Factory.overWriteSetter(constructor,attr,validator,after)},overWriteSetter:function(constructor,attr,validator,after){var method="set"+Util._capitalize(attr);constructor.prototype[method]=function(val){return validator&&void 0!==val&&null!==val&&(val=validator.call(this,val,attr)),this._setAttr(attr,val),after&&after.call(this),this}},addComponentsGetterSetter:function(constructor,attr,components,validator,after){var n,component,len=components.length,capitalize=Util._capitalize,getter="get"+capitalize(attr),setter="set"+capitalize(attr);constructor.prototype[getter]=function(){var ret={};for(n=0;n<len;n++)ret[component=components[n]]=this.getAttr(attr+capitalize(component));return ret};var basicValidator=function(components){if(Konva.isUnminified)return function(val,attr){return Util.isObject(val)||Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be an object with properties '+components),val}}(components);constructor.prototype[setter]=function(val){var key,oldVal=this.attrs[attr];for(key in validator&&(val=validator.call(this,val)),basicValidator&&basicValidator.call(this,val,attr),val)val.hasOwnProperty(key)&&this._setAttr(attr+capitalize(key),val[key]);return this._fireChangeEvent(attr,oldVal,val),after&&after.call(this),this},Factory.addOverloadedGetterSetter(constructor,attr)},addOverloadedGetterSetter:function(constructor,attr){var capitalizedAttr=Util._capitalize(attr),setter="set"+capitalizedAttr,getter="get"+capitalizedAttr;constructor.prototype[attr]=function(){return arguments.length?(this[setter](arguments[0]),this):this[getter]()}},addDeprecatedGetterSetter:function(constructor,attr,def,validator){Util.error("Adding deprecated "+attr);var method="get"+Util._capitalize(attr),message=attr+" property is deprecated and will be removed soon. Look at Konva change log for more information.";constructor.prototype[method]=function(){Util.error(message);var val=this.attrs[attr];return void 0===val?def:val},Factory.addSetter(constructor,attr,validator,function(){Util.error(message)}),Factory.addOverloadedGetterSetter(constructor,attr)},backCompat:function(constructor,methods){Util.each(methods,function(oldMethodName,newMethodName){var method=constructor.prototype[newMethodName],oldGetter="get"+Util._capitalize(oldMethodName),oldSetter="set"+Util._capitalize(oldMethodName);function deprecated(){method.apply(this,arguments),Util.error('"'+oldMethodName+'" method is deprecated and will be removed soon. Use ""'+newMethodName+'" instead.')}constructor.prototype[oldMethodName]=deprecated,constructor.prototype[oldGetter]=deprecated,constructor.prototype[oldSetter]=deprecated})},afterSetFilter:function(){this._filterUpToDate=!1}},extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var __assign=function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};var CONTEXT_METHODS=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],Context=function(){function Context(canvas){this.canvas=canvas,this._context=canvas._canvas.getContext("2d"),Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}return Context.prototype.fillShape=function(shape){shape.fillEnabled()&&this._fill(shape)},Context.prototype._fill=function(shape){},Context.prototype.strokeShape=function(shape){shape.hasStroke()&&this._stroke(shape)},Context.prototype._stroke=function(shape){},Context.prototype.fillStrokeShape=function(shape){this.fillShape(shape),this.strokeShape(shape)},Context.prototype.getTrace=function(relaxed){var n,trace,method,args,traceArr=this.traceArr,len=traceArr.length,str="";for(n=0;n<len;n++)(method=(trace=traceArr[n]).method)?(args=trace.args,str+=method,relaxed?str+="()":Util._isArray(args[0])?str+="(["+args.join(",")+"])":str+="("+args.join(",")+")"):(str+=trace.property,relaxed||(str+="="+trace.val)),str+=";";return str},Context.prototype.clearTrace=function(){this.traceArr=[]},Context.prototype._trace=function(str){var traceArr=this.traceArr;traceArr.push(str),traceArr.length>=100&&traceArr.shift()},Context.prototype.reset=function(){var pixelRatio=this.getCanvas().getPixelRatio();this.setTransform(1*pixelRatio,0,0,1*pixelRatio,0,0)},Context.prototype.getCanvas=function(){return this.canvas},Context.prototype.clear=function(bounds){var canvas=this.getCanvas();bounds?this.clearRect(bounds.x||0,bounds.y||0,bounds.width||0,bounds.height||0):this.clearRect(0,0,canvas.getWidth()/canvas.pixelRatio,canvas.getHeight()/canvas.pixelRatio)},Context.prototype._applyLineCap=function(shape){var lineCap=shape.getLineCap();lineCap&&this.setAttr("lineCap",lineCap)},Context.prototype._applyOpacity=function(shape){var absOpacity=shape.getAbsoluteOpacity();1!==absOpacity&&this.setAttr("globalAlpha",absOpacity)},Context.prototype._applyLineJoin=function(shape){var lineJoin=shape.attrs.lineJoin;lineJoin&&this.setAttr("lineJoin",lineJoin)},Context.prototype.setAttr=function(attr,val){this._context[attr]=val},Context.prototype.arc=function(a0,a1,a2,a3,a4,a5){this._context.arc(a0,a1,a2,a3,a4,a5)},Context.prototype.arcTo=function(a0,a1,a2,a3,a4){this._context.arcTo(a0,a1,a2,a3,a4)},Context.prototype.beginPath=function(){this._context.beginPath()},Context.prototype.bezierCurveTo=function(a0,a1,a2,a3,a4,a5){this._context.bezierCurveTo(a0,a1,a2,a3,a4,a5)},Context.prototype.clearRect=function(a0,a1,a2,a3){this._context.clearRect(a0,a1,a2,a3)},Context.prototype.clip=function(){this._context.clip()},Context.prototype.closePath=function(){this._context.closePath()},Context.prototype.createImageData=function(a0,a1){var a=arguments;return 2===a.length?this._context.createImageData(a0,a1):1===a.length?this._context.createImageData(a0):void 0},Context.prototype.createLinearGradient=function(a0,a1,a2,a3){return this._context.createLinearGradient(a0,a1,a2,a3)},Context.prototype.createPattern=function(a0,a1){return this._context.createPattern(a0,a1)},Context.prototype.createRadialGradient=function(a0,a1,a2,a3,a4,a5){return this._context.createRadialGradient(a0,a1,a2,a3,a4,a5)},Context.prototype.drawImage=function(a0,a1,a2,a3,a4,a5,a6,a7,a8){var a=arguments,_context=this._context;3===a.length?_context.drawImage(a0,a1,a2):5===a.length?_context.drawImage(a0,a1,a2,a3,a4):9===a.length&&_context.drawImage(a0,a1,a2,a3,a4,a5,a6,a7,a8)},Context.prototype.ellipse=function(a0,a1,a2,a3,a4,a5,a6,a7){this._context.ellipse(a0,a1,a2,a3,a4,a5,a6,a7)},Context.prototype.isPointInPath=function(x,y){return this._context.isPointInPath(x,y)},Context.prototype.fill=function(){this._context.fill()},Context.prototype.fillRect=function(x,y,width,height){this._context.fillRect(x,y,width,height)},Context.prototype.strokeRect=function(x,y,width,height){this._context.strokeRect(x,y,width,height)},Context.prototype.fillText=function(a0,a1,a2){this._context.fillText(a0,a1,a2)},Context.prototype.measureText=function(text){return this._context.measureText(text)},Context.prototype.getImageData=function(a0,a1,a2,a3){return this._context.getImageData(a0,a1,a2,a3)},Context.prototype.lineTo=function(a0,a1){this._context.lineTo(a0,a1)},Context.prototype.moveTo=function(a0,a1){this._context.moveTo(a0,a1)},Context.prototype.rect=function(a0,a1,a2,a3){this._context.rect(a0,a1,a2,a3)},Context.prototype.putImageData=function(a0,a1,a2){this._context.putImageData(a0,a1,a2)},Context.prototype.quadraticCurveTo=function(a0,a1,a2,a3){this._context.quadraticCurveTo(a0,a1,a2,a3)},Context.prototype.restore=function(){this._context.restore()},Context.prototype.rotate=function(a0){this._context.rotate(a0)},Context.prototype.save=function(){this._context.save()},Context.prototype.scale=function(a0,a1){this._context.scale(a0,a1)},Context.prototype.setLineDash=function(a0){this._context.setLineDash?this._context.setLineDash(a0):"mozDash"in this._context?this._context.mozDash=a0:"webkitLineDash"in this._context&&(this._context.webkitLineDash=a0)},Context.prototype.getLineDash=function(){return this._context.getLineDash()},Context.prototype.setTransform=function(a0,a1,a2,a3,a4,a5){this._context.setTransform(a0,a1,a2,a3,a4,a5)},Context.prototype.stroke=function(){this._context.stroke()},Context.prototype.strokeText=function(a0,a1,a2,a3){this._context.strokeText(a0,a1,a2,a3)},Context.prototype.transform=function(a0,a1,a2,a3,a4,a5){this._context.transform(a0,a1,a2,a3,a4,a5)},Context.prototype.translate=function(a0,a1){this._context.translate(a0,a1)},Context.prototype._enableTrace=function(){var n,args,that=this,len=CONTEXT_METHODS.length,_simplifyArray=Util._simplifyArray,origSetter=this.setAttr,func=function(methodName){var ret,origMethod=that[methodName];that[methodName]=function(){return args=_simplifyArray(Array.prototype.slice.call(arguments,0)),ret=origMethod.apply(that,arguments),that._trace({method:methodName,args:args}),ret}};for(n=0;n<len;n++)func(CONTEXT_METHODS[n]);that.setAttr=function(){origSetter.apply(that,arguments);var prop=arguments[0],val=arguments[1];"shadowOffsetX"!==prop&&"shadowOffsetY"!==prop&&"shadowBlur"!==prop||(val/=this.canvas.getPixelRatio()),that._trace({property:prop,val:val})}},Context.prototype._applyGlobalCompositeOperation=function(node){var globalCompositeOperation=node.getGlobalCompositeOperation();"source-over"!==globalCompositeOperation&&this.setAttr("globalCompositeOperation",globalCompositeOperation)},Context}();["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"].forEach(function(prop){Object.defineProperty(Context.prototype,prop,{get:function(){return this._context[prop]},set:function(val){this._context[prop]=val}})});var _pixelRatio,SceneContext=function(_super){function SceneContext(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SceneContext,_super),SceneContext.prototype._fillColor=function(shape){var fill=shape.fill();this.setAttr("fillStyle",fill),shape._fillFunc(this)},SceneContext.prototype._fillPattern=function(shape){var fillPatternX=shape.getFillPatternX(),fillPatternY=shape.getFillPatternY(),fillPatternRotation=Konva.getAngle(shape.getFillPatternRotation()),fillPatternOffsetX=shape.getFillPatternOffsetX(),fillPatternOffsetY=shape.getFillPatternOffsetY(),fillPatternScaleX=shape.getFillPatternScaleX(),fillPatternScaleY=shape.getFillPatternScaleY();(fillPatternX||fillPatternY)&&this.translate(fillPatternX||0,fillPatternY||0),fillPatternRotation&&this.rotate(fillPatternRotation),(fillPatternScaleX||fillPatternScaleY)&&this.scale(fillPatternScaleX,fillPatternScaleY),(fillPatternOffsetX||fillPatternOffsetY)&&this.translate(-1*fillPatternOffsetX,-1*fillPatternOffsetY),this.setAttr("fillStyle",shape._getFillPattern()),shape._fillFunc(this)},SceneContext.prototype._fillLinearGradient=function(shape){var grd=shape._getLinearGradient();grd&&(this.setAttr("fillStyle",grd),shape._fillFunc(this))},SceneContext.prototype._fillRadialGradient=function(shape){var grd=shape._getRadialGradient();grd&&(this.setAttr("fillStyle",grd),shape._fillFunc(this))},SceneContext.prototype._fill=function(shape){var hasColor=shape.fill(),fillPriority=shape.getFillPriority();if(hasColor&&"color"===fillPriority)this._fillColor(shape);else{var hasPattern=shape.getFillPatternImage();if(hasPattern&&"pattern"===fillPriority)this._fillPattern(shape);else{var hasLinearGradient=shape.getFillLinearGradientColorStops();if(hasLinearGradient&&"linear-gradient"===fillPriority)this._fillLinearGradient(shape);else{var hasRadialGradient=shape.getFillRadialGradientColorStops();hasRadialGradient&&"radial-gradient"===fillPriority?this._fillRadialGradient(shape):hasColor?this._fillColor(shape):hasPattern?this._fillPattern(shape):hasLinearGradient?this._fillLinearGradient(shape):hasRadialGradient&&this._fillRadialGradient(shape)}}}},SceneContext.prototype._strokeLinearGradient=function(shape){var start=shape.getStrokeLinearGradientStartPoint(),end=shape.getStrokeLinearGradientEndPoint(),colorStops=shape.getStrokeLinearGradientColorStops(),grd=this.createLinearGradient(start.x,start.y,end.x,end.y);if(colorStops){for(var n=0;n<colorStops.length;n+=2)grd.addColorStop(colorStops[n],colorStops[n+1]);this.setAttr("strokeStyle",grd)}},SceneContext.prototype._stroke=function(shape){var dash=shape.dash(),strokeScaleEnabled=shape.getStrokeScaleEnabled();if(shape.hasStroke()){if(!strokeScaleEnabled){this.save();var pixelRatio=this.getCanvas().getPixelRatio();this.setTransform(pixelRatio,0,0,pixelRatio,0,0)}this._applyLineCap(shape),dash&&shape.dashEnabled()&&(this.setLineDash(dash),this.setAttr("lineDashOffset",shape.dashOffset())),this.setAttr("lineWidth",shape.strokeWidth()),shape.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),shape.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(shape):this.setAttr("strokeStyle",shape.stroke()),shape._strokeFunc(this),strokeScaleEnabled||this.restore()}},SceneContext.prototype._applyShadow=function(shape){var util=Util,color=util.get(shape.getShadowRGBA(),"black"),blur=util.get(shape.getShadowBlur(),5),offset=util.get(shape.getShadowOffset(),{x:0,y:0}),scale=shape.getAbsoluteScale(),ratio=this.canvas.getPixelRatio(),scaleX=scale.x*ratio,scaleY=scale.y*ratio;this.setAttr("shadowColor",color),this.setAttr("shadowBlur",blur*Math.min(Math.abs(scaleX),Math.abs(scaleY))),this.setAttr("shadowOffsetX",offset.x*scaleX),this.setAttr("shadowOffsetY",offset.y*scaleY)},SceneContext}(Context),HitContext=function(_super){function HitContext(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(HitContext,_super),HitContext.prototype._fill=function(shape){this.save(),this.setAttr("fillStyle",shape.colorKey),shape._fillFuncHit(this),this.restore()},HitContext.prototype.strokeShape=function(shape){shape.hasHitStroke()&&this._stroke(shape)},HitContext.prototype._stroke=function(shape){if(shape.hasHitStroke()){var strokeScaleEnabled=shape.getStrokeScaleEnabled();if(!strokeScaleEnabled){this.save();var pixelRatio=this.getCanvas().getPixelRatio();this.setTransform(pixelRatio,0,0,pixelRatio,0,0)}this._applyLineCap(shape);var hitStrokeWidth=shape.hitStrokeWidth(),strokeWidth="auto"===hitStrokeWidth?shape.strokeWidth():hitStrokeWidth;this.setAttr("lineWidth",strokeWidth),this.setAttr("strokeStyle",shape.colorKey),shape._strokeFuncHit(this),strokeScaleEnabled||this.restore()}},HitContext}(Context);var Canvas=function(){function Canvas(config){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;var pixelRatio=(config||{}).pixelRatio||Konva.pixelRatio||function(){if(_pixelRatio)return _pixelRatio;var context=Util.createCanvasElement().getContext("2d");return _pixelRatio=(Konva._global.devicePixelRatio||1)/(context.webkitBackingStorePixelRatio||context.mozBackingStorePixelRatio||context.msBackingStorePixelRatio||context.oBackingStorePixelRatio||context.backingStorePixelRatio||1)}();this.pixelRatio=pixelRatio,this._canvas=Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}return Canvas.prototype.getContext=function(){return this.context},Canvas.prototype.getPixelRatio=function(){return this.pixelRatio},Canvas.prototype.setPixelRatio=function(pixelRatio){var previousRatio=this.pixelRatio;this.pixelRatio=pixelRatio,this.setSize(this.getWidth()/previousRatio,this.getHeight()/previousRatio)},Canvas.prototype.setWidth=function(width){this.width=this._canvas.width=width*this.pixelRatio,this._canvas.style.width=width+"px";var pixelRatio=this.pixelRatio;this.getContext()._context.scale(pixelRatio,pixelRatio)},Canvas.prototype.setHeight=function(height){this.height=this._canvas.height=height*this.pixelRatio,this._canvas.style.height=height+"px";var pixelRatio=this.pixelRatio;this.getContext()._context.scale(pixelRatio,pixelRatio)},Canvas.prototype.getWidth=function(){return this.width},Canvas.prototype.getHeight=function(){return this.height},Canvas.prototype.setSize=function(width,height){this.setWidth(width||0),this.setHeight(height||0)},Canvas.prototype.toDataURL=function(mimeType,quality){try{return this._canvas.toDataURL(mimeType,quality)}catch(e){try{return this._canvas.toDataURL()}catch(err){return Util.error("Unable to get data URL. "+err.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}},Canvas}();Factory.addGetterSetter(Canvas,"pixelRatio",void 0,getNumberValidator());var SceneCanvas=function(_super){function SceneCanvas(config){void 0===config&&(config={width:0,height:0});var _this=_super.call(this,config)||this;return _this.context=new SceneContext(_this),_this.setSize(config.width,config.height),_this}return __extends(SceneCanvas,_super),SceneCanvas}(Canvas),HitCanvas=function(_super){function HitCanvas(config){void 0===config&&(config={width:0,height:0});var _this=_super.call(this,config)||this;return _this.hitCanvas=!0,_this.context=new HitContext(_this),_this.setSize(config.width,config.height),_this}return __extends(HitCanvas,_super),HitCanvas}(Canvas),DD={get isDragging(){var flag=!1;return DD._dragElements.forEach(function(elem){"dragging"===elem.dragStatus&&(flag=!0)}),flag},justDragged:!1,get node(){var node;return DD._dragElements.forEach(function(elem){node=elem.node}),node},_dragElements:new Map,_drag:function(evt){var nodesToFireEvents=[];DD._dragElements.forEach(function(elem,key){var node=elem.node,stage=node.getStage();stage.setPointersPositions(evt),void 0===elem.pointerId&&(elem.pointerId=Util._getFirstPointerId(evt));var pos=stage._changedPointerPositions.find(function(pos){return pos.id===elem.pointerId});if(pos){if("dragging"!==elem.dragStatus){var dragDistance=node.dragDistance();if(Math.max(Math.abs(pos.x-elem.startPointerPos.x),Math.abs(pos.y-elem.startPointerPos.y))<dragDistance)return;if(node.startDrag({evt:evt}),!node.isDragging())return}node._setDragPosition(evt,elem),nodesToFireEvents.push(node)}}),nodesToFireEvents.forEach(function(node){node.fire("dragmove",{type:"dragmove",target:node,evt:evt},!0)})},_endDragBefore:function(evt){DD._dragElements.forEach(function(elem,key){var stage=elem.node.getStage();if(evt&&stage.setPointersPositions(evt),stage._changedPointerPositions.find(function(pos){return pos.id===elem.pointerId})){"dragging"!==elem.dragStatus&&"stopped"!==elem.dragStatus||(DD.justDragged=!0,Konva.listenClickTap=!1,elem.dragStatus="stopped");var drawNode=elem.node.getLayer()||elem.node instanceof Konva.Stage&&elem.node;drawNode&&drawNode.draw()}})},_endDragAfter:function(evt){DD._dragElements.forEach(function(elem,key){"stopped"===elem.dragStatus&&elem.node.fire("dragend",{type:"dragend",target:elem.node,evt:evt},!0),"dragging"!==elem.dragStatus&&DD._dragElements.delete(key)})}};Konva.isBrowser&&(window.addEventListener("mouseup",DD._endDragBefore,!0),window.addEventListener("touchend",DD._endDragBefore,!0),window.addEventListener("mousemove",DD._drag),window.addEventListener("touchmove",DD._drag),window.addEventListener("mouseup",DD._endDragAfter,!1),window.addEventListener("touchend",DD._endDragAfter,!1));var ids={},names={},_removeId=function(id,node){id&&ids[id]===node&&delete ids[id]},_addName=function(node,name){name&&(names[name]||(names[name]=[]),names[name].push(node))},_removeName=function(name,_id){if(name){var nodes=names[name];if(nodes){for(var n=0;n<nodes.length;n++){nodes[n]._id===_id&&nodes.splice(n,1)}0===nodes.length&&delete names[name]}}},ABSOLUTE_OPACITY="absoluteOpacity",ABSOLUTE_TRANSFORM="absoluteTransform",LISTENING="listening",SHAPE="Shape",TRANSFORM="transform",VISIBLE="visible",TRANSFORM_CHANGE_STR=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(" "),emptyChildren=new Collection,idCounter=1,Node=function(){function Node(config){var _this=this;this._id=idCounter++,this.eventListeners={},this.attrs={},this.index=0,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this.children=emptyChildren,this._dragEventId=null,this.setAttrs(config),this.on(TRANSFORM_CHANGE_STR,function(){_this._batchingTransformChange?_this._needClearTransformCache=!0:(_this._clearCache(TRANSFORM),_this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM))}),this.on("visibleChange.konva",function(){_this._clearSelfAndDescendantCache(VISIBLE)}),this.on("listeningChange.konva",function(){_this._clearSelfAndDescendantCache(LISTENING)}),this.on("opacityChange.konva",function(){_this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY)})}return Node.prototype.hasChildren=function(){return!1},Node.prototype.getChildren=function(){return emptyChildren},Node.prototype._clearCache=function(attr){attr!==TRANSFORM&&attr!==ABSOLUTE_TRANSFORM||!this._cache.get(attr)?attr?this._cache.delete(attr):this._cache.clear():this._cache.get(attr).dirty=!0},Node.prototype._getCache=function(attr,privateGetter){var cache=this._cache.get(attr);return(void 0===cache||(attr===TRANSFORM||attr===ABSOLUTE_TRANSFORM)&&!0===cache.dirty)&&(cache=privateGetter.call(this),this._cache.set(attr,cache)),cache},Node.prototype._calculate=function(name,deps,getter){var _this=this;if(!this._attachedDepsListeners.get(name)){var depsString=deps.map(function(dep){return dep+"Change.konva"}).join(" ");this.on(depsString,function(){_this._clearCache(name)}),this._attachedDepsListeners.set(name,!0)}return this._getCache(name,getter)},Node.prototype._getCanvasCache=function(){return this._cache.get("canvas")},Node.prototype._clearSelfAndDescendantCache=function(attr,forceEvent){this._clearCache(attr),forceEvent&&attr===ABSOLUTE_TRANSFORM&&this.fire("_clearTransformCache"),this.isCached()||this.children&&this.children.each(function(node){node._clearSelfAndDescendantCache(attr,!0)})},Node.prototype.clearCache=function(){return this._cache.delete("canvas"),this._clearSelfAndDescendantCache(),this},Node.prototype.cache=function(config){var conf=config||{},rect={};void 0!==conf.x&&void 0!==conf.y&&void 0!==conf.width&&void 0!==conf.height||(rect=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()}));var width=Math.ceil(conf.width||rect.width),height=Math.ceil(conf.height||rect.height),pixelRatio=conf.pixelRatio,x=void 0===conf.x?rect.x:conf.x,y=void 0===conf.y?rect.y:conf.y,offset=conf.offset||0,drawBorder=conf.drawBorder||!1;if(width&&height){x-=offset,y-=offset;var cachedSceneCanvas=new SceneCanvas({pixelRatio:pixelRatio,width:width+=2*offset,height:height+=2*offset}),cachedFilterCanvas=new SceneCanvas({pixelRatio:pixelRatio,width:0,height:0}),cachedHitCanvas=new HitCanvas({pixelRatio:1,width:width,height:height}),sceneContext=cachedSceneCanvas.getContext(),hitContext=cachedHitCanvas.getContext();return cachedHitCanvas.isCache=!0,cachedSceneCanvas.isCache=!0,this._cache.delete("canvas"),this._filterUpToDate=!1,!1===conf.imageSmoothingEnabled&&(cachedSceneCanvas.getContext()._context.imageSmoothingEnabled=!1,cachedFilterCanvas.getContext()._context.imageSmoothingEnabled=!1),sceneContext.save(),hitContext.save(),sceneContext.translate(-x,-y),hitContext.translate(-x,-y),this._isUnderCache=!0,this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY),this._clearSelfAndDescendantCache("absoluteScale"),this.drawScene(cachedSceneCanvas,this),this.drawHit(cachedHitCanvas,this),this._isUnderCache=!1,sceneContext.restore(),hitContext.restore(),drawBorder&&(sceneContext.save(),sceneContext.beginPath(),sceneContext.rect(0,0,width,height),sceneContext.closePath(),sceneContext.setAttr("strokeStyle","red"),sceneContext.setAttr("lineWidth",5),sceneContext.stroke(),sceneContext.restore()),this._cache.set("canvas",{scene:cachedSceneCanvas,filter:cachedFilterCanvas,hit:cachedHitCanvas,x:x,y:y}),this}Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.")},Node.prototype.isCached=function(){return this._cache.has("canvas")},Node.prototype.getClientRect=function(config){throw new Error('abstract "getClientRect" method call')},Node.prototype._transformedRect=function(rect,top){var minX,minY,maxX,maxY,points=[{x:rect.x,y:rect.y},{x:rect.x+rect.width,y:rect.y},{x:rect.x+rect.width,y:rect.y+rect.height},{x:rect.x,y:rect.y+rect.height}],trans=this.getAbsoluteTransform(top);return points.forEach(function(point){var transformed=trans.point(point);void 0===minX&&(minX=maxX=transformed.x,minY=maxY=transformed.y),minX=Math.min(minX,transformed.x),minY=Math.min(minY,transformed.y),maxX=Math.max(maxX,transformed.x),maxY=Math.max(maxY,transformed.y)}),{x:minX,y:minY,width:maxX-minX,height:maxY-minY}},Node.prototype._drawCachedSceneCanvas=function(context){context.save(),context._applyOpacity(this),context._applyGlobalCompositeOperation(this);var canvasCache=this._getCanvasCache();context.translate(canvasCache.x,canvasCache.y);var cacheCanvas=this._getCachedSceneCanvas(),ratio=cacheCanvas.pixelRatio;context.drawImage(cacheCanvas._canvas,0,0,cacheCanvas.width/ratio,cacheCanvas.height/ratio),context.restore()},Node.prototype._drawCachedHitCanvas=function(context){var canvasCache=this._getCanvasCache(),hitCanvas=canvasCache.hit;context.save(),context.translate(canvasCache.x,canvasCache.y),context.drawImage(hitCanvas._canvas,0,0),context.restore()},Node.prototype._getCachedSceneCanvas=function(){var len,imageData,n,filter,filters=this.filters(),cachedCanvas=this._getCanvasCache(),sceneCanvas=cachedCanvas.scene,filterCanvas=cachedCanvas.filter,filterContext=filterCanvas.getContext();if(filters){if(!this._filterUpToDate){var ratio=sceneCanvas.pixelRatio;filterCanvas.setSize(sceneCanvas.width/sceneCanvas.pixelRatio,sceneCanvas.height/sceneCanvas.pixelRatio);try{for(len=filters.length,filterContext.clear(),filterContext.drawImage(sceneCanvas._canvas,0,0,sceneCanvas.getWidth()/ratio,sceneCanvas.getHeight()/ratio),imageData=filterContext.getImageData(0,0,filterCanvas.getWidth(),filterCanvas.getHeight()),n=0;n<len;n++)"function"==typeof(filter=filters[n])?(filter.call(this,imageData),filterContext.putImageData(imageData,0,0)):Util.error("Filter should be type of function, but got "+typeof filter+" instead. Please check correct filters")}catch(e){Util.error("Unable to apply filter. "+e.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return filterCanvas}return sceneCanvas},Node.prototype.on=function(evtStr,handler){if(3===arguments.length)return this._delegate.apply(this,arguments);var n,parts,baseEvent,name,events=evtStr.split(" "),len=events.length;for(n=0;n<len;n++)baseEvent=(parts=events[n].split("."))[0],name=parts[1]||"",this.eventListeners[baseEvent]||(this.eventListeners[baseEvent]=[]),this.eventListeners[baseEvent].push({name:name,handler:handler});return this},Node.prototype.off=function(evtStr,callback){var n,t,parts,baseEvent,name,events=(evtStr||"").split(" "),len=events.length;if(!evtStr)for(t in this.eventListeners)this._off(t);for(n=0;n<len;n++)if(baseEvent=(parts=events[n].split("."))[0],name=parts[1],baseEvent)this.eventListeners[baseEvent]&&this._off(baseEvent,name,callback);else for(t in this.eventListeners)this._off(t,name,callback);return this},Node.prototype.dispatchEvent=function(evt){var e={target:this,type:evt.type,evt:evt};return this.fire(evt.type,e),this},Node.prototype.addEventListener=function(type,handler){return this.on(type,function(evt){handler.call(this,evt.evt)}),this},Node.prototype.removeEventListener=function(type){return this.off(type),this},Node.prototype._delegate=function(event,selector,handler){var stopNode=this;this.on(event,function(evt){for(var targets=evt.target.findAncestors(selector,!0,stopNode),i=0;i<targets.length;i++)(evt=Util.cloneObject(evt)).currentTarget=targets[i],handler.call(targets[i],evt)})},Node.prototype.remove=function(){return this.isDragging()&&this.stopDrag(),DD._dragElements.delete(this._id),this._remove(),this},Node.prototype._clearCaches=function(){this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM),this._clearSelfAndDescendantCache(ABSOLUTE_OPACITY),this._clearSelfAndDescendantCache("absoluteScale"),this._clearSelfAndDescendantCache("stage"),this._clearSelfAndDescendantCache(VISIBLE),this._clearSelfAndDescendantCache(LISTENING)},Node.prototype._remove=function(){this._clearCaches();var parent=this.getParent();parent&&parent.children&&(parent.children.splice(this.index,1),parent._setChildrenIndices(),this.parent=null)},Node.prototype.destroy=function(){_removeId(this.id(),this);for(var names=(this.name()||"").split(/\s/g),i=0;i<names.length;i++){var subname=names[i];_removeName(subname,this._id)}return this.remove(),this},Node.prototype.getAttr=function(attr){var method="get"+Util._capitalize(attr);return Util._isFunction(this[method])?this[method]():this.attrs[attr]},Node.prototype.getAncestors=function(){for(var parent=this.getParent(),ancestors=new Collection;parent;)ancestors.push(parent),parent=parent.getParent();return ancestors},Node.prototype.getAttrs=function(){return this.attrs||{}},Node.prototype.setAttrs=function(config){var _this=this;return this._batchTransformChanges(function(){var key,method;if(!config)return _this;for(key in config)"children"!==key&&(method="set"+Util._capitalize(key),Util._isFunction(_this[method])?_this[method](config[key]):_this._setAttr(key,config[key]))}),this},Node.prototype.isListening=function(){return this._getCache(LISTENING,this._isListening)},Node.prototype._isListening=function(relativeTo){if(!this.listening())return!1;var parent=this.getParent();return!parent||parent===relativeTo||this===relativeTo||parent._isListening(relativeTo)},Node.prototype.isVisible=function(){return this._getCache(VISIBLE,this._isVisible)},Node.prototype._isVisible=function(relativeTo){if(!this.visible())return!1;var parent=this.getParent();return!parent||parent===relativeTo||this===relativeTo||parent._isVisible(relativeTo)},Node.prototype.shouldDrawHit=function(top){if(top)return this._isVisible(top)&&this._isListening(top);var layer=this.getLayer(),layerUnderDrag=!1;DD._dragElements.forEach(function(elem){"dragging"===elem.dragStatus&&elem.node.getLayer()===layer&&(layerUnderDrag=!0)});var dragSkip=!Konva.hitOnDragEnabled&&layerUnderDrag;return this.isListening()&&this.isVisible()&&!dragSkip},Node.prototype.show=function(){return this.visible(!0),this},Node.prototype.hide=function(){return this.visible(!1),this},Node.prototype.getZIndex=function(){return this.index||0},Node.prototype.getAbsoluteZIndex=function(){var nodes,len,n,child,depth=this.getDepth(),that=this,index=0;return"Stage"!==that.nodeType&&function addChildren(children){for(nodes=[],len=children.length,n=0;n<len;n++)child=children[n],index++,child.nodeType!==SHAPE&&(nodes=nodes.concat(child.getChildren().toArray())),child._id===that._id&&(n=len);nodes.length>0&&nodes[0].getDepth()<=depth&&addChildren(nodes)}(that.getStage().getChildren()),index},Node.prototype.getDepth=function(){for(var depth=0,parent=this.parent;parent;)depth++,parent=parent.parent;return depth},Node.prototype._batchTransformChanges=function(func){this._batchingTransformChange=!0,func(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(TRANSFORM),this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM,!0)),this._needClearTransformCache=!1},Node.prototype.setPosition=function(pos){var _this=this;return this._batchTransformChanges(function(){_this.x(pos.x),_this.y(pos.y)}),this},Node.prototype.getPosition=function(){return{x:this.x(),y:this.y()}},Node.prototype.getAbsolutePosition=function(top){for(var haveCachedParent=!1,parent=this.parent;parent;){if(parent.isCached()){haveCachedParent=!0;break}parent=parent.parent}haveCachedParent&&!top&&(top=!0);var absoluteMatrix=this.getAbsoluteTransform(top).getMatrix(),absoluteTransform=new Transform,offset=this.offset();return absoluteTransform.m=absoluteMatrix.slice(),absoluteTransform.translate(offset.x,offset.y),absoluteTransform.getTranslation()},Node.prototype.setAbsolutePosition=function(pos){var origTrans=this._clearTransform();this.attrs.x=origTrans.x,this.attrs.y=origTrans.y,delete origTrans.x,delete origTrans.y,this._clearCache(TRANSFORM);var it=this._getAbsoluteTransform().copy();return it.invert(),it.translate(pos.x,pos.y),pos={x:this.attrs.x+it.getTranslation().x,y:this.attrs.y+it.getTranslation().y},this._setTransform(origTrans),this.setPosition({x:pos.x,y:pos.y}),this._clearCache(TRANSFORM),this._clearSelfAndDescendantCache(ABSOLUTE_TRANSFORM),this},Node.prototype._setTransform=function(trans){var key;for(key in trans)this.attrs[key]=trans[key]},Node.prototype._clearTransform=function(){var trans={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,trans},Node.prototype.move=function(change){var changeX=change.x,changeY=change.y,x=this.x(),y=this.y();return void 0!==changeX&&(x+=changeX),void 0!==changeY&&(y+=changeY),this.setPosition({x:x,y:y}),this},Node.prototype._eachAncestorReverse=function(func,top){var len,n,family=[],parent=this.getParent();if(top&&top._id===this._id)func(this);else{for(family.unshift(this);parent&&(!top||parent._id!==top._id);)family.unshift(parent),parent=parent.parent;for(len=family.length,n=0;n<len;n++)func(family[n])}},Node.prototype.rotate=function(theta){return this.rotation(this.rotation()+theta),this},Node.prototype.moveToTop=function(){if(!this.parent)return Util.warn("Node has no parent. moveToTop function is ignored."),!1;var index=this.index;return this.parent.children.splice(index,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},Node.prototype.moveUp=function(){if(!this.parent)return Util.warn("Node has no parent. moveUp function is ignored."),!1;var index=this.index;return index<this.parent.getChildren().length-1&&(this.parent.children.splice(index,1),this.parent.children.splice(index+1,0,this),this.parent._setChildrenIndices(),!0)},Node.prototype.moveDown=function(){if(!this.parent)return Util.warn("Node has no parent. moveDown function is ignored."),!1;var index=this.index;return index>0&&(this.parent.children.splice(index,1),this.parent.children.splice(index-1,0,this),this.parent._setChildrenIndices(),!0)},Node.prototype.moveToBottom=function(){if(!this.parent)return Util.warn("Node has no parent. moveToBottom function is ignored."),!1;var index=this.index;return index>0&&(this.parent.children.splice(index,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0)},Node.prototype.setZIndex=function(zIndex){if(!this.parent)return Util.warn("Node has no parent. zIndex parameter is ignored."),this;(zIndex<0||zIndex>=this.parent.children.length)&&Util.warn("Unexpected value "+zIndex+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");var index=this.index;return this.parent.children.splice(index,1),this.parent.children.splice(zIndex,0,this),this.parent._setChildrenIndices(),this},Node.prototype.getAbsoluteOpacity=function(){return this._getCache(ABSOLUTE_OPACITY,this._getAbsoluteOpacity)},Node.prototype._getAbsoluteOpacity=function(){var absOpacity=this.opacity(),parent=this.getParent();return parent&&!parent._isUnderCache&&(absOpacity*=parent.getAbsoluteOpacity()),absOpacity},Node.prototype.moveTo=function(newContainer){return this.getParent()!==newContainer&&(this._remove(),newContainer.add(this)),this},Node.prototype.toObject=function(){var key,val,getter,defaultValue,obj={},attrs=this.getAttrs();for(key in obj.attrs={},attrs)val=attrs[key],Util.isObject(val)&&!Util._isPlainObject(val)&&!Util._isArray(val)||(getter="function"==typeof this[key]&&this[key],delete attrs[key],defaultValue=getter?getter.call(this):null,attrs[key]=val,defaultValue!==val&&(obj.attrs[key]=val));return obj.className=this.getClassName(),Util._prepareToStringify(obj)},Node.prototype.toJSON=function(){return JSON.stringify(this.toObject())},Node.prototype.getParent=function(){return this.parent},Node.prototype.findAncestors=function(selector,includeSelf,stopNode){var res=[];includeSelf&&this._isMatch(selector)&&res.push(this);for(var ancestor=this.parent;ancestor;){if(ancestor===stopNode)return res;ancestor._isMatch(selector)&&res.push(ancestor),ancestor=ancestor.parent}return res},Node.prototype.isAncestorOf=function(node){return!1},Node.prototype.findAncestor=function(selector,includeSelf,stopNode){return this.findAncestors(selector,includeSelf,stopNode)[0]},Node.prototype._isMatch=function(selector){if(!selector)return!1;if("function"==typeof selector)return selector(this);var n,sel,selectorArr=selector.replace(/ /g,"").split(","),len=selectorArr.length;for(n=0;n<len;n++)if(sel=selectorArr[n],Util.isValidSelector(sel)||(Util.warn('Selector "'+sel+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),Util.warn("Konva is awesome, right?")),"#"===sel.charAt(0)){if(this.id()===sel.slice(1))return!0}else if("."===sel.charAt(0)){if(this.hasName(sel.slice(1)))return!0}else if(this.className===sel||this.nodeType===sel)return!0;return!1},Node.prototype.getLayer=function(){var parent=this.getParent();return parent?parent.getLayer():null},Node.prototype.getStage=function(){return this._getCache("stage",this._getStage)},Node.prototype._getStage=function(){var parent=this.getParent();return parent?parent.getStage():void 0},Node.prototype.fire=function(eventType,evt,bubble){return void 0===evt&&(evt={}),evt.target=evt.target||this,bubble?this._fireAndBubble(eventType,evt):this._fire(eventType,evt),this},Node.prototype.getAbsoluteTransform=function(top){return top?this._getAbsoluteTransform(top):this._getCache(ABSOLUTE_TRANSFORM,this._getAbsoluteTransform)},Node.prototype._getAbsoluteTransform=function(top){var at;if(top)return at=new Transform,this._eachAncestorReverse(function(node){var transformsEnabled=node.transformsEnabled();"all"===transformsEnabled?at.multiply(node.getTransform()):"position"===transformsEnabled&&at.translate(node.x()-node.offsetX(),node.y()-node.offsetY())},top),at;at=this._cache.get(ABSOLUTE_TRANSFORM)||new Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(at):at.reset();var transformsEnabled=this.transformsEnabled();if("all"===transformsEnabled)at.multiply(this.getTransform());else if("position"===transformsEnabled){var x=this.attrs.x||0,y=this.attrs.y||0,offsetX=this.attrs.offsetX||0,offsetY=this.attrs.offsetY||0;at.translate(x-offsetX,y-offsetY)}return at.dirty=!1,at},Node.prototype.getAbsoluteScale=function(top){for(var parent=this;parent;)parent._isUnderCache&&(top=parent),parent=parent.getParent();var attrs=this.getAbsoluteTransform(top).decompose();return{x:attrs.scaleX,y:attrs.scaleY}},Node.prototype.getAbsoluteRotation=function(){return this.getAbsoluteTransform().decompose().rotation},Node.prototype.getTransform=function(){return this._getCache(TRANSFORM,this._getTransform)},Node.prototype._getTransform=function(){var _a,_b,m=this._cache.get(TRANSFORM)||new Transform;m.reset();var x=this.x(),y=this.y(),rotation=Konva.getAngle(this.rotation()),scaleX=null!==(_a=this.attrs.scaleX)&&void 0!==_a?_a:1,scaleY=null!==(_b=this.attrs.scaleY)&&void 0!==_b?_b:1,skewX=this.attrs.skewX||0,skewY=this.attrs.skewY||0,offsetX=this.attrs.offsetX||0,offsetY=this.attrs.offsetY||0;return 0===x&&0===y||m.translate(x,y),0!==rotation&&m.rotate(rotation),0===skewX&&0===skewY||m.skew(skewX,skewY),1===scaleX&&1===scaleY||m.scale(scaleX,scaleY),0===offsetX&&0===offsetY||m.translate(-1*offsetX,-1*offsetY),m.dirty=!1,m},Node.prototype.clone=function(obj){var key,allListeners,len,n,listener,attrs=Util.cloneObject(this.attrs);for(key in obj)attrs[key]=obj[key];var node=new this.constructor(attrs);for(key in this.eventListeners)for(len=(allListeners=this.eventListeners[key]).length,n=0;n<len;n++)(listener=allListeners[n]).name.indexOf("konva")<0&&(node.eventListeners[key]||(node.eventListeners[key]=[]),node.eventListeners[key].push(listener));return node},Node.prototype._toKonvaCanvas=function(config){config=config||{};var box=this.getClientRect(),stage=this.getStage(),x=void 0!==config.x?config.x:box.x,y=void 0!==config.y?config.y:box.y,pixelRatio=config.pixelRatio||1,canvas=new SceneCanvas({width:config.width||box.width||(stage?stage.width():0),height:config.height||box.height||(stage?stage.height():0),pixelRatio:pixelRatio}),context=canvas.getContext();return context.save(),(x||y)&&context.translate(-1*x,-1*y),this.drawScene(canvas),context.restore(),canvas},Node.prototype.toCanvas=function(config){return this._toKonvaCanvas(config)._canvas},Node.prototype.toDataURL=function(config){var mimeType=(config=config||{}).mimeType||null,quality=config.quality||null,url=this._toKonvaCanvas(config).toDataURL(mimeType,quality);return config.callback&&config.callback(url),url},Node.prototype.toImage=function(config){if(!config||!config.callback)throw"callback required for toImage method config argument";var callback=config.callback;delete config.callback,Util._urlToImage(this.toDataURL(config),function(img){callback(img)})},Node.prototype.setSize=function(size){return this.width(size.width),this.height(size.height),this},Node.prototype.getSize=function(){return{width:this.width(),height:this.height()}},Node.prototype.getClassName=function(){return this.className||this.nodeType},Node.prototype.getType=function(){return this.nodeType},Node.prototype.getDragDistance=function(){return void 0!==this.attrs.dragDistance?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Konva.dragDistance},Node.prototype._off=function(type,name,callback){var i,evtName,handler,evtListeners=this.eventListeners[type];for(i=0;i<evtListeners.length;i++)if(evtName=evtListeners[i].name,handler=evtListeners[i].handler,!("konva"===evtName&&"konva"!==name||name&&evtName!==name||callback&&callback!==handler)){if(evtListeners.splice(i,1),0===evtListeners.length){delete this.eventListeners[type];break}i--}},Node.prototype._fireChangeEvent=function(attr,oldVal,newVal){this._fire(attr+"Change",{oldVal:oldVal,newVal:newVal})},Node.prototype.setId=function(id){var oldId=this.id();return _removeId(oldId,this),function(node,id){id&&(ids[id]=node)}(this,id),this._setAttr("id",id),this},Node.prototype.setName=function(name){var subname,i,oldNames=(this.name()||"").split(/\s/g),newNames=(name||"").split(/\s/g);for(i=0;i<oldNames.length;i++)subname=oldNames[i],-1===newNames.indexOf(subname)&&subname&&_removeName(subname,this._id);for(i=0;i<newNames.length;i++)subname=newNames[i],-1===oldNames.indexOf(subname)&&subname&&_addName(this,subname);return this._setAttr("name",name),this},Node.prototype.addName=function(name){if(!this.hasName(name)){var oldName=this.name(),newName=oldName?oldName+" "+name:name;this.setName(newName)}return this},Node.prototype.hasName=function(name){if(!name)return!1;var fullName=this.name();return!!fullName&&-1!==(fullName||"").split(/\s/g).indexOf(name)},Node.prototype.removeName=function(name){var names=(this.name()||"").split(/\s/g),index=names.indexOf(name);return-1!==index&&(names.splice(index,1),this.setName(names.join(" "))),this},Node.prototype.setAttr=function(attr,val){var func=this["set"+Util._capitalize(attr)];return Util._isFunction(func)?func.call(this,val):this._setAttr(attr,val),this},Node.prototype._setAttr=function(key,val){var oldVal=this.attrs[key];(oldVal!==val||Util.isObject(val))&&(void 0===val||null===val?delete this.attrs[key]:this.attrs[key]=val,this._fireChangeEvent(key,oldVal,val))},Node.prototype._setComponentAttr=function(key,component,val){var oldVal;void 0!==val&&((oldVal=this.attrs[key])||(this.attrs[key]=this.getAttr(key)),this.attrs[key][component]=val,this._fireChangeEvent(key,oldVal,val))},Node.prototype._fireAndBubble=function(eventType,evt,compareShape){if(evt&&this.nodeType===SHAPE&&(evt.target=this),!(("mouseenter"===eventType||"mouseleave"===eventType)&&(compareShape&&(this===compareShape||this.isAncestorOf&&this.isAncestorOf(compareShape))||"Stage"===this.nodeType&&!compareShape))){this._fire(eventType,evt);var stopBubble=("mouseenter"===eventType||"mouseleave"===eventType)&&compareShape&&compareShape.isAncestorOf&&compareShape.isAncestorOf(this)&&!compareShape.isAncestorOf(this.parent);(evt&&!evt.cancelBubble||!evt)&&this.parent&&this.parent.isListening()&&!stopBubble&&(compareShape&&compareShape.parent?this._fireAndBubble.call(this.parent,eventType,evt,compareShape):this._fireAndBubble.call(this.parent,eventType,evt))}},Node.prototype._fire=function(eventType,evt){var i,events=this.eventListeners[eventType];if(events)for((evt=evt||{}).currentTarget=this,evt.type=eventType,i=0;i<events.length;i++)events[i].handler.call(this,evt)},Node.prototype.draw=function(){return this.drawScene(),this.drawHit(),this},Node.prototype._createDragElement=function(evt){var pointerId=evt?evt.pointerId:void 0,stage=this.getStage(),ap=this.getAbsolutePosition(),pos=stage._getPointerById(pointerId)||stage._changedPointerPositions[0]||ap;DD._dragElements.set(this._id,{node:this,startPointerPos:pos,offset:{x:pos.x-ap.x,y:pos.y-ap.y},dragStatus:"ready",pointerId:pointerId})},Node.prototype.startDrag=function(evt){DD._dragElements.has(this._id)||this._createDragElement(evt),DD._dragElements.get(this._id).dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:evt&&evt.evt},!0)},Node.prototype._setDragPosition=function(evt,elem){var pos=this.getStage()._getPointerById(elem.pointerId);if(pos){var newNodePos={x:pos.x-elem.offset.x,y:pos.y-elem.offset.y},dbf=this.dragBoundFunc();if(void 0!==dbf){var bounded=dbf.call(this,newNodePos,evt);bounded?newNodePos=bounded:Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}this._lastPos&&this._lastPos.x===newNodePos.x&&this._lastPos.y===newNodePos.y||(this.setAbsolutePosition(newNodePos),this.getLayer()?this.getLayer().batchDraw():this.getStage()&&this.getStage().batchDraw()),this._lastPos=newNodePos}},Node.prototype.stopDrag=function(evt){var elem=DD._dragElements.get(this._id);elem&&(elem.dragStatus="stopped"),DD._endDragBefore(evt),DD._endDragAfter(evt)},Node.prototype.setDraggable=function(draggable){this._setAttr("draggable",draggable),this._dragChange()},Node.prototype.isDragging=function(){var elem=DD._dragElements.get(this._id);return!!elem&&"dragging"===elem.dragStatus},Node.prototype._listenDrag=function(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(evt){var _this=this;if((!(void 0!==evt.evt.button)||Konva.dragButtons.indexOf(evt.evt.button)>=0)&&!this.isDragging()){var hasDraggingChild=!1;DD._dragElements.forEach(function(elem){_this.isAncestorOf(elem.node)&&(hasDraggingChild=!0)}),hasDraggingChild||this._createDragElement(evt)}})},Node.prototype._dragChange=function(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;var dragElement=DD._dragElements.get(this._id),isDragging=dragElement&&"dragging"===dragElement.dragStatus,isReady=dragElement&&"ready"===dragElement.dragStatus;isDragging?this.stopDrag():isReady&&DD._dragElements.delete(this._id)}},Node.prototype._dragCleanup=function(){this.off("mousedown.konva"),this.off("touchstart.konva")},Node.create=function(data,container){return Util._isString(data)&&(data=JSON.parse(data)),this._createNode(data,container)},Node._createNode=function(obj,container){var no,len,n,className=Node.prototype.getClassName.call(obj),children=obj.children;if(container&&(obj.attrs.container=container),_NODES_REGISTRY[className]||(Util.warn('Can not find a node with class name "'+className+'". Fallback to "Shape".'),className="Shape"),no=new(0,_NODES_REGISTRY[className])(obj.attrs),children)for(len=children.length,n=0;n<len;n++)no.add(Node._createNode(children[n]));return no},Node}();Node.prototype.nodeType="Node",Node.prototype._attrsAffectingSize=[];var addGetterSetter=Factory.addGetterSetter;addGetterSetter(Node,"zIndex"),addGetterSetter(Node,"absolutePosition"),addGetterSetter(Node,"position"),addGetterSetter(Node,"x",0,getNumberValidator()),addGetterSetter(Node,"y",0,getNumberValidator()),addGetterSetter(Node,"globalCompositeOperation","source-over",getStringValidator()),addGetterSetter(Node,"opacity",1,getNumberValidator()),addGetterSetter(Node,"name","",getStringValidator()),addGetterSetter(Node,"id","",getStringValidator()),addGetterSetter(Node,"rotation",0,getNumberValidator()),Factory.addComponentsGetterSetter(Node,"scale",["x","y"]),addGetterSetter(Node,"scaleX",1,getNumberValidator()),addGetterSetter(Node,"scaleY",1,getNumberValidator()),Factory.addComponentsGetterSetter(Node,"skew",["x","y"]),addGetterSetter(Node,"skewX",0,getNumberValidator()),addGetterSetter(Node,"skewY",0,getNumberValidator()),Factory.addComponentsGetterSetter(Node,"offset",["x","y"]),addGetterSetter(Node,"offsetX",0,getNumberValidator()),addGetterSetter(Node,"offsetY",0,getNumberValidator()),addGetterSetter(Node,"dragDistance",null,getNumberValidator()),addGetterSetter(Node,"width",0,getNumberValidator()),addGetterSetter(Node,"height",0,getNumberValidator()),addGetterSetter(Node,"listening",!0,getBooleanValidator()),addGetterSetter(Node,"preventDefault",!0,getBooleanValidator()),addGetterSetter(Node,"filters",null,function(val){return this._filterUpToDate=!1,val}),addGetterSetter(Node,"visible",!0,getBooleanValidator()),addGetterSetter(Node,"transformsEnabled","all",getStringValidator()),addGetterSetter(Node,"size"),addGetterSetter(Node,"dragBoundFunc"),addGetterSetter(Node,"draggable",!1,getBooleanValidator()),Factory.backCompat(Node,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Collection.mapMethods(Node);var Container=function(_super){function Container(){var _this=null!==_super&&_super.apply(this,arguments)||this;return _this.children=new Collection,_this}return __extends(Container,_super),Container.prototype.getChildren=function(filterFunc){if(!filterFunc)return this.children;var results=new Collection;return this.children.each(function(child){filterFunc(child)&&results.push(child)}),results},Container.prototype.hasChildren=function(){return this.getChildren().length>0},Container.prototype.removeChildren=function(){for(var child,i=0;i<this.children.length;i++)(child=this.children[i]).parent=null,child.index=0,child.remove();return this.children=new Collection,this},Container.prototype.destroyChildren=function(){for(var child,i=0;i<this.children.length;i++)(child=this.children[i]).parent=null,child.index=0,child.destroy();return this.children=new Collection,this},Container.prototype.add=function(){for(var children=[],_i=0;_i<arguments.length;_i++)children[_i]=arguments[_i];if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}var child=children[0];if(child.getParent())return child.moveTo(this),this;var _children=this.children;return this._validateAdd(child),child._clearCaches(),child.index=_children.length,child.parent=this,_children.push(child),this._fire("add",{child:child}),this},Container.prototype.destroy=function(){return this.hasChildren()&&this.destroyChildren(),_super.prototype.destroy.call(this),this},Container.prototype.find=function(selector){return this._generalFind(selector,!1)},Container.prototype.get=function(selector){return Util.warn("collection.get() method is deprecated. Please use collection.find() instead."),this.find(selector)},Container.prototype.findOne=function(selector){var result=this._generalFind(selector,!0);return result.length>0?result[0]:void 0},Container.prototype._generalFind=function(selector,findOne){var retArr=[];return this._descendants(function(node){var valid=node._isMatch(selector);return valid&&retArr.push(node),!(!valid||!findOne)}),Collection.toCollection(retArr)},Container.prototype._descendants=function(fn){for(var i=0;i<this.children.length;i++){var child=this.children[i];if(fn(child))return!0;if(child.hasChildren()&&child._descendants(fn))return!0}return!1},Container.prototype.toObject=function(){var obj=Node.prototype.toObject.call(this);obj.children=[];for(var children=this.getChildren(),len=children.length,n=0;n<len;n++){var child=children[n];obj.children.push(child.toObject())}return obj},Container.prototype.isAncestorOf=function(node){for(var parent=node.getParent();parent;){if(parent._id===this._id)return!0;parent=parent.getParent()}return!1},Container.prototype.clone=function(obj){var node=Node.prototype.clone.call(this,obj);return this.getChildren().each(function(no){node.add(no.clone())}),node},Container.prototype.getAllIntersections=function(pos){var arr=[];return this.find("Shape").each(function(shape){shape.isVisible()&&shape.intersects(pos)&&arr.push(shape)}),arr},Container.prototype._setChildrenIndices=function(){this.children.each(function(child,n){child.index=n})},Container.prototype.drawScene=function(can,top){var layer=this.getLayer(),canvas=can||layer&&layer.getCanvas(),context=canvas&&canvas.getContext(),cachedCanvas=this._getCanvasCache(),cachedSceneCanvas=cachedCanvas&&cachedCanvas.scene,caching=canvas&&canvas.isCache;if(!this.isVisible()&&!caching)return this;if(cachedSceneCanvas){context.save();var m=this.getAbsoluteTransform(top).getMatrix();context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedSceneCanvas(context),context.restore()}else this._drawChildren("drawScene",canvas,top);return this},Container.prototype.drawHit=function(can,top){if(!this.shouldDrawHit(top))return this;var layer=this.getLayer(),canvas=can||layer&&layer.hitCanvas,context=canvas&&canvas.getContext(),cachedCanvas=this._getCanvasCache();if(cachedCanvas&&cachedCanvas.hit){context.save();var m=this.getAbsoluteTransform(top).getMatrix();context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(context),context.restore()}else this._drawChildren("drawHit",canvas,top);return this},Container.prototype._drawChildren=function(drawMethod,canvas,top){var context=canvas&&canvas.getContext(),clipWidth=this.clipWidth(),clipHeight=this.clipHeight(),clipFunc=this.clipFunc(),hasClip=clipWidth&&clipHeight||clipFunc,selfCache=top===this;if(hasClip){context.save();var transform=this.getAbsoluteTransform(top),m=transform.getMatrix();if(context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),context.beginPath(),clipFunc)clipFunc.call(this,context,this);else{var clipX=this.clipX(),clipY=this.clipY();context.rect(clipX,clipY,clipWidth,clipHeight)}context.clip(),m=transform.copy().invert().getMatrix(),context.transform(m[0],m[1],m[2],m[3],m[4],m[5])}var hasComposition=!selfCache&&"source-over"!==this.globalCompositeOperation()&&"drawScene"===drawMethod;hasComposition&&(context.save(),context._applyGlobalCompositeOperation(this)),this.children.each(function(child){child[drawMethod](canvas,top)}),hasComposition&&context.restore(),hasClip&&context.restore()},Container.prototype.getClientRect=function(config){var minX,minY,maxX,maxY,skipTransform=(config=config||{}).skipTransform,relativeTo=config.relativeTo,selfRect={x:1/0,y:1/0,width:0,height:0},that=this;this.children.each(function(child){if(child.visible()){var rect=child.getClientRect({relativeTo:that,skipShadow:config.skipShadow,skipStroke:config.skipStroke});0===rect.width&&0===rect.height||(void 0===minX?(minX=rect.x,minY=rect.y,maxX=rect.x+rect.width,maxY=rect.y+rect.height):(minX=Math.min(minX,rect.x),minY=Math.min(minY,rect.y),maxX=Math.max(maxX,rect.x+rect.width),maxY=Math.max(maxY,rect.y+rect.height)))}});for(var shapes=this.find("Shape"),hasVisible=!1,i=0;i<shapes.length;i++){if(shapes[i]._isVisible(this)){hasVisible=!0;break}}return selfRect=hasVisible&&void 0!==minX?{x:minX,y:minY,width:maxX-minX,height:maxY-minY}:{x:0,y:0,width:0,height:0},skipTransform?selfRect:this._transformedRect(selfRect,relativeTo)},Container}(Node);Factory.addComponentsGetterSetter(Container,"clip",["x","y","width","height"]),Factory.addGetterSetter(Container,"clipX",void 0,getNumberValidator()),Factory.addGetterSetter(Container,"clipY",void 0,getNumberValidator()),Factory.addGetterSetter(Container,"clipWidth",void 0,getNumberValidator()),Factory.addGetterSetter(Container,"clipHeight",void 0,getNumberValidator()),Factory.addGetterSetter(Container,"clipFunc"),Collection.mapMethods(Container);var Captures=new Map,SUPPORT_POINTER_EVENTS=void 0!==Konva._global.PointerEvent;function getCapturedShape(pointerId){return Captures.get(pointerId)}function createEvent(evt){return{evt:evt,pointerId:evt.pointerId}}function hasPointerCapture(pointerId,shape){return Captures.get(pointerId)===shape}function setPointerCapture(pointerId,shape){releaseCapture(pointerId),shape.getStage()&&(Captures.set(pointerId,shape),SUPPORT_POINTER_EVENTS&&shape._fire("gotpointercapture",createEvent(new PointerEvent("gotpointercapture"))))}function releaseCapture(pointerId,target){var shape=Captures.get(pointerId);if(shape){var stage=shape.getStage();stage&&stage.content,Captures.delete(pointerId),SUPPORT_POINTER_EVENTS&&shape._fire("lostpointercapture",createEvent(new PointerEvent("lostpointercapture")))}}var UNDERSCORE="_",EVENTS=["mouseenter","mousedown","mousemove","mouseup","mouseout","touchstart","touchmove","touchend","mouseover","wheel","contextmenu","pointerdown","pointermove","pointerup","pointercancel","lostpointercapture"],eventsLength=EVENTS.length;function addEvent(ctx,eventName){ctx.content.addEventListener(eventName,function(evt){ctx[UNDERSCORE+eventName](evt)},!1)}var stages=[];function checkNoClip(attrs){return void 0===attrs&&(attrs={}),(attrs.clipFunc||attrs.clipWidth||attrs.clipHeight)&&Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),attrs}var Stage=function(_super){function Stage(config){var _this=_super.call(this,checkNoClip(config))||this;return _this._pointerPositions=[],_this._changedPointerPositions=[],_this._buildDOM(),_this._bindContentEvents(),stages.push(_this),_this.on("widthChange.konva heightChange.konva",_this._resizeDOM),_this.on("visibleChange.konva",_this._checkVisibility),_this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",function(){checkNoClip(_this.attrs)}),_this._checkVisibility(),_this}return __extends(Stage,_super),Stage.prototype._validateAdd=function(child){var isLayer="Layer"===child.getType(),isFastLayer="FastLayer"===child.getType();isLayer||isFastLayer||Util.throw("You may only add layers to the stage.")},Stage.prototype._checkVisibility=function(){if(this.content){var style=this.visible()?"":"none";this.content.style.display=style}},Stage.prototype.setContainer=function(container){if("string"==typeof container){if("."===container.charAt(0)){var className=container.slice(1);container=document.getElementsByClassName(className)[0]}else{var id;id="#"!==container.charAt(0)?container:container.slice(1),container=document.getElementById(id)}if(!container)throw"Can not find container in document with id "+id}return this._setAttr("container",container),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),container.appendChild(this.content)),this},Stage.prototype.shouldDrawHit=function(){return!0},Stage.prototype.clear=function(){var n,layers=this.children,len=layers.length;for(n=0;n<len;n++)layers[n].clear();return this},Stage.prototype.clone=function(obj){return obj||(obj={}),obj.container=document.createElement("div"),Container.prototype.clone.call(this,obj)},Stage.prototype.destroy=function(){_super.prototype.destroy.call(this);var content=this.content;content&&Util._isInDocument(content)&&this.container().removeChild(content);var index=stages.indexOf(this);return index>-1&&stages.splice(index,1),this},Stage.prototype.getPointerPosition=function(){var pos=this._pointerPositions[0]||this._changedPointerPositions[0];return pos?{x:pos.x,y:pos.y}:(Util.warn("Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);"),null)},Stage.prototype._getPointerById=function(id){return this._pointerPositions.find(function(p){return p.id===id})},Stage.prototype.getPointersPositions=function(){return this._pointerPositions},Stage.prototype.getStage=function(){return this},Stage.prototype.getContent=function(){return this.content},Stage.prototype._toKonvaCanvas=function(config){var x=(config=config||{}).x||0,y=config.y||0,canvas=new SceneCanvas({width:config.width||this.width(),height:config.height||this.height(),pixelRatio:config.pixelRatio||1}),_context=canvas.getContext()._context,layers=this.children;return(x||y)&&_context.translate(-1*x,-1*y),layers.each(function(layer){if(layer.isVisible()){var layerCanvas=layer._toKonvaCanvas(config);_context.drawImage(layerCanvas._canvas,x,y,layerCanvas.getWidth()/layerCanvas.getPixelRatio(),layerCanvas.getHeight()/layerCanvas.getPixelRatio())}}),canvas},Stage.prototype.getIntersection=function(pos,selector){if(!pos)return null;var n,shape,layers=this.children;for(n=layers.length-1;n>=0;n--)if(shape=layers[n].getIntersection(pos,selector))return shape;return null},Stage.prototype._resizeDOM=function(){var width=this.width(),height=this.height();this.content&&(this.content.style.width=width+"px",this.content.style.height=height+"px"),this.bufferCanvas.setSize(width,height),this.bufferHitCanvas.setSize(width,height),this.children.each(function(layer){layer.setSize({width:width,height:height}),layer.draw()})},Stage.prototype.add=function(layer){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}_super.prototype.add.call(this,layer);var length=this.children.length;return length>5&&Util.warn("The stage has "+length+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),layer.setSize({width:this.width(),height:this.height()}),layer.draw(),Konva.isBrowser&&this.content.appendChild(layer.canvas._canvas),this},Stage.prototype.getParent=function(){return null},Stage.prototype.getLayer=function(){return null},Stage.prototype.hasPointerCapture=function(pointerId){return hasPointerCapture(pointerId,this)},Stage.prototype.setPointerCapture=function(pointerId){setPointerCapture(pointerId,this)},Stage.prototype.releaseCapture=function(pointerId){releaseCapture(pointerId)},Stage.prototype.getLayers=function(){return this.getChildren()},Stage.prototype._bindContentEvents=function(){if(Konva.isBrowser)for(var n=0;n<eventsLength;n++)addEvent(this,EVENTS[n])},Stage.prototype._mouseenter=function(evt){this.setPointersPositions(evt),this._fire("mouseenter",{evt:evt,target:this,currentTarget:this})},Stage.prototype._mouseover=function(evt){this.setPointersPositions(evt),this._fire("contentMouseover",{evt:evt}),this._fire("mouseover",{evt:evt,target:this,currentTarget:this})},Stage.prototype._mouseout=function(evt){var _a;this.setPointersPositions(evt);var targetShape=(null===(_a=this.targetShape)||void 0===_a?void 0:_a.getStage())?this.targetShape:null,eventsEnabled=!DD.isDragging||Konva.hitOnDragEnabled;targetShape&&eventsEnabled?(targetShape._fireAndBubble("mouseout",{evt:evt}),targetShape._fireAndBubble("mouseleave",{evt:evt}),this._fire("mouseleave",{evt:evt,target:this,currentTarget:this}),this.targetShape=null):eventsEnabled&&(this._fire("mouseleave",{evt:evt,target:this,currentTarget:this}),this._fire("mouseout",{evt:evt,target:this,currentTarget:this})),this.pointerPos=void 0,this._pointerPositions=[],this._fire("contentMouseout",{evt:evt})},Stage.prototype._mousemove=function(evt){var _a;if(Konva.UA.ieMobile)return this._touchmove(evt);this.setPointersPositions(evt);var shape,pointerId=Util._getFirstPointerId(evt),targetShape=(null===(_a=this.targetShape)||void 0===_a?void 0:_a.getStage())?this.targetShape:null,eventsEnabled=!DD.isDragging||Konva.hitOnDragEnabled;if(eventsEnabled){if((shape=this.getIntersection(this.getPointerPosition()))&&shape.isListening())eventsEnabled&&targetShape!==shape?(targetShape&&(targetShape._fireAndBubble("mouseout",{evt:evt,pointerId:pointerId},shape),targetShape._fireAndBubble("mouseleave",{evt:evt,pointerId:pointerId},shape)),shape._fireAndBubble("mouseover",{evt:evt,pointerId:pointerId},targetShape),shape._fireAndBubble("mouseenter",{evt:evt,pointerId:pointerId},targetShape),shape._fireAndBubble("mousemove",{evt:evt,pointerId:pointerId}),this.targetShape=shape):shape._fireAndBubble("mousemove",{evt:evt,pointerId:pointerId});else targetShape&&eventsEnabled&&(targetShape._fireAndBubble("mouseout",{evt:evt,pointerId:pointerId}),targetShape._fireAndBubble("mouseleave",{evt:evt,pointerId:pointerId}),this._fire("mouseover",{evt:evt,target:this,currentTarget:this,pointerId:pointerId}),this.targetShape=null),this._fire("mousemove",{evt:evt,target:this,currentTarget:this,pointerId:pointerId});this._fire("contentMousemove",{evt:evt})}evt.cancelable&&evt.preventDefault()},Stage.prototype._mousedown=function(evt){if(Konva.UA.ieMobile)return this._touchstart(evt);this.setPointersPositions(evt);var pointerId=Util._getFirstPointerId(evt),shape=this.getIntersection(this.getPointerPosition());DD.justDragged=!1,Konva.listenClickTap=!0,shape&&shape.isListening()?(this.clickStartShape=shape,shape._fireAndBubble("mousedown",{evt:evt,pointerId:pointerId})):this._fire("mousedown",{evt:evt,target:this,currentTarget:this,pointerId:pointerId}),this._fire("contentMousedown",{evt:evt})},Stage.prototype._mouseup=function(evt){if(Konva.UA.ieMobile)return this._touchend(evt);this.setPointersPositions(evt);var pointerId=Util._getFirstPointerId(evt),shape=this.getIntersection(this.getPointerPosition()),clickStartShape=this.clickStartShape,clickEndShape=this.clickEndShape,fireDblClick=!1;Konva.inDblClickWindow?(fireDblClick=!0,clearTimeout(this.dblTimeout)):DD.justDragged||(Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout)),this.dblTimeout=setTimeout(function(){Konva.inDblClickWindow=!1},Konva.dblClickWindow),shape&&shape.isListening()?(this.clickEndShape=shape,shape._fireAndBubble("mouseup",{evt:evt,pointerId:pointerId}),Konva.listenClickTap&&clickStartShape&&clickStartShape._id===shape._id&&(shape._fireAndBubble("click",{evt:evt,pointerId:pointerId}),fireDblClick&&clickEndShape&&clickEndShape===shape&&shape._fireAndBubble("dblclick",{evt:evt,pointerId:pointerId}))):(this.clickEndShape=null,this._fire("mouseup",{evt:evt,target:this,currentTarget:this,pointerId:pointerId}),Konva.listenClickTap&&this._fire("click",{evt:evt,target:this,currentTarget:this,pointerId:pointerId}),fireDblClick&&this._fire("dblclick",{evt:evt,target:this,currentTarget:this,pointerId:pointerId})),this._fire("contentMouseup",{evt:evt}),Konva.listenClickTap&&(this._fire("contentClick",{evt:evt}),fireDblClick&&this._fire("contentDblclick",{evt:evt})),Konva.listenClickTap=!1,evt.cancelable&&evt.preventDefault()},Stage.prototype._contextmenu=function(evt){this.setPointersPositions(evt);var shape=this.getIntersection(this.getPointerPosition());shape&&shape.isListening()?shape._fireAndBubble("contextmenu",{evt:evt}):this._fire("contextmenu",{evt:evt,target:this,currentTarget:this}),this._fire("contentContextmenu",{evt:evt})},Stage.prototype._touchstart=function(evt){var _this=this;this.setPointersPositions(evt);var triggeredOnShape=!1;this._changedPointerPositions.forEach(function(pos){var shape=_this.getIntersection(pos);Konva.listenClickTap=!0,DD.justDragged=!1,shape&&shape.isListening()&&(Konva.captureTouchEventsEnabled&&shape.setPointerCapture(pos.id),_this.tapStartShape=shape,shape._fireAndBubble("touchstart",{evt:evt,pointerId:pos.id},_this),triggeredOnShape=!0,shape.isListening()&&shape.preventDefault()&&evt.cancelable&&evt.preventDefault())}),triggeredOnShape||this._fire("touchstart",{evt:evt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire("contentTouchstart",{evt:evt})},Stage.prototype._touchmove=function(evt){var _this=this;if(this.setPointersPositions(evt),!DD.isDragging||Konva.hitOnDragEnabled){var triggeredOnShape=!1,processedShapesIds={};this._changedPointerPositions.forEach(function(pos){var shape=getCapturedShape(pos.id)||_this.getIntersection(pos);shape&&shape.isListening()&&(processedShapesIds[shape._id]||(processedShapesIds[shape._id]=!0,shape._fireAndBubble("touchmove",{evt:evt,pointerId:pos.id}),triggeredOnShape=!0,shape.isListening()&&shape.preventDefault()&&evt.cancelable&&evt.preventDefault()))}),triggeredOnShape||this._fire("touchmove",{evt:evt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire("contentTouchmove",{evt:evt})}DD.isDragging&&DD.node.preventDefault()&&evt.cancelable&&evt.preventDefault()},Stage.prototype._touchend=function(evt){var _this=this;this.setPointersPositions(evt);var tapEndShape=this.tapEndShape,fireDblClick=!1;Konva.inDblClickWindow?(fireDblClick=!0,clearTimeout(this.dblTimeout)):DD.justDragged||(Konva.inDblClickWindow=!0,clearTimeout(this.dblTimeout)),this.dblTimeout=setTimeout(function(){Konva.inDblClickWindow=!1},Konva.dblClickWindow);var triggeredOnShape=!1,processedShapesIds={},tapTriggered=!1,dblTapTriggered=!1;this._changedPointerPositions.forEach(function(pos){var shape=getCapturedShape(pos.id)||_this.getIntersection(pos);shape&&shape.releaseCapture(pos.id),shape&&shape.isListening()&&(processedShapesIds[shape._id]||(processedShapesIds[shape._id]=!0,_this.tapEndShape=shape,shape._fireAndBubble("touchend",{evt:evt,pointerId:pos.id}),triggeredOnShape=!0,Konva.listenClickTap&&shape===_this.tapStartShape&&(tapTriggered=!0,shape._fireAndBubble("tap",{evt:evt,pointerId:pos.id}),fireDblClick&&tapEndShape&&tapEndShape===shape&&(dblTapTriggered=!0,shape._fireAndBubble("dbltap",{evt:evt,pointerId:pos.id}))),shape.isListening()&&shape.preventDefault()&&evt.cancelable&&evt.preventDefault()))}),triggeredOnShape||this._fire("touchend",{evt:evt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Konva.listenClickTap&&!tapTriggered&&(this.tapEndShape=null,this._fire("tap",{evt:evt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})),fireDblClick&&!dblTapTriggered&&this._fire("dbltap",{evt:evt,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),this._fire("contentTouchend",{evt:evt}),Konva.listenClickTap&&(this._fire("contentTap",{evt:evt}),fireDblClick&&this._fire("contentDbltap",{evt:evt})),this.preventDefault()&&evt.cancelable&&evt.preventDefault(),Konva.listenClickTap=!1},Stage.prototype._wheel=function(evt){this.setPointersPositions(evt);var shape=this.getIntersection(this.getPointerPosition());shape&&shape.isListening()?shape._fireAndBubble("wheel",{evt:evt}):this._fire("wheel",{evt:evt,target:this,currentTarget:this}),this._fire("contentWheel",{evt:evt})},Stage.prototype._pointerdown=function(evt){if(Konva._pointerEventsEnabled){this.setPointersPositions(evt);var shape=getCapturedShape(evt.pointerId)||this.getIntersection(this.getPointerPosition());shape&&shape._fireAndBubble("pointerdown",createEvent(evt))}},Stage.prototype._pointermove=function(evt){if(Konva._pointerEventsEnabled){this.setPointersPositions(evt);var shape=getCapturedShape(evt.pointerId)||this.getIntersection(this.getPointerPosition());shape&&shape._fireAndBubble("pointermove",createEvent(evt))}},Stage.prototype._pointerup=function(evt){if(Konva._pointerEventsEnabled){this.setPointersPositions(evt);var shape=getCapturedShape(evt.pointerId)||this.getIntersection(this.getPointerPosition());shape&&shape._fireAndBubble("pointerup",createEvent(evt)),releaseCapture(evt.pointerId)}},Stage.prototype._pointercancel=function(evt){if(Konva._pointerEventsEnabled){this.setPointersPositions(evt);var shape=getCapturedShape(evt.pointerId)||this.getIntersection(this.getPointerPosition());shape&&shape._fireAndBubble("pointerup",createEvent(evt)),releaseCapture(evt.pointerId)}},Stage.prototype._lostpointercapture=function(evt){releaseCapture(evt.pointerId)},Stage.prototype.setPointersPositions=function(evt){var _this=this,contentPosition=this._getContentPosition(),x=null,y=null;void 0!==(evt=evt||window.event).touches?(this._pointerPositions=[],this._changedPointerPositions=[],Collection.prototype.each.call(evt.touches,function(touch){_this._pointerPositions.push({id:touch.identifier,x:(touch.clientX-contentPosition.left)/contentPosition.scaleX,y:(touch.clientY-contentPosition.top)/contentPosition.scaleY})}),Collection.prototype.each.call(evt.changedTouches||evt.touches,function(touch){_this._changedPointerPositions.push({id:touch.identifier,x:(touch.clientX-contentPosition.left)/contentPosition.scaleX,y:(touch.clientY-contentPosition.top)/contentPosition.scaleY})})):(x=(evt.clientX-contentPosition.left)/contentPosition.scaleX,y=(evt.clientY-contentPosition.top)/contentPosition.scaleY,this.pointerPos={x:x,y:y},this._pointerPositions=[{x:x,y:y,id:Util._getFirstPointerId(evt)}],this._changedPointerPositions=[{x:x,y:y,id:Util._getFirstPointerId(evt)}])},Stage.prototype._setPointerPosition=function(evt){Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(evt)},Stage.prototype._getContentPosition=function(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};var rect=this.content.getBoundingClientRect();return{top:rect.top,left:rect.left,scaleX:rect.width/this.content.clientWidth||1,scaleY:rect.height/this.content.clientHeight||1}},Stage.prototype._buildDOM=function(){if(this.bufferCanvas=new SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),Konva.isBrowser){var container=this.container();if(!container)throw"Stage has no container. A container is required.";container.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),container.appendChild(this.content),this._resizeDOM()}},Stage.prototype.cache=function(){return Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this},Stage.prototype.clearCache=function(){return this},Stage.prototype.batchDraw=function(){return this.children.each(function(layer){layer.batchDraw()}),this},Stage}(Container);Stage.prototype.nodeType="Stage",_registerNode(Stage),Factory.addGetterSetter(Stage,"container");var dummyContext,HAS_SHADOW="hasShadow",SHADOW_RGBA="shadowRGBA",patternImage="patternImage",linearGradient="linearGradient",radialGradient="radialGradient";function getDummyContext(){return dummyContext||(dummyContext=Util.createCanvasElement().getContext("2d"))}var shapes={};function _clearHasShadowCache(){this._clearCache(HAS_SHADOW)}function _clearGetShadowRGBACache(){this._clearCache(SHADOW_RGBA)}function _clearFillPatternCache(){this._clearCache(patternImage)}function _clearLinearGradientCache(){this._clearCache(linearGradient)}function _clearRadialGradientCache(){this._clearCache(radialGradient)}var Shape=function(_super){function Shape(config){for(var key,_this=_super.call(this,config)||this;!(key=Util.getRandomColor())||key in shapes;);return _this.colorKey=key,shapes[key]=_this,_this.on("shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_clearHasShadowCache),_this.on("shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_clearGetShadowRGBACache),_this.on("fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva",_clearFillPatternCache),_this.on("fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",_clearLinearGradientCache),_this.on("fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",_clearRadialGradientCache),_this}return __extends(Shape,_super),Shape.prototype.getContext=function(){return this.getLayer().getContext()},Shape.prototype.getCanvas=function(){return this.getLayer().getCanvas()},Shape.prototype.getSceneFunc=function(){return this.attrs.sceneFunc||this._sceneFunc},Shape.prototype.getHitFunc=function(){return this.attrs.hitFunc||this._hitFunc},Shape.prototype.hasShadow=function(){return this._getCache(HAS_SHADOW,this._hasShadow)},Shape.prototype._hasShadow=function(){return this.shadowEnabled()&&0!==this.shadowOpacity()&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())},Shape.prototype._getFillPattern=function(){return this._getCache(patternImage,this.__getFillPattern)},Shape.prototype.__getFillPattern=function(){if(this.fillPatternImage())return getDummyContext().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat")},Shape.prototype._getLinearGradient=function(){return this._getCache(linearGradient,this.__getLinearGradient)},Shape.prototype.__getLinearGradient=function(){var colorStops=this.fillLinearGradientColorStops();if(colorStops){for(var ctx=getDummyContext(),start=this.fillLinearGradientStartPoint(),end=this.fillLinearGradientEndPoint(),grd=ctx.createLinearGradient(start.x,start.y,end.x,end.y),n=0;n<colorStops.length;n+=2)grd.addColorStop(colorStops[n],colorStops[n+1]);return grd}},Shape.prototype._getRadialGradient=function(){return this._getCache(radialGradient,this.__getRadialGradient)},Shape.prototype.__getRadialGradient=function(){var colorStops=this.fillRadialGradientColorStops();if(colorStops){for(var ctx=getDummyContext(),start=this.fillRadialGradientStartPoint(),end=this.fillRadialGradientEndPoint(),grd=ctx.createRadialGradient(start.x,start.y,this.fillRadialGradientStartRadius(),end.x,end.y,this.fillRadialGradientEndRadius()),n=0;n<colorStops.length;n+=2)grd.addColorStop(colorStops[n],colorStops[n+1]);return grd}},Shape.prototype.getShadowRGBA=function(){return this._getCache(SHADOW_RGBA,this._getShadowRGBA)},Shape.prototype._getShadowRGBA=function(){if(this.hasShadow()){var rgba=Util.colorToRGBA(this.shadowColor());return"rgba("+rgba.r+","+rgba.g+","+rgba.b+","+rgba.a*(this.shadowOpacity()||1)+")"}},Shape.prototype.hasFill=function(){var _this=this;return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],function(){return _this.fillEnabled()&&!!(_this.fill()||_this.fillPatternImage()||_this.fillLinearGradientColorStops()||_this.fillRadialGradientColorStops())})},Shape.prototype.hasStroke=function(){var _this=this;return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],function(){return _this.strokeEnabled()&&_this.strokeWidth()&&!(!_this.stroke()&&!_this.strokeLinearGradientColorStops())})},Shape.prototype.hasHitStroke=function(){var width=this.hitStrokeWidth();return"auto"===width?this.hasStroke():this.strokeEnabled()&&!!width},Shape.prototype.intersects=function(point){var bufferHitCanvas=this.getStage().bufferHitCanvas;return bufferHitCanvas.getContext().clear(),this.drawHit(bufferHitCanvas),bufferHitCanvas.context.getImageData(Math.round(point.x),Math.round(point.y),1,1).data[3]>0},Shape.prototype.destroy=function(){return Node.prototype.destroy.call(this),delete shapes[this.colorKey],delete this.colorKey,this},Shape.prototype._useBufferCanvas=function(forceFill){var _a;if(!this.getStage())return!1;if(!(null===(_a=this.attrs.perfectDrawEnabled)||void 0===_a||_a))return!1;var hasFill=forceFill||this.hasFill(),hasStroke=this.hasStroke(),isTransparent=1!==this.getAbsoluteOpacity();if(hasFill&&hasStroke&&isTransparent)return!0;var hasShadow=this.hasShadow(),strokeForShadow=this.shadowForStrokeEnabled();return!!(hasFill&&hasStroke&&hasShadow&&strokeForShadow)},Shape.prototype.setStrokeHitEnabled=function(val){Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),val?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)},Shape.prototype.getStrokeHitEnabled=function(){return 0!==this.hitStrokeWidth()},Shape.prototype.getSelfRect=function(){var size=this.size();return{x:this._centroid?-size.width/2:0,y:this._centroid?-size.height/2:0,width:size.width,height:size.height}},Shape.prototype.getClientRect=function(attrs){var skipTransform=(attrs=attrs||{}).skipTransform,relativeTo=attrs.relativeTo,fillRect=this.getSelfRect(),strokeWidth=!attrs.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,fillAndStrokeWidth=fillRect.width+strokeWidth,fillAndStrokeHeight=fillRect.height+strokeWidth,applyShadow=!attrs.skipShadow&&this.hasShadow(),shadowOffsetX=applyShadow?this.shadowOffsetX():0,shadowOffsetY=applyShadow?this.shadowOffsetY():0,preWidth=fillAndStrokeWidth+Math.abs(shadowOffsetX),preHeight=fillAndStrokeHeight+Math.abs(shadowOffsetY),blurRadius=applyShadow&&this.shadowBlur()||0,width=preWidth+2*blurRadius,height=preHeight+2*blurRadius,roundingOffset=0;Math.round(strokeWidth/2)!==strokeWidth/2&&(roundingOffset=1);var rect={width:width+roundingOffset,height:height+roundingOffset,x:-Math.round(strokeWidth/2+blurRadius)+Math.min(shadowOffsetX,0)+fillRect.x,y:-Math.round(strokeWidth/2+blurRadius)+Math.min(shadowOffsetY,0)+fillRect.y};return skipTransform?rect:this._transformedRect(rect,relativeTo)},Shape.prototype.drawScene=function(can,top){var bufferCanvas,bufferContext,layer=this.getLayer(),canvas=can||layer.getCanvas(),context=canvas.getContext(),cachedCanvas=this._getCanvasCache(),drawFunc=this.getSceneFunc(),hasShadow=this.hasShadow(),caching=canvas.isCache,skipBuffer=canvas.isCache,cachingSelf=top===this;if(!this.isVisible()&&!caching)return this;if(cachedCanvas){context.save();var m=this.getAbsoluteTransform(top).getMatrix();return context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedSceneCanvas(context),context.restore(),this}if(!drawFunc)return this;if(context.save(),this._useBufferCanvas()&&!skipBuffer){(bufferContext=(bufferCanvas=this.getStage().bufferCanvas).getContext()).clear(),bufferContext.save(),bufferContext._applyLineJoin(this);var o=this.getAbsoluteTransform(top).getMatrix();bufferContext.transform(o[0],o[1],o[2],o[3],o[4],o[5]),drawFunc.call(this,bufferContext,this),bufferContext.restore();var ratio=bufferCanvas.pixelRatio;hasShadow&&context._applyShadow(this),context._applyOpacity(this),context._applyGlobalCompositeOperation(this),context.drawImage(bufferCanvas._canvas,0,0,bufferCanvas.width/ratio,bufferCanvas.height/ratio)}else{if(context._applyLineJoin(this),!cachingSelf){o=this.getAbsoluteTransform(top).getMatrix();context.transform(o[0],o[1],o[2],o[3],o[4],o[5]),context._applyOpacity(this),context._applyGlobalCompositeOperation(this)}hasShadow&&context._applyShadow(this),drawFunc.call(this,context,this)}return context.restore(),this},Shape.prototype.drawHit=function(can,top){if(!this.shouldDrawHit(top))return this;var layer=this.getLayer(),canvas=can||layer.hitCanvas,context=canvas&&canvas.getContext(),drawFunc=this.hitFunc()||this.sceneFunc(),cachedCanvas=this._getCanvasCache(),cachedHitCanvas=cachedCanvas&&cachedCanvas.hit;if(this.colorKey||(console.log(this),Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. See the shape in logs above. If you want to reuse shape you should call remove() instead of destroy()")),cachedHitCanvas){context.save();var m=this.getAbsoluteTransform(top).getMatrix();return context.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(context),context.restore(),this}if(!drawFunc)return this;if(context.save(),context._applyLineJoin(this),!(this===top)){var o=this.getAbsoluteTransform(top).getMatrix();context.transform(o[0],o[1],o[2],o[3],o[4],o[5])}return drawFunc.call(this,context,this),context.restore(),this},Shape.prototype.drawHitFromCache=function(alphaThreshold){void 0===alphaThreshold&&(alphaThreshold=0);var hitImageData,hitData,len,rgbColorKey,i,cachedCanvas=this._getCanvasCache(),sceneCanvas=this._getCachedSceneCanvas(),hitCanvas=cachedCanvas.hit,hitContext=hitCanvas.getContext(),hitWidth=hitCanvas.getWidth(),hitHeight=hitCanvas.getHeight();hitContext.clear(),hitContext.drawImage(sceneCanvas._canvas,0,0,hitWidth,hitHeight);try{for(len=(hitData=(hitImageData=hitContext.getImageData(0,0,hitWidth,hitHeight)).data).length,rgbColorKey=Util._hexToRgb(this.colorKey),i=0;i<len;i+=4)hitData[i+3]>alphaThreshold?(hitData[i]=rgbColorKey.r,hitData[i+1]=rgbColorKey.g,hitData[i+2]=rgbColorKey.b,hitData[i+3]=255):hitData[i+3]=0;hitContext.putImageData(hitImageData,0,0)}catch(e){Util.error("Unable to draw hit graph from cached scene canvas. "+e.message)}return this},Shape.prototype.hasPointerCapture=function(pointerId){return hasPointerCapture(pointerId,this)},Shape.prototype.setPointerCapture=function(pointerId){setPointerCapture(pointerId,this)},Shape.prototype.releaseCapture=function(pointerId){releaseCapture(pointerId)},Shape}(Node);Shape.prototype._fillFunc=function(context){context.fill()},Shape.prototype._strokeFunc=function(context){context.stroke()},Shape.prototype._fillFuncHit=function(context){context.fill()},Shape.prototype._strokeFuncHit=function(context){context.stroke()},Shape.prototype._centroid=!1,Shape.prototype.nodeType="Shape",_registerNode(Shape),Factory.addGetterSetter(Shape,"stroke",void 0,getStringValidator()),Factory.addGetterSetter(Shape,"strokeWidth",2,getNumberValidator()),Factory.addGetterSetter(Shape,"hitStrokeWidth","auto",getNumberOrAutoValidator()),Factory.addGetterSetter(Shape,"strokeHitEnabled",!0,getBooleanValidator()),Factory.addGetterSetter(Shape,"perfectDrawEnabled",!0,getBooleanValidator()),Factory.addGetterSetter(Shape,"shadowForStrokeEnabled",!0,getBooleanValidator()),Factory.addGetterSetter(Shape,"lineJoin"),Factory.addGetterSetter(Shape,"lineCap"),Factory.addGetterSetter(Shape,"sceneFunc"),Factory.addGetterSetter(Shape,"hitFunc"),Factory.addGetterSetter(Shape,"dash"),Factory.addGetterSetter(Shape,"dashOffset",0,getNumberValidator()),Factory.addGetterSetter(Shape,"shadowColor",void 0,getStringValidator()),Factory.addGetterSetter(Shape,"shadowBlur",0,getNumberValidator()),Factory.addGetterSetter(Shape,"shadowOpacity",1,getNumberValidator()),Factory.addComponentsGetterSetter(Shape,"shadowOffset",["x","y"]),Factory.addGetterSetter(Shape,"shadowOffsetX",0,getNumberValidator()),Factory.addGetterSetter(Shape,"shadowOffsetY",0,getNumberValidator()),Factory.addGetterSetter(Shape,"fillPatternImage"),Factory.addGetterSetter(Shape,"fill",void 0,getStringValidator()),Factory.addGetterSetter(Shape,"fillPatternX",0,getNumberValidator()),Factory.addGetterSetter(Shape,"fillPatternY",0,getNumberValidator()),Factory.addGetterSetter(Shape,"fillLinearGradientColorStops"),Factory.addGetterSetter(Shape,"strokeLinearGradientColorStops"),Factory.addGetterSetter(Shape,"fillRadialGradientStartRadius",0),Factory.addGetterSetter(Shape,"fillRadialGradientEndRadius",0),Factory.addGetterSetter(Shape,"fillRadialGradientColorStops"),Factory.addGetterSetter(Shape,"fillPatternRepeat","repeat"),Factory.addGetterSetter(Shape,"fillEnabled",!0),Factory.addGetterSetter(Shape,"strokeEnabled",!0),Factory.addGetterSetter(Shape,"shadowEnabled",!0),Factory.addGetterSetter(Shape,"dashEnabled",!0),Factory.addGetterSetter(Shape,"strokeScaleEnabled",!0),Factory.addGetterSetter(Shape,"fillPriority","color"),Factory.addComponentsGetterSetter(Shape,"fillPatternOffset",["x","y"]),Factory.addGetterSetter(Shape,"fillPatternOffsetX",0,getNumberValidator()),Factory.addGetterSetter(Shape,"fillPatternOffsetY",0,getNumberValidator()),Factory.addComponentsGetterSetter(Shape,"fillPatternScale",["x","y"]),Factory.addGetterSetter(Shape,"fillPatternScaleX",1,getNumberValidator()),Factory.addGetterSetter(Shape,"fillPatternScaleY",1,getNumberValidator()),Factory.addComponentsGetterSetter(Shape,"fillLinearGradientStartPoint",["x","y"]),Factory.addComponentsGetterSetter(Shape,"strokeLinearGradientStartPoint",["x","y"]),Factory.addGetterSetter(Shape,"fillLinearGradientStartPointX",0),Factory.addGetterSetter(Shape,"strokeLinearGradientStartPointX",0),Factory.addGetterSetter(Shape,"fillLinearGradientStartPointY",0),Factory.addGetterSetter(Shape,"strokeLinearGradientStartPointY",0),Factory.addComponentsGetterSetter(Shape,"fillLinearGradientEndPoint",["x","y"]),Factory.addComponentsGetterSetter(Shape,"strokeLinearGradientEndPoint",["x","y"]),Factory.addGetterSetter(Shape,"fillLinearGradientEndPointX",0),Factory.addGetterSetter(Shape,"strokeLinearGradientEndPointX",0),Factory.addGetterSetter(Shape,"fillLinearGradientEndPointY",0),Factory.addGetterSetter(Shape,"strokeLinearGradientEndPointY",0),Factory.addComponentsGetterSetter(Shape,"fillRadialGradientStartPoint",["x","y"]),Factory.addGetterSetter(Shape,"fillRadialGradientStartPointX",0),Factory.addGetterSetter(Shape,"fillRadialGradientStartPointY",0),Factory.addComponentsGetterSetter(Shape,"fillRadialGradientEndPoint",["x","y"]),Factory.addGetterSetter(Shape,"fillRadialGradientEndPointX",0),Factory.addGetterSetter(Shape,"fillRadialGradientEndPointY",0),Factory.addGetterSetter(Shape,"fillPatternRotation",0),Factory.backCompat(Shape,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"}),Collection.mapMethods(Shape);var INTERSECTION_OFFSETS=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],INTERSECTION_OFFSETS_LEN=INTERSECTION_OFFSETS.length,Layer=function(_super){function Layer(config){var _this=_super.call(this,config)||this;return _this.canvas=new SceneCanvas,_this.hitCanvas=new HitCanvas({pixelRatio:1}),_this._waitingForDraw=!1,_this.on("visibleChange.konva",_this._checkVisibility),_this._checkVisibility(),_this.on("imageSmoothingEnabledChange.konva",_this._setSmoothEnabled),_this._setSmoothEnabled(),_this}return __extends(Layer,_super),Layer.prototype.createPNGStream=function(){return this.canvas._canvas.createPNGStream()},Layer.prototype.getCanvas=function(){return this.canvas},Layer.prototype.getHitCanvas=function(){return this.hitCanvas},Layer.prototype.getContext=function(){return this.getCanvas().getContext()},Layer.prototype.clear=function(bounds){return this.getContext().clear(bounds),this.getHitCanvas().getContext().clear(bounds),this},Layer.prototype.setZIndex=function(index){_super.prototype.setZIndex.call(this,index);var stage=this.getStage();return stage&&(stage.content.removeChild(this.getCanvas()._canvas),index<stage.children.length-1?stage.content.insertBefore(this.getCanvas()._canvas,stage.children[index+1].getCanvas()._canvas):stage.content.appendChild(this.getCanvas()._canvas)),this},Layer.prototype.moveToTop=function(){Node.prototype.moveToTop.call(this);var stage=this.getStage();return stage&&(stage.content.removeChild(this.getCanvas()._canvas),stage.content.appendChild(this.getCanvas()._canvas)),!0},Layer.prototype.moveUp=function(){if(!Node.prototype.moveUp.call(this))return!1;var stage=this.getStage();return!!stage&&(stage.content.removeChild(this.getCanvas()._canvas),this.index<stage.children.length-1?stage.content.insertBefore(this.getCanvas()._canvas,stage.children[this.index+1].getCanvas()._canvas):stage.content.appendChild(this.getCanvas()._canvas),!0)},Layer.prototype.moveDown=function(){if(Node.prototype.moveDown.call(this)){var stage=this.getStage();if(stage){var children=stage.children;stage.content.removeChild(this.getCanvas()._canvas),stage.content.insertBefore(this.getCanvas()._canvas,children[this.index+1].getCanvas()._canvas)}return!0}return!1},Layer.prototype.moveToBottom=function(){if(Node.prototype.moveToBottom.call(this)){var stage=this.getStage();if(stage){var children=stage.children;stage.content.removeChild(this.getCanvas()._canvas),stage.content.insertBefore(this.getCanvas()._canvas,children[1].getCanvas()._canvas)}return!0}return!1},Layer.prototype.getLayer=function(){return this},Layer.prototype.remove=function(){var _canvas=this.getCanvas()._canvas;return Node.prototype.remove.call(this),_canvas&&_canvas.parentNode&&Util._isInDocument(_canvas)&&_canvas.parentNode.removeChild(_canvas),this},Layer.prototype.getStage=function(){return this.parent},Layer.prototype.setSize=function(_a){var width=_a.width,height=_a.height;return this.canvas.setSize(width,height),this.hitCanvas.setSize(width,height),this._setSmoothEnabled(),this},Layer.prototype._validateAdd=function(child){var type=child.getType();"Group"!==type&&"Shape"!==type&&Util.throw("You may only add groups and shapes to a layer.")},Layer.prototype._toKonvaCanvas=function(config){return(config=config||{}).width=config.width||this.getWidth(),config.height=config.height||this.getHeight(),config.x=void 0!==config.x?config.x:this.x(),config.y=void 0!==config.y?config.y:this.y(),Node.prototype._toKonvaCanvas.call(this,config)},Layer.prototype._checkVisibility=function(){var visible=this.visible();this.canvas._canvas.style.display=visible?"block":"none"},Layer.prototype._setSmoothEnabled=function(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()},Layer.prototype.getWidth=function(){if(this.parent)return this.parent.width()},Layer.prototype.setWidth=function(){Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')},Layer.prototype.getHeight=function(){if(this.parent)return this.parent.height()},Layer.prototype.setHeight=function(){Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')},Layer.prototype.batchDraw=function(){var _this=this;return this._waitingForDraw||(this._waitingForDraw=!0,Util.requestAnimFrame(function(){_this.draw(),_this._waitingForDraw=!1})),this},Layer.prototype.getIntersection=function(pos,selector){var obj,i,intersectionOffset,shape;if(!this.isListening()||!this.isVisible())return null;for(var spiralSearchDistance=1,continueSearch=!1;;){for(i=0;i<INTERSECTION_OFFSETS_LEN;i++){if(intersectionOffset=INTERSECTION_OFFSETS[i],(shape=(obj=this._getIntersection({x:pos.x+intersectionOffset.x*spiralSearchDistance,y:pos.y+intersectionOffset.y*spiralSearchDistance})).shape)&&selector)return shape.findAncestor(selector,!0);if(shape)return shape;if(continueSearch=!!obj.antialiased,!obj.antialiased)break}if(!continueSearch)return null;spiralSearchDistance+=1}},Layer.prototype._getIntersection=function(pos){var colorKey,shape,ratio=this.hitCanvas.pixelRatio,p=this.hitCanvas.context.getImageData(Math.round(pos.x*ratio),Math.round(pos.y*ratio),1,1).data,p3=p[3];return 255===p3?(colorKey=Util._rgbToHex(p[0],p[1],p[2]),(shape=shapes["#"+colorKey])?{shape:shape}:{antialiased:!0}):p3>0?{antialiased:!0}:{}},Layer.prototype.drawScene=function(can,top){var layer=this.getLayer(),canvas=can||layer&&layer.getCanvas();return this._fire("beforeDraw",{node:this}),this.clearBeforeDraw()&&canvas.getContext().clear(),Container.prototype.drawScene.call(this,canvas,top),this._fire("draw",{node:this}),this},Layer.prototype.drawHit=function(can,top){var layer=this.getLayer(),canvas=can||layer&&layer.hitCanvas;return layer&&layer.clearBeforeDraw()&&layer.getHitCanvas().getContext().clear(),Container.prototype.drawHit.call(this,canvas,top),this},Layer.prototype.enableHitGraph=function(){return this.hitGraphEnabled(!0),this},Layer.prototype.disableHitGraph=function(){return this.hitGraphEnabled(!1),this},Layer.prototype.setHitGraphEnabled=function(val){Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(val)},Layer.prototype.getHitGraphEnabled=function(val){return Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()},Layer.prototype.toggleHitCanvas=function(){if(this.parent){var parent=this.parent;!!this.hitCanvas._canvas.parentNode?parent.content.removeChild(this.hitCanvas._canvas):parent.content.appendChild(this.hitCanvas._canvas)}},Layer}(Container);Layer.prototype.nodeType="Layer",_registerNode(Layer),Factory.addGetterSetter(Layer,"imageSmoothingEnabled",!0),Factory.addGetterSetter(Layer,"clearBeforeDraw",!0),Factory.addGetterSetter(Layer,"hitGraphEnabled",!0,getBooleanValidator()),Collection.mapMethods(Layer);var FastLayer=function(_super){function FastLayer(attrs){var _this=_super.call(this,attrs)||this;return _this.listening(!1),Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.'),_this}return __extends(FastLayer,_super),FastLayer}(Layer);FastLayer.prototype.nodeType="FastLayer",_registerNode(FastLayer),Collection.mapMethods(FastLayer);var Group=function(_super){function Group(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Group,_super),Group.prototype._validateAdd=function(child){var type=child.getType();"Group"!==type&&"Shape"!==type&&Util.throw("You may only add groups and shapes to groups.")},Group}(Container);Group.prototype.nodeType="Group",_registerNode(Group),Collection.mapMethods(Group);var now=glob.performance&&glob.performance.now?function(){return glob.performance.now()}:function(){return(new Date).getTime()},Animation=function(){function Animation(func,layers){this.id=Animation.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:now(),frameRate:0},this.func=func,this.setLayers(layers)}return Animation.prototype.setLayers=function(layers){var lays=[];return lays=layers?layers.length>0?layers:[layers]:[],this.layers=lays,this},Animation.prototype.getLayers=function(){return this.layers},Animation.prototype.addLayer=function(layer){var n,layers=this.layers,len=layers.length;for(n=0;n<len;n++)if(layers[n]._id===layer._id)return!1;return this.layers.push(layer),!0},Animation.prototype.isRunning=function(){var n,animations=Animation.animations,len=animations.length;for(n=0;n<len;n++)if(animations[n].id===this.id)return!0;return!1},Animation.prototype.start=function(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=now(),Animation._addAnimation(this),this},Animation.prototype.stop=function(){return Animation._removeAnimation(this),this},Animation.prototype._updateFrameObject=function(time){this.frame.timeDiff=time-this.frame.lastTime,this.frame.lastTime=time,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff},Animation._addAnimation=function(anim){this.animations.push(anim),this._handleAnimation()},Animation._removeAnimation=function(anim){var n,id=anim.id,animations=this.animations,len=animations.length;for(n=0;n<len;n++)if(animations[n].id===id){this.animations.splice(n,1);break}},Animation._runFrames=function(){var anim,layers,func,n,i,layersLen,layer,key,layerHash={},animations=this.animations;for(n=0;n<animations.length;n++)if(layers=(anim=animations[n]).layers,func=anim.func,anim._updateFrameObject(now()),layersLen=layers.length,!func||!1!==func.call(anim,anim.frame))for(i=0;i<layersLen;i++)void 0!==(layer=layers[i])._id&&(layerHash[layer._id]=layer);for(key in layerHash)layerHash.hasOwnProperty(key)&&layerHash[key].draw()},Animation._animationLoop=function(){var Anim=Animation;Anim.animations.length?(Anim._runFrames(),requestAnimationFrame(Anim._animationLoop)):Anim.animRunning=!1},Animation._handleAnimation=function(){this.animRunning||(this.animRunning=!0,requestAnimationFrame(this._animationLoop))},Animation.animations=[],Animation.animIdCounter=0,Animation.animRunning=!1,Animation}(),blacklist={node:1,duration:1,easing:1,onFinish:1,yoyo:1},idCounter$1=0,colorAttrs=["fill","stroke","shadowColor"],TweenEngine=function(){function TweenEngine(prop,propFunc,func,begin,finish,duration,yoyo){this.prop=prop,this.propFunc=propFunc,this.begin=begin,this._pos=begin,this.duration=duration,this._change=0,this.prevPos=0,this.yoyo=yoyo,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=func,this._change=finish-this.begin,this.pause()}return TweenEngine.prototype.fire=function(str){var handler=this[str];handler&&handler()},TweenEngine.prototype.setTime=function(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())},TweenEngine.prototype.getTime=function(){return this._time},TweenEngine.prototype.setPosition=function(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p},TweenEngine.prototype.getPosition=function(t){return void 0===t&&(t=this._time),this.func(t,this.begin,this._change,this.duration)},TweenEngine.prototype.play=function(){this.state=2,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")},TweenEngine.prototype.reverse=function(){this.state=3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")},TweenEngine.prototype.seek=function(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")},TweenEngine.prototype.reset=function(){this.pause(),this._time=0,this.update(),this.fire("onReset")},TweenEngine.prototype.finish=function(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")},TweenEngine.prototype.update=function(){this.setPosition(this.getPosition(this._time))},TweenEngine.prototype.onEnterFrame=function(){var t=this.getTimer()-this._startTime;2===this.state?this.setTime(t):3===this.state&&this.setTime(this.duration-t)},TweenEngine.prototype.pause=function(){this.state=1,this.fire("onPause")},TweenEngine.prototype.getTimer=function(){return(new Date).getTime()},TweenEngine}(),Tween=function(){function Tween(config){var duration,key,that=this,node=config.node,nodeId=node._id,easing=config.easing||Easings.Linear,yoyo=!!config.yoyo;duration=void 0===config.duration?.3:0===config.duration?.001:config.duration,this.node=node,this._id=idCounter$1++;var layers=node.getLayer()||(node instanceof Konva.Stage?node.getLayers():null);for(key in layers||Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new Animation(function(){that.tween.onEnterFrame()},layers),this.tween=new TweenEngine(key,function(i){that._tweenFunc(i)},easing,0,1,1e3*duration,yoyo),this._addListeners(),Tween.attrs[nodeId]||(Tween.attrs[nodeId]={}),Tween.attrs[nodeId][this._id]||(Tween.attrs[nodeId][this._id]={}),Tween.tweens[nodeId]||(Tween.tweens[nodeId]={}),config)void 0===blacklist[key]&&this._addAttr(key,config[key]);this.reset(),this.onFinish=config.onFinish,this.onReset=config.onReset}return Tween.prototype._addAttr=function(key,end){var start,diff,tweenId,n,len,trueEnd,trueStart,endRGBA,node=this.node,nodeId=node._id;if((tweenId=Tween.tweens[nodeId][key])&&delete Tween.attrs[nodeId][tweenId][key],start=node.getAttr(key),Util._isArray(end))if(diff=[],len=Math.max(end.length,start.length),"points"===key&&end.length!==start.length&&(end.length>start.length?(trueStart=start,start=Util._prepareArrayForTween(start,end,node.closed())):(trueEnd=end,end=Util._prepareArrayForTween(end,start,node.closed()))),0===key.indexOf("fill"))for(n=0;n<len;n++)if(n%2==0)diff.push(end[n]-start[n]);else{var startRGBA=Util.colorToRGBA(start[n]);endRGBA=Util.colorToRGBA(end[n]),start[n]=startRGBA,diff.push({r:endRGBA.r-startRGBA.r,g:endRGBA.g-startRGBA.g,b:endRGBA.b-startRGBA.b,a:endRGBA.a-startRGBA.a})}else for(n=0;n<len;n++)diff.push(end[n]-start[n]);else-1!==colorAttrs.indexOf(key)?(start=Util.colorToRGBA(start),diff={r:(endRGBA=Util.colorToRGBA(end)).r-start.r,g:endRGBA.g-start.g,b:endRGBA.b-start.b,a:endRGBA.a-start.a}):diff=end-start;Tween.attrs[nodeId][this._id][key]={start:start,diff:diff,end:end,trueEnd:trueEnd,trueStart:trueStart},Tween.tweens[nodeId][key]=this._id},Tween.prototype._tweenFunc=function(i){var key,attr,start,diff,newVal,n,len,end,node=this.node,attrs=Tween.attrs[node._id][this._id];for(key in attrs){if(start=(attr=attrs[key]).start,diff=attr.diff,end=attr.end,Util._isArray(start))if(newVal=[],len=Math.max(start.length,end.length),0===key.indexOf("fill"))for(n=0;n<len;n++)n%2==0?newVal.push((start[n]||0)+diff[n]*i):newVal.push("rgba("+Math.round(start[n].r+diff[n].r*i)+","+Math.round(start[n].g+diff[n].g*i)+","+Math.round(start[n].b+diff[n].b*i)+","+(start[n].a+diff[n].a*i)+")");else for(n=0;n<len;n++)newVal.push((start[n]||0)+diff[n]*i);else newVal=-1!==colorAttrs.indexOf(key)?"rgba("+Math.round(start.r+diff.r*i)+","+Math.round(start.g+diff.g*i)+","+Math.round(start.b+diff.b*i)+","+(start.a+diff.a*i)+")":start+diff*i;node.setAttr(key,newVal)}},Tween.prototype._addListeners=function(){var _this=this;this.tween.onPlay=function(){_this.anim.start()},this.tween.onReverse=function(){_this.anim.start()},this.tween.onPause=function(){_this.anim.stop()},this.tween.onFinish=function(){var node=_this.node,attrs=Tween.attrs[node._id][_this._id];attrs.points&&attrs.points.trueEnd&&node.setAttr("points",attrs.points.trueEnd),_this.onFinish&&_this.onFinish.call(_this)},this.tween.onReset=function(){var node=_this.node,attrs=Tween.attrs[node._id][_this._id];attrs.points&&attrs.points.trueStart&&node.points(attrs.points.trueStart),_this.onReset&&_this.onReset()}},Tween.prototype.play=function(){return this.tween.play(),this},Tween.prototype.reverse=function(){return this.tween.reverse(),this},Tween.prototype.reset=function(){return this.tween.reset(),this},Tween.prototype.seek=function(t){return this.tween.seek(1e3*t),this},Tween.prototype.pause=function(){return this.tween.pause(),this},Tween.prototype.finish=function(){return this.tween.finish(),this},Tween.prototype.destroy=function(){var key,nodeId=this.node._id,thisId=this._id,attrs=Tween.tweens[nodeId];for(key in this.pause(),attrs)delete Tween.tweens[nodeId][key];delete Tween.attrs[nodeId][thisId]},Tween.attrs={},Tween.tweens={},Tween}();Node.prototype.to=function(params){var onFinish=params.onFinish;params.node=this,params.onFinish=function(){this.destroy(),onFinish&&onFinish()},new Tween(params).play()};var Easings={BackEaseIn:function(t,b,c,d){var s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},BackEaseOut:function(t,b,c,d){var s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},BackEaseInOut:function(t,b,c,d){var s=1.70158;return(t/=d/2)<1?c/2*(t*t*((1+(s*=1.525))*t-s))+b:c/2*((t-=2)*t*((1+(s*=1.525))*t+s)+2)+b},ElasticEaseIn:function(t,b,c,d,a,p){var s=0;return 0===t?b:1==(t/=d)?b+c:(p||(p=.3*d),!a||a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)+b)},ElasticEaseOut:function(t,b,c,d,a,p){var s=0;return 0===t?b:1==(t/=d)?b+c:(p||(p=.3*d),!a||a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b)},ElasticEaseInOut:function(t,b,c,d,a,p){var s=0;return 0===t?b:2==(t/=d/2)?b+c:(p||(p=d*(.3*1.5)),!a||a<Math.abs(c)?(a=c,s=p/4):s=p/(2*Math.PI)*Math.asin(c/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*-.5+b:a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b)},BounceEaseOut:function(t,b,c,d){return(t/=d)<1/2.75?c*(7.5625*t*t)+b:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+b:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+b:c*(7.5625*(t-=2.625/2.75)*t+.984375)+b},BounceEaseIn:function(t,b,c,d){return c-Easings.BounceEaseOut(d-t,0,c,d)+b},BounceEaseInOut:function(t,b,c,d){return t<d/2?.5*Easings.BounceEaseIn(2*t,0,c,d)+b:.5*Easings.BounceEaseOut(2*t-d,0,c,d)+.5*c+b},EaseIn:function(t,b,c,d){return c*(t/=d)*t+b},EaseOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},EaseInOut:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t+b:-c/2*(--t*(t-2)-1)+b},StrongEaseIn:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},StrongEaseOut:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},StrongEaseInOut:function(t,b,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+b:c/2*((t-=2)*t*t*t*t+2)+b},Linear:function(t,b,c,d){return c*t/d+b}},Konva$1=Util._assign(Konva,{Collection:Collection,Util:Util,Transform:Transform,Node:Node,ids:ids,names:names,Container:Container,Stage:Stage,stages:stages,Layer:Layer,FastLayer:FastLayer,Group:Group,DD:DD,Shape:Shape,shapes:shapes,Animation:Animation,Tween:Tween,Easings:Easings,Context:Context,Canvas:Canvas}),Arc=function(_super){function Arc(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Arc,_super),Arc.prototype._sceneFunc=function(context){var angle=Konva.getAngle(this.angle()),clockwise=this.clockwise();context.beginPath(),context.arc(0,0,this.outerRadius(),0,angle,clockwise),context.arc(0,0,this.innerRadius(),angle,0,!clockwise),context.closePath(),context.fillStrokeShape(this)},Arc.prototype.getWidth=function(){return 2*this.outerRadius()},Arc.prototype.getHeight=function(){return 2*this.outerRadius()},Arc.prototype.setWidth=function(width){this.outerRadius(width/2)},Arc.prototype.setHeight=function(height){this.outerRadius(height/2)},Arc}(Shape);Arc.prototype._centroid=!0,Arc.prototype.className="Arc",Arc.prototype._attrsAffectingSize=["innerRadius","outerRadius"],_registerNode(Arc),Factory.addGetterSetter(Arc,"innerRadius",0,getNumberValidator()),Factory.addGetterSetter(Arc,"outerRadius",0,getNumberValidator()),Factory.addGetterSetter(Arc,"angle",0,getNumberValidator()),Factory.addGetterSetter(Arc,"clockwise",!1,getBooleanValidator()),Collection.mapMethods(Arc);var Line=function(_super){function Line(config){var _this=_super.call(this,config)||this;return _this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")}),_this}return __extends(Line,_super),Line.prototype._sceneFunc=function(context){var tp,len,n,points=this.points(),length=points.length,tension=this.tension(),closed=this.closed(),bezier=this.bezier();if(length){if(context.beginPath(),context.moveTo(points[0],points[1]),0!==tension&&length>4){for(len=(tp=this.getTensionPoints()).length,n=closed?0:4,closed||context.quadraticCurveTo(tp[0],tp[1],tp[2],tp[3]);n<len-2;)context.bezierCurveTo(tp[n++],tp[n++],tp[n++],tp[n++],tp[n++],tp[n++]);closed||context.quadraticCurveTo(tp[len-2],tp[len-1],points[length-2],points[length-1])}else if(bezier)for(n=2;n<length;)context.bezierCurveTo(points[n++],points[n++],points[n++],points[n++],points[n++],points[n++]);else for(n=2;n<length;n+=2)context.lineTo(points[n],points[n+1]);closed?(context.closePath(),context.fillStrokeShape(this)):context.strokeShape(this)}},Line.prototype.getTensionPoints=function(){return this._getCache("tensionPoints",this._getTensionPoints)},Line.prototype._getTensionPoints=function(){return this.closed()?this._getTensionPointsClosed():Util._expandPoints(this.points(),this.tension())},Line.prototype._getTensionPointsClosed=function(){var p=this.points(),len=p.length,tension=this.tension(),firstControlPoints=Util._getControlPoints(p[len-2],p[len-1],p[0],p[1],p[2],p[3],tension),lastControlPoints=Util._getControlPoints(p[len-4],p[len-3],p[len-2],p[len-1],p[0],p[1],tension),middle=Util._expandPoints(p,tension);return[firstControlPoints[2],firstControlPoints[3]].concat(middle).concat([lastControlPoints[0],lastControlPoints[1],p[len-2],p[len-1],lastControlPoints[2],lastControlPoints[3],firstControlPoints[0],firstControlPoints[1],p[0],p[1]])},Line.prototype.getWidth=function(){return this.getSelfRect().width},Line.prototype.getHeight=function(){return this.getSelfRect().height},Line.prototype.getSelfRect=function(){var points=this.points();if(points.length<4)return{x:points[0]||0,y:points[1]||0,width:0,height:0};for(var x,y,minX=(points=0!==this.tension()?function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}([points[0],points[1]],this._getTensionPoints(),[points[points.length-2],points[points.length-1]]):this.points())[0],maxX=points[0],minY=points[1],maxY=points[1],i=0;i<points.length/2;i++)x=points[2*i],y=points[2*i+1],minX=Math.min(minX,x),maxX=Math.max(maxX,x),minY=Math.min(minY,y),maxY=Math.max(maxY,y);return{x:minX,y:minY,width:maxX-minX,height:maxY-minY}},Line}(Shape);Line.prototype.className="Line",Line.prototype._attrsAffectingSize=["points","bezier","tension"],_registerNode(Line),Factory.addGetterSetter(Line,"closed",!1),Factory.addGetterSetter(Line,"bezier",!1),Factory.addGetterSetter(Line,"tension",0,getNumberValidator()),Factory.addGetterSetter(Line,"points",[],function(){if(Konva.isUnminified)return function(val,attr){return Util._isArray(val)?val.forEach(function(item){Util._isNumber(item)||Util.warn('"'+attr+'" attribute has non numeric element '+item+". Make sure that all elements are numbers.")}):Util.warn(_formatValue(val)+' is a not valid value for "'+attr+'" attribute. The value should be a array of numbers.'),val}}()),Collection.mapMethods(Line);var Arrow=function(_super){function Arrow(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Arrow,_super),Arrow.prototype._sceneFunc=function(ctx){_super.prototype._sceneFunc.call(this,ctx);var PI2=2*Math.PI,points=this.points(),tp=points,fromTension=0!==this.tension()&&points.length>4;fromTension&&(tp=this.getTensionPoints());var dx,dy,n=points.length;fromTension?(dx=points[n-2]-(tp[tp.length-2]+tp[tp.length-4])/2,dy=points[n-1]-(tp[tp.length-1]+tp[tp.length-3])/2):(dx=points[n-2]-points[n-4],dy=points[n-1]-points[n-3]);var radians=(Math.atan2(dy,dx)+PI2)%PI2,length=this.pointerLength(),width=this.pointerWidth();ctx.save(),ctx.beginPath(),ctx.translate(points[n-2],points[n-1]),ctx.rotate(radians),ctx.moveTo(0,0),ctx.lineTo(-length,width/2),ctx.lineTo(-length,-width/2),ctx.closePath(),ctx.restore(),this.pointerAtBeginning()&&(ctx.save(),ctx.translate(points[0],points[1]),fromTension?(dx=(tp[0]+tp[2])/2-points[0],dy=(tp[1]+tp[3])/2-points[1]):(dx=points[2]-points[0],dy=points[3]-points[1]),ctx.rotate((Math.atan2(-dy,-dx)+PI2)%PI2),ctx.moveTo(0,0),ctx.lineTo(-length,width/2),ctx.lineTo(-length,-width/2),ctx.closePath(),ctx.restore());var isDashEnabled=this.dashEnabled();isDashEnabled&&(this.attrs.dashEnabled=!1,ctx.setLineDash([])),ctx.fillStrokeShape(this),isDashEnabled&&(this.attrs.dashEnabled=!0)},Arrow.prototype.getSelfRect=function(){var lineRect=_super.prototype.getSelfRect.call(this),offset=this.pointerWidth()/2;return{x:lineRect.x-offset,y:lineRect.y-offset,width:lineRect.width+2*offset,height:lineRect.height+2*offset}},Arrow}(Line);Arrow.prototype.className="Arrow",_registerNode(Arrow),Factory.addGetterSetter(Arrow,"pointerLength",10,getNumberValidator()),Factory.addGetterSetter(Arrow,"pointerWidth",10,getNumberValidator()),Factory.addGetterSetter(Arrow,"pointerAtBeginning",!1),Collection.mapMethods(Arrow);var Circle=function(_super){function Circle(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Circle,_super),Circle.prototype._sceneFunc=function(context){context.beginPath(),context.arc(0,0,this.radius(),0,2*Math.PI,!1),context.closePath(),context.fillStrokeShape(this)},Circle.prototype.getWidth=function(){return 2*this.radius()},Circle.prototype.getHeight=function(){return 2*this.radius()},Circle.prototype.setWidth=function(width){this.radius()!==width/2&&this.radius(width/2)},Circle.prototype.setHeight=function(height){this.radius()!==height/2&&this.radius(height/2)},Circle}(Shape);Circle.prototype._centroid=!0,Circle.prototype.className="Circle",Circle.prototype._attrsAffectingSize=["radius"],_registerNode(Circle),Factory.addGetterSetter(Circle,"radius",0,getNumberValidator()),Collection.mapMethods(Circle);var Ellipse=function(_super){function Ellipse(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Ellipse,_super),Ellipse.prototype._sceneFunc=function(context){var rx=this.radiusX(),ry=this.radiusY();context.beginPath(),context.save(),rx!==ry&&context.scale(1,ry/rx),context.arc(0,0,rx,0,2*Math.PI,!1),context.restore(),context.closePath(),context.fillStrokeShape(this)},Ellipse.prototype.getWidth=function(){return 2*this.radiusX()},Ellipse.prototype.getHeight=function(){return 2*this.radiusY()},Ellipse.prototype.setWidth=function(width){this.radiusX(width/2)},Ellipse.prototype.setHeight=function(height){this.radiusY(height/2)},Ellipse}(Shape);Ellipse.prototype.className="Ellipse",Ellipse.prototype._centroid=!0,Ellipse.prototype._attrsAffectingSize=["radiusX","radiusY"],_registerNode(Ellipse),Factory.addComponentsGetterSetter(Ellipse,"radius",["x","y"]),Factory.addGetterSetter(Ellipse,"radiusX",0,getNumberValidator()),Factory.addGetterSetter(Ellipse,"radiusY",0,getNumberValidator()),Collection.mapMethods(Ellipse);var Image=function(_super){function Image(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Image,_super),Image.prototype._useBufferCanvas=function(){return _super.prototype._useBufferCanvas.call(this,!0)},Image.prototype._sceneFunc=function(context){var cropWidth,cropHeight,params,width=this.getWidth(),height=this.getHeight(),image=this.attrs.image;image&&(cropWidth=this.attrs.cropWidth,cropHeight=this.attrs.cropHeight,params=cropWidth&&cropHeight?[image,this.cropX(),this.cropY(),cropWidth,cropHeight,0,0,width,height]:[image,0,0,width,height]),(this.hasFill()||this.hasStroke())&&(context.beginPath(),context.rect(0,0,width,height),context.closePath(),context.fillStrokeShape(this)),image&&context.drawImage.apply(context,params)},Image.prototype._hitFunc=function(context){var width=this.width(),height=this.height();context.beginPath(),context.rect(0,0,width,height),context.closePath(),context.fillStrokeShape(this)},Image.prototype.getWidth=function(){var _a,_b;return null!==(_a=this.attrs.width)&&void 0!==_a?_a:(null===(_b=this.image())||void 0===_b?void 0:_b.width)||0},Image.prototype.getHeight=function(){var _a,_b;return null!==(_a=this.attrs.height)&&void 0!==_a?_a:(null===(_b=this.image())||void 0===_b?void 0:_b.height)||0},Image.fromURL=function(url,callback){var img=Util.createImageElement();img.onload=function(){var image=new Image({image:img});callback(image)},img.crossOrigin="Anonymous",img.src=url},Image}(Shape);Image.prototype.className="Image",_registerNode(Image),Factory.addGetterSetter(Image,"image"),Factory.addComponentsGetterSetter(Image,"crop",["x","y","width","height"]),Factory.addGetterSetter(Image,"cropX",0,getNumberValidator()),Factory.addGetterSetter(Image,"cropY",0,getNumberValidator()),Factory.addGetterSetter(Image,"cropWidth",0,getNumberValidator()),Factory.addGetterSetter(Image,"cropHeight",0,getNumberValidator()),Collection.mapMethods(Image);var ATTR_CHANGE_LIST=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width"],attrChangeListLen=ATTR_CHANGE_LIST.length,Label=function(_super){function Label(config){var _this=_super.call(this,config)||this;return _this.on("add.konva",function(evt){this._addListeners(evt.child),this._sync()}),_this}return __extends(Label,_super),Label.prototype.getText=function(){return this.find("Text")[0]},Label.prototype.getTag=function(){return this.find("Tag")[0]},Label.prototype._addListeners=function(text){var n,that=this,func=function(){that._sync()};for(n=0;n<attrChangeListLen;n++)text.on(ATTR_CHANGE_LIST[n]+"Change.konva",func)},Label.prototype.getWidth=function(){return this.getText().width()},Label.prototype.getHeight=function(){return this.getText().height()},Label.prototype._sync=function(){var width,height,pointerDirection,pointerWidth,x,y,pointerHeight,text=this.getText(),tag=this.getTag();if(text&&tag){switch(width=text.width(),height=text.height(),pointerDirection=tag.pointerDirection(),pointerWidth=tag.pointerWidth(),pointerHeight=tag.pointerHeight(),x=0,y=0,pointerDirection){case"up":x=width/2,y=-1*pointerHeight;break;case"right":x=width+pointerWidth,y=height/2;break;case"down":x=width/2,y=height+pointerHeight;break;case"left":x=-1*pointerWidth,y=height/2}tag.setAttrs({x:-1*x,y:-1*y,width:width,height:height}),text.setAttrs({x:-1*x,y:-1*y})}},Label}(Group);Label.prototype.className="Label",_registerNode(Label),Collection.mapMethods(Label);var Tag=function(_super){function Tag(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Tag,_super),Tag.prototype._sceneFunc=function(context){var width=this.width(),height=this.height(),pointerDirection=this.pointerDirection(),pointerWidth=this.pointerWidth(),pointerHeight=this.pointerHeight(),cornerRadius=Math.min(this.cornerRadius(),width/2,height/2);context.beginPath(),cornerRadius?context.moveTo(cornerRadius,0):context.moveTo(0,0),"up"===pointerDirection&&(context.lineTo((width-pointerWidth)/2,0),context.lineTo(width/2,-1*pointerHeight),context.lineTo((width+pointerWidth)/2,0)),cornerRadius?(context.lineTo(width-cornerRadius,0),context.arc(width-cornerRadius,cornerRadius,cornerRadius,3*Math.PI/2,0,!1)):context.lineTo(width,0),"right"===pointerDirection&&(context.lineTo(width,(height-pointerHeight)/2),context.lineTo(width+pointerWidth,height/2),context.lineTo(width,(height+pointerHeight)/2)),cornerRadius?(context.lineTo(width,height-cornerRadius),context.arc(width-cornerRadius,height-cornerRadius,cornerRadius,0,Math.PI/2,!1)):context.lineTo(width,height),"down"===pointerDirection&&(context.lineTo((width+pointerWidth)/2,height),context.lineTo(width/2,height+pointerHeight),context.lineTo((width-pointerWidth)/2,height)),cornerRadius?(context.lineTo(cornerRadius,height),context.arc(cornerRadius,height-cornerRadius,cornerRadius,Math.PI/2,Math.PI,!1)):context.lineTo(0,height),"left"===pointerDirection&&(context.lineTo(0,(height+pointerHeight)/2),context.lineTo(-1*pointerWidth,height/2),context.lineTo(0,(height-pointerHeight)/2)),cornerRadius&&(context.lineTo(0,cornerRadius),context.arc(cornerRadius,cornerRadius,cornerRadius,Math.PI,3*Math.PI/2,!1)),context.closePath(),context.fillStrokeShape(this)},Tag.prototype.getSelfRect=function(){var x=0,y=0,pointerWidth=this.pointerWidth(),pointerHeight=this.pointerHeight(),direction=this.pointerDirection(),width=this.width(),height=this.height();return"up"===direction?(y-=pointerHeight,height+=pointerHeight):"down"===direction?height+=pointerHeight:"left"===direction?(x-=1.5*pointerWidth,width+=pointerWidth):"right"===direction&&(width+=1.5*pointerWidth),{x:x,y:y,width:width,height:height}},Tag}(Shape);Tag.prototype.className="Tag",_registerNode(Tag),Factory.addGetterSetter(Tag,"pointerDirection","none"),Factory.addGetterSetter(Tag,"pointerWidth",0,getNumberValidator()),Factory.addGetterSetter(Tag,"pointerHeight",0,getNumberValidator()),Factory.addGetterSetter(Tag,"cornerRadius",0,getNumberValidator()),Collection.mapMethods(Tag);var Path=function(_super){function Path(config){var _this=_super.call(this,config)||this;_this.dataArray=[],_this.pathLength=0,_this.dataArray=Path.parsePathData(_this.data()),_this.pathLength=0;for(var i=0;i<_this.dataArray.length;++i)_this.pathLength+=_this.dataArray[i].pathLength;return _this.on("dataChange.konva",function(){this.dataArray=Path.parsePathData(this.data()),this.pathLength=0;for(var i=0;i<this.dataArray.length;++i)this.pathLength+=this.dataArray[i].pathLength}),_this}return __extends(Path,_super),Path.prototype._sceneFunc=function(context){var ca=this.dataArray;context.beginPath();for(var isClosed=!1,n=0;n<ca.length;n++){var c=ca[n].command,p=ca[n].points;switch(c){case"L":context.lineTo(p[0],p[1]);break;case"M":context.moveTo(p[0],p[1]);break;case"C":context.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":context.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":var cx=p[0],cy=p[1],rx=p[2],ry=p[3],theta=p[4],dTheta=p[5],psi=p[6],fs=p[7],r=rx>ry?rx:ry,scaleX=rx>ry?1:rx/ry,scaleY=rx>ry?ry/rx:1;context.translate(cx,cy),context.rotate(psi),context.scale(scaleX,scaleY),context.arc(0,0,r,theta,theta+dTheta,1-fs),context.scale(1/scaleX,1/scaleY),context.rotate(-psi),context.translate(-cx,-cy);break;case"z":isClosed=!0,context.closePath()}}isClosed||this.hasFill()?context.fillStrokeShape(this):context.strokeShape(this)},Path.prototype.getSelfRect=function(){var points=[];this.dataArray.forEach(function(data){if("A"===data.command){var start=data.points[4],dTheta=data.points[5],end=data.points[4]+dTheta,inc=Math.PI/180;if(Math.abs(start-end)<inc&&(inc=Math.abs(start-end)),dTheta<0)for(var t=start-inc;t>end;t-=inc){var point=Path.getPointOnEllipticalArc(data.points[0],data.points[1],data.points[2],data.points[3],t,0);points.push(point.x,point.y)}else for(t=start+inc;t<end;t+=inc){point=Path.getPointOnEllipticalArc(data.points[0],data.points[1],data.points[2],data.points[3],t,0);points.push(point.x,point.y)}}else if("C"===data.command)for(t=0;t<=1;t+=.01){point=Path.getPointOnCubicBezier(t,data.start.x,data.start.y,data.points[0],data.points[1],data.points[2],data.points[3],data.points[4],data.points[5]);points.push(point.x,point.y)}else points=points.concat(data.points)});for(var x,y,minX=points[0],maxX=points[0],minY=points[1],maxY=points[1],i=0;i<points.length/2;i++)x=points[2*i],y=points[2*i+1],isNaN(x)||(minX=Math.min(minX,x),maxX=Math.max(maxX,x)),isNaN(y)||(minY=Math.min(minY,y),maxY=Math.max(maxY,y));return{x:Math.round(minX),y:Math.round(minY),width:Math.round(maxX-minX),height:Math.round(maxY-minY)}},Path.prototype.getLength=function(){return this.pathLength},Path.prototype.getPointAtLength=function(length){var point,i=0,ii=this.dataArray.length;if(!ii)return null;for(;i<ii&&length>this.dataArray[i].pathLength;)length-=this.dataArray[i].pathLength,++i;if(i===ii)return{x:(point=this.dataArray[i-1].points.slice(-2))[0],y:point[1]};if(length<.01)return{x:(point=this.dataArray[i].points.slice(0,2))[0],y:point[1]};var cp=this.dataArray[i],p=cp.points;switch(cp.command){case"L":return Path.getPointOnLine(length,cp.start.x,cp.start.y,p[0],p[1]);case"C":return Path.getPointOnCubicBezier(length/cp.pathLength,cp.start.x,cp.start.y,p[0],p[1],p[2],p[3],p[4],p[5]);case"Q":return Path.getPointOnQuadraticBezier(length/cp.pathLength,cp.start.x,cp.start.y,p[0],p[1],p[2],p[3]);case"A":var cx=p[0],cy=p[1],rx=p[2],ry=p[3],theta=p[4],dTheta=p[5],psi=p[6];return theta+=dTheta*length/cp.pathLength,Path.getPointOnEllipticalArc(cx,cy,rx,ry,theta,psi)}return null},Path.getLineLength=function(x1,y1,x2,y2){return Math.sqrt((x2-x1)*(x2-x1)+(y2-y1)*(y2-y1))},Path.getPointOnLine=function(dist,P1x,P1y,P2x,P2y,fromX,fromY){void 0===fromX&&(fromX=P1x),void 0===fromY&&(fromY=P1y);var m=(P2y-P1y)/(P2x-P1x+1e-8),run=Math.sqrt(dist*dist/(1+m*m));P2x<P1x&&(run*=-1);var pt,rise=m*run;if(P2x===P1x)pt={x:fromX,y:fromY+rise};else if((fromY-P1y)/(fromX-P1x+1e-8)===m)pt={x:fromX+run,y:fromY+rise};else{var ix,iy,len=this.getLineLength(P1x,P1y,P2x,P2y);if(len<1e-8)return;var u=(fromX-P1x)*(P2x-P1x)+(fromY-P1y)*(P2y-P1y);ix=P1x+(u/=len*len)*(P2x-P1x),iy=P1y+u*(P2y-P1y);var pRise=this.getLineLength(fromX,fromY,ix,iy),pRun=Math.sqrt(dist*dist-pRise*pRise);run=Math.sqrt(pRun*pRun/(1+m*m)),P2x<P1x&&(run*=-1),pt={x:ix+run,y:iy+(rise=m*run)}}return pt},Path.getPointOnCubicBezier=function(pct,P1x,P1y,P2x,P2y,P3x,P3y,P4x,P4y){function CB1(t){return t*t*t}function CB2(t){return 3*t*t*(1-t)}function CB3(t){return 3*t*(1-t)*(1-t)}function CB4(t){return(1-t)*(1-t)*(1-t)}return{x:P4x*CB1(pct)+P3x*CB2(pct)+P2x*CB3(pct)+P1x*CB4(pct),y:P4y*CB1(pct)+P3y*CB2(pct)+P2y*CB3(pct)+P1y*CB4(pct)}},Path.getPointOnQuadraticBezier=function(pct,P1x,P1y,P2x,P2y,P3x,P3y){function QB1(t){return t*t}function QB2(t){return 2*t*(1-t)}function QB3(t){return(1-t)*(1-t)}return{x:P3x*QB1(pct)+P2x*QB2(pct)+P1x*QB3(pct),y:P3y*QB1(pct)+P2y*QB2(pct)+P1y*QB3(pct)}},Path.getPointOnEllipticalArc=function(cx,cy,rx,ry,theta,psi){var cosPsi=Math.cos(psi),sinPsi=Math.sin(psi),pt_x=rx*Math.cos(theta),pt_y=ry*Math.sin(theta);return{x:cx+(pt_x*cosPsi-pt_y*sinPsi),y:cy+(pt_x*sinPsi+pt_y*cosPsi)}},Path.parsePathData=function(data){if(!data)return[];var cs=data,cc=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];cs=cs.replace(new RegExp(" ","g"),",");for(var n=0;n<cc.length;n++)cs=cs.replace(new RegExp(cc[n],"g"),"|"+cc[n]);var match,arr=cs.split("|"),ca=[],coords=[],cpx=0,cpy=0,re=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(n=1;n<arr.length;n++){var str=arr[n],c=str.charAt(0);for(str=str.slice(1),coords.length=0;match=re.exec(str);)coords.push(match[0]);for(var p=[],j=0,jlen=coords.length;j<jlen;j++){var parsed=parseFloat(coords[j]);isNaN(parsed)?p.push(0):p.push(parsed)}for(;p.length>0&&!isNaN(p[0]);){var prevCmd,ctlPtx,ctlPty,rx,ry,psi,fa,fs,x1,y1,cmd=null,points=[],startX=cpx,startY=cpy;switch(c){case"l":cpx+=p.shift(),cpy+=p.shift(),cmd="L",points.push(cpx,cpy);break;case"L":cpx=p.shift(),cpy=p.shift(),points.push(cpx,cpy);break;case"m":var dx=p.shift(),dy=p.shift();if(cpx+=dx,cpy+=dy,cmd="M",ca.length>2&&"z"===ca[ca.length-1].command)for(var idx=ca.length-2;idx>=0;idx--)if("M"===ca[idx].command){cpx=ca[idx].points[0]+dx,cpy=ca[idx].points[1]+dy;break}points.push(cpx,cpy),c="l";break;case"M":cpx=p.shift(),cpy=p.shift(),cmd="M",points.push(cpx,cpy),c="L";break;case"h":cpx+=p.shift(),cmd="L",points.push(cpx,cpy);break;case"H":cpx=p.shift(),cmd="L",points.push(cpx,cpy);break;case"v":cpy+=p.shift(),cmd="L",points.push(cpx,cpy);break;case"V":cpy=p.shift(),cmd="L",points.push(cpx,cpy);break;case"C":points.push(p.shift(),p.shift(),p.shift(),p.shift()),cpx=p.shift(),cpy=p.shift(),points.push(cpx,cpy);break;case"c":points.push(cpx+p.shift(),cpy+p.shift(),cpx+p.shift(),cpy+p.shift()),cpx+=p.shift(),cpy+=p.shift(),cmd="C",points.push(cpx,cpy);break;case"S":ctlPtx=cpx,ctlPty=cpy,"C"===(prevCmd=ca[ca.length-1]).command&&(ctlPtx=cpx+(cpx-prevCmd.points[2]),ctlPty=cpy+(cpy-prevCmd.points[3])),points.push(ctlPtx,ctlPty,p.shift(),p.shift()),cpx=p.shift(),cpy=p.shift(),cmd="C",points.push(cpx,cpy);break;case"s":ctlPtx=cpx,ctlPty=cpy,"C"===(prevCmd=ca[ca.length-1]).command&&(ctlPtx=cpx+(cpx-prevCmd.points[2]),ctlPty=cpy+(cpy-prevCmd.points[3])),points.push(ctlPtx,ctlPty,cpx+p.shift(),cpy+p.shift()),cpx+=p.shift(),cpy+=p.shift(),cmd="C",points.push(cpx,cpy);break;case"Q":points.push(p.shift(),p.shift()),cpx=p.shift(),cpy=p.shift(),points.push(cpx,cpy);break;case"q":points.push(cpx+p.shift(),cpy+p.shift()),cpx+=p.shift(),cpy+=p.shift(),cmd="Q",points.push(cpx,cpy);break;case"T":ctlPtx=cpx,ctlPty=cpy,"Q"===(prevCmd=ca[ca.length-1]).command&&(ctlPtx=cpx+(cpx-prevCmd.points[0]),ctlPty=cpy+(cpy-prevCmd.points[1])),cpx=p.shift(),cpy=p.shift(),cmd="Q",points.push(ctlPtx,ctlPty,cpx,cpy);break;case"t":ctlPtx=cpx,ctlPty=cpy,"Q"===(prevCmd=ca[ca.length-1]).command&&(ctlPtx=cpx+(cpx-prevCmd.points[0]),ctlPty=cpy+(cpy-prevCmd.points[1])),cpx+=p.shift(),cpy+=p.shift(),cmd="Q",points.push(ctlPtx,ctlPty,cpx,cpy);break;case"A":rx=p.shift(),ry=p.shift(),psi=p.shift(),fa=p.shift(),fs=p.shift(),x1=cpx,y1=cpy,cpx=p.shift(),cpy=p.shift(),cmd="A",points=this.convertEndpointToCenterParameterization(x1,y1,cpx,cpy,fa,fs,rx,ry,psi);break;case"a":rx=p.shift(),ry=p.shift(),psi=p.shift(),fa=p.shift(),fs=p.shift(),x1=cpx,y1=cpy,cpx+=p.shift(),cpy+=p.shift(),cmd="A",points=this.convertEndpointToCenterParameterization(x1,y1,cpx,cpy,fa,fs,rx,ry,psi)}ca.push({command:cmd||c,points:points,start:{x:startX,y:startY},pathLength:this.calcLength(startX,startY,cmd||c,points)})}"z"!==c&&"Z"!==c||ca.push({command:"z",points:[],start:void 0,pathLength:0})}return ca},Path.calcLength=function(x,y,cmd,points){var len,p1,p2,t,path=Path;switch(cmd){case"L":return path.getLineLength(x,y,points[0],points[1]);case"C":for(len=0,p1=path.getPointOnCubicBezier(0,x,y,points[0],points[1],points[2],points[3],points[4],points[5]),t=.01;t<=1;t+=.01)p2=path.getPointOnCubicBezier(t,x,y,points[0],points[1],points[2],points[3],points[4],points[5]),len+=path.getLineLength(p1.x,p1.y,p2.x,p2.y),p1=p2;return len;case"Q":for(len=0,p1=path.getPointOnQuadraticBezier(0,x,y,points[0],points[1],points[2],points[3]),t=.01;t<=1;t+=.01)p2=path.getPointOnQuadraticBezier(t,x,y,points[0],points[1],points[2],points[3]),len+=path.getLineLength(p1.x,p1.y,p2.x,p2.y),p1=p2;return len;case"A":len=0;var start=points[4],dTheta=points[5],end=points[4]+dTheta,inc=Math.PI/180;if(Math.abs(start-end)<inc&&(inc=Math.abs(start-end)),p1=path.getPointOnEllipticalArc(points[0],points[1],points[2],points[3],start,0),dTheta<0)for(t=start-inc;t>end;t-=inc)p2=path.getPointOnEllipticalArc(points[0],points[1],points[2],points[3],t,0),len+=path.getLineLength(p1.x,p1.y,p2.x,p2.y),p1=p2;else for(t=start+inc;t<end;t+=inc)p2=path.getPointOnEllipticalArc(points[0],points[1],points[2],points[3],t,0),len+=path.getLineLength(p1.x,p1.y,p2.x,p2.y),p1=p2;return p2=path.getPointOnEllipticalArc(points[0],points[1],points[2],points[3],end,0),len+=path.getLineLength(p1.x,p1.y,p2.x,p2.y)}return 0},Path.convertEndpointToCenterParameterization=function(x1,y1,x2,y2,fa,fs,rx,ry,psiDeg){var psi=psiDeg*(Math.PI/180),xp=Math.cos(psi)*(x1-x2)/2+Math.sin(psi)*(y1-y2)/2,yp=-1*Math.sin(psi)*(x1-x2)/2+Math.cos(psi)*(y1-y2)/2,lambda=xp*xp/(rx*rx)+yp*yp/(ry*ry);lambda>1&&(rx*=Math.sqrt(lambda),ry*=Math.sqrt(lambda));var f=Math.sqrt((rx*rx*(ry*ry)-rx*rx*(yp*yp)-ry*ry*(xp*xp))/(rx*rx*(yp*yp)+ry*ry*(xp*xp)));fa===fs&&(f*=-1),isNaN(f)&&(f=0);var cxp=f*rx*yp/ry,cyp=f*-ry*xp/rx,cx=(x1+x2)/2+Math.cos(psi)*cxp-Math.sin(psi)*cyp,cy=(y1+y2)/2+Math.sin(psi)*cxp+Math.cos(psi)*cyp,vMag=function(v){return Math.sqrt(v[0]*v[0]+v[1]*v[1])},vRatio=function(u,v){return(u[0]*v[0]+u[1]*v[1])/(vMag(u)*vMag(v))},vAngle=function(u,v){return(u[0]*v[1]<u[1]*v[0]?-1:1)*Math.acos(vRatio(u,v))},theta=vAngle([1,0],[(xp-cxp)/rx,(yp-cyp)/ry]),u=[(xp-cxp)/rx,(yp-cyp)/ry],v=[(-1*xp-cxp)/rx,(-1*yp-cyp)/ry],dTheta=vAngle(u,v);return vRatio(u,v)<=-1&&(dTheta=Math.PI),vRatio(u,v)>=1&&(dTheta=0),0===fs&&dTheta>0&&(dTheta-=2*Math.PI),1===fs&&dTheta<0&&(dTheta+=2*Math.PI),[cx,cy,rx,ry,theta,dTheta,psi,fs]},Path}(Shape);Path.prototype.className="Path",Path.prototype._attrsAffectingSize=["data"],_registerNode(Path),Factory.addGetterSetter(Path,"data"),Collection.mapMethods(Path);var Rect=function(_super){function Rect(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Rect,_super),Rect.prototype._sceneFunc=function(context){var cornerRadius=this.cornerRadius(),width=this.width(),height=this.height();if(context.beginPath(),cornerRadius){var topLeft=0,topRight=0,bottomLeft=0,bottomRight=0;"number"==typeof cornerRadius?topLeft=topRight=bottomLeft=bottomRight=Math.min(cornerRadius,width/2,height/2):(topLeft=Math.min(cornerRadius[0],width/2,height/2),topRight=Math.min(cornerRadius[1],width/2,height/2),bottomRight=Math.min(cornerRadius[2],width/2,height/2),bottomLeft=Math.min(cornerRadius[3],width/2,height/2)),context.moveTo(topLeft,0),context.lineTo(width-topRight,0),context.arc(width-topRight,topRight,topRight,3*Math.PI/2,0,!1),context.lineTo(width,height-bottomRight),context.arc(width-bottomRight,height-bottomRight,bottomRight,0,Math.PI/2,!1),context.lineTo(bottomLeft,height),context.arc(bottomLeft,height-bottomLeft,bottomLeft,Math.PI/2,Math.PI,!1),context.lineTo(0,topLeft),context.arc(topLeft,topLeft,topLeft,Math.PI,3*Math.PI/2,!1)}else context.rect(0,0,width,height);context.closePath(),context.fillStrokeShape(this)},Rect}(Shape);Rect.prototype.className="Rect",_registerNode(Rect),Factory.addGetterSetter(Rect,"cornerRadius",0),Collection.mapMethods(Rect);var RegularPolygon=function(_super){function RegularPolygon(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(RegularPolygon,_super),RegularPolygon.prototype._sceneFunc=function(context){var n,x,y,sides=this.sides(),radius=this.radius();for(context.beginPath(),context.moveTo(0,0-radius),n=1;n<sides;n++)x=radius*Math.sin(2*n*Math.PI/sides),y=-1*radius*Math.cos(2*n*Math.PI/sides),context.lineTo(x,y);context.closePath(),context.fillStrokeShape(this)},RegularPolygon.prototype.getWidth=function(){return 2*this.radius()},RegularPolygon.prototype.getHeight=function(){return 2*this.radius()},RegularPolygon.prototype.setWidth=function(width){this.radius(width/2)},RegularPolygon.prototype.setHeight=function(height){this.radius(height/2)},RegularPolygon}(Shape);RegularPolygon.prototype.className="RegularPolygon",RegularPolygon.prototype._centroid=!0,RegularPolygon.prototype._attrsAffectingSize=["radius"],_registerNode(RegularPolygon),Factory.addGetterSetter(RegularPolygon,"radius",0,getNumberValidator()),Factory.addGetterSetter(RegularPolygon,"sides",0,getNumberValidator()),Collection.mapMethods(RegularPolygon);var PIx2=2*Math.PI,Ring=function(_super){function Ring(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Ring,_super),Ring.prototype._sceneFunc=function(context){context.beginPath(),context.arc(0,0,this.innerRadius(),0,PIx2,!1),context.moveTo(this.outerRadius(),0),context.arc(0,0,this.outerRadius(),PIx2,0,!0),context.closePath(),context.fillStrokeShape(this)},Ring.prototype.getWidth=function(){return 2*this.outerRadius()},Ring.prototype.getHeight=function(){return 2*this.outerRadius()},Ring.prototype.setWidth=function(width){this.outerRadius(width/2)},Ring.prototype.setHeight=function(height){this.outerRadius(height/2)},Ring}(Shape);Ring.prototype.className="Ring",Ring.prototype._centroid=!0,Ring.prototype._attrsAffectingSize=["innerRadius","outerRadius"],_registerNode(Ring),Factory.addGetterSetter(Ring,"innerRadius",0,getNumberValidator()),Factory.addGetterSetter(Ring,"outerRadius",0,getNumberValidator()),Collection.mapMethods(Ring);var Sprite=function(_super){function Sprite(config){var _this=_super.call(this,config)||this;return _this._updated=!0,_this.anim=new Animation(function(){var updated=_this._updated;return _this._updated=!1,updated}),_this.on("animationChange.konva",function(){this.frameIndex(0)}),_this.on("frameIndexChange.konva",function(){this._updated=!0}),_this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())}),_this}return __extends(Sprite,_super),Sprite.prototype._sceneFunc=function(context){var anim=this.animation(),index=this.frameIndex(),ix4=4*index,set=this.animations()[anim],offsets=this.frameOffsets(),x=set[ix4+0],y=set[ix4+1],width=set[ix4+2],height=set[ix4+3],image=this.image();if((this.hasFill()||this.hasStroke())&&(context.beginPath(),context.rect(0,0,width,height),context.closePath(),context.fillStrokeShape(this)),image)if(offsets){var offset=offsets[anim],ix2=2*index;context.drawImage(image,x,y,width,height,offset[ix2+0],offset[ix2+1],width,height)}else context.drawImage(image,x,y,width,height,0,0,width,height)},Sprite.prototype._hitFunc=function(context){var anim=this.animation(),index=this.frameIndex(),ix4=4*index,set=this.animations()[anim],offsets=this.frameOffsets(),width=set[ix4+2],height=set[ix4+3];if(context.beginPath(),offsets){var offset=offsets[anim],ix2=2*index;context.rect(offset[ix2+0],offset[ix2+1],width,height)}else context.rect(0,0,width,height);context.closePath(),context.fillShape(this)},Sprite.prototype._useBufferCanvas=function(){return _super.prototype._useBufferCanvas.call(this,!0)},Sprite.prototype._setInterval=function(){var that=this;this.interval=setInterval(function(){that._updateIndex()},1e3/this.frameRate())},Sprite.prototype.start=function(){if(!this.isRunning()){var layer=this.getLayer();this.anim.setLayers(layer),this._setInterval(),this.anim.start()}},Sprite.prototype.stop=function(){this.anim.stop(),clearInterval(this.interval)},Sprite.prototype.isRunning=function(){return this.anim.isRunning()},Sprite.prototype._updateIndex=function(){var index=this.frameIndex(),animation=this.animation();index<this.animations()[animation].length/4-1?this.frameIndex(index+1):this.frameIndex(0)},Sprite}(Shape);Sprite.prototype.className="Sprite",_registerNode(Sprite),Factory.addGetterSetter(Sprite,"animation"),Factory.addGetterSetter(Sprite,"animations"),Factory.addGetterSetter(Sprite,"frameOffsets"),Factory.addGetterSetter(Sprite,"image"),Factory.addGetterSetter(Sprite,"frameIndex",0,getNumberValidator()),Factory.addGetterSetter(Sprite,"frameRate",17,getNumberValidator()),Factory.backCompat(Sprite,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Collection.mapMethods(Sprite);var Star=function(_super){function Star(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Star,_super),Star.prototype._sceneFunc=function(context){var innerRadius=this.innerRadius(),outerRadius=this.outerRadius(),numPoints=this.numPoints();context.beginPath(),context.moveTo(0,0-outerRadius);for(var n=1;n<2*numPoints;n++){var radius=n%2==0?outerRadius:innerRadius,x=radius*Math.sin(n*Math.PI/numPoints),y=-1*radius*Math.cos(n*Math.PI/numPoints);context.lineTo(x,y)}context.closePath(),context.fillStrokeShape(this)},Star.prototype.getWidth=function(){return 2*this.outerRadius()},Star.prototype.getHeight=function(){return 2*this.outerRadius()},Star.prototype.setWidth=function(width){this.outerRadius(width/2)},Star.prototype.setHeight=function(height){this.outerRadius(height/2)},Star}(Shape);Star.prototype.className="Star",Star.prototype._centroid=!0,Star.prototype._attrsAffectingSize=["innerRadius","outerRadius"],_registerNode(Star),Factory.addGetterSetter(Star,"numPoints",5,getNumberValidator()),Factory.addGetterSetter(Star,"innerRadius",0,getNumberValidator()),Factory.addGetterSetter(Star,"outerRadius",0,getNumberValidator()),Collection.mapMethods(Star);var dummyContext$1,CHANGE_KONVA$1="Change.konva",CONTEXT_2D="2d",ATTR_CHANGE_LIST$1=["fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],attrChangeListLen$1=ATTR_CHANGE_LIST$1.length;function getDummyContext$1(){return dummyContext$1||(dummyContext$1=Util.createCanvasElement().getContext(CONTEXT_2D))}var Text=function(_super){function Text(config){var _this=_super.call(this,function(config){return(config=config||{}).fillLinearGradientColorStops||config.fillRadialGradientColorStops||config.fillPatternImage||(config.fill=config.fill||"black"),config}(config))||this;_this._partialTextX=0,_this._partialTextY=0;for(var n=0;n<attrChangeListLen$1;n++)_this.on(ATTR_CHANGE_LIST$1[n]+CHANGE_KONVA$1,_this._setTextData);return _this._setTextData(),_this}return __extends(Text,_super),Text.prototype._sceneFunc=function(context){var n,padding=this.padding(),fontSize=this.fontSize(),lineHeightPx=this.lineHeight()*fontSize,textArr=this.textArr,textArrLen=textArr.length,verticalAlign=this.verticalAlign(),alignY=0,align=this.align(),totalWidth=this.getWidth(),letterSpacing=this.letterSpacing(),fill=this.fill(),textDecoration=this.textDecoration(),shouldUnderline=-1!==textDecoration.indexOf("underline"),shouldLineThrough=-1!==textDecoration.indexOf("line-through"),translateY=0,lineTranslateX=(translateY=lineHeightPx/2,0),lineTranslateY=0;for(context.setAttr("font",this._getContextFont()),context.setAttr("textBaseline","middle"),context.setAttr("textAlign","left"),"middle"===verticalAlign?alignY=(this.getHeight()-textArrLen*lineHeightPx-2*padding)/2:"bottom"===verticalAlign&&(alignY=this.getHeight()-textArrLen*lineHeightPx-2*padding),context.translate(padding,alignY+padding),n=0;n<textArrLen;n++){lineTranslateX=0,lineTranslateY=0;var spacesNumber,oneWord,lineWidth,obj=textArr[n],text=obj.text,width=obj.width,lastLine=n!==textArrLen-1;if(context.save(),"right"===align?lineTranslateX+=totalWidth-width-2*padding:"center"===align&&(lineTranslateX+=(totalWidth-width-2*padding)/2),shouldUnderline&&(context.save(),context.beginPath(),context.moveTo(lineTranslateX,translateY+lineTranslateY+Math.round(fontSize/2)),oneWord=0===(spacesNumber=text.split(" ").length-1),lineWidth="justify"===align&&lastLine&&!oneWord?totalWidth-2*padding:width,context.lineTo(lineTranslateX+Math.round(lineWidth),translateY+lineTranslateY+Math.round(fontSize/2)),context.lineWidth=fontSize/15,context.strokeStyle=fill,context.stroke(),context.restore()),shouldLineThrough&&(context.save(),context.beginPath(),context.moveTo(lineTranslateX,translateY+lineTranslateY),oneWord=0===(spacesNumber=text.split(" ").length-1),lineWidth="justify"===align&&lastLine&&!oneWord?totalWidth-2*padding:width,context.lineTo(lineTranslateX+Math.round(lineWidth),translateY+lineTranslateY),context.lineWidth=fontSize/15,context.strokeStyle=fill,context.stroke(),context.restore()),0!==letterSpacing||"justify"===align){spacesNumber=text.split(" ").length-1;for(var li=0;li<text.length;li++){var letter=text[li];" "===letter&&n!==textArrLen-1&&"justify"===align&&(lineTranslateX+=(totalWidth-2*padding-width)/spacesNumber),this._partialTextX=lineTranslateX,this._partialTextY=translateY+lineTranslateY,this._partialText=letter,context.fillStrokeShape(this),lineTranslateX+=this.measureSize(letter).width+letterSpacing}}else this._partialTextX=lineTranslateX,this._partialTextY=translateY+lineTranslateY,this._partialText=text,context.fillStrokeShape(this);context.restore(),textArrLen>1&&(translateY+=lineHeightPx)}},Text.prototype._hitFunc=function(context){var width=this.getWidth(),height=this.getHeight();context.beginPath(),context.rect(0,0,width,height),context.closePath(),context.fillStrokeShape(this)},Text.prototype.setText=function(text){var str=Util._isString(text)?text:null===text||void 0===text?"":text+"";return this._setAttr("text",str),this},Text.prototype.getWidth=function(){return"auto"===this.attrs.width||void 0===this.attrs.width?this.getTextWidth()+2*this.padding():this.attrs.width},Text.prototype.getHeight=function(){return"auto"===this.attrs.height||void 0===this.attrs.height?this.fontSize()*this.textArr.length*this.lineHeight()+2*this.padding():this.attrs.height},Text.prototype.getTextWidth=function(){return this.textWidth},Text.prototype.getTextHeight=function(){return Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight},Text.prototype.measureSize=function(text){var metrics,_context=getDummyContext$1(),fontSize=this.fontSize();return _context.save(),_context.font=this._getContextFont(),metrics=_context.measureText(text),_context.restore(),{width:metrics.width,height:fontSize}},Text.prototype._getContextFont=function(){return Konva.UA.isIE?this.fontStyle()+" "+this.fontSize()+"px "+this.fontFamily():this.fontStyle()+" "+this.fontVariant()+" "+this.fontSize()+"px "+this.fontFamily().split(",").map(function(family){var hasSpace=(family=family.trim()).indexOf(" ")>=0,hasQuotes=family.indexOf('"')>=0||family.indexOf("'")>=0;return hasSpace&&!hasQuotes&&(family='"'+family+'"'),family}).join(", ")},Text.prototype._addTextLine=function(line){"justify"===this.align()&&(line=line.trim());var width=this._getTextWidth(line);return this.textArr.push({text:line,width:width})},Text.prototype._getTextWidth=function(text){var letterSpacing=this.letterSpacing(),length=text.length;return getDummyContext$1().measureText(text).width+(length?letterSpacing*(length-1):0)},Text.prototype._setTextData=function(){var lines=this.text().split("\n"),fontSize=+this.fontSize(),textWidth=0,lineHeightPx=this.lineHeight()*fontSize,width=this.attrs.width,height=this.attrs.height,fixedWidth="auto"!==width&&void 0!==width,fixedHeight="auto"!==height&&void 0!==height,padding=this.padding(),maxWidth=width-2*padding,maxHeightPx=height-2*padding,currentHeightPx=0,wrap=this.wrap(),shouldWrap="none"!==wrap,wrapAtWord="char"!==wrap&&shouldWrap,shouldAddEllipsis=this.ellipsis()&&!shouldWrap;this.textArr=[],getDummyContext$1().font=this._getContextFont();for(var additionalWidth=shouldAddEllipsis?this._getTextWidth("…"):0,i=0,max=lines.length;i<max;++i){var line=lines[i],lineWidth=this._getTextWidth(line);if(fixedWidth&&lineWidth>maxWidth)for(;line.length>0;){for(var low=0,high=line.length,match="",matchWidth=0;low<high;){var mid=low+high>>>1,substr=line.slice(0,mid+1),substrWidth=this._getTextWidth(substr)+additionalWidth;substrWidth<=maxWidth?(low=mid+1,match=substr+(shouldAddEllipsis?"…":""),matchWidth=substrWidth):high=mid}if(!match)break;if(wrapAtWord){var wrapIndex,nextChar=line[match.length];(wrapIndex=(" "===nextChar||"-"===nextChar)&&matchWidth<=maxWidth?match.length:Math.max(match.lastIndexOf(" "),match.lastIndexOf("-"))+1)>0&&(low=wrapIndex,match=match.slice(0,low),matchWidth=this._getTextWidth(match))}if(match=match.trimRight(),this._addTextLine(match),textWidth=Math.max(textWidth,matchWidth),currentHeightPx+=lineHeightPx,!shouldWrap||fixedHeight&&currentHeightPx+lineHeightPx>maxHeightPx)break;if((line=(line=line.slice(low)).trimLeft()).length>0&&(lineWidth=this._getTextWidth(line))<=maxWidth){this._addTextLine(line),currentHeightPx+=lineHeightPx,textWidth=Math.max(textWidth,lineWidth);break}}else this._addTextLine(line),currentHeightPx+=lineHeightPx,textWidth=Math.max(textWidth,lineWidth);if(fixedHeight&&currentHeightPx+lineHeightPx>maxHeightPx)break}this.textHeight=fontSize,this.textWidth=textWidth},Text.prototype.getStrokeScaleEnabled=function(){return!0},Text}(Shape);Text.prototype._fillFunc=function(context){context.fillText(this._partialText,this._partialTextX,this._partialTextY)},Text.prototype._strokeFunc=function(context){context.strokeText(this._partialText,this._partialTextX,this._partialTextY)},Text.prototype.className="Text",Text.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight"],_registerNode(Text),Factory.overWriteSetter(Text,"width",getNumberOrAutoValidator()),Factory.overWriteSetter(Text,"height",getNumberOrAutoValidator()),Factory.addGetterSetter(Text,"fontFamily","Arial"),Factory.addGetterSetter(Text,"fontSize",12,getNumberValidator()),Factory.addGetterSetter(Text,"fontStyle","normal"),Factory.addGetterSetter(Text,"fontVariant","normal"),Factory.addGetterSetter(Text,"padding",0,getNumberValidator()),Factory.addGetterSetter(Text,"align","left"),Factory.addGetterSetter(Text,"verticalAlign","top"),Factory.addGetterSetter(Text,"lineHeight",1,getNumberValidator()),Factory.addGetterSetter(Text,"wrap","word"),Factory.addGetterSetter(Text,"ellipsis",!1),Factory.addGetterSetter(Text,"letterSpacing",0,getNumberValidator()),Factory.addGetterSetter(Text,"text","",getStringValidator()),Factory.addGetterSetter(Text,"textDecoration",""),Collection.mapMethods(Text);function _fillFunc$2(context){context.fillText(this.partialText,0,0)}function _strokeFunc$2(context){context.strokeText(this.partialText,0,0)}var TextPath=function(_super){function TextPath(config){var _this=_super.call(this,config)||this;return _this.dummyCanvas=Util.createCanvasElement(),_this.dataArray=[],_this.dataArray=Path.parsePathData(_this.attrs.data),_this.on("dataChange.konva",function(){this.dataArray=Path.parsePathData(this.attrs.data),this._setTextData()}),_this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva",_this._setTextData),config&&config.getKerning&&(Util.warn('getKerning TextPath API is deprecated. Please use "kerningFunc" instead.'),_this.kerningFunc(config.getKerning)),_this._setTextData(),_this}return __extends(TextPath,_super),TextPath.prototype._sceneFunc=function(context){context.setAttr("font",this._getContextFont()),context.setAttr("textBaseline",this.textBaseline()),context.setAttr("textAlign","left"),context.save();var textDecoration=this.textDecoration(),fill=this.fill(),fontSize=this.fontSize(),glyphInfo=this.glyphInfo;"underline"===textDecoration&&context.beginPath();for(var i=0;i<glyphInfo.length;i++){context.save();var p0=glyphInfo[i].p0;context.translate(p0.x,p0.y),context.rotate(glyphInfo[i].rotation),this.partialText=glyphInfo[i].text,context.fillStrokeShape(this),"underline"===textDecoration&&(0===i&&context.moveTo(0,fontSize/2+1),context.lineTo(fontSize,fontSize/2+1)),context.restore()}"underline"===textDecoration&&(context.strokeStyle=fill,context.lineWidth=fontSize/20,context.stroke()),context.restore()},TextPath.prototype._hitFunc=function(context){context.beginPath();var glyphInfo=this.glyphInfo;if(glyphInfo.length>=1){var p0=glyphInfo[0].p0;context.moveTo(p0.x,p0.y)}for(var i=0;i<glyphInfo.length;i++){var p1=glyphInfo[i].p1;context.lineTo(p1.x,p1.y)}context.setAttr("lineWidth",this.fontSize()),context.setAttr("strokeStyle",this.colorKey),context.stroke()},TextPath.prototype.getTextWidth=function(){return this.textWidth},TextPath.prototype.getTextHeight=function(){return Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight},TextPath.prototype.setText=function(text){return Text.prototype.setText.call(this,text)},TextPath.prototype._getContextFont=function(){return Text.prototype._getContextFont.call(this)},TextPath.prototype._getTextSize=function(text){var _context=this.dummyCanvas.getContext("2d");_context.save(),_context.font=this._getContextFont();var metrics=_context.measureText(text);return _context.restore(),{width:metrics.width,height:parseInt(this.attrs.fontSize,10)}},TextPath.prototype._setTextData=function(){var that=this,size=this._getTextSize(this.attrs.text),letterSpacing=this.letterSpacing(),align=this.align(),kerningFunc=this.kerningFunc();this.textWidth=size.width,this.textHeight=size.height;var textFullWidth=Math.max(this.textWidth+((this.attrs.text||"").length-1)*letterSpacing,0);this.glyphInfo=[];for(var fullPathWidth=0,l=0;l<that.dataArray.length;l++)that.dataArray[l].pathLength>0&&(fullPathWidth+=that.dataArray[l].pathLength);var offset=0;"center"===align&&(offset=Math.max(0,fullPathWidth/2-textFullWidth/2)),"right"===align&&(offset=Math.max(0,fullPathWidth-textFullWidth));for(var p0,p1,pathCmd,charArr=this.text().split(""),spacesNumber=this.text().split(" ").length-1,pIndex=-1,currentT=0,getNextPathSegment=function(){currentT=0;for(var pathData=that.dataArray,j=pIndex+1;j<pathData.length;j++){if(pathData[j].pathLength>0)return pIndex=j,pathData[j];"M"===pathData[j].command&&(p0={x:pathData[j].points[0],y:pathData[j].points[1]})}return{}},findSegmentToFitCharacter=function(c){var glyphWidth=that._getTextSize(c).width+letterSpacing;" "===c&&"justify"===align&&(glyphWidth+=(fullPathWidth-textFullWidth)/spacesNumber);var currLen=0,attempts=0;for(p1=void 0;Math.abs(glyphWidth-currLen)/glyphWidth>.01&&attempts<25;){attempts++;for(var cumulativePathLength=currLen;void 0===pathCmd;)(pathCmd=getNextPathSegment())&&cumulativePathLength+pathCmd.pathLength<glyphWidth&&(cumulativePathLength+=pathCmd.pathLength,pathCmd=void 0);if(pathCmd==={}||void 0===p0)return;var needNewSegment=!1;switch(pathCmd.command){case"L":Path.getLineLength(p0.x,p0.y,pathCmd.points[0],pathCmd.points[1])>glyphWidth?p1=Path.getPointOnLine(glyphWidth,p0.x,p0.y,pathCmd.points[0],pathCmd.points[1],p0.x,p0.y):pathCmd=void 0;break;case"A":var start=pathCmd.points[4],dTheta=pathCmd.points[5],end=pathCmd.points[4]+dTheta;0===currentT?currentT=start+1e-8:glyphWidth>currLen?currentT+=Math.PI/180*dTheta/Math.abs(dTheta):currentT-=Math.PI/360*dTheta/Math.abs(dTheta),(dTheta<0&&currentT<end||dTheta>=0&&currentT>end)&&(currentT=end,needNewSegment=!0),p1=Path.getPointOnEllipticalArc(pathCmd.points[0],pathCmd.points[1],pathCmd.points[2],pathCmd.points[3],currentT,pathCmd.points[6]);break;case"C":0===currentT?currentT=glyphWidth>pathCmd.pathLength?1e-8:glyphWidth/pathCmd.pathLength:glyphWidth>currLen?currentT+=(glyphWidth-currLen)/pathCmd.pathLength:currentT-=(currLen-glyphWidth)/pathCmd.pathLength,currentT>1&&(currentT=1,needNewSegment=!0),p1=Path.getPointOnCubicBezier(currentT,pathCmd.start.x,pathCmd.start.y,pathCmd.points[0],pathCmd.points[1],pathCmd.points[2],pathCmd.points[3],pathCmd.points[4],pathCmd.points[5]);break;case"Q":0===currentT?currentT=glyphWidth/pathCmd.pathLength:glyphWidth>currLen?currentT+=(glyphWidth-currLen)/pathCmd.pathLength:currentT-=(currLen-glyphWidth)/pathCmd.pathLength,currentT>1&&(currentT=1,needNewSegment=!0),p1=Path.getPointOnQuadraticBezier(currentT,pathCmd.start.x,pathCmd.start.y,pathCmd.points[0],pathCmd.points[1],pathCmd.points[2],pathCmd.points[3])}void 0!==p1&&(currLen=Path.getLineLength(p0.x,p0.y,p1.x,p1.y)),needNewSegment&&(needNewSegment=!1,pathCmd=void 0)}},lettersInOffset=offset/(that._getTextSize("C").width+letterSpacing)-1,k=0;k<lettersInOffset&&(findSegmentToFitCharacter("C"),void 0!==p0&&void 0!==p1);k++)p0=p1;for(var i=0;i<charArr.length&&(findSegmentToFitCharacter(charArr[i]),void 0!==p0&&void 0!==p1);i++){var width=Path.getLineLength(p0.x,p0.y,p1.x,p1.y),kern=0;if(kerningFunc)try{kern=kerningFunc(charArr[i-1],charArr[i])*this.fontSize()}catch(e){kern=0}p0.x+=kern,p1.x+=kern,this.textWidth+=kern;var midpoint=Path.getPointOnLine(kern+width/2,p0.x,p0.y,p1.x,p1.y),rotation=Math.atan2(p1.y-p0.y,p1.x-p0.x);this.glyphInfo.push({transposeX:midpoint.x,transposeY:midpoint.y,text:charArr[i],rotation:rotation,p0:p0,p1:p1}),p0=p1}},TextPath.prototype.getSelfRect=function(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};var points=[];this.glyphInfo.forEach(function(info){points.push(info.p0.x),points.push(info.p0.y),points.push(info.p1.x),points.push(info.p1.y)});for(var x,y,minX=points[0]||0,maxX=points[0]||0,minY=points[1]||0,maxY=points[1]||0,i=0;i<points.length/2;i++)x=points[2*i],y=points[2*i+1],minX=Math.min(minX,x),maxX=Math.max(maxX,x),minY=Math.min(minY,y),maxY=Math.max(maxY,y);var fontSize=this.fontSize();return{x:minX-fontSize/2,y:minY-fontSize/2,width:maxX-minX+fontSize,height:maxY-minY+fontSize}},TextPath}(Shape);TextPath.prototype._fillFunc=_fillFunc$2,TextPath.prototype._strokeFunc=_strokeFunc$2,TextPath.prototype._fillFuncHit=_fillFunc$2,TextPath.prototype._strokeFuncHit=_strokeFunc$2,TextPath.prototype.className="TextPath",TextPath.prototype._attrsAffectingSize=["text","fontSize","data"],_registerNode(TextPath),Factory.addGetterSetter(TextPath,"data"),Factory.addGetterSetter(TextPath,"fontFamily","Arial"),Factory.addGetterSetter(TextPath,"fontSize",12,getNumberValidator()),Factory.addGetterSetter(TextPath,"fontStyle","normal"),Factory.addGetterSetter(TextPath,"align","left"),Factory.addGetterSetter(TextPath,"letterSpacing",0,getNumberValidator()),Factory.addGetterSetter(TextPath,"textBaseline","middle"),Factory.addGetterSetter(TextPath,"fontVariant","normal"),Factory.addGetterSetter(TextPath,"text",""),Factory.addGetterSetter(TextPath,"textDecoration",null),Factory.addGetterSetter(TextPath,"kerningFunc",null),Collection.mapMethods(TextPath);var ATTR_CHANGE_LIST$2=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange"].map(function(e){return e+".tr-konva"}).join(" "),TRANSFORM_CHANGE_STR$1=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"].map(function(e){return e+".tr-konva"}).join(" "),ANGLES={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},TOUCH_DEVICE="ontouchstart"in Konva._global;var ANCHORS_NAMES=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function rotateAroundPoint(shape,angleRad,point){var x=point.x+(shape.x-point.x)*Math.cos(angleRad)-(shape.y-point.y)*Math.sin(angleRad),y=point.y+(shape.x-point.x)*Math.sin(angleRad)+(shape.y-point.y)*Math.cos(angleRad);return __assign(__assign({},shape),{rotation:shape.rotation+angleRad,x:x,y:y})}function rotateAroundCenter(shape,deltaRad){return rotateAroundPoint(shape,deltaRad,function(shape){return{x:shape.x+shape.width/2*Math.cos(shape.rotation)+shape.height/2*Math.sin(-shape.rotation),y:shape.y+shape.height/2*Math.cos(shape.rotation)+shape.width/2*Math.sin(shape.rotation)}}(shape))}var Transformer=function(_super){function Transformer(config){var _this=_super.call(this,config)||this;return _this._transforming=!1,_this._createElements(),_this._handleMouseMove=_this._handleMouseMove.bind(_this),_this._handleMouseUp=_this._handleMouseUp.bind(_this),_this.update=_this.update.bind(_this),_this.on(ATTR_CHANGE_LIST$2,_this.update),_this.getNode()&&_this.update(),_this}return __extends(Transformer,_super),Transformer.prototype.attachTo=function(node){return this.setNode(node),this},Transformer.prototype.setNode=function(node){return Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([node])},Transformer.prototype.getNode=function(){return this._nodes&&this._nodes[0]},Transformer.prototype.setNodes=function(nodes){var _this=this;return void 0===nodes&&(nodes=[]),this._nodes&&this._nodes.length&&this.detach(),this._nodes=nodes,1===nodes.length?this.rotation(nodes[0].rotation()):this.rotation(0),this._nodes.forEach(function(node){var additionalEvents=node._attrsAffectingSize.map(function(prop){return prop+"Change.tr-konva"}).join(" "),onChange=function(){_this._resetTransformCache(),_this._transforming||_this.update()};node.on(additionalEvents,onChange),node.on(TRANSFORM_CHANGE_STR$1,onChange),node.on("_clearTransformCache.tr-konva",onChange),node.on("xChange.tr-konva yChange.tr-konva",onChange),_this._proxyDrag(node)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this},Transformer.prototype._proxyDrag=function(node){var lastPos,_this=this;node.on("dragstart.tr-konva",function(e){lastPos=node.getAbsolutePosition(),_this.isDragging()||node===_this.findOne(".back")||_this.startDrag()}),node.on("dragmove.tr-konva",function(e){if(lastPos){var abs=node.getAbsolutePosition(),dx=abs.x-lastPos.x,dy=abs.y-lastPos.y;_this.nodes().forEach(function(otherNode){if(otherNode!==node&&!otherNode.isDragging()){var otherAbs=otherNode.getAbsolutePosition();otherNode.setAbsolutePosition({x:otherAbs.x+dx,y:otherAbs.y+dy}),otherNode.startDrag()}}),lastPos=null}})},Transformer.prototype.getNodes=function(){return this._nodes},Transformer.prototype.getActiveAnchor=function(){return this._movingAnchorName},Transformer.prototype.detach=function(){this._nodes&&this._nodes.forEach(function(node){node.off(".tr-konva")}),this._nodes=[],this._resetTransformCache()},Transformer.prototype._resetTransformCache=function(){this._clearCache("nodesRect"),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")},Transformer.prototype._getNodeRect=function(){return this._getCache("nodesRect",this.__getNodeRect)},Transformer.prototype.__getNodeShape=function(node,rot,relative){void 0===rot&&(rot=this.rotation());var rect=node.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),absScale=node.getAbsoluteScale(relative),absPos=node.getAbsolutePosition(relative),dx=rect.x*absScale.x-node.offsetX()*absScale.x,dy=rect.y*absScale.y-node.offsetY()*absScale.y,rotation=(Konva.getAngle(node.getAbsoluteRotation())+2*Math.PI)%(2*Math.PI);return rotateAroundPoint({x:absPos.x+dx*Math.cos(rotation)+dy*Math.sin(-rotation),y:absPos.y+dy*Math.cos(rotation)+dx*Math.sin(rotation),width:rect.width*absScale.x,height:rect.height*absScale.y,rotation:rotation},-Konva.getAngle(rot),{x:0,y:0})},Transformer.prototype.__getNodeRect=function(){var _this=this;if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};var totalPoints=[];this.nodes().map(function(node){var box=node.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:_this.ignoreStroke()}),points=[{x:box.x,y:box.y},{x:box.x+box.width,y:box.y},{x:box.x+box.width,y:box.y+box.height},{x:box.x,y:box.y+box.height}],trans=node.getAbsoluteTransform();points.forEach(function(point){var transformed=trans.point(point);totalPoints.push(transformed)})});var minX,minY,maxX,maxY,tr=new Transform;tr.rotate(-Konva.getAngle(this.rotation())),totalPoints.forEach(function(point){var transformed=tr.point(point);void 0===minX&&(minX=maxX=transformed.x,minY=maxY=transformed.y),minX=Math.min(minX,transformed.x),minY=Math.min(minY,transformed.y),maxX=Math.max(maxX,transformed.x),maxY=Math.max(maxY,transformed.y)}),tr.invert();var p=tr.point({x:minX,y:minY});return{x:p.x,y:p.y,width:maxX-minX,height:maxY-minY,rotation:Konva.getAngle(this.rotation())}},Transformer.prototype.getX=function(){return this._getNodeRect().x},Transformer.prototype.getY=function(){return this._getNodeRect().y},Transformer.prototype.getWidth=function(){return this._getNodeRect().width},Transformer.prototype.getHeight=function(){return this._getNodeRect().height},Transformer.prototype._createElements=function(){this._createBack(),ANCHORS_NAMES.forEach(function(name){this._createAnchor(name)}.bind(this)),this._createAnchor("rotater")},Transformer.prototype._createAnchor=function(name){var _this=this,anchor=new Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:name+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:TOUCH_DEVICE?10:"auto"}),self=this;anchor.on("mousedown touchstart",function(e){self._handleMouseDown(e)}),anchor.on("dragstart",function(e){anchor.stopDrag(),e.cancelBubble=!0}),anchor.on("dragend",function(e){e.cancelBubble=!0}),anchor.on("mouseenter",function(){var rad=Konva.getAngle(_this.rotation()),cursor=function(anchorName,rad){if("rotater"===anchorName)return"crosshair";rad+=Util._degToRad(ANGLES[anchorName]||0);var angle=(Util._radToDeg(rad)%360+360)%360;return Util._inRange(angle,337.5,360)||Util._inRange(angle,0,22.5)?"ns-resize":Util._inRange(angle,22.5,67.5)?"nesw-resize":Util._inRange(angle,67.5,112.5)?"ew-resize":Util._inRange(angle,112.5,157.5)?"nwse-resize":Util._inRange(angle,157.5,202.5)?"ns-resize":Util._inRange(angle,202.5,247.5)?"nesw-resize":Util._inRange(angle,247.5,292.5)?"ew-resize":Util._inRange(angle,292.5,337.5)?"nwse-resize":(Util.error("Transformer has unknown angle for cursor detection: "+angle),"pointer")}(name,rad);anchor.getStage().content.style.cursor=cursor,_this._cursorChange=!0}),anchor.on("mouseout",function(){anchor.getStage().content.style.cursor="",_this._cursorChange=!1}),this.add(anchor)},Transformer.prototype._createBack=function(){var _this=this,back=new Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc:function(ctx){var tr=this.getParent(),padding=tr.padding();ctx.beginPath(),ctx.rect(-padding,-padding,this.width()+2*padding,this.height()+2*padding),ctx.moveTo(this.width()/2,-padding),tr.rotateEnabled()&&ctx.lineTo(this.width()/2,-tr.rotateAnchorOffset()*Util._sign(this.height())-padding),ctx.fillStrokeShape(this)},hitFunc:function(ctx,shape){if(_this.shouldOverdrawWholeArea()){var padding=_this.padding();ctx.beginPath(),ctx.rect(-padding,-padding,shape.width()+2*padding,shape.height()+2*padding),ctx.fillStrokeShape(shape)}}});this.add(back),this._proxyDrag(back)},Transformer.prototype._handleMouseDown=function(e){this._movingAnchorName=e.target.name().split(" ")[0];var attrs=this._getNodeRect(),width=attrs.width,height=attrs.height,hypotenuse=Math.sqrt(Math.pow(width,2)+Math.pow(height,2));this.sin=Math.abs(height/hypotenuse),this.cos=Math.abs(width/hypotenuse),window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0),this._transforming=!0;var ap=e.target.getAbsolutePosition(),pos=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:pos.x-ap.x,y:pos.y-ap.y},this._fire("transformstart",{evt:e,target:this.getNode()}),this.getNode()._fire("transformstart",{evt:e,target:this.getNode()})},Transformer.prototype._handleMouseMove=function(e){var x,y,newHypotenuse,anchorNode=this.findOne("."+this._movingAnchorName),stage=anchorNode.getStage();stage.setPointersPositions(e);var pp=stage.getPointerPosition(),newNodePos={x:pp.x-this._anchorDragOffset.x,y:pp.y-this._anchorDragOffset.y},oldAbs=anchorNode.getAbsolutePosition();anchorNode.setAbsolutePosition(newNodePos);var newAbs=anchorNode.getAbsolutePosition();if(oldAbs.x!==newAbs.x||oldAbs.y!==newAbs.y)if("rotater"!==this._movingAnchorName){var keepProportion=this.keepRatio()||e.shiftKey,centeredScaling=this.centeredScaling()||e.altKey;if("top-left"===this._movingAnchorName){if(keepProportion){var comparePoint=centeredScaling?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};newHypotenuse=Math.sqrt(Math.pow(comparePoint.x-anchorNode.x(),2)+Math.pow(comparePoint.y-anchorNode.y(),2));var reverseX=this.findOne(".top-left").x()>comparePoint.x?-1:1,reverseY=this.findOne(".top-left").y()>comparePoint.y?-1:1;x=newHypotenuse*this.cos*reverseX,y=newHypotenuse*this.sin*reverseY,this.findOne(".top-left").x(comparePoint.x-x),this.findOne(".top-left").y(comparePoint.y-y)}}else if("top-center"===this._movingAnchorName)this.findOne(".top-left").y(anchorNode.y());else if("top-right"===this._movingAnchorName){if(keepProportion){comparePoint=centeredScaling?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};newHypotenuse=Math.sqrt(Math.pow(anchorNode.x()-comparePoint.x,2)+Math.pow(comparePoint.y-anchorNode.y(),2));reverseX=this.findOne(".top-right").x()<comparePoint.x?-1:1,reverseY=this.findOne(".top-right").y()>comparePoint.y?-1:1;x=newHypotenuse*this.cos*reverseX,y=newHypotenuse*this.sin*reverseY,this.findOne(".top-right").x(comparePoint.x+x),this.findOne(".top-right").y(comparePoint.y-y)}var pos=anchorNode.position();this.findOne(".top-left").y(pos.y),this.findOne(".bottom-right").x(pos.x)}else if("middle-left"===this._movingAnchorName)this.findOne(".top-left").x(anchorNode.x());else if("middle-right"===this._movingAnchorName)this.findOne(".bottom-right").x(anchorNode.x());else if("bottom-left"===this._movingAnchorName){if(keepProportion){comparePoint=centeredScaling?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};newHypotenuse=Math.sqrt(Math.pow(comparePoint.x-anchorNode.x(),2)+Math.pow(anchorNode.y()-comparePoint.y,2));reverseX=comparePoint.x<anchorNode.x()?-1:1,reverseY=anchorNode.y()<comparePoint.y?-1:1;x=newHypotenuse*this.cos*reverseX,y=newHypotenuse*this.sin*reverseY,anchorNode.x(comparePoint.x-x),anchorNode.y(comparePoint.y+y)}pos=anchorNode.position(),this.findOne(".top-left").x(pos.x),this.findOne(".bottom-right").y(pos.y)}else if("bottom-center"===this._movingAnchorName)this.findOne(".bottom-right").y(anchorNode.y());else if("bottom-right"===this._movingAnchorName){if(keepProportion){comparePoint=centeredScaling?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};newHypotenuse=Math.sqrt(Math.pow(anchorNode.x()-comparePoint.x,2)+Math.pow(anchorNode.y()-comparePoint.y,2));reverseX=this.findOne(".bottom-right").x()<comparePoint.x?-1:1,reverseY=this.findOne(".bottom-right").y()<comparePoint.y?-1:1;x=newHypotenuse*this.cos*reverseX,y=newHypotenuse*this.sin*reverseY,this.findOne(".bottom-right").x(comparePoint.x+x),this.findOne(".bottom-right").y(comparePoint.y+y)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(centeredScaling=this.centeredScaling()||e.altKey){var topLeft=this.findOne(".top-left"),bottomRight=this.findOne(".bottom-right"),topOffsetX=topLeft.x(),topOffsetY=topLeft.y(),bottomOffsetX=this.getWidth()-bottomRight.x(),bottomOffsetY=this.getHeight()-bottomRight.y();bottomRight.move({x:-topOffsetX,y:-topOffsetY}),topLeft.move({x:bottomOffsetX,y:bottomOffsetY})}var absPos=this.findOne(".top-left").getAbsolutePosition();x=absPos.x,y=absPos.y;var width=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),height=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:x,y:y,width:width,height:height,rotation:Konva.getAngle(this.rotation())},e)}else{var attrs=this._getNodeRect();x=anchorNode.x()-attrs.width/2,y=-anchorNode.y()+attrs.height/2;var delta=Math.atan2(-y,x)+Math.PI/2;attrs.height<0&&(delta-=Math.PI);var newRotation=Konva.getAngle(this.rotation())+delta,tol=Konva.getAngle(this.rotationSnapTolerance()),shape=rotateAroundCenter(attrs,function(snaps,newRotationRad,tol){for(var snapped=newRotationRad,i=0;i<snaps.length;i++){var angle=Konva.getAngle(snaps[i]),absDiff=Math.abs(angle-newRotationRad)%(2*Math.PI);Math.min(absDiff,2*Math.PI-absDiff)<tol&&(snapped=angle)}return snapped}(this.rotationSnaps(),newRotation,tol)-attrs.rotation);this._fitNodesInto(shape,e)}},Transformer.prototype._handleMouseUp=function(e){this._removeEvents(e)},Transformer.prototype.getAbsoluteTransform=function(){return this.getTransform()},Transformer.prototype._removeEvents=function(e){if(this._transforming){this._transforming=!1,window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0);var node=this.getNode();this._fire("transformend",{evt:e,target:node}),node&&node.fire("transformend",{evt:e,target:node}),this._movingAnchorName=null}},Transformer.prototype._fitNodesInto=function(newAttrs,evt){var _this=this,oldAttrs=this._getNodeRect();if(Util._inRange(newAttrs.width,2*-this.padding()-1,1))this.update();else if(Util._inRange(newAttrs.height,2*-this.padding()-1,1))this.update();else{var t=new Transform;if(t.rotate(Konva.getAngle(this.rotation())),this._movingAnchorName&&newAttrs.width<0&&this._movingAnchorName.indexOf("left")>=0){var offset=t.point({x:2*-this.padding(),y:0});newAttrs.x+=offset.x,newAttrs.y+=offset.y,newAttrs.width+=2*this.padding(),this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=offset.x,this._anchorDragOffset.y-=offset.y}else if(this._movingAnchorName&&newAttrs.width<0&&this._movingAnchorName.indexOf("right")>=0){offset=t.point({x:2*this.padding(),y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=offset.x,this._anchorDragOffset.y-=offset.y,newAttrs.width+=2*this.padding()}if(this._movingAnchorName&&newAttrs.height<0&&this._movingAnchorName.indexOf("top")>=0){offset=t.point({x:0,y:2*-this.padding()});newAttrs.x+=offset.x,newAttrs.y+=offset.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=offset.x,this._anchorDragOffset.y-=offset.y,newAttrs.height+=2*this.padding()}else if(this._movingAnchorName&&newAttrs.height<0&&this._movingAnchorName.indexOf("bottom")>=0){offset=t.point({x:0,y:2*this.padding()});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=offset.x,this._anchorDragOffset.y-=offset.y,newAttrs.height+=2*this.padding()}if(this.boundBoxFunc()){var bounded=this.boundBoxFunc()(oldAttrs,newAttrs);bounded?newAttrs=bounded:Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}var oldTr=new Transform;oldTr.translate(oldAttrs.x,oldAttrs.y),oldTr.rotate(oldAttrs.rotation),oldTr.scale(oldAttrs.width/1e7,oldAttrs.height/1e7);var newTr=new Transform;newTr.translate(newAttrs.x,newAttrs.y),newTr.rotate(newAttrs.rotation),newTr.scale(newAttrs.width/1e7,newAttrs.height/1e7);var delta=newTr.multiply(oldTr.invert());this._nodes.forEach(function(node){var parentTransform=node.getParent().getAbsoluteTransform(),localTransform=node.getTransform().copy();localTransform.translate(node.offsetX(),node.offsetY());var newLocalTransform=new Transform;newLocalTransform.multiply(parentTransform.copy().invert()).multiply(delta).multiply(parentTransform).multiply(localTransform);var attrs=newLocalTransform.decompose();node.setAttrs(attrs),_this._fire("transform",{evt:evt,target:node}),node._fire("transform",{evt:evt,target:node})}),this.rotation(Util._getRotation(newAttrs.rotation)),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}},Transformer.prototype.forceUpdate=function(){this._resetTransformCache(),this.update()},Transformer.prototype._batchChangeChild=function(selector,attrs){this.findOne(selector).setAttrs(attrs)},Transformer.prototype.update=function(){var _this=this,attrs=this._getNodeRect();this.rotation(Util._getRotation(attrs.rotation));var width=attrs.width,height=attrs.height,enabledAnchors=this.enabledAnchors(),resizeEnabled=this.resizeEnabled(),padding=this.padding(),anchorSize=this.anchorSize();this.find("._anchor").each(function(node){node.setAttrs({width:anchorSize,height:anchorSize,offsetX:anchorSize/2,offsetY:anchorSize/2,stroke:_this.anchorStroke(),strokeWidth:_this.anchorStrokeWidth(),fill:_this.anchorFill(),cornerRadius:_this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:anchorSize/2+padding,offsetY:anchorSize/2+padding,visible:resizeEnabled&&enabledAnchors.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:width/2,y:0,offsetY:anchorSize/2+padding,visible:resizeEnabled&&enabledAnchors.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:width,y:0,offsetX:anchorSize/2-padding,offsetY:anchorSize/2+padding,visible:resizeEnabled&&enabledAnchors.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:height/2,offsetX:anchorSize/2+padding,visible:resizeEnabled&&enabledAnchors.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:width,y:height/2,offsetX:anchorSize/2-padding,visible:resizeEnabled&&enabledAnchors.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:height,offsetX:anchorSize/2+padding,offsetY:anchorSize/2-padding,visible:resizeEnabled&&enabledAnchors.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:width/2,y:height,offsetY:anchorSize/2-padding,visible:resizeEnabled&&enabledAnchors.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:width,y:height,offsetX:anchorSize/2-padding,offsetY:anchorSize/2-padding,visible:resizeEnabled&&enabledAnchors.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:width/2,y:-this.rotateAnchorOffset()*Util._sign(height)-padding,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:width,height:height,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0})},Transformer.prototype.isTransforming=function(){return this._transforming},Transformer.prototype.stopTransform=function(){if(this._transforming){this._removeEvents();var anchorNode=this.findOne("."+this._movingAnchorName);anchorNode&&anchorNode.stopDrag()}},Transformer.prototype.destroy=function(){return this.getStage()&&this._cursorChange&&(this.getStage().content.style.cursor=""),Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this},Transformer.prototype.toObject=function(){return Node.prototype.toObject.call(this)},Transformer}(Group);Transformer.prototype.className="Transformer",_registerNode(Transformer),Factory.addGetterSetter(Transformer,"enabledAnchors",ANCHORS_NAMES,function(val){return val instanceof Array||Util.warn("enabledAnchors value should be an array"),val instanceof Array&&val.forEach(function(name){-1===ANCHORS_NAMES.indexOf(name)&&Util.warn("Unknown anchor name: "+name+". Available names are: "+ANCHORS_NAMES.join(", "))}),val||[]}),Factory.addGetterSetter(Transformer,"resizeEnabled",!0),Factory.addGetterSetter(Transformer,"anchorSize",10,getNumberValidator()),Factory.addGetterSetter(Transformer,"rotateEnabled",!0),Factory.addGetterSetter(Transformer,"rotationSnaps",[]),Factory.addGetterSetter(Transformer,"rotateAnchorOffset",50,getNumberValidator()),Factory.addGetterSetter(Transformer,"rotationSnapTolerance",5,getNumberValidator()),Factory.addGetterSetter(Transformer,"borderEnabled",!0),Factory.addGetterSetter(Transformer,"anchorStroke","rgb(0, 161, 255)"),Factory.addGetterSetter(Transformer,"anchorStrokeWidth",1,getNumberValidator()),Factory.addGetterSetter(Transformer,"anchorFill","white"),Factory.addGetterSetter(Transformer,"anchorCornerRadius",0,getNumberValidator()),Factory.addGetterSetter(Transformer,"borderStroke","rgb(0, 161, 255)"),Factory.addGetterSetter(Transformer,"borderStrokeWidth",1,getNumberValidator()),Factory.addGetterSetter(Transformer,"borderDash"),Factory.addGetterSetter(Transformer,"keepRatio",!0),Factory.addGetterSetter(Transformer,"centeredScaling",!1),Factory.addGetterSetter(Transformer,"ignoreStroke",!1),Factory.addGetterSetter(Transformer,"padding",0,getNumberValidator()),Factory.addGetterSetter(Transformer,"node"),Factory.addGetterSetter(Transformer,"nodes"),Factory.addGetterSetter(Transformer,"boundBoxFunc"),Factory.addGetterSetter(Transformer,"shouldOverdrawWholeArea",!1),Factory.backCompat(Transformer,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Collection.mapMethods(Transformer);var Wedge=function(_super){function Wedge(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(Wedge,_super),Wedge.prototype._sceneFunc=function(context){context.beginPath(),context.arc(0,0,this.radius(),0,Konva.getAngle(this.angle()),this.clockwise()),context.lineTo(0,0),context.closePath(),context.fillStrokeShape(this)},Wedge.prototype.getWidth=function(){return 2*this.radius()},Wedge.prototype.getHeight=function(){return 2*this.radius()},Wedge.prototype.setWidth=function(width){this.radius(width/2)},Wedge.prototype.setHeight=function(height){this.radius(height/2)},Wedge}(Shape);function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}Wedge.prototype.className="Wedge",Wedge.prototype._centroid=!0,Wedge.prototype._attrsAffectingSize=["radius"],_registerNode(Wedge),Factory.addGetterSetter(Wedge,"radius",0,getNumberValidator()),Factory.addGetterSetter(Wedge,"angle",0,getNumberValidator()),Factory.addGetterSetter(Wedge,"clockwise",!1),Factory.backCompat(Wedge,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Collection.mapMethods(Wedge);var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];Factory.addGetterSetter(Node,"blurRadius",0,getNumberValidator(),Factory.afterSetFilter);Factory.addGetterSetter(Node,"brightness",0,getNumberValidator(),Factory.afterSetFilter);Factory.addGetterSetter(Node,"contrast",0,getNumberValidator(),Factory.afterSetFilter);function remap(fromValue,fromMin,fromMax,toMin,toMax){var fromRange=fromMax-fromMin,toRange=toMax-toMin;return 0===fromRange?toMin+toRange/2:0===toRange?toMin:toRange*((fromValue-fromMin)/fromRange)+toMin}Factory.addGetterSetter(Node,"embossStrength",.5,getNumberValidator(),Factory.afterSetFilter),Factory.addGetterSetter(Node,"embossWhiteLevel",.5,getNumberValidator(),Factory.afterSetFilter),Factory.addGetterSetter(Node,"embossDirection","top-left",null,Factory.afterSetFilter),Factory.addGetterSetter(Node,"embossBlend",!1,null,Factory.afterSetFilter);Factory.addGetterSetter(Node,"enhance",0,getNumberValidator(),Factory.afterSetFilter);Factory.addGetterSetter(Node,"hue",0,getNumberValidator(),Factory.afterSetFilter),Factory.addGetterSetter(Node,"saturation",0,getNumberValidator(),Factory.afterSetFilter),Factory.addGetterSetter(Node,"luminance",0,getNumberValidator(),Factory.afterSetFilter);Factory.addGetterSetter(Node,"hue",0,getNumberValidator(),Factory.afterSetFilter),Factory.addGetterSetter(Node,"saturation",0,getNumberValidator(),Factory.afterSetFilter),Factory.addGetterSetter(Node,"value",0,getNumberValidator(),Factory.afterSetFilter);function pixelAt(idata,x,y){var idx=4*(y*idata.width+x),d=[];return d.push(idata.data[idx++],idata.data[idx++],idata.data[idx++],idata.data[idx++]),d}function rgbDistance(p1,p2){return Math.sqrt(Math.pow(p1[0]-p2[0],2)+Math.pow(p1[1]-p2[1],2)+Math.pow(p1[2]-p2[2],2))}Factory.addGetterSetter(Node,"kaleidoscopePower",2,getNumberValidator(),Factory.afterSetFilter),Factory.addGetterSetter(Node,"kaleidoscopeAngle",0,getNumberValidator(),Factory.afterSetFilter);Factory.addGetterSetter(Node,"threshold",0,getNumberValidator(),Factory.afterSetFilter);Factory.addGetterSetter(Node,"noise",.2,getNumberValidator(),Factory.afterSetFilter);Factory.addGetterSetter(Node,"pixelSize",8,getNumberValidator(),Factory.afterSetFilter);Factory.addGetterSetter(Node,"levels",.5,getNumberValidator(),Factory.afterSetFilter);Factory.addGetterSetter(Node,"red",0,function(val){return this._filterUpToDate=!1,val>255?255:val<0?0:Math.round(val)}),Factory.addGetterSetter(Node,"green",0,function(val){return this._filterUpToDate=!1,val>255?255:val<0?0:Math.round(val)}),Factory.addGetterSetter(Node,"blue",0,RGBComponent,Factory.afterSetFilter);Factory.addGetterSetter(Node,"red",0,function(val){return this._filterUpToDate=!1,val>255?255:val<0?0:Math.round(val)}),Factory.addGetterSetter(Node,"green",0,function(val){return this._filterUpToDate=!1,val>255?255:val<0?0:Math.round(val)}),Factory.addGetterSetter(Node,"blue",0,RGBComponent,Factory.afterSetFilter),Factory.addGetterSetter(Node,"alpha",1,function(val){return this._filterUpToDate=!1,val>1?1:val<0?0:val});return Factory.addGetterSetter(Node,"threshold",.5,getNumberValidator(),Factory.afterSetFilter),Konva$1.Util._assign(Konva$1,{Arc:Arc,Arrow:Arrow,Circle:Circle,Ellipse:Ellipse,Image:Image,Label:Label,Tag:Tag,Line:Line,Path:Path,Rect:Rect,RegularPolygon:RegularPolygon,Ring:Ring,Sprite:Sprite,Star:Star,Text:Text,TextPath:TextPath,Transformer:Transformer,Wedge:Wedge,Filters:{Blur:function(imageData){var radius=Math.round(this.blurRadius());radius>0&&function(imageData,radius){var x,y,i,p,yp,yi,yw,r_sum,g_sum,b_sum,a_sum,r_out_sum,g_out_sum,b_out_sum,a_out_sum,r_in_sum,g_in_sum,b_in_sum,a_in_sum,pr,pg,pb,pa,rbs,pixels=imageData.data,width=imageData.width,height=imageData.height,div=radius+radius+1,widthMinus1=width-1,heightMinus1=height-1,radiusPlus1=radius+1,sumFactor=radiusPlus1*(radiusPlus1+1)/2,stackStart=new BlurStack,stackEnd=null,stack=stackStart,stackIn=null,stackOut=null,mul_sum=mul_table[radius],shg_sum=shg_table[radius];for(i=1;i<div;i++)stack=stack.next=new BlurStack,i===radiusPlus1&&(stackEnd=stack);for(stack.next=stackStart,yw=yi=0,y=0;y<height;y++){for(r_in_sum=g_in_sum=b_in_sum=a_in_sum=r_sum=g_sum=b_sum=a_sum=0,r_out_sum=radiusPlus1*(pr=pixels[yi]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),a_out_sum=radiusPlus1*(pa=pixels[yi+3]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,a_sum+=sumFactor*pa,stack=stackStart,i=0;i<radiusPlus1;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack.a=pa,stack=stack.next;for(i=1;i<radiusPlus1;i++)p=yi+((widthMinus1<i?widthMinus1:i)<<2),r_sum+=(stack.r=pr=pixels[p])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[p+1])*rbs,b_sum+=(stack.b=pb=pixels[p+2])*rbs,a_sum+=(stack.a=pa=pixels[p+3])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,a_in_sum+=pa,stack=stack.next;for(stackIn=stackStart,stackOut=stackEnd,x=0;x<width;x++)pixels[yi+3]=pa=a_sum*mul_sum>>shg_sum,0!==pa?(pa=255/pa,pixels[yi]=(r_sum*mul_sum>>shg_sum)*pa,pixels[yi+1]=(g_sum*mul_sum>>shg_sum)*pa,pixels[yi+2]=(b_sum*mul_sum>>shg_sum)*pa):pixels[yi]=pixels[yi+1]=pixels[yi+2]=0,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,a_sum-=a_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,a_out_sum-=stackIn.a,p=yw+((p=x+radius+1)<widthMinus1?p:widthMinus1)<<2,r_sum+=r_in_sum+=stackIn.r=pixels[p],g_sum+=g_in_sum+=stackIn.g=pixels[p+1],b_sum+=b_in_sum+=stackIn.b=pixels[p+2],a_sum+=a_in_sum+=stackIn.a=pixels[p+3],stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,a_out_sum+=pa=stackOut.a,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,a_in_sum-=pa,stackOut=stackOut.next,yi+=4;yw+=width}for(x=0;x<width;x++){for(g_in_sum=b_in_sum=a_in_sum=r_in_sum=g_sum=b_sum=a_sum=r_sum=0,r_out_sum=radiusPlus1*(pr=pixels[yi=x<<2]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),a_out_sum=radiusPlus1*(pa=pixels[yi+3]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,a_sum+=sumFactor*pa,stack=stackStart,i=0;i<radiusPlus1;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack.a=pa,stack=stack.next;for(yp=width,i=1;i<=radius;i++)yi=yp+x<<2,r_sum+=(stack.r=pr=pixels[yi])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[yi+1])*rbs,b_sum+=(stack.b=pb=pixels[yi+2])*rbs,a_sum+=(stack.a=pa=pixels[yi+3])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,a_in_sum+=pa,stack=stack.next,i<heightMinus1&&(yp+=width);for(yi=x,stackIn=stackStart,stackOut=stackEnd,y=0;y<height;y++)pixels[3+(p=yi<<2)]=pa=a_sum*mul_sum>>shg_sum,pa>0?(pa=255/pa,pixels[p]=(r_sum*mul_sum>>shg_sum)*pa,pixels[p+1]=(g_sum*mul_sum>>shg_sum)*pa,pixels[p+2]=(b_sum*mul_sum>>shg_sum)*pa):pixels[p]=pixels[p+1]=pixels[p+2]=0,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,a_sum-=a_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,a_out_sum-=stackIn.a,p=x+((p=y+radiusPlus1)<heightMinus1?p:heightMinus1)*width<<2,r_sum+=r_in_sum+=stackIn.r=pixels[p],g_sum+=g_in_sum+=stackIn.g=pixels[p+1],b_sum+=b_in_sum+=stackIn.b=pixels[p+2],a_sum+=a_in_sum+=stackIn.a=pixels[p+3],stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,a_out_sum+=pa=stackOut.a,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,a_in_sum-=pa,stackOut=stackOut.next,yi+=width}}(imageData,radius)},Brighten:function(imageData){var i,brightness=255*this.brightness(),data=imageData.data,len=data.length;for(i=0;i<len;i+=4)data[i]+=brightness,data[i+1]+=brightness,data[i+2]+=brightness},Contrast:function(imageData){var i,adjust=Math.pow((this.contrast()+100)/100,2),data=imageData.data,nPixels=data.length,red=150,green=150,blue=150;for(i=0;i<nPixels;i+=4)red=data[i],green=data[i+1],blue=data[i+2],red/=255,red-=.5,red*=adjust,red+=.5,green/=255,green-=.5,green*=adjust,green+=.5,green*=255,blue/=255,blue-=.5,blue*=adjust,blue+=.5,blue*=255,red=(red*=255)<0?0:red>255?255:red,green=green<0?0:green>255?255:green,blue=blue<0?0:blue>255?255:blue,data[i]=red,data[i+1]=green,data[i+2]=blue},Emboss:function(imageData){var strength=10*this.embossStrength(),greyLevel=255*this.embossWhiteLevel(),direction=this.embossDirection(),blend=this.embossBlend(),dirY=0,dirX=0,data=imageData.data,w=imageData.width,h=imageData.height,w4=4*w,y=h;switch(direction){case"top-left":dirY=-1,dirX=-1;break;case"top":dirY=-1,dirX=0;break;case"top-right":dirY=-1,dirX=1;break;case"right":dirY=0,dirX=1;break;case"bottom-right":dirY=1,dirX=1;break;case"bottom":dirY=1,dirX=0;break;case"bottom-left":dirY=1,dirX=-1;break;case"left":dirY=0,dirX=-1;break;default:Util.error("Unknown emboss direction: "+direction)}do{var offsetY=(y-1)*w4,otherY=dirY;y+otherY<1&&(otherY=0),y+otherY>h&&(otherY=0);var offsetYOther=(y-1+otherY)*w*4,x=w;do{var offset=offsetY+4*(x-1),otherX=dirX;x+otherX<1&&(otherX=0),x+otherX>w&&(otherX=0);var offsetOther=offsetYOther+4*(x-1+otherX),dR=data[offset]-data[offsetOther],dG=data[offset+1]-data[offsetOther+1],dB=data[offset+2]-data[offsetOther+2],dif=dR,absDif=dif>0?dif:-dif;if((dG>0?dG:-dG)>absDif&&(dif=dG),(dB>0?dB:-dB)>absDif&&(dif=dB),dif*=strength,blend){var r=data[offset]+dif,g=data[offset+1]+dif,b=data[offset+2]+dif;data[offset]=r>255?255:r<0?0:r,data[offset+1]=g>255?255:g<0?0:g,data[offset+2]=b>255?255:b<0?0:b}else{var grey=greyLevel-dif;grey<0?grey=0:grey>255&&(grey=255),data[offset]=data[offset+1]=data[offset+2]=grey}}while(--x)}while(--y)},Enhance:function(imageData){var r,g,b,i,data=imageData.data,nSubPixels=data.length,rMin=data[0],rMax=rMin,gMin=data[1],gMax=gMin,bMin=data[2],bMax=bMin,enhanceAmount=this.enhance();if(0!==enhanceAmount){for(i=0;i<nSubPixels;i+=4)(r=data[i+0])<rMin?rMin=r:r>rMax&&(rMax=r),(g=data[i+1])<gMin?gMin=g:g>gMax&&(gMax=g),(b=data[i+2])<bMin?bMin=b:b>bMax&&(bMax=b);var rMid,rGoalMax,rGoalMin,gMid,gGoalMax,gGoalMin,bMid,bGoalMax,bGoalMin;for(rMax===rMin&&(rMax=255,rMin=0),gMax===gMin&&(gMax=255,gMin=0),bMax===bMin&&(bMax=255,bMin=0),enhanceAmount>0?(rGoalMax=rMax+enhanceAmount*(255-rMax),rGoalMin=rMin-enhanceAmount*(rMin-0),gGoalMax=gMax+enhanceAmount*(255-gMax),gGoalMin=gMin-enhanceAmount*(gMin-0),bGoalMax=bMax+enhanceAmount*(255-bMax),bGoalMin=bMin-enhanceAmount*(bMin-0)):(rGoalMax=rMax+enhanceAmount*(rMax-(rMid=.5*(rMax+rMin))),rGoalMin=rMin+enhanceAmount*(rMin-rMid),gGoalMax=gMax+enhanceAmount*(gMax-(gMid=.5*(gMax+gMin))),gGoalMin=gMin+enhanceAmount*(gMin-gMid),bGoalMax=bMax+enhanceAmount*(bMax-(bMid=.5*(bMax+bMin))),bGoalMin=bMin+enhanceAmount*(bMin-bMid)),i=0;i<nSubPixels;i+=4)data[i+0]=remap(data[i+0],rMin,rMax,rGoalMin,rGoalMax),data[i+1]=remap(data[i+1],gMin,gMax,gGoalMin,gGoalMax),data[i+2]=remap(data[i+2],bMin,bMax,bGoalMin,bGoalMax)}},Grayscale:function(imageData){var i,brightness,data=imageData.data,len=data.length;for(i=0;i<len;i+=4)brightness=.34*data[i]+.5*data[i+1]+.16*data[i+2],data[i]=brightness,data[i+1]=brightness,data[i+2]=brightness},HSL:function(imageData){var i,r,g,b,a,data=imageData.data,nPixels=data.length,s=Math.pow(2,this.saturation()),h=Math.abs(this.hue()+360)%360,l=127*this.luminance(),vsu=1*s*Math.cos(h*Math.PI/180),vsw=1*s*Math.sin(h*Math.PI/180),rr=.299+.701*vsu+.167*vsw,rg=.587-.587*vsu+.33*vsw,rb=.114-.114*vsu-.497*vsw,gr=.299-.299*vsu-.328*vsw,gg=.587+.413*vsu+.035*vsw,gb=.114-.114*vsu+.293*vsw,br=.299-.3*vsu+1.25*vsw,bg=.587-.586*vsu-1.05*vsw,bb=.114+.886*vsu-.2*vsw;for(i=0;i<nPixels;i+=4)r=data[i+0],g=data[i+1],b=data[i+2],a=data[i+3],data[i+0]=rr*r+rg*g+rb*b+l,data[i+1]=gr*r+gg*g+gb*b+l,data[i+2]=br*r+bg*g+bb*b+l,data[i+3]=a},HSV:function(imageData){var i,r,g,b,a,data=imageData.data,nPixels=data.length,v=Math.pow(2,this.value()),s=Math.pow(2,this.saturation()),h=Math.abs(this.hue()+360)%360,vsu=v*s*Math.cos(h*Math.PI/180),vsw=v*s*Math.sin(h*Math.PI/180),rr=.299*v+.701*vsu+.167*vsw,rg=.587*v-.587*vsu+.33*vsw,rb=.114*v-.114*vsu-.497*vsw,gr=.299*v-.299*vsu-.328*vsw,gg=.587*v+.413*vsu+.035*vsw,gb=.114*v-.114*vsu+.293*vsw,br=.299*v-.3*vsu+1.25*vsw,bg=.587*v-.586*vsu-1.05*vsw,bb=.114*v+.886*vsu-.2*vsw;for(i=0;i<nPixels;i+=4)r=data[i+0],g=data[i+1],b=data[i+2],a=data[i+3],data[i+0]=rr*r+rg*g+rb*b,data[i+1]=gr*r+gg*g+gb*b,data[i+2]=br*r+bg*g+bb*b,data[i+3]=a},Invert:function(imageData){var i,data=imageData.data,len=data.length;for(i=0;i<len;i+=4)data[i]=255-data[i],data[i+1]=255-data[i+1],data[i+2]=255-data[i+2]},Kaleidoscope:function(imageData){var x,y,i,r,g,b,a,srcPos,dstPos,xSize=imageData.width,ySize=imageData.height,power=Math.round(this.kaleidoscopePower()),angle=Math.round(this.kaleidoscopeAngle()),offset=Math.floor(xSize*(angle%360)/360);if(!(power<1)){var tempCanvas=Util.createCanvasElement();tempCanvas.width=xSize,tempCanvas.height=ySize;var scratchData=tempCanvas.getContext("2d").getImageData(0,0,xSize,ySize);!function(src,dst,opt){var i,x,y,rad,srcPixels=src.data,dstPixels=dst.data,xSize=src.width,ySize=src.height,xMid=opt.polarCenterX||xSize/2,yMid=opt.polarCenterY||ySize/2,r=0,g=0,b=0,a=0,rMax=Math.sqrt(xMid*xMid+yMid*yMid);x=xSize-xMid,y=ySize-yMid,rMax=(rad=Math.sqrt(x*x+y*y))>rMax?rad:rMax;var radius,theta,sin,cos,rSize=ySize,tSize=xSize,conversion=360/tSize*Math.PI/180;for(theta=0;theta<tSize;theta+=1)for(sin=Math.sin(theta*conversion),cos=Math.cos(theta*conversion),radius=0;radius<rSize;radius+=1)x=Math.floor(xMid+rMax*radius/rSize*cos),r=srcPixels[0+(i=4*((y=Math.floor(yMid+rMax*radius/rSize*sin))*xSize+x))],g=srcPixels[i+1],b=srcPixels[i+2],a=srcPixels[i+3],dstPixels[0+(i=4*(theta+radius*xSize))]=r,dstPixels[i+1]=g,dstPixels[i+2]=b,dstPixels[i+3]=a}(imageData,scratchData,{polarCenterX:xSize/2,polarCenterY:ySize/2});for(var minSectionSize=xSize/Math.pow(2,power);minSectionSize<=8;)minSectionSize*=2,power-=1;var sectionSize=minSectionSize=Math.ceil(minSectionSize),xStart=0,xEnd=sectionSize,xDelta=1;for(offset+minSectionSize>xSize&&(xStart=sectionSize,xEnd=0,xDelta=-1),y=0;y<ySize;y+=1)for(x=xStart;x!==xEnd;x+=xDelta)srcPos=4*(xSize*y+Math.round(x+offset)%xSize),r=scratchData.data[srcPos+0],g=scratchData.data[srcPos+1],b=scratchData.data[srcPos+2],a=scratchData.data[srcPos+3],dstPos=4*(xSize*y+x),scratchData.data[dstPos+0]=r,scratchData.data[dstPos+1]=g,scratchData.data[dstPos+2]=b,scratchData.data[dstPos+3]=a;for(y=0;y<ySize;y+=1)for(sectionSize=Math.floor(minSectionSize),i=0;i<power;i+=1){for(x=0;x<sectionSize+1;x+=1)srcPos=4*(xSize*y+x),r=scratchData.data[srcPos+0],g=scratchData.data[srcPos+1],b=scratchData.data[srcPos+2],a=scratchData.data[srcPos+3],dstPos=4*(xSize*y+2*sectionSize-x-1),scratchData.data[dstPos+0]=r,scratchData.data[dstPos+1]=g,scratchData.data[dstPos+2]=b,scratchData.data[dstPos+3]=a;sectionSize*=2}!function(src,dst,opt){var i,x,y,dx,dy,rad,srcPixels=src.data,dstPixels=dst.data,xSize=src.width,ySize=src.height,xMid=opt.polarCenterX||xSize/2,yMid=opt.polarCenterY||ySize/2,r=0,g=0,b=0,a=0,rMax=Math.sqrt(xMid*xMid+yMid*yMid);x=xSize-xMid,y=ySize-yMid,rMax=(rad=Math.sqrt(x*x+y*y))>rMax?rad:rMax;var radius,theta,x1,rSize=ySize,tSize=xSize,phaseShift=opt.polarRotation||0;for(x=0;x<xSize;x+=1)for(y=0;y<ySize;y+=1)dx=x-xMid,dy=y-yMid,radius=Math.sqrt(dx*dx+dy*dy)*rSize/rMax,theta=(theta=(180*Math.atan2(dy,dx)/Math.PI+360+phaseShift)%360)*tSize/360,x1=Math.floor(theta),r=srcPixels[0+(i=4*(Math.floor(radius)*xSize+x1))],g=srcPixels[i+1],b=srcPixels[i+2],a=srcPixels[i+3],dstPixels[0+(i=4*(y*xSize+x))]=r,dstPixels[i+1]=g,dstPixels[i+2]=b,dstPixels[i+3]=a}(scratchData,imageData,{polarRotation:0})}},Mask:function(imageData){var mask=function(idata,threshold){var rgbv_no=pixelAt(idata,0,0),rgbv_ne=pixelAt(idata,idata.width-1,0),rgbv_so=pixelAt(idata,0,idata.height-1),rgbv_se=pixelAt(idata,idata.width-1,idata.height-1),thres=threshold||10;if(rgbDistance(rgbv_no,rgbv_ne)<thres&&rgbDistance(rgbv_ne,rgbv_se)<thres&&rgbDistance(rgbv_se,rgbv_so)<thres&&rgbDistance(rgbv_so,rgbv_no)<thres){for(var mean=function(pTab){for(var m=[0,0,0],i=0;i<pTab.length;i++)m[0]+=pTab[i][0],m[1]+=pTab[i][1],m[2]+=pTab[i][2];return m[0]/=pTab.length,m[1]/=pTab.length,m[2]/=pTab.length,m}([rgbv_ne,rgbv_no,rgbv_se,rgbv_so]),mask=[],i=0;i<idata.width*idata.height;i++){var d=rgbDistance(mean,[idata.data[4*i],idata.data[4*i+1],idata.data[4*i+2]]);mask[i]=d<thres?0:255}return mask}}(imageData,this.threshold());return mask&&function(idata,mask){for(var i=0;i<idata.width*idata.height;i++)idata.data[4*i+3]=mask[i]}(imageData,mask=function(mask,sw,sh){for(var weights=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],side=Math.round(Math.sqrt(weights.length)),halfSide=Math.floor(side/2),maskResult=[],y=0;y<sh;y++)for(var x=0;x<sw;x++){for(var so=y*sw+x,a=0,cy=0;cy<side;cy++)for(var cx=0;cx<side;cx++){var scy=y+cy-halfSide,scx=x+cx-halfSide;if(scy>=0&&scy<sh&&scx>=0&&scx<sw){var wt=weights[cy*side+cx];a+=mask[scy*sw+scx]*wt}}maskResult[so]=a}return maskResult}(mask=function(mask,sw,sh){for(var weights=[1,1,1,1,1,1,1,1,1],side=Math.round(Math.sqrt(weights.length)),halfSide=Math.floor(side/2),maskResult=[],y=0;y<sh;y++)for(var x=0;x<sw;x++){for(var so=y*sw+x,a=0,cy=0;cy<side;cy++)for(var cx=0;cx<side;cx++){var scy=y+cy-halfSide,scx=x+cx-halfSide;if(scy>=0&&scy<sh&&scx>=0&&scx<sw){var wt=weights[cy*side+cx];a+=mask[scy*sw+scx]*wt}}maskResult[so]=a>=1020?255:0}return maskResult}(mask=function(mask,sw,sh){for(var weights=[1,1,1,1,0,1,1,1,1],side=Math.round(Math.sqrt(weights.length)),halfSide=Math.floor(side/2),maskResult=[],y=0;y<sh;y++)for(var x=0;x<sw;x++){for(var so=y*sw+x,a=0,cy=0;cy<side;cy++)for(var cx=0;cx<side;cx++){var scy=y+cy-halfSide,scx=x+cx-halfSide;if(scy>=0&&scy<sh&&scx>=0&&scx<sw){var wt=weights[cy*side+cx];a+=mask[scy*sw+scx]*wt}}maskResult[so]=2040===a?255:0}return maskResult}(mask,imageData.width,imageData.height),imageData.width,imageData.height),imageData.width,imageData.height)),imageData},Noise:function(imageData){var i,amount=255*this.noise(),data=imageData.data,nPixels=data.length,half=amount/2;for(i=0;i<nPixels;i+=4)data[i+0]+=half-2*half*Math.random(),data[i+1]+=half-2*half*Math.random(),data[i+2]+=half-2*half*Math.random()},Pixelate:function(imageData){var x,y,i,red,green,blue,alpha,xBinStart,xBinEnd,yBinStart,yBinEnd,xBin,yBin,pixelsInBin,pixelSize=Math.ceil(this.pixelSize()),width=imageData.width,height=imageData.height,nBinsX=Math.ceil(width/pixelSize),nBinsY=Math.ceil(height/pixelSize),data=imageData.data;if(pixelSize<=0)Util.error("pixelSize value can not be <= 0");else for(xBin=0;xBin<nBinsX;xBin+=1)for(yBin=0;yBin<nBinsY;yBin+=1){for(red=0,green=0,blue=0,alpha=0,xBinEnd=(xBinStart=xBin*pixelSize)+pixelSize,yBinEnd=(yBinStart=yBin*pixelSize)+pixelSize,pixelsInBin=0,x=xBinStart;x<xBinEnd;x+=1)if(!(x>=width))for(y=yBinStart;y<yBinEnd;y+=1)y>=height||(red+=data[0+(i=4*(width*y+x))],green+=data[i+1],blue+=data[i+2],alpha+=data[i+3],pixelsInBin+=1);for(red/=pixelsInBin,green/=pixelsInBin,blue/=pixelsInBin,alpha/=pixelsInBin,x=xBinStart;x<xBinEnd;x+=1)if(!(x>=width))for(y=yBinStart;y<yBinEnd;y+=1)y>=height||(data[0+(i=4*(width*y+x))]=red,data[i+1]=green,data[i+2]=blue,data[i+3]=alpha)}},Posterize:function(imageData){var i,levels=Math.round(254*this.levels())+1,data=imageData.data,len=data.length,scale=255/levels;for(i=0;i<len;i+=1)data[i]=Math.floor(data[i]/scale)*scale},RGB:function(imageData){var i,brightness,data=imageData.data,nPixels=data.length,red=this.red(),green=this.green(),blue=this.blue();for(i=0;i<nPixels;i+=4)brightness=(.34*data[i]+.5*data[i+1]+.16*data[i+2])/255,data[i]=brightness*red,data[i+1]=brightness*green,data[i+2]=brightness*blue,data[i+3]=data[i+3]},RGBA:function(imageData){var i,ia,data=imageData.data,nPixels=data.length,red=this.red(),green=this.green(),blue=this.blue(),alpha=this.alpha();for(i=0;i<nPixels;i+=4)ia=1-alpha,data[i]=red*alpha+data[i]*ia,data[i+1]=green*alpha+data[i+1]*ia,data[i+2]=blue*alpha+data[i+2]*ia},Sepia:function(imageData){var i,r,g,b,data=imageData.data,nPixels=data.length;for(i=0;i<nPixels;i+=4)r=data[i+0],g=data[i+1],b=data[i+2],data[i+0]=Math.min(255,.393*r+.769*g+.189*b),data[i+1]=Math.min(255,.349*r+.686*g+.168*b),data[i+2]=Math.min(255,.272*r+.534*g+.131*b)},Solarize:function(imageData){var data=imageData.data,w=imageData.width,w4=4*w,y=imageData.height;do{var offsetY=(y-1)*w4,x=w;do{var offset=offsetY+4*(x-1),r=data[offset],g=data[offset+1],b=data[offset+2];r>127&&(r=255-r),g>127&&(g=255-g),b>127&&(b=255-b),data[offset]=r,data[offset+1]=g,data[offset+2]=b}while(--x)}while(--y)},Threshold:function(imageData){var i,level=255*this.threshold(),data=imageData.data,len=data.length;for(i=0;i<len;i+=1)data[i]=data[i]<level?0:255}}})}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.moment=factory()}(this,function(){"use strict";var hookCallback,some;function hooks(){return hookCallback.apply(null,arguments)}function isArray(input){return input instanceof Array||"[object Array]"===Object.prototype.toString.call(input)}function isObject(input){return null!=input&&"[object Object]"===Object.prototype.toString.call(input)}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function isObjectEmpty(obj){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(obj).length;var k;for(k in obj)if(hasOwnProp(obj,k))return!1;return!0}function isUndefined(input){return void 0===input}function isNumber(input){return"number"==typeof input||"[object Number]"===Object.prototype.toString.call(input)}function isDate(input){return input instanceof Date||"[object Date]"===Object.prototype.toString.call(input)}function map(arr,fn){var i,res=[];for(i=0;i<arr.length;++i)res.push(fn(arr[i],i));return res}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!0).utc()}function getParsingFlags(m){return null==m._pf&&(m._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}),m._pf}function isValid(m){if(null==m._isValid){var flags=getParsingFlags(m),parsedParts=some.call(flags.parsedDateParts,function(i){return null!=i}),isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidEra&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts);if(m._strict&&(isNowValid=isNowValid&&0===flags.charsLeftOver&&0===flags.unusedTokens.length&&void 0===flags.bigHour),null!=Object.isFrozen&&Object.isFrozen(m))return isNowValid;m._isValid=isNowValid}return m._isValid}function createInvalid(flags){var m=createUTC(NaN);return null!=flags?extend(getParsingFlags(m),flags):getParsingFlags(m).userInvalidated=!0,m}some=Array.prototype.some?Array.prototype.some:function(fun){var i,t=Object(this),len=t.length>>>0;for(i=0;i<len;i++)if(i in t&&fun.call(this,t[i],i,t))return!0;return!1};var momentProperties=hooks.momentProperties=[],updateInProgress=!1;function copyConfig(to,from){var i,prop,val;if(isUndefined(from._isAMomentObject)||(to._isAMomentObject=from._isAMomentObject),isUndefined(from._i)||(to._i=from._i),isUndefined(from._f)||(to._f=from._f),isUndefined(from._l)||(to._l=from._l),isUndefined(from._strict)||(to._strict=from._strict),isUndefined(from._tzm)||(to._tzm=from._tzm),isUndefined(from._isUTC)||(to._isUTC=from._isUTC),isUndefined(from._offset)||(to._offset=from._offset),isUndefined(from._pf)||(to._pf=getParsingFlags(from)),isUndefined(from._locale)||(to._locale=from._locale),momentProperties.length>0)for(i=0;i<momentProperties.length;i++)isUndefined(val=from[prop=momentProperties[i]])||(to[prop]=val);return to}function Moment(config){copyConfig(this,config),this._d=new Date(null!=config._d?config._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===updateInProgress&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(obj){return obj instanceof Moment||null!=obj&&null!=obj._isAMomentObject}function warn(msg){!1===hooks.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){if(null!=hooks.deprecationHandler&&hooks.deprecationHandler(null,msg),firstTime){var arg,i,key,args=[];for(i=0;i<arguments.length;i++){if(arg="","object"==typeof arguments[i]){for(key in arg+="\n["+i+"] ",arguments[0])hasOwnProp(arguments[0],key)&&(arg+=key+": "+arguments[0][key]+", ");arg=arg.slice(0,-2)}else arg=arguments[i];args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack),firstTime=!1}return fn.apply(this,arguments)},fn)}var keys,deprecations={};function deprecateSimple(name,msg){null!=hooks.deprecationHandler&&hooks.deprecationHandler(name,msg),deprecations[name]||(warn(msg),deprecations[name]=!0)}function isFunction(input){return"undefined"!=typeof Function&&input instanceof Function||"[object Function]"===Object.prototype.toString.call(input)}function mergeConfigs(parentConfig,childConfig){var prop,res=extend({},parentConfig);for(prop in childConfig)hasOwnProp(childConfig,prop)&&(isObject(parentConfig[prop])&&isObject(childConfig[prop])?(res[prop]={},extend(res[prop],parentConfig[prop]),extend(res[prop],childConfig[prop])):null!=childConfig[prop]?res[prop]=childConfig[prop]:delete res[prop]);for(prop in parentConfig)hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])&&(res[prop]=extend({},res[prop]));return res}function Locale(config){null!=config&&this.set(config)}hooks.suppressDeprecationWarnings=!1,hooks.deprecationHandler=null,keys=Object.keys?Object.keys:function(obj){var i,res=[];for(i in obj)hasOwnProp(obj,i)&&res.push(i);return res};function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length;return(number>=0?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;"string"==typeof callback&&(func=function(){return this[callback]()}),token&&(formatTokenFunctions[token]=func),padded&&(formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}),ordinal&&(formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)})}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]=formatFunctions[format]||function(format){var i,length,input,array=format.match(formattingTokens);for(i=0,length=array.length;i<length;i++)formatTokenFunctions[array[i]]?array[i]=formatTokenFunctions[array[i]]:array[i]=(input=array[i]).match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"");return function(mom){var i,output="";for(i=0;i<length;i++)output+=isFunction(array[i])?array[i].call(mom,format):array[i];return output}}(format),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return"string"==typeof units?aliases[units]||aliases[units.toLowerCase()]:void 0}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop))&&(normalizedInput[normalizedProp]=inputObject[prop]);return normalizedInput}var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority}function isLeapYear(year){return year%4==0&&year%100!=0||year%400==0}function absFloor(number){return number<0?Math.ceil(number)||0:Math.floor(number)}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=absFloor(coercedNumber)),value}function makeGetSet(unit,keepTime){return function(value){return null!=value?(set$1(this,unit,value),hooks.updateOffset(this,keepTime),this):get(this,unit)}}function get(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function set$1(mom,unit,value){mom.isValid()&&!isNaN(value)&&("FullYear"===unit&&isLeapYear(mom.year())&&1===mom.month()&&29===mom.date()?(value=toInt(value),mom._d["set"+(mom._isUTC?"UTC":"")+unit](value,mom.month(),daysInMonth(value,mom.month()))):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value))}var regexes,match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){return hasOwnProp(regexes,token)?regexes[token](config._strict,config._locale):new RegExp(regexEscape(token.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}regexes={};var tokens={};function addParseToken(token,callback){var i,func=callback;for("string"==typeof token&&(token=[token]),isNumber(callback)&&(func=function(input,array){array[callback]=toInt(input)}),i=0;i<token.length;i++)tokens[token[i]]=func}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{},callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){null!=input&&hasOwnProp(tokens,token)&&tokens[token](input,config._a,config,token)}var indexOf,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;function daysInMonth(year,month){if(isNaN(year)||isNaN(month))return NaN;var x,modMonth=(month%(x=12)+x)%x;return year+=(month-modMonth)/12,1===modMonth?isLeapYear(year)?29:28:31-modMonth%7%2}indexOf=Array.prototype.indexOf?Array.prototype.indexOf:function(o){var i;for(i=0;i<this.length;++i)if(this[i]===o)return i;return-1},addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1}),addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)}),addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)}),addUnitAlias("month","M"),addUnitPriority("month",8),addRegexToken("M",match1to2),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",function(isStrict,locale){return locale.monthsShortRegex(isStrict)}),addRegexToken("MMMM",function(isStrict,locale){return locale.monthsRegex(isStrict)}),addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1}),addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);null!=month?array[MONTH]=month:getParsingFlags(config).invalidMonth=input});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function setMonth(mom,value){var dayOfMonth;if(!mom.isValid())return mom;if("string"==typeof value)if(/^\d+$/.test(value))value=toInt(value);else if(!isNumber(value=mom.localeData().monthsParse(value)))return mom;return dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom}function getSetMonth(value){return null!=value?(setMonth(this,value),hooks.updateOffset(this,!0),this):get(this,"Month")}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<12;i++)mom=createUTC([2e3,i]),shortPieces.push(this.monthsShort(mom,"")),longPieces.push(this.months(mom,"")),mixedPieces.push(this.months(mom,"")),mixedPieces.push(this.monthsShort(mom,""));for(shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),i=0;i<12;i++)shortPieces[i]=regexEscape(shortPieces[i]),longPieces[i]=regexEscape(longPieces[i]);for(i=0;i<24;i++)mixedPieces[i]=regexEscape(mixedPieces[i]);this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}function daysInYear(year){return isLeapYear(year)?366:365}addFormatToken("Y",0,0,function(){var y=this.year();return y<=9999?zeroFill(y,4):"+"+y}),addFormatToken(0,["YY",2],0,function(){return this.year()%100}),addFormatToken(0,["YYYY",4],0,"year"),addFormatToken(0,["YYYYY",5],0,"year"),addFormatToken(0,["YYYYYY",6,!0],0,"year"),addUnitAlias("year","y"),addUnitPriority("year",1),addRegexToken("Y",matchSigned),addRegexToken("YY",match1to2,match2),addRegexToken("YYYY",match1to4,match4),addRegexToken("YYYYY",match1to6,match6),addRegexToken("YYYYYY",match1to6,match6),addParseToken(["YYYYY","YYYYYY"],YEAR),addParseToken("YYYY",function(input,array){array[YEAR]=2===input.length?hooks.parseTwoDigitYear(input):toInt(input)}),addParseToken("YY",function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)}),addParseToken("Y",function(input,array){array[YEAR]=parseInt(input,10)}),hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!0);function createUTCDate(y){var date,args;return y<100&&y>=0?((args=Array.prototype.slice.call(arguments))[0]=y+400,date=new Date(Date.UTC.apply(null,args)),isFinite(date.getUTCFullYear())&&date.setUTCFullYear(y)):date=new Date(Date.UTC.apply(null,arguments)),date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy;return-((7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7)+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var resYear,resDayOfYear,dayOfYear=1+7*(week-1)+(7+weekday-dow)%7+firstWeekOffset(year,dow,doy);return dayOfYear<=0?resDayOfYear=daysInYear(resYear=year-1)+dayOfYear:dayOfYear>daysInYear(year)?(resYear=year+1,resDayOfYear=dayOfYear-daysInYear(year)):(resYear=year,resDayOfYear=dayOfYear),{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var resWeek,resYear,weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1;return week<1?resWeek=week+weeksInYear(resYear=mom.year()-1,dow,doy):week>weeksInYear(mom.year(),dow,doy)?(resWeek=week-weeksInYear(mom.year(),dow,doy),resYear=mom.year()+1):(resYear=mom.year(),resWeek=week),{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}addFormatToken("w",["ww",2],"wo","week"),addFormatToken("W",["WW",2],"Wo","isoWeek"),addUnitAlias("week","w"),addUnitAlias("isoWeek","W"),addUnitPriority("week",5),addUnitPriority("isoWeek",5),addRegexToken("w",match1to2),addRegexToken("ww",match1to2,match2),addRegexToken("W",match1to2),addRegexToken("WW",match1to2,match2),addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});function shiftWeekdays(ws,n){return ws.slice(n,7).concat(ws.slice(0,n))}addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)}),addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)}),addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)}),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addUnitAlias("day","d"),addUnitAlias("weekday","e"),addUnitAlias("isoWeekday","E"),addUnitPriority("day",11),addUnitPriority("weekday",11),addUnitPriority("isoWeekday",11),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)}),addRegexToken("ddd",function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)}),addRegexToken("dddd",function(isStrict,locale){return locale.weekdaysRegex(isStrict)}),addWeekParseToken(["dd","ddd","dddd"],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);null!=weekday?week.d=weekday:getParsingFlags(config).invalidWeekday=input}),addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var i,mom,minp,shortp,longp,minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[];for(i=0;i<7;i++)mom=createUTC([2e3,1]).day(i),minp=regexEscape(this.weekdaysMin(mom,"")),shortp=regexEscape(this.weekdaysShort(mom,"")),longp=regexEscape(this.weekdays(mom,"")),minPieces.push(minp),shortPieces.push(shortp),longPieces.push(longp),mixedPieces.push(minp),mixedPieces.push(shortp),mixedPieces.push(longp);minPieces.sort(cmpLenRev),shortPieces.sort(cmpLenRev),longPieces.sort(cmpLenRev),mixedPieces.sort(cmpLenRev),this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}function matchMeridiem(isStrict,locale){return locale._meridiemParse}addFormatToken("H",["HH",2],0,"hour"),addFormatToken("h",["hh",2],0,hFormat),addFormatToken("k",["kk",2],0,function(){return this.hours()||24}),addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)}),addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)}),addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)}),addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)}),meridiem("a",!0),meridiem("A",!1),addUnitAlias("hour","h"),addUnitPriority("hour",13),addRegexToken("a",matchMeridiem),addRegexToken("A",matchMeridiem),addRegexToken("H",match1to2),addRegexToken("h",match1to2),addRegexToken("k",match1to2),addRegexToken("HH",match1to2,match2),addRegexToken("hh",match1to2,match2),addRegexToken("kk",match1to2,match2),addRegexToken("hmm",match3to4),addRegexToken("hmmss",match5to6),addRegexToken("Hmm",match3to4),addRegexToken("Hmmss",match5to6),addParseToken(["H","HH"],HOUR),addParseToken(["k","kk"],function(input,array,config){var kInput=toInt(input);array[HOUR]=24===kInput?0:kInput}),addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input),config._meridiem=input}),addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input),getParsingFlags(config).bigHour=!0}),addParseToken("hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos)),getParsingFlags(config).bigHour=!0}),addParseToken("hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2)),getParsingFlags(config).bigHour=!0}),addParseToken("Hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos)),array[MINUTE]=toInt(input.substr(pos))}),addParseToken("Hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1)),array[MINUTE]=toInt(input.substr(pos1,2)),array[SECOND]=toInt(input.substr(pos2))});var getSetHour=makeGetSet("Hours",!0);var globalLocale,baseConfig={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:{dow:0,doy:6},weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:/[ap]\.?m?\.?/i},locales={},localeFamilies={};function commonPrefix(arr1,arr2){var i,minl=Math.min(arr1.length,arr2.length);for(i=0;i<minl;i+=1)if(arr1[i]!==arr2[i])return i;return minl}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function loadLocale(name){var oldLocale=null;if(void 0===locales[name]&&"undefined"!=typeof module&&module&&module.exports)try{oldLocale=globalLocale._abbr,require("./locale/"+name),getSetGlobalLocale(oldLocale)}catch(e){locales[name]=null}return locales[name]}function getSetGlobalLocale(key,values){var data;return key&&((data=isUndefined(values)?getLocale(key):defineLocale(key,values))?globalLocale=data:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+key+" not found. Did you forget to load it?")),globalLocale._abbr}function defineLocale(name,config){if(null!==config){var locale,parentConfig=baseConfig;if(config.abbr=name,null!=locales[name])deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),parentConfig=locales[name]._config;else if(null!=config.parentLocale)if(null!=locales[config.parentLocale])parentConfig=locales[config.parentLocale]._config;else{if(null==(locale=loadLocale(config.parentLocale)))return localeFamilies[config.parentLocale]||(localeFamilies[config.parentLocale]=[]),localeFamilies[config.parentLocale].push({name:name,config:config}),null;parentConfig=locale._config}return locales[name]=new Locale(mergeConfigs(parentConfig,config)),localeFamilies[name]&&localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config)}),getSetGlobalLocale(name),locales[name]}return delete locales[name],null}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return globalLocale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return function(names){for(var j,next,locale,split,i=0;i<names.length;){for(j=(split=normalizeLocale(names[i]).split("-")).length,next=(next=normalizeLocale(names[i+1]))?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&commonPrefix(split,next)>=j-1)break;j--}i++}return globalLocale}(key)}function checkOverflow(m){var overflow,a=m._a;return a&&-2===getParsingFlags(m).overflow&&(overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||24===a[HOUR]&&(0!==a[MINUTE]||0!==a[SECOND]||0!==a[MILLISECOND])?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)&&(overflow=DATE),getParsingFlags(m)._overflowWeeks&&-1===overflow&&(overflow=WEEK),getParsingFlags(m)._overflowWeekday&&-1===overflow&&(overflow=WEEKDAY),getParsingFlags(m).overflow=overflow),m}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function configFromISO(config){var i,l,allowTime,dateFormat,timeFormat,tzFormat,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string);if(match){for(getParsingFlags(config).iso=!0,i=0,l=isoDates.length;i<l;i++)if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0],allowTime=!1!==isoDates[i][2];break}if(null==dateFormat)return void(config._isValid=!1);if(match[3]){for(i=0,l=isoTimes.length;i<l;i++)if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}if(null==timeFormat)return void(config._isValid=!1)}if(!allowTime&&null!=timeFormat)return void(config._isValid=!1);if(match[4]){if(!tzRegex.exec(match[4]))return void(config._isValid=!1);tzFormat="Z"}config._f=dateFormat+(timeFormat||"")+(tzFormat||""),configFromStringAndFormat(config)}else config._isValid=!1}function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[function(yearStr){var year=parseInt(yearStr,10);if(year<=49)return 2e3+year;if(year<=999)return 1900+year;return year}(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];return secondStr&&result.push(parseInt(secondStr,10)),result}function configFromRFC2822(config){var parsedArray,match=rfc2822.exec(config._i.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(match){if(parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]),!function(weekdayStr,parsedInput,config){return!weekdayStr||defaultLocaleWeekdaysShort.indexOf(weekdayStr)===new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay()||(getParsingFlags(config).weekdayMismatch=!0,config._isValid=!1,!1)}(match[1],parsedArray,config))return;config._a=parsedArray,config._tzm=function(obsOffset,militaryOffset,numOffset){if(obsOffset)return obsOffsets[obsOffset];if(militaryOffset)return 0;var hm=parseInt(numOffset,10),m=hm%100;return(hm-m)/100*60+m}(match[8],match[9],match[10]),config._d=createUTCDate.apply(null,config._a),config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),getParsingFlags(config).rfc2822=!0}else config._isValid=!1}function defaults(a,b,c){return null!=a?a:null!=b?b:c}function configFromArray(config){var i,date,currentDate,expectedWeekday,yearToUse,input=[];if(!config._d){for(currentDate=function(config){var nowValue=new Date(hooks.now());return config._useUTC?[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]:[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&function(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow,curWeek;null!=(w=config._w).GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year),week=defaults(w.W,1),((weekday=defaults(w.E,1))<1||weekday>7)&&(weekdayOverflow=!0)):(dow=config._locale._week.dow,doy=config._locale._week.doy,curWeek=weekOfYear(createLocal(),dow,doy),weekYear=defaults(w.gg,config._a[YEAR],curWeek.year),week=defaults(w.w,curWeek.week),null!=w.d?((weekday=w.d)<0||weekday>6)&&(weekdayOverflow=!0):null!=w.e?(weekday=w.e+dow,(w.e<0||w.e>6)&&(weekdayOverflow=!0)):weekday=dow);week<1||week>weeksInYear(weekYear,dow,doy)?getParsingFlags(config)._overflowWeeks=!0:null!=weekdayOverflow?getParsingFlags(config)._overflowWeekday=!0:(temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear)}(config),null!=config._dayOfYear&&(yearToUse=defaults(config._a[YEAR],currentDate[YEAR]),(config._dayOfYear>daysInYear(yearToUse)||0===config._dayOfYear)&&(getParsingFlags(config)._overflowDayOfYear=!0),date=createUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;i<3&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;i<7;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?createUTCDate:function(y,m,d,h,M,s,ms){var date;return y<100&&y>=0?(date=new Date(y+400,m,d,h,M,s,ms),isFinite(date.getFullYear())&&date.setFullYear(y)):date=new Date(y,m,d,h,M,s,ms),date}).apply(null,input),expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay(),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),config._nextDay&&(config._a[HOUR]=24),config._w&&void 0!==config._w.d&&config._w.d!==expectedWeekday&&(getParsingFlags(config).weekdayMismatch=!0)}}function configFromStringAndFormat(config){if(config._f!==hooks.ISO_8601)if(config._f!==hooks.RFC_2822){config._a=[],getParsingFlags(config).empty=!0;var i,parsedInput,tokens,token,skipped,era,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],(parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0])&&((skipped=string.substr(0,string.indexOf(parsedInput))).length>0&&getParsingFlags(config).unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?getParsingFlags(config).empty=!1:getParsingFlags(config).unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&getParsingFlags(config).unusedTokens.push(token);getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&getParsingFlags(config).unusedInput.push(string),config._a[HOUR]<=12&&!0===getParsingFlags(config).bigHour&&config._a[HOUR]>0&&(getParsingFlags(config).bigHour=void 0),getParsingFlags(config).parsedDateParts=config._a.slice(0),getParsingFlags(config).meridiem=config._meridiem,config._a[HOUR]=function(locale,hour,meridiem){var isPm;if(null==meridiem)return hour;return null!=locale.meridiemHour?locale.meridiemHour(hour,meridiem):null!=locale.isPM?((isPm=locale.isPM(meridiem))&&hour<12&&(hour+=12),isPm||12!==hour||(hour=0),hour):hour}(config._locale,config._a[HOUR],config._meridiem),null!==(era=getParsingFlags(config).era)&&(config._a[YEAR]=config._locale.erasConvertYear(era,config._a[YEAR])),configFromArray(config),checkOverflow(config)}else configFromRFC2822(config);else configFromISO(config)}function prepareConfig(config){var input=config._i,format=config._f;return config._locale=config._locale||getLocale(config._l),null===input||void 0===format&&""===input?createInvalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),isMoment(input)?new Moment(checkOverflow(input)):(isDate(input)?config._d=input:isArray(format)?function(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore,validFormatFound,bestFormatIsValid=!1;if(0===config._f.length)return getParsingFlags(config).invalidFormat=!0,void(config._d=new Date(NaN));for(i=0;i<config._f.length;i++)currentScore=0,validFormatFound=!1,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._f=config._f[i],configFromStringAndFormat(tempConfig),isValid(tempConfig)&&(validFormatFound=!0),currentScore+=getParsingFlags(tempConfig).charsLeftOver,currentScore+=10*getParsingFlags(tempConfig).unusedTokens.length,getParsingFlags(tempConfig).score=currentScore,bestFormatIsValid?currentScore<scoreToBeat&&(scoreToBeat=currentScore,bestMoment=tempConfig):(null==scoreToBeat||currentScore<scoreToBeat||validFormatFound)&&(scoreToBeat=currentScore,bestMoment=tempConfig,validFormatFound&&(bestFormatIsValid=!0));extend(config,bestMoment||tempConfig)}(config):format?configFromStringAndFormat(config):function(config){var input=config._i;isUndefined(input)?config._d=new Date(hooks.now()):isDate(input)?config._d=new Date(input.valueOf()):"string"==typeof input?function(config){var matched=aspNetJsonRegex.exec(config._i);null===matched?(configFromISO(config),!1===config._isValid&&(delete config._isValid,configFromRFC2822(config),!1===config._isValid&&(delete config._isValid,config._strict?config._isValid=!1:hooks.createFromInputFallback(config)))):config._d=new Date(+matched[1])}(config):isArray(input)?(config._a=map(input.slice(0),function(obj){return parseInt(obj,10)}),configFromArray(config)):isObject(input)?function(config){if(!config._d){var i=normalizeObjectUnits(config._i),dayOrDate=void 0===i.day?i.date:i.day;config._a=map([i.year,i.month,dayOrDate,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10)}),configFromArray(config)}}(config):isNumber(input)?config._d=new Date(input):hooks.createFromInputFallback(config)}(config),isValid(config)||(config._d=null),config))}function createLocalOrUTC(input,format,locale,strict,isUTC){var res,c={};return!0!==format&&!1!==format||(strict=format,format=void 0),!0!==locale&&!1!==locale||(strict=locale,locale=void 0),(isObject(input)&&isObjectEmpty(input)||isArray(input)&&0===input.length)&&(input=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=isUTC,c._l=locale,c._i=input,c._f=format,c._strict=strict,(res=new Moment(checkOverflow(prepareConfig(c))))._nextDay&&(res.add(1,"d"),res._nextDay=void 0),res}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,!1)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))}),hooks.ISO_8601=function(){},hooks.RFC_2822=function(){};var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other<this?this:other:createInvalid()}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);return this.isValid()&&other.isValid()?other>this?this:other:createInvalid()});function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return createLocal();for(res=moments[0],i=1;i<moments.length;++i)moments[i].isValid()&&!moments[i][fn](res)||(res=moments[i]);return res}var ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=function(m){var key,i,unitHasDecimal=!1;for(key in m)if(hasOwnProp(m,key)&&(-1===indexOf.call(ordering,key)||null!=m[key]&&isNaN(m[key])))return!1;for(i=0;i<ordering.length;++i)if(m[ordering[i]]){if(unitHasDecimal)return!1;parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])&&(unitHasDecimal=!0)}return!0}(normalizedInput),this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+1e3*hours*60*60,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){return number<0?-1*Math.round(-1*number):Math.round(number)}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset(),sign="+";return offset<0&&(offset=-offset,sign="-"),sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":"),offset("ZZ",""),addRegexToken("Z",matchShortOffset),addRegexToken("ZZ",matchShortOffset),addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=!0,config._tzm=offsetFromString(matchShortOffset,input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var parts,minutes,matches=(string||"").match(matcher);return null===matches?null:0===(minutes=60*(parts=((matches[matches.length-1]||[])+"").match(chunkOffset)||["-",0,0])[1]+toInt(parts[2]))?0:"+"===parts[0]?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf(),res._d.setTime(res._d.valueOf()+diff),hooks.updateOffset(res,!1),res):createLocal(input).local()}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset())}function isUtc(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}hooks.updateOffset=function(){};var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var sign,ret,diffRes,duration=input,match=null;return isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:isNumber(input)||!isNaN(+input)?(duration={},key?duration[key]=+input:duration.milliseconds=+input):(match=aspNetRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(1e3*match[MILLISECOND]))*sign}):(match=isoRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}):null==duration?duration={}:"object"==typeof duration&&("from"in duration||"to"in duration)&&(diffRes=function(base,other){var res;if(!base.isValid()||!other.isValid())return{milliseconds:0,months:0};other=cloneWithOffset(other,base),base.isBefore(other)?res=positiveMomentsDifference(base,other):((res=positiveMomentsDifference(other,base)).milliseconds=-res.milliseconds,res.months=-res.months);return res}(createLocal(duration.from),createLocal(duration.to)),(duration={}).ms=diffRes.milliseconds,duration.M=diffRes.months),ret=new Duration(duration),isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),isDuration(input)&&hasOwnProp(input,"_isValid")&&(ret._isValid=input._isValid),ret}function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function createAdder(direction,name){return function(val,period){var tmp;return null===period||isNaN(+period)||(deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),tmp=val,val=period,period=tmp),addSubtract(this,createDuration(val,period),direction),this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);mom.isValid()&&(updateOffset=null==updateOffset||updateOffset,months&&setMonth(mom,get(mom,"Month")+months*isAdding),days&&set$1(mom,"Date",get(mom,"Date")+days*isAdding),milliseconds&&mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding),updateOffset&&hooks.updateOffset(mom,days||months))}createDuration.fn=Duration.prototype,createDuration.invalid=function(){return createDuration(NaN)};var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function isString(input){return"string"==typeof input||input instanceof String}function isMomentInput(input){return isMoment(input)||isDate(input)||isString(input)||isNumber(input)||function(input){var arrayTest=isArray(input),dataTypeTest=!1;arrayTest&&(dataTypeTest=0===input.filter(function(item){return!isNumber(item)&&isString(input)}).length);return arrayTest&&dataTypeTest}(input)||function(input){var i,objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=!1,properties=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"];for(i=0;i<properties.length;i+=1)propertyTest=propertyTest||hasOwnProp(input,properties[i]);return objectTest&&propertyTest}(input)||null===input||void 0===input}function monthDiff(a,b){if(a.date()<b.date())return-monthDiff(b,a);var wholeMonthDiff=12*(b.year()-a.year())+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months");return-(wholeMonthDiff+(b-anchor<0?(b-anchor)/(anchor-a.clone().add(wholeMonthDiff-1,"months")):(b-anchor)/(a.clone().add(wholeMonthDiff+1,"months")-anchor)))||0}function locale(key){var newLocaleData;return void 0===key?this._locale._abbr:(null!=(newLocaleData=getLocale(key))&&(this._locale=newLocaleData),this)}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){return void 0===key?this.localeData():this.locale(key)});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=3506328*MS_PER_HOUR;function mod$1(dividend,divisor){return(dividend%divisor+divisor)%divisor}function localStartOfDate(y,m,d){return y<100&&y>=0?new Date(y+400,m,d)-MS_PER_400_YEARS:new Date(y,m,d).valueOf()}function utcStartOfDate(y,m,d){return y<100&&y>=0?Date.UTC(y+400,m,d)-MS_PER_400_YEARS:Date.UTC(y,m,d)}function matchEraAbbr(isStrict,locale){return locale.erasAbbrRegex(isStrict)}function computeErasParse(){var i,l,abbrPieces=[],namePieces=[],narrowPieces=[],mixedPieces=[],eras=this.eras();for(i=0,l=eras.length;i<l;++i)namePieces.push(regexEscape(eras[i].name)),abbrPieces.push(regexEscape(eras[i].abbr)),narrowPieces.push(regexEscape(eras[i].narrow)),mixedPieces.push(regexEscape(eras[i].name)),mixedPieces.push(regexEscape(eras[i].abbr)),mixedPieces.push(regexEscape(eras[i].narrow));this._erasRegex=new RegExp("^("+mixedPieces.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+namePieces.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+abbrPieces.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+narrowPieces.join("|")+")","i")}function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;return null==input?weekOfYear(this,dow,doy).year:(week>(weeksTarget=weeksInYear(input,dow,doy))&&(week=weeksTarget),function(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);return this.year(date.getUTCFullYear()),this.month(date.getUTCMonth()),this.date(date.getUTCDate()),this}.call(this,input,week,weekday,dow,doy))}addFormatToken("N",0,0,"eraAbbr"),addFormatToken("NN",0,0,"eraAbbr"),addFormatToken("NNN",0,0,"eraAbbr"),addFormatToken("NNNN",0,0,"eraName"),addFormatToken("NNNNN",0,0,"eraNarrow"),addFormatToken("y",["y",1],"yo","eraYear"),addFormatToken("y",["yy",2],0,"eraYear"),addFormatToken("y",["yyy",3],0,"eraYear"),addFormatToken("y",["yyyy",4],0,"eraYear"),addRegexToken("N",matchEraAbbr),addRegexToken("NN",matchEraAbbr),addRegexToken("NNN",matchEraAbbr),addRegexToken("NNNN",function(isStrict,locale){return locale.erasNameRegex(isStrict)}),addRegexToken("NNNNN",function(isStrict,locale){return locale.erasNarrowRegex(isStrict)}),addParseToken(["N","NN","NNN","NNNN","NNNNN"],function(input,array,config,token){var era=config._locale.erasParse(input,token,config._strict);era?getParsingFlags(config).era=era:getParsingFlags(config).invalidEra=input}),addRegexToken("y",matchUnsigned),addRegexToken("yy",matchUnsigned),addRegexToken("yyy",matchUnsigned),addRegexToken("yyyy",matchUnsigned),addRegexToken("yo",function(isStrict,locale){return locale._eraYearOrdinalRegex||matchUnsigned}),addParseToken(["y","yy","yyy","yyyy"],YEAR),addParseToken(["yo"],function(input,array,config,token){var match;config._locale._eraYearOrdinalRegex&&(match=input.match(config._locale._eraYearOrdinalRegex)),config._locale.eraYearOrdinalParse?array[YEAR]=config._locale.eraYearOrdinalParse(input,match):array[YEAR]=parseInt(input,10)}),addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100}),addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100}),addWeekYearFormatToken("gggg","weekYear"),addWeekYearFormatToken("ggggg","weekYear"),addWeekYearFormatToken("GGGG","isoWeekYear"),addWeekYearFormatToken("GGGGG","isoWeekYear"),addUnitAlias("weekYear","gg"),addUnitAlias("isoWeekYear","GG"),addUnitPriority("weekYear",1),addUnitPriority("isoWeekYear",1),addRegexToken("G",matchSigned),addRegexToken("g",matchSigned),addRegexToken("GG",match1to2,match2),addRegexToken("gg",match1to2,match2),addRegexToken("GGGG",match1to4,match4),addRegexToken("gggg",match1to4,match4),addRegexToken("GGGGG",match1to6,match6),addRegexToken("ggggg",match1to6,match6),addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)}),addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)}),addFormatToken("Q",0,"Qo","quarter"),addUnitAlias("quarter","Q"),addUnitPriority("quarter",7),addRegexToken("Q",match1),addParseToken("Q",function(input,array){array[MONTH]=3*(toInt(input)-1)}),addFormatToken("D",["DD",2],"Do","date"),addUnitAlias("date","D"),addUnitPriority("date",9),addRegexToken("D",match1to2),addRegexToken("DD",match1to2,match2),addRegexToken("Do",function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient}),addParseToken(["D","DD"],DATE),addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear"),addUnitAlias("dayOfYear","DDD"),addUnitPriority("dayOfYear",4),addRegexToken("DDD",match1to3),addRegexToken("DDDD",match3),addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)}),addFormatToken("m",["mm",2],0,"minute"),addUnitAlias("minute","m"),addUnitPriority("minute",14),addRegexToken("m",match1to2),addRegexToken("mm",match1to2,match2),addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second"),addUnitAlias("second","s"),addUnitPriority("second",15),addRegexToken("s",match1to2),addRegexToken("ss",match1to2,match2),addParseToken(["s","ss"],SECOND);var token,getSetMillisecond,getSetSecond=makeGetSet("Seconds",!1);for(addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)}),addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),addFormatToken(0,["SSS",3],0,"millisecond"),addFormatToken(0,["SSSS",4],0,function(){return 10*this.millisecond()}),addFormatToken(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),addFormatToken(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),addFormatToken(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),addFormatToken(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),addFormatToken(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),addUnitAlias("millisecond","ms"),addUnitPriority("millisecond",16),addRegexToken("S",match1to3,match1),addRegexToken("SS",match1to3,match2),addRegexToken("SSS",match1to3,match3),token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(input,array){array[MILLISECOND]=toInt(1e3*("0."+input))}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);getSetMillisecond=makeGetSet("Milliseconds",!1),addFormatToken("z",0,0,"zoneAbbr"),addFormatToken("zz",0,0,"zoneName");var proto=Moment.prototype;function preParsePostFormat(string){return string}proto.add=add,proto.calendar=function(time,formats){1===arguments.length&&(arguments[0]?isMomentInput(arguments[0])?(time=arguments[0],formats=void 0):function(input){var i,objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=!1,properties=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(i=0;i<properties.length;i+=1)propertyTest=propertyTest||hasOwnProp(input,properties[i]);return objectTest&&propertyTest}(arguments[0])&&(formats=arguments[0],time=void 0):(time=void 0,formats=void 0));var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse",output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))},proto.clone=function(){return new Moment(this)},proto.diff=function(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid())return NaN;if(!(that=cloneWithOffset(input,this)).isValid())return NaN;switch(zoneDelta=6e4*(that.utcOffset()-this.utcOffset()),units=normalizeUnits(units)){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)},proto.endOf=function(units){var time,startOfDate;if(void 0===(units=normalizeUnits(units))||"millisecond"===units||!this.isValid())return this;switch(startOfDate=this._isUTC?utcStartOfDate:localStartOfDate,units){case"year":time=startOfDate(this.year()+1,0,1)-1;break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":time=startOfDate(this.year(),this.month()+1,1)-1;break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date()+1)-1;break;case"hour":time=this._d.valueOf(),time+=MS_PER_HOUR-mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":time=this._d.valueOf(),time+=MS_PER_MINUTE-mod$1(time,MS_PER_MINUTE)-1;break;case"second":time=this._d.valueOf(),time+=MS_PER_SECOND-mod$1(time,MS_PER_SECOND)-1}return this._d.setTime(time),hooks.updateOffset(this,!0),this},proto.format=function(inputString){inputString||(inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var output=formatMoment(this,inputString);return this.localeData().postformat(output)},proto.from=function(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())?createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()},proto.fromNow=function(withoutSuffix){return this.from(createLocal(),withoutSuffix)},proto.to=function(time,withoutSuffix){return this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())?createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix):this.localeData().invalidDate()},proto.toNow=function(withoutSuffix){return this.to(createLocal(),withoutSuffix)},proto.get=function(units){return isFunction(this[units=normalizeUnits(units)])?this[units]():this},proto.invalidAt=function(){return getParsingFlags(this).overflow},proto.isAfter=function(input,units){var localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units)||"millisecond")?this.valueOf()>localInput.valueOf():localInput.valueOf()<this.clone().startOf(units).valueOf())},proto.isBefore=function(input,units){var localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units)||"millisecond")?this.valueOf()<localInput.valueOf():this.clone().endOf(units).valueOf()<localInput.valueOf())},proto.isBetween=function(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);return!!(this.isValid()&&localFrom.isValid()&&localTo.isValid())&&("("===(inclusivity=inclusivity||"()")[0]?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(")"===inclusivity[1]?this.isBefore(localTo,units):!this.isAfter(localTo,units))},proto.isSame=function(input,units){var inputMs,localInput=isMoment(input)?input:createLocal(input);return!(!this.isValid()||!localInput.isValid())&&("millisecond"===(units=normalizeUnits(units)||"millisecond")?this.valueOf()===localInput.valueOf():(inputMs=localInput.valueOf(),this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()))},proto.isSameOrAfter=function(input,units){return this.isSame(input,units)||this.isAfter(input,units)},proto.isSameOrBefore=function(input,units){return this.isSame(input,units)||this.isBefore(input,units)},proto.isValid=function(){return isValid(this)},proto.lang=lang,proto.locale=locale,proto.localeData=localeData,proto.max=prototypeMax,proto.min=prototypeMin,proto.parsingFlags=function(){return extend({},getParsingFlags(this))},proto.set=function(units,value){if("object"==typeof units){var i,prioritized=function(unitsObj){var u,units=[];for(u in unitsObj)hasOwnProp(unitsObj,u)&&units.push({unit:u,priority:priorities[u]});return units.sort(function(a,b){return a.priority-b.priority}),units}(units=normalizeObjectUnits(units));for(i=0;i<prioritized.length;i++)this[prioritized[i].unit](units[prioritized[i].unit])}else if(isFunction(this[units=normalizeUnits(units)]))return this[units](value);return this},proto.startOf=function(units){var time,startOfDate;if(void 0===(units=normalizeUnits(units))||"millisecond"===units||!this.isValid())return this;switch(startOfDate=this._isUTC?utcStartOfDate:localStartOfDate,units){case"year":time=startOfDate(this.year(),0,1);break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3,1);break;case"month":time=startOfDate(this.year(),this.month(),1);break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date());break;case"hour":time=this._d.valueOf(),time-=mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":time=this._d.valueOf(),time-=mod$1(time,MS_PER_MINUTE);break;case"second":time=this._d.valueOf(),time-=mod$1(time,MS_PER_SECOND)}return this._d.setTime(time),hooks.updateOffset(this,!0),this},proto.subtract=subtract,proto.toArray=function(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]},proto.toObject=function(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}},proto.toDate=function(){return new Date(this.valueOf())},proto.toISOString=function(keepOffset){if(!this.isValid())return null;var utc=!0!==keepOffset,m=utc?this.clone().utc():this;return m.year()<0||m.year()>9999?formatMoment(m,utc?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction(Date.prototype.toISOString)?utc?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",formatMoment(m,"Z")):formatMoment(m,utc?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},proto.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var prefix,year,suffix,func="moment",zone="";return this.isLocal()||(func=0===this.utcOffset()?"moment.utc":"moment.parseZone",zone="Z"),prefix="["+func+'("]',year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",suffix=zone+'[")]',this.format(prefix+year+"-MM-DD[T]HH:mm:ss.SSS"+suffix)},"undefined"!=typeof Symbol&&null!=Symbol.for&&(proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),proto.toJSON=function(){return this.isValid()?this.toISOString():null},proto.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},proto.unix=function(){return Math.floor(this.valueOf()/1e3)},proto.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},proto.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},proto.eraName=function(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){if(val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until)return eras[i].name;if(eras[i].until<=val&&val<=eras[i].since)return eras[i].name}return""},proto.eraNarrow=function(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){if(val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until)return eras[i].narrow;if(eras[i].until<=val&&val<=eras[i].since)return eras[i].narrow}return""},proto.eraAbbr=function(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){if(val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until)return eras[i].abbr;if(eras[i].until<=val&&val<=eras[i].since)return eras[i].abbr}return""},proto.eraYear=function(){var i,l,dir,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i)if(dir=eras[i].since<=eras[i].until?1:-1,val=this.clone().startOf("day").valueOf(),eras[i].since<=val&&val<=eras[i].until||eras[i].until<=val&&val<=eras[i].since)return(this.year()-hooks(eras[i].since).year())*dir+eras[i].offset;return this.year()},proto.year=getSetYear,proto.isLeapYear=function(){return isLeapYear(this.year())},proto.weekYear=function(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},proto.isoWeekYear=function(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)},proto.quarter=proto.quarters=function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},proto.month=getSetMonth,proto.daysInMonth=function(){return daysInMonth(this.year(),this.month())},proto.week=proto.weeks=function(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")},proto.isoWeek=proto.isoWeeks=function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")},proto.weeksInYear=function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},proto.weeksInWeekYear=function(){var weekInfo=this.localeData()._week;return weeksInYear(this.weekYear(),weekInfo.dow,weekInfo.doy)},proto.isoWeeksInYear=function(){return weeksInYear(this.year(),1,4)},proto.isoWeeksInISOWeekYear=function(){return weeksInYear(this.isoWeekYear(),1,4)},proto.date=getSetDayOfMonth,proto.day=proto.days=function(input){if(!this.isValid())return null!=input?this:NaN;var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=function(input,locale){return"string"!=typeof input?input:isNaN(input)?"number"==typeof(input=locale.weekdaysParse(input))?input:null:parseInt(input,10)}(input,this.localeData()),this.add(input-day,"d")):day},proto.weekday=function(input){if(!this.isValid())return null!=input?this:NaN;var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")},proto.isoWeekday=function(input){if(!this.isValid())return null!=input?this:NaN;if(null!=input){var weekday=function(input,locale){return"string"==typeof input?locale.weekdaysParse(input)%7||7:isNaN(input)?null:input}(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}return this.day()||7},proto.dayOfYear=function(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")},proto.hour=proto.hours=getSetHour,proto.minute=proto.minutes=getSetMinute,proto.second=proto.seconds=getSetSecond,proto.millisecond=proto.milliseconds=getSetMillisecond,proto.utcOffset=function(input,keepLocalTime,keepMinutes){var localAdjust,offset=this._offset||0;if(!this.isValid())return null!=input?this:NaN;if(null!=input){if("string"==typeof input){if(null===(input=offsetFromString(matchShortOffset,input)))return this}else Math.abs(input)<16&&!keepMinutes&&(input*=60);return!this._isUTC&&keepLocalTime&&(localAdjust=getDateOffset(this)),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.add(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addSubtract(this,createDuration(input-offset,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?offset:getDateOffset(this)},proto.utc=function(keepLocalTime){return this.utcOffset(0,keepLocalTime)},proto.local=function(keepLocalTime){return this._isUTC&&(this.utcOffset(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.subtract(getDateOffset(this),"m")),this},proto.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var tZone=offsetFromString(matchOffset,this._i);null!=tZone?this.utcOffset(tZone):this.utcOffset(0,!0)}return this},proto.hasAlignedHourOffset=function(input){return!!this.isValid()&&(input=input?createLocal(input).utcOffset():0,(this.utcOffset()-input)%60==0)},proto.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},proto.isLocal=function(){return!!this.isValid()&&!this._isUTC},proto.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},proto.isUtc=isUtc,proto.isUTC=isUtc,proto.zoneAbbr=function(){return this._isUTC?"UTC":""},proto.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth),proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth),proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear),proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(input,keepLocalTime){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,keepLocalTime),this):-this.utcOffset()}),proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!isUndefined(this._isDSTShifted))return this._isDSTShifted;var other,c={};return copyConfig(c,this),(c=prepareConfig(c))._a?(other=c._isUTC?createUTC(c._a):createLocal(c._a),this._isDSTShifted=this.isValid()&&function(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;i<len;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}(c._a,other.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted});var proto$1=Locale.prototype;function get$1(format,index,field,setter){var locale=getLocale(),utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber(format)&&(index=format,format=void 0),format=format||"",null!=index)return get$1(format,index,field,"month");var i,out=[];for(i=0;i<12;i++)out[i]=get$1(format,i,field,"month");return out}function listWeekdaysImpl(localeSorted,format,index,field){"boolean"==typeof localeSorted?(isNumber(format)&&(index=format,format=void 0),format=format||""):(index=format=localeSorted,localeSorted=!1,isNumber(format)&&(index=format,format=void 0),format=format||"");var i,locale=getLocale(),shift=localeSorted?locale._week.dow:0,out=[];if(null!=index)return get$1(format,(index+shift)%7,field,"day");for(i=0;i<7;i++)out[i]=get$1(format,(i+shift)%7,field,"day");return out}proto$1.calendar=function(key,mom,now){var output=this._calendar[key]||this._calendar.sameElse;return isFunction(output)?output.call(mom,now):output},proto$1.longDateFormat=function(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];return format||!formatUpper?format:(this._longDateFormat[key]=formatUpper.match(formattingTokens).map(function(tok){return"MMMM"===tok||"MM"===tok||"DD"===tok||"dddd"===tok?tok.slice(1):tok}).join(""),this._longDateFormat[key])},proto$1.invalidDate=function(){return this._invalidDate},proto$1.ordinal=function(number){return this._ordinal.replace("%d",number)},proto$1.preparse=preParsePostFormat,proto$1.postformat=preParsePostFormat,proto$1.relativeTime=function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},proto$1.pastFuture=function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)},proto$1.set=function(config){var prop,i;for(i in config)hasOwnProp(config,i)&&(isFunction(prop=config[i])?this[i]=prop:this["_"+i]=prop);this._config=config,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},proto$1.eras=function(m,format){var i,l,date,eras=this._eras||getLocale("en")._eras;for(i=0,l=eras.length;i<l;++i){switch(typeof eras[i].since){case"string":date=hooks(eras[i].since).startOf("day"),eras[i].since=date.valueOf()}switch(typeof eras[i].until){case"undefined":eras[i].until=1/0;break;case"string":date=hooks(eras[i].until).startOf("day").valueOf(),eras[i].until=date.valueOf()}}return eras},proto$1.erasParse=function(eraName,format,strict){var i,l,name,abbr,narrow,eras=this.eras();for(eraName=eraName.toUpperCase(),i=0,l=eras.length;i<l;++i)if(name=eras[i].name.toUpperCase(),abbr=eras[i].abbr.toUpperCase(),narrow=eras[i].narrow.toUpperCase(),strict)switch(format){case"N":case"NN":case"NNN":if(abbr===eraName)return eras[i];break;case"NNNN":if(name===eraName)return eras[i];break;case"NNNNN":if(narrow===eraName)return eras[i]}else if([name,abbr,narrow].indexOf(eraName)>=0)return eras[i]},proto$1.erasConvertYear=function(era,year){var dir=era.since<=era.until?1:-1;return void 0===year?hooks(era.since).year():hooks(era.since).year()+(year-era.offset)*dir},proto$1.erasAbbrRegex=function(isStrict){return hasOwnProp(this,"_erasAbbrRegex")||computeErasParse.call(this),isStrict?this._erasAbbrRegex:this._erasRegex},proto$1.erasNameRegex=function(isStrict){return hasOwnProp(this,"_erasNameRegex")||computeErasParse.call(this),isStrict?this._erasNameRegex:this._erasRegex},proto$1.erasNarrowRegex=function(isStrict){return hasOwnProp(this,"_erasNarrowRegex")||computeErasParse.call(this),isStrict?this._erasNarrowRegex:this._erasRegex},proto$1.months=function(m,format){return m?isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]:isArray(this._months)?this._months:this._months.standalone},proto$1.monthsShort=function(m,format){return m?isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]:isArray(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},proto$1.monthsParse=function(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact)return function(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)mom=createUTC([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase();return strict?"MMM"===format?-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:null:-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:null:"MMM"===format?-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:null:-1!==(ii=indexOf.call(this._longMonthsParse,llc))?ii:-1!==(ii=indexOf.call(this._shortMonthsParse,llc))?ii:null}.call(this,monthName,format,strict);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(mom=createUTC([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}},proto$1.monthsRegex=function(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex)},proto$1.monthsShortRegex=function(isStrict){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),isStrict?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex)},proto$1.week=function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},proto$1.firstDayOfYear=function(){return this._week.doy},proto$1.firstDayOfWeek=function(){return this._week.dow},proto$1.weekdays=function(m,format){var weekdays=isArray(this._weekdays)?this._weekdays:this._weekdays[m&&!0!==m&&this._weekdays.isFormat.test(format)?"format":"standalone"];return!0===m?shiftWeekdays(weekdays,this._week.dow):m?weekdays[m.day()]:weekdays},proto$1.weekdaysMin=function(m){return!0===m?shiftWeekdays(this._weekdaysMin,this._week.dow):m?this._weekdaysMin[m.day()]:this._weekdaysMin},proto$1.weekdaysShort=function(m){return!0===m?shiftWeekdays(this._weekdaysShort,this._week.dow):m?this._weekdaysShort[m.day()]:this._weekdaysShort},proto$1.weekdaysParse=function(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact)return function(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)mom=createUTC([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase();return strict?"dddd"===format?-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:null:"ddd"===format?-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:null:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:"dddd"===format?-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:"ddd"===format?-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:null:-1!==(ii=indexOf.call(this._minWeekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._weekdaysParse,llc))?ii:-1!==(ii=indexOf.call(this._shortWeekdaysParse,llc))?ii:null}.call(this,weekdayName,format,strict);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(mom=createUTC([2e3,1]).day(i),strict&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"dddd"===format&&this._fullWeekdaysParse[i].test(weekdayName))return i;if(strict&&"ddd"===format&&this._shortWeekdaysParse[i].test(weekdayName))return i;if(strict&&"dd"===format&&this._minWeekdaysParse[i].test(weekdayName))return i;if(!strict&&this._weekdaysParse[i].test(weekdayName))return i}},proto$1.weekdaysRegex=function(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex)},proto$1.weekdaysShortRegex=function(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},proto$1.weekdaysMinRegex=function(isStrict){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},proto$1.isPM=function(input){return"p"===(input+"").toLowerCase().charAt(0)},proto$1.meridiem=function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10;return number+(1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")}}),hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale),hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);return duration._milliseconds+=direction*other._milliseconds,duration._days+=direction*other._days,duration._months+=direction*other._months,duration._bubble()}function absCeil(number){return number<0?Math.floor(number):Math.ceil(number)}function daysToMonths(days){return 4800*days/146097}function monthsToDays(months){return 146097*months/4800}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y");function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var minutes,hours,years,s,totalSign,ymSign,daysSign,hmsSign,seconds=abs$1(this._milliseconds)/1e3,days=abs$1(this._days),months=abs$1(this._months),total=this.asSeconds();return total?(hours=absFloor((minutes=absFloor(seconds/60))/60),seconds%=60,minutes%=60,years=absFloor(months/12),months%=12,s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"",totalSign=total<0?"-":"",ymSign=sign(this._months)!==sign(total)?"-":"",daysSign=sign(this._days)!==sign(total)?"-":"",hmsSign=sign(this._milliseconds)!==sign(total)?"-":"",totalSign+"P"+(years?ymSign+years+"Y":"")+(months?ymSign+months+"M":"")+(days?daysSign+days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hmsSign+hours+"H":"")+(minutes?hmsSign+minutes+"M":"")+(seconds?hmsSign+s+"S":"")):"P0D"}var proto$2=Duration.prototype;return proto$2.isValid=function(){return this._isValid},proto$2.abs=function(){var data=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),data.milliseconds=mathAbs(data.milliseconds),data.seconds=mathAbs(data.seconds),data.minutes=mathAbs(data.minutes),data.hours=mathAbs(data.hours),data.months=mathAbs(data.months),data.years=mathAbs(data.years),this},proto$2.add=function(input,value){return addSubtract$1(this,input,value,1)},proto$2.subtract=function(input,value){return addSubtract$1(this,input,value,-1)},proto$2.as=function(units){if(!this.isValid())return NaN;var days,months,milliseconds=this._milliseconds;if("month"===(units=normalizeUnits(units))||"quarter"===units||"year"===units)switch(days=this._days+milliseconds/864e5,months=this._months+daysToMonths(days),units){case"month":return months;case"quarter":return months/3;case"year":return months/12}else switch(days=this._days+Math.round(monthsToDays(this._months)),units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return 24*days+milliseconds/36e5;case"minute":return 1440*days+milliseconds/6e4;case"second":return 86400*days+milliseconds/1e3;case"millisecond":return Math.floor(864e5*days)+milliseconds;default:throw new Error("Unknown unit "+units)}},proto$2.asMilliseconds=asMilliseconds,proto$2.asSeconds=asSeconds,proto$2.asMinutes=asMinutes,proto$2.asHours=asHours,proto$2.asDays=asDays,proto$2.asWeeks=asWeeks,proto$2.asMonths=asMonths,proto$2.asQuarters=asQuarters,proto$2.asYears=asYears,proto$2.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12):NaN},proto$2._bubble=function(){var seconds,minutes,hours,years,monthsFromDays,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data;return milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0||(milliseconds+=864e5*absCeil(monthsToDays(months)+days),days=0,months=0),data.milliseconds=milliseconds%1e3,seconds=absFloor(milliseconds/1e3),data.seconds=seconds%60,minutes=absFloor(seconds/60),data.minutes=minutes%60,hours=absFloor(minutes/60),data.hours=hours%24,months+=monthsFromDays=absFloor(daysToMonths(days+=absFloor(hours/24))),days-=absCeil(monthsToDays(monthsFromDays)),years=absFloor(months/12),months%=12,data.days=days,data.months=months,data.years=years,this},proto$2.clone=function(){return createDuration(this)},proto$2.get=function(units){return units=normalizeUnits(units),this.isValid()?this[units+"s"]():NaN},proto$2.milliseconds=milliseconds,proto$2.seconds=seconds,proto$2.minutes=minutes,proto$2.hours=hours,proto$2.days=days,proto$2.weeks=function(){return absFloor(this.days()/7)},proto$2.months=months,proto$2.years=years,proto$2.humanize=function(argWithSuffix,argThresholds){if(!this.isValid())return this.localeData().invalidDate();var locale,output,withSuffix=!1,th=thresholds;return"object"==typeof argWithSuffix&&(argThresholds=argWithSuffix,argWithSuffix=!1),"boolean"==typeof argWithSuffix&&(withSuffix=argWithSuffix),"object"==typeof argThresholds&&(th=Object.assign({},thresholds,argThresholds),null!=argThresholds.s&&null==argThresholds.ss&&(th.ss=argThresholds.s-1)),output=function(posNegDuration,withoutSuffix,thresholds,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),weeks=round(duration.as("w")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days];return null!=thresholds.w&&(a=a||weeks<=1&&["w"]||weeks<thresholds.w&&["ww",weeks]),(a=a||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years])[2]=withoutSuffix,a[3]=+posNegDuration>0,a[4]=locale,function(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}.apply(null,a)}(this,!withSuffix,th,locale=this.localeData()),withSuffix&&(output=locale.pastFuture(+this,output)),locale.postformat(output)},proto$2.toISOString=toISOString$1,proto$2.toString=toISOString$1,proto$2.toJSON=toISOString$1,proto$2.locale=locale,proto$2.localeData=localeData,proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1),proto$2.lang=lang,addFormatToken("X",0,0,"unix"),addFormatToken("x",0,0,"valueOf"),addRegexToken("x",matchSigned),addRegexToken("X",/[+-]?\d+(\.\d{1,3})?/),addParseToken("X",function(input,array,config){config._d=new Date(1e3*parseFloat(input))}),addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))}),hooks.version="2.29.1",hookCallback=createLocal,hooks.fn=proto,hooks.min=function(){return pickBy("isBefore",[].slice.call(arguments,0))},hooks.max=function(){return pickBy("isAfter",[].slice.call(arguments,0))},hooks.now=function(){return Date.now?Date.now():+new Date},hooks.utc=createUTC,hooks.unix=function(input){return createLocal(1e3*input)},hooks.months=function(format,index){return listMonthsImpl(format,index,"months")},hooks.isDate=isDate,hooks.locale=getSetGlobalLocale,hooks.invalid=createInvalid,hooks.duration=createDuration,hooks.isMoment=isMoment,hooks.weekdays=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")},hooks.parseZone=function(){return createLocal.apply(null,arguments).parseZone()},hooks.localeData=getLocale,hooks.isDuration=isDuration,hooks.monthsShort=function(format,index){return listMonthsImpl(format,index,"monthsShort")},hooks.weekdaysMin=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")},hooks.defineLocale=defineLocale,hooks.updateLocale=function(name,config){if(null!=config){var locale,tmpLocale,parentConfig=baseConfig;null!=locales[name]&&null!=locales[name].parentLocale?locales[name].set(mergeConfigs(locales[name]._config,config)):(null!=(tmpLocale=loadLocale(name))&&(parentConfig=tmpLocale._config),config=mergeConfigs(parentConfig,config),null==tmpLocale&&(config.abbr=name),(locale=new Locale(config)).parentLocale=locales[name],locales[name]=locale),getSetGlobalLocale(name)}else null!=locales[name]&&(null!=locales[name].parentLocale?(locales[name]=locales[name].parentLocale,name===getSetGlobalLocale()&&getSetGlobalLocale(name)):null!=locales[name]&&delete locales[name]);return locales[name]},hooks.locales=function(){return keys(locales)},hooks.weekdaysShort=function(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")},hooks.normalizeUnits=normalizeUnits,hooks.relativeTimeRounding=function(roundingFunction){return void 0===roundingFunction?round:"function"==typeof roundingFunction&&(round=roundingFunction,!0)},hooks.relativeTimeThreshold=function(threshold,limit){return void 0!==thresholds[threshold]&&(void 0===limit?thresholds[threshold]:(thresholds[threshold]=limit,"s"===threshold&&(thresholds.ss=limit-1),!0))},hooks.calendarFormat=function(myMoment,now){var diff=myMoment.diff(now,"days",!0);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"},hooks.prototype=proto,hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},hooks}),function(global,factory){"function"==typeof define&&define.amd?define(factory):"object"==typeof module&&module.exports?module.exports=factory():global.numeral=factory()}(this,function(){var numeral,_,formats={},locales={},defaults={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},options={currentLocale:defaults.currentLocale,zeroFormat:defaults.zeroFormat,nullFormat:defaults.nullFormat,defaultFormat:defaults.defaultFormat,scalePercentBy100:defaults.scalePercentBy100};function Numeral(input,number){this._input=input,this._value=number}return(numeral=function(input){var value,kind,unformatFunction,regexp;if(numeral.isNumeral(input))value=input.value();else if(0===input||void 0===input)value=0;else if(null===input||_.isNaN(input))value=null;else if("string"==typeof input)if(options.zeroFormat&&input===options.zeroFormat)value=0;else if(options.nullFormat&&input===options.nullFormat||!input.replace(/[^0-9]+/g,"").length)value=null;else{for(kind in formats)if((regexp="function"==typeof formats[kind].regexps.unformat?formats[kind].regexps.unformat():formats[kind].regexps.unformat)&&input.match(regexp)){unformatFunction=formats[kind].unformat;break}value=(unformatFunction=unformatFunction||numeral._.stringToNumber)(input)}else value=Number(input)||null;return new Numeral(input,value)}).version="2.0.6",numeral.isNumeral=function(obj){return obj instanceof Numeral},numeral._=_={numberToFormat:function(value,format,roundingFunction){var leadingCount,abbrForce,abs,int,precision,signed,thousands,output,locale=locales[numeral.options.currentLocale],negP=!1,optDec=!1,abbr="",decimal="",neg=!1;if(value=value||0,abs=Math.abs(value),numeral._.includes(format,"(")?(negP=!0,format=format.replace(/[\(|\)]/g,"")):(numeral._.includes(format,"+")||numeral._.includes(format,"-"))&&(signed=numeral._.includes(format,"+")?format.indexOf("+"):value<0?format.indexOf("-"):-1,format=format.replace(/[\+|\-]/g,"")),numeral._.includes(format,"a")&&(abbrForce=!!(abbrForce=format.match(/a(k|m|b|t)?/))&&abbrForce[1],numeral._.includes(format," a")&&(abbr=" "),format=format.replace(new RegExp(abbr+"a[kmbt]?"),""),abs>=1e12&&!abbrForce||"t"===abbrForce?(abbr+=locale.abbreviations.trillion,value/=1e12):abs<1e12&&abs>=1e9&&!abbrForce||"b"===abbrForce?(abbr+=locale.abbreviations.billion,value/=1e9):abs<1e9&&abs>=1e6&&!abbrForce||"m"===abbrForce?(abbr+=locale.abbreviations.million,value/=1e6):(abs<1e6&&abs>=1e3&&!abbrForce||"k"===abbrForce)&&(abbr+=locale.abbreviations.thousand,value/=1e3)),numeral._.includes(format,"[.]")&&(optDec=!0,format=format.replace("[.]",".")),int=value.toString().split(".")[0],precision=format.split(".")[1],thousands=format.indexOf(","),leadingCount=(format.split(".")[0].split(",")[0].match(/0/g)||[]).length,precision?(numeral._.includes(precision,"[")?(precision=(precision=precision.replace("]","")).split("["),decimal=numeral._.toFixed(value,precision[0].length+precision[1].length,roundingFunction,precision[1].length)):decimal=numeral._.toFixed(value,precision.length,roundingFunction),int=decimal.split(".")[0],decimal=numeral._.includes(decimal,".")?locale.delimiters.decimal+decimal.split(".")[1]:"",optDec&&0===Number(decimal.slice(1))&&(decimal="")):int=numeral._.toFixed(value,0,roundingFunction),abbr&&!abbrForce&&Number(int)>=1e3&&abbr!==locale.abbreviations.trillion)switch(int=String(Number(int)/1e3),abbr){case locale.abbreviations.thousand:abbr=locale.abbreviations.million;break;case locale.abbreviations.million:abbr=locale.abbreviations.billion;break;case locale.abbreviations.billion:abbr=locale.abbreviations.trillion}if(numeral._.includes(int,"-")&&(int=int.slice(1),neg=!0),int.length<leadingCount)for(var i=leadingCount-int.length;i>0;i--)int="0"+int;return thousands>-1&&(int=int.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+locale.delimiters.thousands)),0===format.indexOf(".")&&(int=""),output=int+decimal+(abbr||""),negP?output=(negP&&neg?"(":"")+output+(negP&&neg?")":""):signed>=0?output=0===signed?(neg?"-":"+")+output:output+(neg?"-":"+"):neg&&(output="-"+output),output},stringToNumber:function(string){var abbreviation,value,regexp,locale=locales[options.currentLocale],stringOriginal=string,abbreviations={thousand:3,million:6,billion:9,trillion:12};if(options.zeroFormat&&string===options.zeroFormat)value=0;else if(options.nullFormat&&string===options.nullFormat||!string.replace(/[^0-9]+/g,"").length)value=null;else{for(abbreviation in value=1,"."!==locale.delimiters.decimal&&(string=string.replace(/\./g,"").replace(locale.delimiters.decimal,".")),abbreviations)if(regexp=new RegExp("[^a-zA-Z]"+locale.abbreviations[abbreviation]+"(?:\\)|(\\"+locale.currency.symbol+")?(?:\\))?)?$"),stringOriginal.match(regexp)){value*=Math.pow(10,abbreviations[abbreviation]);break}value*=(string.split("-").length+Math.min(string.split("(").length-1,string.split(")").length-1))%2?1:-1,string=string.replace(/[^0-9\.]+/g,""),value*=Number(string)}return value},isNaN:function(value){return"number"==typeof value&&isNaN(value)},includes:function(string,search){return-1!==string.indexOf(search)},insert:function(string,subString,start){return string.slice(0,start)+subString+string.slice(start)},reduce:function(array,callback){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof callback)throw new TypeError(callback+" is not a function");var value,t=Object(array),len=t.length>>>0,k=0;if(3===arguments.length)value=arguments[2];else{for(;k<len&&!(k in t);)k++;if(k>=len)throw new TypeError("Reduce of empty array with no initial value");value=t[k++]}for(;k<len;k++)k in t&&(value=callback(value,t[k],k,t));return value},multiplier:function(x){var parts=x.toString().split(".");return parts.length<2?1:Math.pow(10,parts[1].length)},correctionFactor:function(){return Array.prototype.slice.call(arguments).reduce(function(accum,next){var mn=_.multiplier(next);return accum>mn?accum:mn},1)},toFixed:function(value,maxDecimals,roundingFunction,optionals){var boundedPrecision,optionalsRegExp,power,output,splitValue=value.toString().split("."),minDecimals=maxDecimals-(optionals||0);return boundedPrecision=2===splitValue.length?Math.min(Math.max(splitValue[1].length,minDecimals),maxDecimals):minDecimals,power=Math.pow(10,boundedPrecision),output=(roundingFunction(value+"e+"+boundedPrecision)/power).toFixed(boundedPrecision),optionals>maxDecimals-boundedPrecision&&(optionalsRegExp=new RegExp("\\.?0{1,"+(optionals-(maxDecimals-boundedPrecision))+"}$"),output=output.replace(optionalsRegExp,"")),output}},numeral.options=options,numeral.formats=formats,numeral.locales=locales,numeral.locale=function(key){return key&&(options.currentLocale=key.toLowerCase()),options.currentLocale},numeral.localeData=function(key){if(!key)return locales[options.currentLocale];if(key=key.toLowerCase(),!locales[key])throw new Error("Unknown locale : "+key);return locales[key]},numeral.reset=function(){for(var property in defaults)options[property]=defaults[property]},numeral.zeroFormat=function(format){options.zeroFormat="string"==typeof format?format:null},numeral.nullFormat=function(format){options.nullFormat="string"==typeof format?format:null},numeral.defaultFormat=function(format){options.defaultFormat="string"==typeof format?format:"0.0"},numeral.register=function(type,name,format){if(name=name.toLowerCase(),this[type+"s"][name])throw new TypeError(name+" "+type+" already registered.");return this[type+"s"][name]=format,format},numeral.validate=function(val,culture){var _decimalSep,_thousandSep,_currSymbol,_valArray,_abbrObj,_thousandRegEx,localeData,temp;if("string"!=typeof val&&(val+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",val)),(val=val.trim()).match(/^\d+$/))return!0;if(""===val)return!1;try{localeData=numeral.localeData(culture)}catch(e){localeData=numeral.localeData(numeral.locale())}return _currSymbol=localeData.currency.symbol,_abbrObj=localeData.abbreviations,_decimalSep=localeData.delimiters.decimal,_thousandSep="."===localeData.delimiters.thousands?"\\.":localeData.delimiters.thousands,(null===(temp=val.match(/^[^\d]+/))||(val=val.substr(1),temp[0]===_currSymbol))&&((null===(temp=val.match(/[^\d]+$/))||(val=val.slice(0,-1),temp[0]===_abbrObj.thousand||temp[0]===_abbrObj.million||temp[0]===_abbrObj.billion||temp[0]===_abbrObj.trillion))&&(_thousandRegEx=new RegExp(_thousandSep+"{2}"),!val.match(/[^\d.,]/g)&&(!((_valArray=val.split(_decimalSep)).length>2)&&(_valArray.length<2?!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx):1===_valArray[0].length?!!_valArray[0].match(/^\d+$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/):!!_valArray[0].match(/^\d+.*\d$/)&&!_valArray[0].match(_thousandRegEx)&&!!_valArray[1].match(/^\d+$/)))))},numeral.fn=Numeral.prototype={clone:function(){return numeral(this)},format:function(inputString,roundingFunction){var kind,output,formatFunction,value=this._value,format=inputString||options.defaultFormat;if(roundingFunction=roundingFunction||Math.round,0===value&&null!==options.zeroFormat)output=options.zeroFormat;else if(null===value&&null!==options.nullFormat)output=options.nullFormat;else{for(kind in formats)if(format.match(formats[kind].regexps.format)){formatFunction=formats[kind].format;break}output=(formatFunction=formatFunction||numeral._.numberToFormat)(value,format,roundingFunction)}return output},value:function(){return this._value},input:function(){return this._input},set:function(value){return this._value=Number(value),this},add:function(value){var corrFactor=_.correctionFactor.call(null,this._value,value);return this._value=_.reduce([this._value,value],function(accum,curr,currI,O){return accum+Math.round(corrFactor*curr)},0)/corrFactor,this},subtract:function(value){var corrFactor=_.correctionFactor.call(null,this._value,value);return this._value=_.reduce([value],function(accum,curr,currI,O){return accum-Math.round(corrFactor*curr)},Math.round(this._value*corrFactor))/corrFactor,this},multiply:function(value){return this._value=_.reduce([this._value,value],function(accum,curr,currI,O){var corrFactor=_.correctionFactor(accum,curr);return Math.round(accum*corrFactor)*Math.round(curr*corrFactor)/Math.round(corrFactor*corrFactor)},1),this},divide:function(value){return this._value=_.reduce([this._value,value],function(accum,curr,currI,O){var corrFactor=_.correctionFactor(accum,curr);return Math.round(accum*corrFactor)/Math.round(curr*corrFactor)}),this},difference:function(value){return Math.abs(numeral(this._value).subtract(value).value())}},numeral.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(number){var b=number%10;return 1==~~(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th"},currency:{symbol:"$"}}),numeral}),function(window){let zn={findClass:name=>{let obj=window;return name.split(".").forEach(part=>{obj&&(obj=obj[part])}),obj},shortid:()=>{let rval=[],a=Array.from(Math.random().toString(36).substr(2)),b=Array.from((new Date).getTime().toString(36));return a.forEach((x,i)=>{rval.push(x),i<b.length&&rval.push(b.shift())}),0!=b.length&&(rval=rval.concat(b)),rval.join("")},ng:{}};zn.ng.directives={},window.zn=zn}(window),function(window){"zn".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Base=class{constructor(options){this.options=options,this.eventHandlers={}}init(){}destroy(){}on(eventName,eventHandler){let parts=eventName.split("."),ename=parts.shift(),handlerId=parts.join(".")||zn.shortid();return(this.eventHandlers[ename]=this.eventHandlers[ename]||{})[handlerId]=eventHandler,handlerId}off(eventName){let parts=eventName.split("."),ename=parts.shift(),handlerId=parts.join("."),handlers=this.eventHandlers[ename];handlers[handlerId]&&delete handlers[handlerId]}fireEvent(eventName,event){let evt=event||{};evt.source=this,Object.values(this.eventHandlers[eventName]||{}).forEach(eh=>eh(evt))}}}(window),function(window){let utils={findMethod:function(fullname){if(!fullname)return null;let parts=fullname.split("."),obj=window;for(let i=0,l=parts.length;i<l&&null!=obj;i++)obj=obj[parts[i]];return obj},fn:function(p1,p2){let scope=null,fn=null,s=1;"object"==typeof p1&&(scope=p1,fn=p2,s=2),"function"==typeof p1&&(fn=p1);let args=[];for(let i=s,l=arguments.length;i<l;++i)args.push(arguments[i]);return()=>{fn.apply(scope,args)}},getLocalTemplate:function(src){let content=null;return $("template").each((i,e)=>{let $e=$(e),template=$e.attr("template");src.endsWith(template)&&(content=$e.html())}),content},fetchTemplateContent:src=>{return new Promise(($res,$rej)=>{console.info("[zn]",`fetching template => ${src}`);let content=utils.getLocalTemplate(src),err=null;null==content?$.ajax({async:!0,type:"GET",url:src,success:res=>content=res,error:(jqxhr,text,error)=>{err=error},complete:(xhr,status)=>{err?$rej(err):$res(content)}}):$res(content)})},loadTemplates:()=>{return new Promise(async($res,$rej)=>{let elements=$("*[zn-template]").get();for(;elements.length>0;){for(let e of elements){let $e=$(e),src=$e.attr("zn-template"),content=await utils.fetchTemplateContent(src);$e.html(content),$e.removeAttr("zn-template")}elements=$("*[zn-template]").get()}$res()})}};utils.debounce=((fn,delay)=>{let timerId=-1,scope=this;return function(){let args=arguments;-1!=timerId&&window.clearTimeout(timerId),timerId=window.setTimeout(()=>fn.apply(scope,args),delay)}}),utils.slug=(x=>x.replace(/[!@#$%^&*()+\=\[\]{};':"\\|,.<>\/?]+/g,"").replace(/_+/g,"-").replace(/\s+/g,"-").replace(/-+/g,"-").toLocaleLowerCase()),utils.copyObj=(obj=>{let str=JSON.stringify(obj),newObj=JSON.parse(str);return utils.sanitize(newObj),newObj}),utils.sanitize=(obj=>{obj instanceof Array?obj.forEach(o=>utils.sanitize(o)):"object"==typeof obj&&(obj.$$hashKey&&delete obj.$$hashKey,Object.keys(obj).forEach(k=>(obj[k]instanceof Array||"object"==typeof obj)&&utils.sanitize(obj[k])))}),"zn".split(".").reduce((a,e)=>a[e]=a[e]||{},window).utils=utils}(window),function(window){"zn".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Routes=class extends zn.Base{constructor(options){super(options),this.init()}init(){let routes=this;Object.keys(routes.options).forEach(routeUrl=>{routes.options[routeUrl]={url:routeUrl,...routes.options[routeUrl],...routes.parseRouteUrl(routeUrl)},routes.options[routeUrl].default&&(routes.default=routeUrl)}),routes.setupEventHandlers()}parseRouteUrl(routeUrl){let matcher={rex:null,params:[]},pattern=routeUrl.split("/").reduce((a,c)=>""==c?a:(["@",":"].includes(c.substring(0,1))?(a+="(/[^/]+|.{0,0})",matcher.params.push(c.substring(1))):"*"==c?(a+="(/.+)",matcher.params.push("*")):a+="/"+c,a),"");return matcher.rex=new RegExp("("+pattern+")$"),matcher}lookupRouteUrl(routeUrl){let routes=this,rval=null;for(let routeDefn of Object.values(routes.options)){let matches=routeDefn.rex.exec(routeUrl);if(matches){rval={paramValues:routeDefn.params.reduce((a,c,i)=>(a[c]=unescape(matches[i+2].substring(1)),a),{}),...routeDefn};break}}return rval}go(route){let routes=this;route?window.location.hash=`#!${route}`:window.location.hash?routes.handleRoute():(console.info("[zn]","redirecting to default route"),window.location.hash=`#!${routes.default}`)}setupEventHandlers(){let routes=this;$(window).on("hashchange",evt=>routes.handleRoute())}handleRoute(){let routeUrl=window.location.hash.substring(2);if(null==routeUrl||""==routeUrl)return;console.info("[zn]",`serving route ${routeUrl}`);let route=this.lookupRouteUrl(routeUrl);null!=route?this.fireEvent("load",{route:route}):console.error("[zn]",`invalid route ${routeUrl}`)}}}(window),function(window){$(()=>zn.Module.init()),"zn".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Module=class extends zn.Base{constructor(options){super(options),this.views={},this.routeView={},this.data=zn.defn.data}setupUI(){this.$module=$(".zn-module"),this.$module.attr("zn-module",this.options.defn.name)}loadModuleLayout(){let module=this;return new Promise(async($res,$rej)=>{module.$module.attr("zn-template",module.options.defn.template),await zn.utils.loadTemplates(),$res()})}initModule(){let module=this;return new Promise(async($res,$rej)=>{let moduleHandlerClass=zn.findClass(module.options.defn.class);null!=moduleHandlerClass?(module.moduleHandler=new moduleHandlerClass,await module.moduleHandler.init(),$res()):$rej(`module class not found ${module.options.defn.class}`)})}setupView($e,viewName,viewObj){let module=this,oid=zn.shortid();viewObj.__name=viewName,viewObj.__oid=oid,module.views[viewName]=viewObj,""==$e.attr("zn-route")&&(module.routeView=viewObj),viewObj.on("update",evt=>module.notifyOtherViews(evt))}setupNGModuleForView($e,viewName,viewObj){let mid=viewObj.__oid,ng={mid:mid,moduleName:`${viewName}-ng-module-${mid}`,ctrlName:`${viewName}-ng-ctrl-${mid}`},ngElement=$($e.find(".zn-view-wrapper").get());ngElement.addClass("ng-cloak"),ng.module=angular.module(ng.moduleName,[]),ng.module.controller(ng.ctrlName,["$scope",function($scope){}]),zn.ng&&zn.ng.directives&&Object.keys(zn.ng.directives).forEach(name=>ng.module.directive(name,zn.ng.directives[name])),angular.bootstrap(ngElement,[ng.moduleName]),ng.$scope=angular.element(ngElement).scope(),ng.$scope.view=new Proxy(viewObj,{}),ng.$scope.env=this.options.env,ng.$scope.module={data:zn.defn.data},ng.$scope.$apply(),ngElement.css("visibility","visible"),viewObj.__ng=ng,viewObj.apply=(fn=>ng.$scope.$apply(fn))}loadView($e,optns){let module=this;return new Promise(async($res,$rej)=>{if($e.get()[0].znv)return void $res();let viewName=$e.attr("zn-view");console.info("[zn]",`loading view => ${viewName}`);let viewDefn=zn.defn.views[viewName],viewClassName=viewDefn.class,viewClass=zn.findClass(viewClassName);if(null==viewClass)return void $rej(`class ${viewClassName} not found for view ${viewName}`);$e.html('<div class="zn-view-wrapper"></div>'),$e.find(".zn-view-wrapper").attr("zn-template",viewDefn.template),await zn.utils.loadTemplates();let viewObj=new viewClass({module:module,...optns||{}});$e.get()[0].znv=viewObj,module.setupView($e,viewName,viewObj),module.setupNGModuleForView($e,viewName,viewObj),$res(viewObj)})}loadViews(){let module=this;return new Promise(async($res,$rej)=>{let elements=$("[zn-view]").get(),viewObjs=[];for(let e of elements){let viewObj=await module.loadView($(e));null!=viewObj&&viewObjs.push(viewObj)}for(let viewObj of viewObjs)if(viewObj.init){let promise=viewObj.init();promise&&(await promise,viewObj.__ng.$scope.$apply()),console.info("[zn]",`view initialized => ${viewObj.__name}`)}$res()})}unloadCurrentView(){this.routeView&&(this.routeView.destroy&&this.routeView.destroy(),delete this.routeView)}loadViewForRoute(route){let module=this;return new Promise(async($res,$rej)=>{module.unloadCurrentView();let viewName=route.view,$route=$("[zn-route]");$route.attr("zn-view",viewName),$route.get()[0].znv=null;let viewObj=await module.loadView($route,{routeValues:route.paramValues});if(null!=viewObj&&viewObj.init){let promise=viewObj.init();promise&&(await promise,viewObj.__ng.$scope.$apply()),console.info("[zn]",`view initialized => ${viewObj.__name}`),module.fireEvent("route-change",{route:route})}$res()})}initRoutes(){let module=this;module.routes=new zn.Routes(zn.defn.routes),module.routes.on("load",evt=>module.loadViewForRoute(evt.route).then())}loadRoute(){this.routes.go()}async load(){this.initRoutes(),this.setupUI(),await this.loadModuleLayout(),await this.initModule(),await this.loadViews(),console.info("[zn]","module loaded"),this.loadRoute()}static instance(){return zn.Module.$instance}static init(){console.info("[zn]","loading environment values"),zn.env=JSON.parse($("#zn-env").html()),zn.defn=JSON.parse($("#zn-defn").html()),console.info("[zn]","loading module");let instance=new zn.Module({defn:zn.defn,env:zn.env});zn.Module.$instance=instance,instance.load()}}}(window),function(window){class Button{constructor(options){this.options=options,this.eventHandlers={}}init(){this.$target=$(this.options.target),this.$target.addClass("zn-button"),this.$target.attr("title",this.options.title),this.$target.attr("data-type",this.options.type),this.$target.attr("zn-button",this.options.name),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setValue(v){this.value=value}getValue(){return this.value}setupUI(){this.$target.html(Button.html(this.options))}setupEventHandlers(){let button=this;button.$target.on("click",evt=>{button.fireEvent("action",{action:button.options.action})})}static get(name){return $(`[zn-button='${name}']`).get()[0].znc}static html(options){return`${options.icon?Button.htmlIcon(options.icon):""}<span class="text">${options.text||""}</span>`}static htmlIcon(icon){return`<i class="icon ${icon}"></i>`}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Button=Button}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,text:scope.text,icon:scope.icon,action:scope.action,type:scope.type},button=new zn.ui.components.Button(options);button.on("action",evt=>{scope.onaction({$event:evt})}),button.init()},tag:"znButton",factory:function(){return{scope:{name:"@",text:"@",action:"=",icon:"@",type:"@",onaction:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).button=directive}(window),function(window){class Calendar{constructor(options){this.options=options,this.value=options.date,this.name=options.name,this.eventHandlers={}}init(){this.$target=$(this.options.target),this.$target.addClass("zn-calendar"),this.$target.attr("zn-calendar",this.options.name),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,evt.name=eventName,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setValue(value){let calendar=this;calendar.value=value,value&&(calendar.options.date=value,calendar.loadDates(!0))}getValue(){return this.value}setupUI(){this.options.view="weeks",this.$target.html(Calendar.html()),this.loadDates(!0)}setupEventHandlers(){let calendar=this;calendar.$target.off("click.date").on("click.date",".date",function(evt){evt.preventDefault();let sd=calendar.options.selectedDate,$date=$(this);sd.date=parseInt($date.attr("data-date")),calendar.options.date=new Date(sd.year+"-"+(sd.month+1)+"-"+sd.date),calendar.$target.find(".date.selected").removeClass("selected"),$date.addClass("selected"),calendar.value=calendar.options.date,calendar.fireEvent("date-select",{date:calendar.options.date})}),calendar.$target.off("click.month").on("click.month",".month",function(evt){evt.preventDefault(),calendar.options.selectedDate.month=parseInt($(this).attr("data-month")),calendar.options.view="weeks",calendar.loadWeeks(!1)}),calendar.$target.off("click.year").on("click.year",".year",function(evt){evt.preventDefault(),calendar.options.selectedDate.year=parseInt($(this).attr("data-year")),calendar.options.view="months",calendar.loadMonths(!1)}),calendar.$target.off("click.previous").on("click.previous",".previous",function(evt){evt.preventDefault();let sd=calendar.options.selectedDate;"weeks"==calendar.options.view&&(sd.month=sd.month-1,sd.month<0&&(sd.month=11,sd.year--),calendar.loadWeeks(!1)),"months"==calendar.options.view&&(sd.year=sd.year-1,calendar.loadMonths(!1)),"years"==calendar.options.view&&(sd.year=sd.year-12,calendar.loadYears(!1))}),calendar.$target.off("click.next").on("click.next",".next",function(evt){evt.preventDefault();let sd=calendar.options.selectedDate;"weeks"==calendar.options.view&&(sd.month=sd.month+1,sd.month>11&&(sd.month=0,sd.year++),calendar.options.date=new Date(sd.year+"-"+(sd.month+1)+"-"+sd.date),calendar.loadWeeks(!1)),"months"==calendar.options.view&&(sd.year=sd.year+1,calendar.loadMonths(!1)),"years"==calendar.options.view&&(sd.year=sd.year+12,calendar.loadYears(!1))}),calendar.$target.off("click.viewselector").on("click.viewselector",".view-selector",function(evt){if(evt.preventDefault(),"weeks"==calendar.options.view)calendar.options.view="months",calendar.loadMonths(!0);else if("months"==calendar.options.view)calendar.options.view="years",calendar.loadYears(!0);else if("years"==calendar.options.view){let date=new Date,sd={year:date.getFullYear(),month:date.getMonth(),date:date.getDate()};calendar.options.selectedDate=sd,calendar.options.view="weeks",calendar.loadWeeks(!0)}})}loadWeeks(markDate){let $calendar=this.$target;$calendar.find(".months").hide(),$calendar.find(".years").hide();let sd=this.options.selectedDate,numdays=Calendar.monthDaysFor(sd.month,sd.year),fomwday=new Date(sd.year+"-"+(sd.month+1)+"-1").getDay(),html="<div class='row'>";for(let i=0;i<fomwday;i++)html+="<div class='empty-date'>&nbsp;</div>";for(let i=1;i<=numdays;i++){html+=`<a class='date ${markDate&&i==sd.date?"selected":""}' data-date='${i}'>${i}</a>`,(fomwday+i)%7==0&&(html+="</div><div class='row'>")}html+="</div>",$calendar.find(".dates").html(html),$calendar.find(".header .title a").text(Calendar.months()[sd.month]+" "+sd.year),$calendar.find(".weeks").show()}loadMonths(markDate){let $calendar=this.$target;$calendar.find(".weeks").hide(),$calendar.find(".years").hide();let sd=this.options.selectedDate,html="<div class='row'>";for(let i=0,l=Calendar.months().length;i<l;i++){html+=`<a class='month ${markDate&&i==sd.month?"selected":""}' data-month='${i}'>${Calendar.months()[i]}</a>`,(i+1)%3==0&&(html+="</div><div class='row'>")}html+="</div>",$calendar.find(".months").html(html),$calendar.find(".header .title a").text(Calendar.months()[sd.month]+" "+sd.year),$calendar.find(".months").show()}loadYears(markDate){let $calendar=this.$target;$calendar.find(".weeks").hide(),$calendar.find(".months").hide();let sd=this.options.selectedDate,y=sd.year-4,html="<div class='row'>";for(let i=0;i<12;i++){html+=`<a class='year ${markDate&&y+i==sd.year?"selected":""}' data-year='${y+i}'>${y+i}</a>`,(i+1)%3==0&&(html+="</div><div class='row'>")}html+="</div>",$calendar.find(".years").html(html),$calendar.find(".header .title a").text("Today"),$calendar.find(".years").show()}loadDates(markDate){let sd={year:this.options.date.getFullYear(),month:this.options.date.getMonth(),date:this.options.date.getDate()};this.options.selectedDate=sd,"weeks"==this.options.view&&this.loadWeeks(markDate),"months"==this.options.view&&this.loadMonths(markDate),"years"==this.options.view&&this.loadYears(markDate)}static get(name){return $(`[zn-calendar='${name}']`).get()[0].znc}static html(){return'\n      <div class="header">\n        <div class="actions">\n          <a class="previous"><i class="fas fa-arrow-circle-left"></i></a>\n          <a class="next"><i class="fas fa-arrow-circle-right"></i></a>\n        </div>\n        <div class="title"><a class="view-selector"></a></div>\n      </div>\n      <div class="content">\n        <div class="years">\n        </div>\n        <div class="months">\n        </div>\n        <div class="weeks">\n          <div class="days">\n            <div class="day">Su</div><div class="day">Mo</div><div class="day">Tu</div>\n            <div class="day">We</div><div class="day">Th</div><div class="day">Fr</div>\n            <div class="day">Sa</div>\n          </div>\n          <div class="dates">\n          </div>\n        </div>\n      </div>\n      '}static monthDays(){return[31,28,31,30,31,30,31,31,30,31,30,31]}static months(){return["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}static monthDaysFor(m,y){let rval=Calendar.monthDays()[m];return 1==m&&(y%4==0&&rval++,y%100==0&&rval--,y%400==0&&rval++),rval}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Calendar=Calendar}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,date:scope.date||new Date},calendar=new zn.ui.components.Calendar(options);scope.$watch("date",(nv,ov)=>{calendar.setValue(nv)}),calendar.on("date-select",evt=>{scope.date&&(scope.date=evt.date),scope.$apply()}),calendar.on("date-select",evt=>{scope.ondateselect({$event:evt})}),calendar.init()},tag:"znCalendar",factory:function(){return{scope:{name:"@",date:"=",ondateselect:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).calendar=directive}(window),function(window){class CheckboxField{constructor(options){this.options=options,this.value=options.value,this.eventHandlers={},this.options.values=this.options.values||{on:!0,off:!1}}init(){this.$target=$(this.options.target),this.$target.addClass("zn-checkboxfield"),this.$target.attr("zn-checkboxfield",this.options.name),this.options.error&&this.$target.addClass("error"),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.setValue(this.options.value),this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,evt.name=eventName,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setValue(value){this.value=value,this.$input.attr("data-state",value&&this.options.values.on==value?"on":"off")}getValue(){return this.value}message(msg,type){let checkboxfield=this;""!=msg?(checkboxfield.$msg.text(msg),"error"==type?checkboxfield.$target.addClass("error"):checkboxfield.$target.addClass("message")):(checkboxfield.$msg.text(""),checkboxfield.$target.removeClass("error").removeClass("message"))}setupUI(){this.$target.html(CheckboxField.html(this.options)),this.$input=this.$target.find(".zn-checkboxfield-input"),this.$msg=this.$target.find(".zn-checkboxfield-msg")}setupEventHandlers(){let checkboxfield=this;checkboxfield.$target.find(".zn-checkboxfield-input").on("click",evt=>{let $input=$(evt.currentTarget),state="on"==$input.attr("data-state")?"off":"on";$input.attr("data-state",state);let oldValue=checkboxfield.value,newValue=checkboxfield.options.values[state];checkboxfield.value=newValue,checkboxfield.fireEvent("change",{newValue:newValue,oldValue:oldValue})}).on("keypress",evt=>{if(32!=evt.keyCode)return;let $input=$(evt.currentTarget),state="on"==$input.attr("data-state")?"off":"on";$input.attr("data-state",state);let oldValue=checkboxfield.value,newValue=checkboxfield.options.values[state];checkboxfield.value=newValue,checkboxfield.fireEvent("change",{newValue:newValue,oldValue:oldValue})}),checkboxfield.$target.find(".zn-checkboxfield-input").on("focus",evt=>{checkboxfield.$target.addClass("focused")}),checkboxfield.$target.find(".zn-checkboxfield-input").on("blur",evt=>{checkboxfield.$target.removeClass("focused")})}static get(name){return $(`[zn-checkboxfield='${name}']`).get()[0].znc}static html(options){return`\n      ${options.label?CheckboxField.htmlLabel(options.label):""}\n      <div class="zn-checkboxfield-input" tabindex="0" data-state="off">\n        <i class="state-off far fa-square"></i><i class="state-on fas fa-check-square"></i>\n        <span class="text">${options.text||""}</span>\n      </div>\n      <div class="zn-checkboxfield-msg">${options.error||options.message||""}</div>\n      `}static htmlIcon(icon){return`<i class="icon ${icon}"></i>`}static htmlLabel(label){return`<div class="zn-checkboxfield-label">${label}</div>`}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).CheckboxField=CheckboxField}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,text:scope.text,value:scope.value,values:{on:scope.onvalue,off:scope.offvalue},error:scope.error?scope.error:"",message:scope.message},checkboxfield=new zn.ui.components.CheckboxField(options);checkboxfield.on("init",()=>{checkboxfield.on("change",evt=>{scope.value=evt.newValue,scope.$apply(),scope.onchange&&scope.onchange({$event:evt})}),scope.$watch("value",(nv,ov)=>checkboxfield.setValue(nv)),scope.$watch("error",(nv,ov)=>checkboxfield.message(nv||"","error")),scope.$watch("message",(nv,ov)=>checkboxfield.message(nv,"message"))}),checkboxfield.init()},tag:"znCheckboxfield",factory:function(){return{scope:{name:"@",text:"@",value:"=",onvalue:"@",offvalue:"@",error:"=",message:"=",onchange:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).checkboxfield=directive}(window),function(window){class DateField{constructor(options){this.options=options,this.name=options.name,this.eventHandlers={},this.options.format=this.options.format||"DD/MM/YYYY"}init(){this.$target=$(this.options.target),this.$target.addClass("zn-datefield"),this.$target.attr("zn-datefield",this.options.name),this.options.error&&this.$target.addClass("error"),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.setValue(this.options.value),this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,evt.name=eventName,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setValue(value){this.value=value,value?this.$input.val(DateField.format(value,"date",this.options.format)):this.$input.val("")}getValue(){return this.value}message(msg,type){let datefield=this;""!=msg?(datefield.$msg.text(msg),"error"==type?datefield.$target.addClass("error"):datefield.$target.addClass("message")):(datefield.$msg.text(""),datefield.$target.removeClass("error").removeClass("message"))}setupUI(){this.$target.html(DateField.html(this.options)),this.$input=this.$target.find(".zn-datefield-input input"),this.$calendar=this.$target.find(".calendar"),this.$msg=this.$target.find(".zn-datefield-msg")}setupEventHandlers(){let datefield=this;datefield.$target.find(".zn-datefield-input input").on("change",evt=>{let $input=$(evt.currentTarget),oldValue=datefield.getValue(),newValue=$input.val();datefield.value=newValue,datefield.fireEvent("change",{oldValue:oldValue,newValue:newValue})}),datefield.$target.find(".zn-datefield-input input").on("keydown",evt=>{13==evt.keyCode&&datefield.fireEvent("action")}),datefield.$target.find(".zn-datefield-input input").on("focus",evt=>{datefield.$target.addClass("focused")}),datefield.$target.find(".zn-datefield-input input").on("blur",evt=>{datefield.$target.removeClass("focused")}),datefield.$target.find(".zn-datefield-input .action").on("click",evt=>{datefield.$input.focus(),datefield.showCalendar()})}showCalendar(){let datefield=this;datefield.$calendar.addClass("showing");var $body=$("body");let hide=()=>{$body.off("mousedown.zn.ui.components.datefield.calendarpopup"),$body.off("keydown.zn.ui.components.datefield.calendarpopup"),datefield.$calendar.hide(),datefield.$calendar.removeClass("showing"),datefield.$input.focus()};$body.on("mousedown.zn.ui.components.datefield.calendarpopup",evt=>{DateField.pointInContent({x:evt.pageX,y:evt.pageY},datefield.$calendar)||hide()}),$body.on("keydown.zn.ui.components.datefield.calendarpopup",evt=>{27==evt.keyCode&&hide()});let calendar=new zn.ui.components.Calendar({name:datefield.name,target:datefield.$calendar,date:datefield.value||new Date});calendar.on("date-select",evt=>{let oldValue=datefield.getValue(),newValue=evt.date;datefield.setValue(evt.date),datefield.fireEvent("change",{oldValue:oldValue,newValue:newValue}),datefield.fireEvent("date-select",{date:newValue}),hide()}),calendar.init();let p=datefield.$input.position(),w=datefield.$input.width()+3,h=datefield.$input.height(),top=p.top+h+9,left=p.left+w-datefield.$calendar.width()+13,ch=$(document).height(),cw=$(document).width();top+datefield.$calendar.height()>ch&&(top=ch-datefield.$calendar.height()-20),left+datefield.$calendar.width()>cw&&(left=cw-datefield.$calendar.width()-20),datefield.$calendar.css("top",top+"px").css("left",left+"px").show()}static get(name){return $(`[zn-datefield='${name}']`).get()[0].znc}static html(options){return`\n      ${options.label?DateField.htmlLabel(options.label):""}\n      <div class="zn-datefield-input">\n        ${options.icon?DateField.htmlIcon(options.icon):""}\n        <input type="text" placeholder="${options.placeholder||""}" ${options.readonly?"readonly":""} size="1"/>\n        <span class="action"><i class="far fa-calendar-alt"></i></span>\n      </div>\n      <div class="zn-datefield-msg">${options.error||options.message||""}</div>\n      <div class="calendar zn-calendar"></div>\n      `}static htmlIcon(icon){return`<i class="icon ${icon}"></i>`}static htmlLabel(label){return`<div class="zn-datefield-label">${label}</div>`}static format(v,t,f){return null==t||null==f||""==f?v:"number"==t?numeral(v).format(f):"date"==t?moment(v).format(f):v}static pointInContent(point,content){var offset=content.offset();return point.x>=offset.left&&point.x<=offset.left+content.width()&&point.y>=offset.top&&point.y<=offset.top+content.height()}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).DateField=DateField}(window),function(window){let directive={linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,label:scope.label,value:scope.value,placeholder:scope.placeholder,icon:scope.icon,readonly:"true"===scope.readonly,error:scope.error?scope.error:"",message:scope.message},datefield=new zn.ui.components.DateField(options);datefield.on("init",()=>{datefield.on("change",evt=>{scope.value=evt.newValue,scope.$apply(),scope.onchange&&scope.onchange({$event:evt})}),datefield.on("action",evt=>scope.onaction({$event:evt})),scope.$watch("value",(nv,ov)=>datefield.setValue(nv)),scope.$watch("error",(nv,ov)=>datefield.message(nv||"","error")),scope.$watch("message",(nv,ov)=>datefield.message(nv,"message"))}),datefield.init()},tag:"znDatefield",factory:function(){return{scope:{name:"@",label:"@",value:"=",placeholder:"@",icon:"@",readonly:"@",onaction:"&",error:"=",message:"=",onchange:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).datefield=directive}(window),function(window){class Dialog{constructor(options){this.options=options,this.eventHandlers={},(Dialog.instances=Dialog.instances||[]).push(this)}init(){this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}show(showAtLoc){this.options.centered?this.$target.css("display","flex"):this.$target.show(),this.setupDialogCloseEventHandlers(),this.$target.addClass("showing"),this.bodyOverFlow=$("body").css("overflow"),$("body").css("overflow","hidden")}hide(){this.removeDialogCloseEventHandlers(),this.$target.hide(),this.$target.removeClass("showing"),$("body").css("overflow",this.bodyOverFlow)}setupEventHandlers(){let dialog=this;dialog.$target.on("click",".zn-dialog-footer .zn-action",evt=>{evt.preventDefault();let $action=$(evt.currentTarget),action=$action.attr("data-action"),index=parseInt($action.attr("data-index"));dialog.fireEvent("action",{action:action}),!1!==dialog.options.actions[index].autohide&&dialog.hide()})}setupDialogCloseEventHandlers(){let dialog=this;$("body").on(`keydown.zn.ui.components.dialog.${dialog.options.name}`,evt=>{27==evt.keyCode&&dialog.hide()})}removeDialogCloseEventHandlers(){$("body").off(`keydown.zn.ui.components.dialog.${this.options.name}`)}setupUI(){this.$target=$(this.options.target),this.$target.addClass("zn-dialog"),this.$target.attr("zn-dialog",this.options.name),this.options.centered&&this.$target.addClass("centered"),"N"!==this.options.wrap&&this.wrap(this.options),this.$wrapper=this.$target.find(".zn-dialog-wrapper"),this.$header=this.$target.find(".zn-dialog-header"),this.options.title?this.$header.text(this.options.title):this.$target.addClass("title-none"),this.$content=this.$target.find(".zn-dialog-content"),this.$footer=this.$target.find(".zn-dialog-footer"),this.options.actions?this.setActions(this.options.actions):this.$target.addClass("actions-none")}setTitle(title){this.options.title=title,this.$header.text(this.options.title)}wrap(){let content=this.$target.html();this.$target.html(Dialog.html()),this.$target.find(".zn-dialog-content").html(content)}setActions(actions){this.options.actions=actions,this.options.actions.forEach((a,i)=>{a.index=i}),this.$footer.find(".right-actions").html(Dialog.htmlActions(this.options.actions.filter(a=>null==a.slot||"right"===a.slot))),this.$footer.find(".left-actions").html(Dialog.htmlActions(this.options.actions.filter(a=>"left"===a.slot))),this.$target.removeClass("actions-none")}static get(name){return $(`[zn-dialog='${name}']`).get()[0].znc}static hide(){Dialog.instances&&Dialog.instances.forEach(dialog=>dialog.hide())}static html(options){return'\n      <div class="zn-dialog-wrapper">\n        <div class="zn-dialog-header"></div>\n        <div class="zn-dialog-content"></div>\n        <div class="zn-dialog-footer">\n          <div class="zn-actions left-actions"></div>\n          <div class="zn-actions right-actions"></div>\n        </div>\n      </div>'}static htmlIcon(icon){return`<i class="icon ${icon}"></i>`}static htmlAction(item){return`\n      <a class="zn-action" data-action="${item.action}" data-index="${item.index}">\n        ${item.icon?Dialog.htmlIcon(item.icon):""}<span class="text">${item.label||""}</span>\n      </a>`}static htmlActions(actions){return actions.reduce((a,c)=>a+Dialog.htmlAction(c),"")}static format(v,t,f){return null==t||null==f||""==f?v:"number"==t?numeral(v).format(f):"date"==t?moment(v).format(f):v}static pointInContent(point,content){var offset=content.offset();return point.x>=offset.left&&point.x<=offset.left+content.width()&&point.y>=offset.top&&point.y<=offset.top+content.height()}static extent(e){let dim={},htmlElement=$(e).get()[0];return dim.left=htmlElement.offsetLeft,dim.top=htmlElement.offsetTop,dim.width=htmlElement.offsetWidth,dim.height=htmlElement.offsetHeight,dim}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Dialog=Dialog}(window),function(window){let directive={html:function(){return'\n    <div>\n      <div class="zn-dialog-wrapper">\n        <div class="zn-dialog-header"></div>\n        <div class="zn-dialog-content"><ng-transclude></ng-transclude></div>\n        <div class="zn-dialog-footer">\n          <div class="zn-actions left-actions"></div>\n          <div class="zn-actions right-actions"></div>\n        </div>\n      </div>\n    </div>'},linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,wrap:"N",title:scope.dialogtitle,actions:scope.actions},dialog=new zn.ui.components.Dialog(options);dialog.on("init",evt=>{dialog.on("action",evt=>{scope.onaction({$event:evt})}),scope.$watch("actions",(nv,ov)=>{nv&&dialog.setActions(nv)})}),dialog.init()},tag:"znDialog",factory:function(){return{scope:{name:"@",source:"@",dialogtitle:"@",actions:"=",onaction:"&"},restrict:"A",transclude:!0,template:directive.html(),replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).dialog=directive}(window),function(window){class DropdownField{constructor(options){this.options=options,this.value=options.value,this.eventHandlers={}}init(){this.$target=$(this.options.target),this.$target.addClass("zn-dropdownfield"),this.$target.attr("zn-dropdownfield",this.options.name),this.options.error&&this.$target.addClass("error"),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.setValue(this.options.value),this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,evt.name=eventName,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setValue(value){this.value=value;let item=DropdownField.itemForValue(this.options.items,this.value);item?this.$value.text(item.label).removeClass("placeholder"):this.$value.text(this.options.placeholder||"").addClass("placeholder")}getValue(){return this.value}message(msg,type){let dropdownfield=this;""!=msg?(dropdownfield.$msg.text(msg),"error"==type?dropdownfield.$target.addClass("error"):dropdownfield.$target.addClass("message")):(dropdownfield.$msg.text(""),dropdownfield.$target.removeClass("error").removeClass("message"))}setupUI(){this.$target.html(DropdownField.html(this.options)),this.$value=this.$target.find(".value"),this.$input=this.$target.find(".zn-dropdownfield-input"),this.$items=this.$target.find(".zn-dropdownfield-items"),this.$msg=this.$target.find(".zn-dropdownfield-msg")}setupEventHandlers(){let dropdownfield=this;dropdownfield.$target.find(".zn-dropdownfield-input").on("keydown",evt=>{40==evt.keyCode&&(dropdownfield.$items.hasClass("showing")||dropdownfield.showDropdownMenuItems())}),dropdownfield.$target.find(".zn-dropdownfield-input").on("focus",evt=>{dropdownfield.$target.addClass("focused")}).on("blur",evt=>{dropdownfield.$target.removeClass("focused")}).on("click",evt=>{dropdownfield.showDropdownMenuItems()})}showDropdownMenuItems(){let dropdownfield=this;dropdownfield.$items.html(DropdownField.htmlDropdownMenu(dropdownfield.options.items)),dropdownfield.$items.addClass("showing");var $body=$("body");let hide=()=>{$body.off("mousedown.zn.ui.components.dropdownfield.itemspopup"),$body.off("keydown.zn.ui.components.dropdownfield.itemspopup"),dropdownfield.$items.hide(),dropdownfield.$items.removeClass("showing")};$body.on("mousedown.zn.ui.components.dropdownfield.itemspopup",evt=>{DropdownField.pointInContent({x:evt.pageX,y:evt.pageY},dropdownfield.$items)||hide()}),$body.on("keydown.zn.ui.components.dropdownfield.itemspopup",evt=>{27==evt.keyCode&&hide()}),dropdownfield.$items.find(".zn-dropdownfield-item").click(evt=>{let newValue=$(evt.currentTarget).attr("zn-value"),oldValue=dropdownfield.getValue();hide(),newValue!=oldValue&&(dropdownfield.setValue(newValue),dropdownfield.fireEvent("change",{newValue:newValue,oldValue:oldValue}))});let p=dropdownfield.$input.position(),w=dropdownfield.$input.width()+3,h=dropdownfield.$input.height(),top=p.top+h+12,left=p.left+3,ch=$(document).height();top+dropdownfield.$items.height()>ch&&(top=ch-dropdownfield.$items.height()-20),dropdownfield.$items.width(w).css("top",top+"px").css("left",left+"px").show()}static get(name){return $(`[zn-dropdownfield='${name}']`).get()[0].znc}static html(options){return`\n      ${options.label?DropdownField.htmlLabel(options.label):""}\n      <div class="zn-dropdownfield-input" tabindex="0"><span class="value placeholder">${options.placeholder}</span><span class="action"><i class="fas fa-caret-down"></i></span></div>\n      <div class="zn-dropdownfield-msg">${options.error||options.message||""}</div>\n      <div class="zn-dropdownfield-items"></div>\n      `}static htmlIcon(icon){return`<i class="icon ${icon}"></i>`}static htmlLabel(label){return`<div class="zn-dropdownfield-label">${label}</div>`}static htmlDropdownMenu(items){return items?items.reduce((a,item)=>a+`<a class="zn-dropdownfield-item" zn-value='${item.value}' title='${item.label}'><span class="zn-dropdownfield-item-text">${item.label}</span></a>`,""):""}static pointInContent(point,content){let offset=content.offset(),w=content.get()[0].offsetWidth;return point.x>=offset.left&&point.x<=offset.left+w&&point.y>=offset.top&&point.y<=offset.top+content.height()}static itemForValue(items,value){if(!items)return null;let result=items.filter(i=>i.value==value);return 0==result.length?null:result[0]}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).DropdownField=DropdownField}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){scope.$watch("items",(nv,ov)=>{if(!nv)return;let options={target:element,name:scope.name,label:scope.label,value:scope.value,items:scope.items,placeholder:scope.placeholder,error:scope.error?scope.error:"",message:scope.message},dropdownfield=new zn.ui.components.DropdownField(options);dropdownfield.on("init",()=>{dropdownfield.on("change",evt=>{scope.value=evt.newValue,scope.$apply(),scope.onchange&&scope.onchange({$event:evt})}),scope.$watch("value",(nv,ov)=>dropdownfield.setValue(nv)),scope.$watch("error",(nv,ov)=>dropdownfield.message(nv||"","error")),scope.$watch("message",(nv,ov)=>dropdownfield.message(nv,"message"))}),dropdownfield.init()})},tag:"znDropdownfield",factory:function(){return{scope:{name:"@",label:"@",placeholder:"@",value:"=",items:"=",error:"=",message:"=",onchange:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).dropdownfield=directive}(window),function(window){class List{constructor(options){this.options=options,this.eventHandlers={}}init(){this.$target=$(this.options.target),this.$target.addClass("zn-list"),this.$target.attr("zn-list",this.options.name),this.options.multiSelect&&this.$target.addClass("zn-multi-select"),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,evt.name=eventName,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setupUI(){this.$target.html(List.html()),this.$items=this.$target.find(".zn-list-items"),this.$listMore=this.$target.find(".zn-list-more"),this.options.items&&this.setItems(this.options.items),this.trackScroll(this.options.trackScroll)}setupEventHandlers(){let list=this;list.$target.on("mouseenter",".zn-list-items .zn-list-item",evt=>{$(evt.currentTarget).addClass("hover")}),list.$target.on("mouseleave",".zn-list-items .zn-list-item",evt=>{$(evt.currentTarget).removeClass("hover")}),list.$target.on("click",".zn-list-items .zn-list-item .zn-list-item-content",evt=>{list.$target.find(".zn-list-item.selected").removeClass("selected");let $item=$(evt.target).closest(".zn-list-item"),index=parseInt($item.attr("data-index")),item=list.options.items[index];$item.addClass("selected");let $checkbox=$item.find(".zn-multi-select .checkbox"),checked="Y"==$checkbox.attr("data-checked")?"N":"Y";$checkbox.attr("data-checked",checked),"Y"==checked?$item.addClass("checked"):$item.removeClass("checked"),list.fireEvent("select",{source:list,item:item,index:index}),list.options.multiSelect&&list.fireEvent("selection-change",{source:list,selection:list.getSelectedItems()})}),list.$target.on("click",".zn-list-items .zn-list-item .zn-action",evt=>{evt.preventDefault();let $action=$(evt.currentTarget),$item=$action.closest(".zn-list-item"),index=parseInt($item.attr("data-index")),item=list.options.items[index];list.fireEvent("item-action",{source:list,item:item,index:index,action:$action.attr("data-action")})})}setItems(items){this.options.items=items;let actionshtml=List.htmlActions(this.options.itemActions||[]),itemshtml=this.options.items.reduce((a,c,i)=>a+List.htmlItem(c,i,actionshtml),"");this.$items.html(itemshtml)}addItems(items){this.options.items=(this.options.items||[]).concat(items);let actionshtml=List.htmlActions(this.options.itemActions||[]),itemshtml=items.reduce((a,c,i)=>a+List.htmlItem(c,i,actionshtml),"");this.$items.append(itemshtml)}setItemActions(itemActions){this.options.itemActions=itemActions,this.$items.find(".zn-list-item-actions").html(List.htmlActions(this.options.itemActions||[]))}setupScrollTrackingEventHandler(){let list=this;List.trackScrollToEnd(()=>list.fireEvent("scroll-end",{}),list.$listMore,12,list.options.scrollContainer)}trackScroll(track){let list=this;list.options.scrollTracking=track,track?(list.setupScrollTrackingEventHandler(),list.$listMore.css("display","flex")):list.$listMore.hide()}getSelectedItems(){let list=this,selected={data:[],indexes:[]};return list.$target.find(".zn-list-item .checkbox[data-checked='Y']").each((i,e)=>{let $item=$(e),index=parseInt($item.attr("data-index"));selected.data.push(list.options.items[index]),selected.indexes.push(index)}),selected}static get(name){return $(`[zn-list='${name}']`).get()[0].znc}static html(){return'\n      <div class="zn-list-items">\n      </div>\n      <div class="zn-list-more"><div class="zn-loader-moon"></div></div>\n      '}static htmlItem(item,index,actions){return`\n      <div class="zn-list-item" data-index="${index}">\n        ${item.img?List.htmlImg(item.img):""}\n        <div class="zn-list-item-content">\n          <div class="text">\n            <span>${item.text}</span>\n            <div class="zn-multi-select">\n              <a class='checkbox' data-checked='N'>\n                <i class="far fa-check-circle unchecked"></i>\n                <i class="fas fa-check-circle checked"></i>\n                \x3c!--i class="far fa-square unchecked"></i><i class="fas fa-check-square checked"></i--\x3e\n              </a>\n            </div>\n          </div>\n          <div class="subtext">${item.subtext}</div>\n        </div>\n        <div class="zn-list-item-actions">\n          ${actions}\n        </div>\n      </div>\n      `}static htmlIcon(icon){return`<i class="icon ${icon}"></i>`}static htmlImg(img){return`<div class="img"><img class="img" src='${img}'/></div>`}static htmlActions(actions){return actions.reduce((a,item)=>a+`\n        <a href='#action' class="zn-action" data-action='${item.action}' title='${item.label}'><i class="${item.icon}"></i></a>\n      `,"")}static trackScrollToEnd(eh,$marker,threshold,container){let $scrollContainer=$(window),containerType="window";container&&($scrollContainer=$(container),containerType="custom");let ehid=(new Date).getTime();$scrollContainer.on(`scroll.${ehid}`,evt=>{let containerHeight=$scrollContainer.height(),p=$marker.position(),containerScrollTop=$scrollContainer.scrollTop();containerHeight+("window"==containerType?containerScrollTop:"static"==$scrollContainer.css("position")?$scrollContainer.position().top:0)-p.top>threshold&&($scrollContainer.off(`scroll.${ehid}`),eh())})}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).List=List}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,items:scope.items,itemActions:scope.itemactions,multiSelect:"true"==scope.multiselect,trackScroll:"true"==scope.trackscroll,scrollContainer:scope.scrollcontainer},list=new zn.ui.components.List(options);list.on("init",()=>{list.on("select",evt=>scope.onselect({$event:evt})),list.on("selection-change",evt=>scope.onselectionchange({$event:evt})),list.on("item-action",evt=>scope.onitemaction({$event:evt})),list.on("scroll-end",evt=>scope.onscrollend({$event:evt})),scope.$watch("items",(nv,ov)=>{nv&&list.setItems(nv)}),scope.$watch("itemactions",(nv,ov)=>{nv&&list.setItemActions(nv)})}),list.init()},tag:"znList",factory:function(){return{scope:{name:"@",items:"=",itemactions:"=",multiselect:"@",trackscroll:"@",scrollcontainer:"@",onselect:"&",onselectionchange:"&",onitemaction:"&",onscrollend:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).list=directive}(window),function(window){class Popup{constructor(options){this.options=options,this.eventHandlers={},(Popup.instances=Popup.instances||[]).push(this)}init(){this.setupUI(),this.$target.get()[0].znc=this,this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}show(showAtLoc){let popup=this,top=0,left=0;if(popup.$target.show(),popup.setupEventHandlers(),showAtLoc)left=showAtLoc.left,top=showAtLoc.top;else if(popup.options.showAt){let $source=$(popup.options.source),sourceExtent=Popup.extent($source),popupExtent=Popup.extent(popup.$target);top=sourceExtent.top,left=sourceExtent.left,"bottom"==popup.options.showAt&&(top+=sourceExtent.height+3),"top"==popup.options.showAt&&(top-=popupExtent.height+3),"right"==popup.options.showAt&&(left+=sourceExtent.width+3),"left"==popup.options.showAt&&(left-=popupExtent.width+3),popup.options.snap&&popup.$target.width($source.width()),popupExtent=Popup.extent(popup.$target);let bodyExtent=Popup.extent($("body"));top+popupExtent.height>bodyExtent.height&&(top=bodyExtent.height-popupExtent.height-10),left+popupExtent.width>bodyExtent.width&&(left=bodyExtent.width-popupExtent.width-10)}popup.$target.css("left",left+"px"),popup.$target.css("top",top+"px"),popup.$target.addClass("showing")}hide(){this.removeEventHandlers(),this.$target.hide(),this.$target.removeClass("showing")}setupEventHandlers(){let popup=this;var $body=$("body");$body.on(`mousedown.zn.ui.components.popup.${popup.options.name}`,evt=>{let p={x:evt.pageX,y:evt.pageY},$a=popup.$target,$b=popup.$source||popup.$target;Popup.pointInContent(p,$a)||Popup.pointInContent(p,$b)||popup.hide()}),$body.on(`keydown.zn.ui.components.popup.${popup.options.name}`,evt=>{27==evt.keyCode&&popup.hide()})}removeEventHandlers(){var $body=$("body");$body.off(`mousedown.zn.ui.components.popup.${this.options.name}`),$body.off(`keydown.zn.ui.components.popup.${this.options.name}`)}setupUI(){this.$target=$(this.options.target),this.$target.addClass("zn-popup"),this.$target.attr("zn-popup",this.options.name)}static get(name){return $(`[zn-popup='${name}']`).get()[0].znc}static hide(){Popup.instances&&Popup.instances.forEach(popup=>popup.hide())}static htmlPopup(){return""}static pointInContent(point,content){var offset=content.offset();let w=content.get()[0].offsetWidth;return point.x>=offset.left&&point.x<=offset.left+w&&point.y>=offset.top&&point.y<=offset.top+content.height()}static extent(e){let dim={},htmlElement=$(e).get()[0];return dim.left=htmlElement.offsetLeft,dim.top=htmlElement.offsetTop,dim.width=htmlElement.offsetWidth,dim.height=htmlElement.offsetHeight,dim}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Popup=Popup}(window),function(window){let directive={html:function(){return"<div><ng-transclude></ng-transclude></div>"},linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,source:scope.source,snap:"Y"==scope.snap,showAt:scope.showat};new zn.ui.components.Popup(options).init()},tag:"znPopup",factory:function(){return{scope:{name:"@",source:"@",snap:"@",showat:"@"},restrict:"A",transclude:!0,template:directive.html(),replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).popup=directive}(window),function(window){class RadioGroup{constructor(options){this.options=options,this.value=options.value,this.eventHandlers={},this.options.values=this.options.values||{on:!0,off:!1}}init(){this.$target=$(this.options.target),this.$target.addClass("zn-radiogroup"),this.$target.attr("zn-radiogroup",this.options.name),"horizontal"===this.options.layout&&this.$target.addClass("horizontal"),this.options.error&&this.$target.addClass("error"),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.setValue(this.options.value),this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,evt.name=eventName,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setValue(value){this.options.value=value,this.value=value,this.$input.find(".zn-radiogroup-item[data-state='on']").attr("data-state","off"),this.value&&this.$input.find(`.zn-radiogroup-item[data-value='${this.value}']`).attr("data-state","on")}getValue(){return this.value}message(msg,type){let radiogroup=this;""!=msg?(radiogroup.$msg.text(msg),"error"==type?radiogroup.$target.addClass("error"):radiogroup.$target.addClass("message")):(radiogroup.$msg.text(""),radiogroup.$target.removeClass("error").removeClass("message"))}setupUI(){this.$target.html(RadioGroup.html(this.options)),this.$input=this.$target.find(".zn-radiogroup-input"),this.$msg=this.$target.find(".zn-radiogroup-msg")}setupEventHandlers(){let radiogroup=this;radiogroup.$target.find(".zn-radiogroup-input").on("click",".zn-radiogroup-item",evt=>{radiogroup.$target.find(".zn-radiogroup-input .zn-radiogroup-item[data-state='on']").attr("data-state","off");let $item=$(evt.currentTarget);$item.attr("data-state","on");let oldValue=radiogroup.value,newValue=RadioGroup.itemForValue(radiogroup.options.items,$item.attr("data-value")).value;radiogroup.value=newValue,radiogroup.fireEvent("change",{newValue:newValue,oldValue:oldValue})}).on("keypress",".zn-radiogroup-item",evt=>{if(32!=evt.keyCode)return;radiogroup.$target.find(".zn-radiogroup-input .zn-radiogroup-item[data-state='on']").attr("data-state","off");let $item=$(evt.currentTarget);$item.attr("data-state","on");let oldValue=radiogroup.value,newValue=RadioGroup.itemForValue(radiogroup.options.items,$item.attr("data-value")).value;radiogroup.value=newValue,radiogroup.fireEvent("change",{newValue:newValue,oldValue:oldValue})}),radiogroup.$target.find(".zn-radiogroup-input").on("focus",".zn-radiogroup-item",evt=>{$(evt.currentTarget).addClass("focused")}),radiogroup.$target.find(".zn-radiogroup-input").on("blur",".zn-radiogroup-item",evt=>{$(evt.currentTarget).removeClass("focused")})}static get(name){return $(`[zn-radiogroup='${name}']`).get()[0].znc}static html(options){return`\n      ${options.label?RadioGroup.htmlLabel(options.label):""}\n      <div class="zn-radiogroup-input">\n        ${RadioGroup.htmlItems(options.items,options.value)}\n      </div>\n      <div class="zn-radiogroup-msg">${options.error||options.message||""}</div>\n      `}static htmlIcon(icon){return`<i class="icon ${icon}"></i>`}static htmlLabel(label){return`<div class="zn-radiogroup-label">${label}</div>`}static htmlItems(items,value){return items.reduce((a,c)=>a+RadioGroup.htmlItem(c,value),"")}static htmlItem(item,value){return`\n      <div class="zn-radiogroup-item" tabindex="0" data-state="${item.value==value?"on":"off"}" data-value="${item.value}">\n        <i class="state-off far fa-circle"></i><i class="state-on fas fa-check-circle"></i>\n        <span class="text">${item.label}</span>\n      </div>\n      `}static itemForValue(items,value){let result=items.filter(i=>i.value==value);return 0==result.length?null:result[0]}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).RadioGroup=RadioGroup}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){scope.$watch("items",(nv,ov)=>{if(!nv)return;let options={target:element,name:scope.name,label:scope.label,value:scope.value,items:nv,layout:scope.layout,error:scope.error?scope.error:"",message:scope.message},radiogroup=new zn.ui.components.RadioGroup(options);radiogroup.on("init",()=>{radiogroup.on("change",evt=>{scope.value=evt.newValue,scope.$apply(),scope.onchange&&scope.onchange({$event:evt})}),scope.$watch("value",(nv,ov)=>radiogroup.setValue(nv)),scope.$watch("error",(nv,ov)=>radiogroup.message(nv||"","error")),scope.$watch("message",(nv,ov)=>radiogroup.message(nv,"message"))}),radiogroup.init()})},tag:"znRadiogroup",factory:function(){return{scope:{name:"@",label:"@",value:"=",items:"=",layout:"@",error:"=",message:"=",onchange:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).radiogroup=directive}(window),function(window){class Table{constructor(options){this.options=options,this.isEmpty=!0,this.dataOptions={filters:[],sort:{},pageSize:options.pageSize},this.eventHandlers={}}init(){let table=this;table.$target=$(table.options.target),table.fixedCols=[],table.scrollableCols=[],table.options.columns.forEach((col,index)=>{if(col.index=index+1,!0===col.fixed?table.fixedCols.push(col):table.scrollableCols.push(col),!0===col.filtered){let filterstate={index:index,field:col.field};col.selectedValues&&col.selectedValues.length>0&&(filterstate.selectedValues=col.selectedValues),!0===col.includeBlanks&&(filterstate.includeBlanks=col.includeBlanks),(filterstate.selectedValues||filterstate.includeBlanks)&&table.dataOptions.filters.push(filterstate)}!0===col.sorted&&(table.dataOptions.sort={index:index,field:col.field,order:col.sortOrder})}),table.dataOptions.pageSize=table.options.pageSize,table.name=table.options.name,table.$target.addClass("zn-table"),table.$target.attr("zn-table",table.name),table.options.multiSelect&&table.$target.addClass("zn-table-multi-select"),table.options.fill&&table.$target.addClass("zn-table-fill"),table.options.containerScroll&&table.$target.addClass("zn-table-container-scroll"),table.options.rowActions&&table.$target.addClass("zn-table-row-actions"),table.options.actions&&table.options.actions.length>0&&table.$target.addClass("zn-table-actions"),table.options.paging&&table.$target.addClass("zn-table-pagination"),table.setupUI(),table.setupEventHandlers(),table.options.rows&&(table.baseRows=JSON.stringify(table.options.rows),table.getData("init",table.dataOptions,rows=>{table.setRows(rows)})),table.$target.get()[0].znc=table,table.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}initRows(rows){let table=this;table.options.rows=rows,table.baseRows=JSON.stringify(table.options.rows),table.getData("init",table.dataOptions,rows=>{table.setRows(rows)})}setupUI(){let table=this;table.$target.html(Table.html()),table.$fixed=table.$target.find(".zn-table-fixed"),table.$fixedHeader=table.$target.find(".zn-table-fixed-header"),table.$fixedContent=table.$target.find(".zn-table-fixed-content"),table.$scrollable=table.$target.find(".zn-table-scrollable"),table.$scrollableHeader=table.$target.find(".zn-table-scrollable-header"),table.$scrollableContent=table.$target.find(".zn-table-scrollable-content"),table.$rowActionsMenu=table.$target.find(".zn-row-actions-menu"),table.$filterPopup=table.$target.find(".zn-table-filter-popup"),table.$footer=table.$target.find(".zn-table-footer"),table.$pageNumbers=table.$target.find(".zn-table-page-numbers"),table.$actions=table.$target.find(".zn-table-actions"),table.$fixedHeader.html(Table.htmlFixedHeader(table.fixedCols)),table.$scrollableHeader.html(Table.htmlScrollableHeader(table.scrollableCols)),table.options.headerHeight&&(table.$fixedHeader.height(table.options.headerHeight),table.$fixedContent.css("top",table.options.headerHeight+"px"),table.$fixedHeader.find(".zn-table-row").height(table.options.headerHeight),table.$scrollableHeader.height(table.options.headerHeight),table.$scrollableContent.css("top",table.options.headerHeight+"px"),table.$scrollableHeader.find(".zn-table-row").height(table.options.headerHeight)),table.options.rowHeight&&(table.$fixedContent.find(".zn-table-row").height(table.options.rowHeight),table.$scrollableContent.find(".zn-table-row").height(table.options.rowHeight));let fixedWidth=0;table.options.rowActions&&(fixedWidth+=30),table.options.multiSelect&&(fixedWidth+=30),fixedWidth=table.fixedCols.reduce((a,c)=>a+c.width,fixedWidth),table.$fixed.width(fixedWidth),0==fixedWidth&&table.$fixed.hide(),table.options.actions&&table.options.actions.length>0&&table.$actions.html(Table.htmlTableActions(table.options.actions))}setupEventHandlers(){let table=this;table.$scrollableContent.on("scroll",evt=>{let left=table.$scrollableContent.scrollLeft(),top=table.$scrollableContent.scrollTop();table.$scrollableHeader.scrollLeft(left),table.$fixedContent.scrollTop(top)}),table.$fixedHeader.find(".zn-table-cell.multi-select .checkbox").click(evt=>{evt.preventDefault();let $checkbox=$(evt.currentTarget),checked="Y"==$checkbox.attr("data-checked")?"N":"Y";$checkbox.attr("data-checked",checked),table.$fixedContent.find(".zn-table-cell.multi-select .checkbox").attr("data-checked",checked),table.fireEvent("row-selection-change",{source:table,selection:table.getSelectedRows()})}),table.$actions.find(".zn-table-action").on("click",evt=>{evt.preventDefault();let action=$(evt.currentTarget).attr("data-action");table.fireEvent("action",{action:action})}),table.setupRowSelectionEventHandlers(),table.setupColHeaderEventHandlers(),table.setupFilterPopupEventHandlers(),table.setupPaginationEventHandlers()}setupRowSelectionEventHandlers(){let table=this;table.$target.on("mouseenter",".zn-table-fixed-content .zn-table-row, .zn-table-scrollable-content .zn-table-row",evt=>{if(table.isEmpty)return;let index=$(evt.currentTarget).attr("data-row"),$rows=table.$target.find(`.zn-table-row[data-row='${index}']`);$rows.addClass("hover"),table.eventHandlers["row-select"]&&$rows.addClass("select")}),table.$target.on("mouseleave",".zn-table-fixed-content .zn-table-row, .zn-table-scrollable-content .zn-table-row",evt=>{if(table.isEmpty)return;let index=$(evt.currentTarget).attr("data-row");table.$target.find(`.zn-table-row[data-row='${index}']`).removeClass("hover").removeClass("select")}),table.$target.on("click",".zn-table-fixed-content .zn-table-row, .zn-table-scrollable-content .zn-table-row",evt=>{if(table.isEmpty)return;evt.preventDefault();let $cell=$(evt.target).closest(".zn-table-cell"),index=$cell.closest(".zn-table-row").attr("data-row");if("0"==$cell.attr("data-col")){if($cell.hasClass("actions")){let action=$cell.find("[zn-row-action]").attr("zn-row-action");"zn-table:show-actions"==action?table.showRowActionsMenu($cell,index):table.fireEvent("row-action",{source:table,action:action,rowsIndex:index,row:table.rows[index]})}if($cell.hasClass("multi-select")){let $checkbox=$cell.find(".checkbox");"Y"==$checkbox.attr("data-checked")?$checkbox.attr("data-checked","N"):$checkbox.attr("data-checked","Y"),table.fireEvent("row-selection-change",{source:table,selection:table.getSelectedRows()})}}else table.eventHandlers["row-select"]&&(table.selectedRowIndex=index,table.$target.find(".zn-table-row.selected").removeClass("selected"),table.$target.find(`.zn-table-row[data-row='${index}']`).addClass("selected"),table.fireEvent("row-select",{source:table,index:index,row:table.rows[index]}))})}setupColHeaderEventHandlers(){let table=this;table.$target.on("click",".zn-table-fixed-header .col-header-action, .zn-table-scrollable-header .col-header-action",evt=>{evt.preventDefault();let $colHeaderAction=$(evt.currentTarget),action=$colHeaderAction.attr("data-action"),colIndex=parseInt($colHeaderAction.attr("data-col-index"))-1;"sort"==action&&table.sort(colIndex,table.options.columns[colIndex]),"filter"==action&&table.filter(colIndex,table.options.columns[colIndex])})}setupFilterPopupEventHandlers(){let table=this;table.$filterPopup.on("click",".filter-actions .filter-action",evt=>{evt.preventDefault();let ctx=table.$filterPopup.ctx,filterAction=$(evt.currentTarget).attr("zn-filter-action");table.hideFilterPopup();let $selectAllCheckbox=table.$filterPopup.find(".lov .lov-action[zn-lov-action='select-all'] .checkbox"),$blanksCheckbox=table.$filterPopup.find(".lov .lov-action[zn-lov-action='blanks'] .checkbox");if("apply"==filterAction)if("Y"!=$selectAllCheckbox.attr("data-checked")){let selectedValues=[];table.$filterPopup.find(".items .checkbox[data-checked='Y']").each((i,e)=>selectedValues.push($(e).attr("data-value"))),table.addFilter(ctx.index,ctx.column,selectedValues,"Y"==$blanksCheckbox.attr("data-checked")),table.$target.find(`.zn-table-header-cell[data-col='${ctx.index+1}'] .actions .filter`).attr("data-state","on")}else table.removeFilter(ctx.index,ctx.column),table.$target.find(`.zn-table-header-cell[data-col='${ctx.index+1}'] .actions .filter`).attr("data-state","off");"clear"==filterAction&&(table.removeFilter(ctx.index,ctx.column),table.$target.find(`.zn-table-header-cell[data-col='${ctx.index+1}'] .actions .filter`).attr("data-state","off"))}),table.$filterPopup.on("click",".search-input .close",evt=>{evt.preventDefault(),table.hideFilterPopup()}),table.$filterPopup.on("keydown",".search-input input",evt=>{if(13!=evt.keyCode)return;let ctx=table.$filterPopup.ctx,val=$(evt.target).val();if(""!=val){let options={includeScore:!0,ignoreLocation:!0,threshold:.4},fuse=new Fuse(ctx.lov,options);table.$filterPopup.find(".items").html(Table.htmlFilterLovItems(fuse.search(val).map(i=>i.item))),table.$filterPopup.find(".lov-action[zn-lov-action='blanks']").addClass("na")}else table.$filterPopup.find(".items").html(Table.htmlFilterLovItems(ctx.lov)),ctx.hasBlanks&&table.$filterPopup.find(".lov-action[zn-lov-action='blanks']").removeClass("na");table.$filterPopup.find(".lov-action[zn-lov-action='select-all'] .checkbox").attr("data-checked","Y")}),table.$filterPopup.on("click",".lov .lov-actions .lov-action",evt=>{let ctx=table.$filterPopup.ctx,$lovAction=$(evt.currentTarget),$checkbox=$lovAction.find(".checkbox"),checked="N"==$checkbox.attr("data-checked")?"Y":"N";$checkbox.attr("data-checked",checked);let action=$lovAction.attr("zn-lov-action"),$selectAllCheckbox=table.$filterPopup.find(".lov .lov-action[zn-lov-action='select-all'] .checkbox"),$blanksCheckbox=table.$filterPopup.find(".lov .lov-action[zn-lov-action='blanks'] .checkbox");"select-all"==action&&(table.$filterPopup.find(".lov .items .checkbox").attr("data-checked",checked),$blanksCheckbox.attr("data-checked",checked)),"blanks"==action&&(table.$filterPopup.find(".lov .items .checkbox[data-checked='Y']").get().length==ctx.lov.length&&"Y"==checked?$selectAllCheckbox.attr("data-checked","Y"):$selectAllCheckbox.attr("data-checked","N"))}),table.$filterPopup.on("click",".lov .items .item",evt=>{let ctx=table.$filterPopup.ctx,$checkbox=$(evt.currentTarget).find(".checkbox"),checked="N"==$checkbox.attr("data-checked")?"Y":"N";$checkbox.attr("data-checked",checked);let $selectAllCheckbox=table.$filterPopup.find(".lov .lov-action[zn-lov-action='select-all'] .checkbox"),$blanksCheckbox=table.$filterPopup.find(".lov .lov-action[zn-lov-action='blanks'] .checkbox");table.$filterPopup.find(".lov .items .checkbox[data-checked='Y']").get().length==ctx.lov.length&&"Y"==$blanksCheckbox.attr("data-checked")?$selectAllCheckbox.attr("data-checked","Y"):$selectAllCheckbox.attr("data-checked","N")})}setupPaginationEventHandlers(){let table=this;table.$footer.on("click",".zn-table-page-number",evt=>{evt.preventDefault();let page=$(evt.currentTarget).attr("data-page");"previous"==page?1==table.dataOptions.page||table.dataOptions.page--:"next"==page?table.dataOptions.page==table.numPages||table.dataOptions.page++:table.dataOptions.page=parseInt(page),table.getData("page",table.dataOptions,rows=>{table.setRows(rows)})})}setRows(rows){let table=this;table.rows=rows;let content=Table.htmlContent(rows,table.fixedCols,table.scrollableCols,table.options.rowActions,table.options.multiSelect);table.$fixedContent.html(content.fixed),table.$scrollableContent.html(content.scrollable),table.$target.hasClass("zn-table-fill")||table.$target.hasClass("zn-table-container-scroll")||table.$scrollableHeader.find(".zn-table-row").width(table.$scrollableContent.find(".zn-table-row[data-row='0']").width()+10),table.options.headerHeight&&(table.$fixedHeader.height(table.options.headerHeight),table.$fixedContent.css("top",table.options.headerHeight),table.$scrollableHeader.height(table.options.headerHeight),table.$scrollableContent.css("top",table.options.headerHeight)),table.options.rowHeight&&table.$target.find(".zn-table-row").height(table.options.rowHeight);let fixedWidth=0;table.options.rowActions&&(fixedWidth+=30,table.$target.find(".zn-table-cell.actions").show()),table.options.multiSelect&&(fixedWidth+=30,table.$target.find(".zn-table-cell.multi-select").show()),fixedWidth=table.fixedCols.reduce((a,c)=>a+c.width,fixedWidth),table.$fixed.width(fixedWidth),0==fixedWidth&&table.$fixed.hide(),rows.length>0&&(table.isEmpty=!1),table.options.paging&&table.setPages()}setRowActions(rowActions){let table=this;table.options.rowActions=rowActions;let rowActionsHTML="";rowActions&&rowActions.length>0&&(rowActionsHTML=rowActions.length>1?Table.htmlRowAction({action:"zn-table:show-actions",label:"Show Actions",icon:"fas fa-bars"}):Table.htmlRowAction(rowActions[0]),table.$fixedContent.find(".zn-table-cell.actions").html(rowActionsHTML));let fixedWidth=0;table.options.rowActions&&(fixedWidth+=30,table.$target.find(".zn-table-cell.actions").show()),table.options.multiSelect&&(fixedWidth+=30,table.$target.find(".zn-table-cell.multi-select").show()),fixedWidth=table.fixedCols.reduce((a,c)=>a+c.width,fixedWidth),table.$fixed.width(fixedWidth),0==fixedWidth&&table.$fixed.hide()}showRowActionsMenu($cell,index){let table=this,actionMenuItems=Table.htmlActionsMenu(table.options.rowActions);table.$rowActionsMenu.html(actionMenuItems);var $body=$("body");let hide=()=>{$body.off("mousedown.zn.ui.components.table.menupopup"),$body.off("keydown.zn.ui.components.table.menupopup"),table.$rowActionsMenu.hide()};$body.on("mousedown.zn.ui.components.table.menupopup",evt=>{Table.pointInContent({x:evt.pageX,y:evt.pageY},table.$rowActionsMenu)||hide()}),$body.on("keydown.zn.ui.components.table.menupopup",evt=>{27==evt.keyCode&&hide()}),table.$rowActionsMenu.find(".zn-popup-menu-item").click(evt=>{let action=$(evt.currentTarget).attr("zn-row-action");hide(),table.fireEvent("row-action",{source:table,action:action,rowIndex:index,row:table.rows[index]})});let p=$cell.position(),tp=table.$target.position(),top=(table.$target.width(),table.$target.height(),tp.top+p.top+table.$fixedHeader.height()+2),left=tp.left+p.left+2,ch=$(document).height();top+table.$rowActionsMenu.height()>ch&&(top=ch-table.$rowActionsMenu.height()-5),table.$rowActionsMenu.css("top",top+"px").css("left",left+"px").show()}setPages(){let pageNumbers=[],p=this.dataOptions.page,numPages=this.numPages,s=p-2<1?1:p-2,e=s+4;for(e>numPages&&(e=numPages,s=numPages-4),s<1&&(s=1);s<=e;)pageNumbers.push(s++);this.$pageNumbers.html(Table.htmlPages(pageNumbers,p))}getSelectedRows(){let table=this,selected={data:[],indexes:[]};return table.$fixedContent.find(".zn-table-cell.multi-select .checkbox[data-checked='Y']").each((i,e)=>{let index=$(e).parent().parent().attr("data-row");selected.data.push(table.rows[index]),selected.indexes.push(index)}),selected}sort(colIndex,column){let table=this,sort=table.dataOptions.sort;sort.field&&table.$target.find(`.zn-table-header-cell[data-col='${sort.index+1}'] .actions .sort`).removeAttr("data-state").removeAttr("data-sort"),sort.field=column.field,sort.order&&sort.index==colIndex?sort.order="asc"==sort.order?"desc":"asc":sort.order="asc",sort.index=colIndex,table.getData("sort",table.dataOptions,rows=>{table.$target.find(`.zn-table-header-cell[data-col='${colIndex+1}'] .actions .sort`).attr("data-state","on").attr("data-sort",sort.order),table.setRows(rows),table.$scrollableContent.scrollTop(0)})}filter(colIndex){let table=this,$headerCell=table.$target.find(`.zn-table-header-cell[data-col='${colIndex+1}']`),column=table.options.columns[colIndex],filterstate={selectedValues:null,includeBlanks:null};table.dataOptions.filters.forEach(f=>{f.index==colIndex&&(filterstate=f)}),table.getLovs({filters:table.dataOptions.filters,index:colIndex,column:column},results=>{table.showFilterPopup($headerCell,colIndex,column,results.list,results.hasBlanks,filterstate)})}showFilterPopup($cell,index,column,lov,hasBlanks,filterstate){let table=this,popContent=Table.htmlFilterPopup(column.label,lov,hasBlanks,filterstate);table.$filterPopup.html(popContent),table.$filterPopup.ctx={$cell:$cell,index:index,column:column,lov:lov,hasBlanks:hasBlanks,filterstate:filterstate};var $body=$("body");$body.on("mousedown.zn.ui.components.table.filterpopup",evt=>{Table.pointInContent({x:evt.pageX,y:evt.pageY},table.$filterPopup)||table.hideFilterPopup()}),$body.on("keydown.zn.ui.components.table.filterpopup",evt=>{27==evt.keyCode&&table.hideFilterPopup()});let $header=$cell.parent().parent(),offset=$header.position().left;$header.hasClass("zn-table-scrollable-header")&&(offset+=table.$fixed.width());let p=$cell.position(),tp=table.$target.position(),top=(table.$target.width(),table.$target.height(),tp.top+p.top+2),left=tp.left+p.left+2+offset,cw=($(document).height(),$(document).width());left+table.$filterPopup.width()>cw&&(left=cw-table.$filterPopup.width()-5),table.$filterPopup.css("top",top+"px").css("left",left+"px").css("display","flex")}hideFilterPopup(){var $body=$("body");$body.off("mousedown.zn.ui.components.table.filterpopup"),$body.off("keydown.zn.ui.components.table.filterpopup"),this.$filterPopup.hide()}addFilter(index,column,selectedValues,includeBlanks){let table=this,filters=table.dataOptions.filters.reduce((a,c)=>(c.field!=column.field&&a.push(c),a),[]);table.dataOptions.filters=filters,filters.push({index:index,field:column.field,selectedValues:selectedValues,includeBlanks:includeBlanks}),table.getData("filter-add",table.dataOptions,rows=>{table.setRows(rows),table.$scrollableContent.scrollTop(0)})}removeFilter(index,column){let table=this,filters=table.dataOptions.filters.reduce((a,c)=>(c.field!=column.field&&a.push(c),a),[]);table.dataOptions.filters=filters,table.getData("filter-remove",table.dataOptions,rows=>{table.setRows(rows),table.$scrollableContent.scrollTop(0)})}filterRows(rows,filters,l){return rows.reduce((a,row)=>{let match=!0;for(let i=0;i<=l&&match;i++){let value=row[filters[i].field];match=filters[i].selectedValues.includes(""+value)||filters[i].includeBlanks&&(null==value||""==value)}return match&&a.push(row),a},[])}sortRows(rows,sort){rows.sort((a,b)=>{let va=a[sort.field],vb=b[sort.field];return va<vb?"asc"==sort.order?-1:1:va>vb?"asc"==sort.order?1:-1:0})}getLovs(ctx,$$){let rows=JSON.parse(this.baseRows),hasBlanks=!1,lim=ctx.filters.length-1;ctx.filters.length>0&&ctx.index==ctx.filters[ctx.filters.length-1].index&&lim--;let map=this.filterRows(rows,ctx.filters,lim).reduce((a,c)=>{let value=c[ctx.column.field];return value&&""!=value?a[c[ctx.column.field]]=value:hasBlanks=!0,a},{}),list=Object.keys(map);list.sort(),$$({list:list,hasBlanks:hasBlanks})}getData(evt,dataOptions,$$){let table=this,processedRows=null,ps=dataOptions.pageSize;if(["init","sort","filter-add","filter-remove"].includes(evt)){let rows=JSON.parse(table.baseRows);processedRows=table.filterRows(rows,dataOptions.filters,dataOptions.filters.length-1),table.sortRows(processedRows,dataOptions.sort),table.processedRows=JSON.stringify(processedRows),dataOptions.page=1,ps&&(table.numPages=Math.floor(processedRows.length/ps)+(processedRows.length%ps?1:0))}let pageRows=processedRows||JSON.parse(table.processedRows);if(table.options.paging){let p=dataOptions.page;ps&&p&&(pageRows=pageRows.slice(-1==ps?0:(p-1)*ps,-1==ps?pageRows.length-1:p*ps))}$$(pageRows)}static get(name){return $(`[zn-table='${name}']`).get()[0].znc}static html(){return'\n      <div class="zn-table-content">\n        <div class="zn-table-fixed">\n          <div class="zn-table-fixed-header"></div>\n          <div class="zn-table-fixed-content"></div>\n        </div>\n        <div class="zn-table-scrollable">\n          <div class="zn-table-scrollable-header"></div>\n          <div class="zn-table-scrollable-content"></div>\n        </div>\n      </div>\n      <div class="zn-table-footer"><div class="zn-table-actions"></div><div class="zn-table-page-numbers"></div></div>\n      <div class="zn-row-actions-menu zn-popup-menu-items"></div>\n      <div class="zn-table-filter-popup"></div>\n      '}static htmlCell(index,value,w){let style="";return w&&(style=`width: ${w}px; flex-grow: 0; flex-basis: unset;`),`<div class="zn-table-cell col-${index}" data-col='${index}' style='${style}' title="${value||""}">${value||"-"}</div>`}static htmlHeaderCell(col){let style="";return col.width&&(style=`width: ${col.width}px; flex-grow: 0; flex-basis: unset;`),`\n      <div class="zn-table-cell zn-table-header-cell col-${col.index}" data-col='${col.index}' style='${style}' title="${col.label}">\n        <div class="text">${col.label}</div>\n        <div class="actions">\n          <span class="filter ${!0===col.filterable?"filterable":""}" data-state="${!0===col.filtered?"on":""}" data-col-index="${col.index}">\n            <a href='#filter' class="col-header-action" data-action="filter" data-col-index="${col.index}" title="Filter"><i class="fas fa-filter"></i></a>\n          </span>\n          <span class="sort ${!0===col.sortable?"sortable":""}" data-state="${!0===col.sorted?"on":""}" data-sort="${col.sortOrder}" data-col-index="${col.index}">\n            <a href='#sort-ascending' class="asc col-header-action" data-action="sort" data-col-index="${col.index}" title="Sort"><i class="fas fa-arrow-up"></i></a>\n            <a href='#sort-descending' class="desc col-header-action" data-action="sort" data-col-index="${col.index}" title="Sort"><i class="fas fa-arrow-down"></i></a>\n          </span>\n        </div>\n      </div>`}static htmlFixedHeader(cols){return`<div class="zn-table-row">\n         <div class="zn-table-cell zn-table-header-cell col-0 actions">&nbsp;</div>\n         <div class="zn-table-cell zn-table-header-cell col-0 multi-select">${Table.htmlMultiSelect()}</div>\n         ${cols.reduce((a,c)=>a+Table.htmlHeaderCell(c),"")}\n       </div>`}static htmlScrollableHeader(cols){return`<div class="zn-table-row">\n        ${cols.reduce((a,c)=>a+Table.htmlHeaderCell(c),"")}\n       </div>`}static htmlActionsMenu(actions){return actions.reduce((a,item)=>a+`<a class="zn-popup-menu-item" zn-row-action='${item.action}' title='${item.label}'><i class="${item.icon}"></i><span class="zn-popup-menu-item-text">${item.label}</span></a>`,"")}static htmlRowAction(a){return`<a href='#action' class="zn-row-action" zn-row-action='${a.action}' title='${a.label}'><i class="${a.icon}"></i></a>`}static htmlMultiSelect(){return"<a href='#select' class='checkbox' data-checked='N'><i class=\"far fa-square unchecked\"></i><i class=\"fas fa-check-square checked\"></i></a>"}static htmlContentRow(row,rowIndex,fixedcols,scrollablecols,rowActionsHTML,multiSelectHTML){let rc=rowIndex%2==0?"odd":"even";return{fixed:`\n      <div class="zn-table-row ${rc}" data-row='${rowIndex}'>\n        ${rowActionsHTML?`<div class="zn-table-cell col-0 actions" data-col='0'>${rowActionsHTML}</div>`:""}\n        ${multiSelectHTML?`<div class="zn-table-cell col-0 multi-select" data-col='0'>${row?multiSelectHTML:"&nbsp;"}</div>`:""}\n        ${fixedcols.reduce((a,c)=>a+Table.htmlCell(c.index,row?c.field&&row[c.field]?Table.format(row[c.field],c.type,c.format):"-":" ",c.width),"")}\n      </div>\n      `,scrollable:`\n      <div class="zn-table-row ${rc}" data-row='${rowIndex}'>\n        ${scrollablecols.reduce((a,c)=>a+Table.htmlCell(c.index,row?c.field&&row[c.field]?Table.format(row[c.field],c.type,c.format):"-":" ",c.width),"")}\n      </div>`}}static htmlContent(rows,fixedcols,scrollablecols,actions,multiselect){let rowActionsHTML=null;actions&&actions.length>0&&(rowActionsHTML=Table.htmlRowAction(1==actions.length?actions[0]:{action:"zn-table:show-actions",label:"Show Actions",icon:"fas fa-bars"}));let multiSelectHTML=null;if(multiselect&&(multiSelectHTML=Table.htmlMultiSelect()),0==rows.length)return Table.htmlContentRow(null,0,fixedcols,scrollablecols,rowActionsHTML,multiSelectHTML);let content=rows.reduce((a,row,i)=>{let{fixed:fixed,scrollable:scrollable}=Table.htmlContentRow(row,i,fixedcols,scrollablecols,rowActionsHTML,multiSelectHTML);return a.fixed+=fixed,a.scrollable+=scrollable,a},{fixed:"",scrollable:""});return content.fixed+='<div class="zn-table-buffer-row">&nbsp;</div>',content}static htmlFilterLovItem(item,checked){return`\n      <div class="item">\n        <span class='checkbox' data-checked='${checked}' data-value='${item}'><i class="far fa-square unchecked"></i><i class="fas fa-check-square checked"></i></span>\n        <span class="value">${item}</span>\n      </div>`}static htmlFilterLovItems(items,selectedValues){return items.reduce((a,c)=>a+Table.htmlFilterLovItem(c,selectedValues?selectedValues.includes(c)?"Y":"N":"Y"),"")}static htmlFilterPopup(label,items,hasBlanks,filterstate){return`\n      <div class="search-input">\n        <i class="fas fa-search"></i><input type="text" placeholder="${label}"/><i class="close fas fa-times"></i>\n      </div>\n      <div class="lov">\n        <div class="lov-actions">\n          <div class="lov-action" zn-lov-action="select-all">\n            <span class='checkbox' data-checked='${filterstate.selectedValues?"N":"Y"}'><i class="far fa-square unchecked"></i><i class="fas fa-check-square checked"></i></span>\n            <span class="value">(Select All)</span>\n          </div>\n          <div class="lov-action  ${hasBlanks?"":"na"}" zn-lov-action="blanks">\n            <span class='checkbox ${hasBlanks?"":"na"}' data-checked='${null!=filterstate.includeBlanks?!0===filterstate.includeBlanks?"Y":"N":"Y"}'><i class="far fa-square unchecked"></i><i class="fas fa-check-square checked"></i></span>\n            <span class="value">(Blank)</span>\n          </div>\n        </div>\n        <div class="items">\n          ${Table.htmlFilterLovItems(items,filterstate.selectedValues)}\n        </div>\n      </div>\n      <div class="footer">\n        <div class="filter-actions">\n          <a class="filter-action" zn-filter-action="clear" href="#clear-filter">Clear</a>\n          <a class="filter-action" zn-filter-action="apply" href="#apply-filter">Apply</a>\n          <a class="filter-action" zn-filter-action="cancel" href="#cancel">Cancel</a>\n        </div>\n      </div>`}static htmlPage(pageNumber,selectedPage){return`<a class="zn-table-page-number ${pageNumber==selectedPage?"selected":""}" href="#page-${pageNumber}" data-page="${pageNumber}">${pageNumber}</a>`}static htmlPages(pageNumbers,selectedPage){return`\n      <a class="zn-table-page-number page-nav" href="#previous-page" data-page="previous"><i class="fas fa-arrow-left"></i></a>\n      ${pageNumbers.reduce((a,c)=>a+Table.htmlPage(c,selectedPage),"")}\n      <a class="zn-table-page-number page-nav" href="#next-page" data-page="next"><i class="fas fa-arrow-right"></i></a>\n      `}static htmlIcon(icon){return`<i class="icon ${icon}"></i>`}static htmlTableAction(item){return`<a class="zn-table-action" data-action="${item.action}">${item.icon?Table.htmlIcon(item.icon):""}<span class="text">${item.label||""}</span></a>`}static htmlTableActions(actions){return actions.reduce((a,c)=>a+Table.htmlTableAction(c),"")}static format(v,t,f){return null==t||null==f||""==f?v:"number"==t?numeral(v).format(f):"date"==t?moment(v).format(f):v}static pointInContent(point,content){var offset=content.offset();return point.x>=offset.left&&point.x<=offset.left+content.width()&&point.y>=offset.top&&point.y<=offset.top+content.height()}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Table=Table}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){scope.$watch("columns",function(nv,ov){if(!nv)return;let options={target:element,name:scope.name,columns:nv,rows:scope.rows,multiSelect:"true"===scope.multiselect,containerScroll:"true"===scope.containerscroll};scope.headerheight&&(options.headerHeight=scope.headerheight),scope.rowheight&&(options.rowHeight=scope.rowheight),scope.rowactions&&(options.rowActions=scope.rowactions),scope.actions&&(options.actions=scope.actions),scope.pagesize&&(options.paging=!0,options.pageSize=parseInt(scope.pagesize));let table=new zn.ui.components.Table(options);table.on("row-select",evt=>{scope.onrowselect({$event:evt})}),table.on("row-action",evt=>{scope.onrowaction({$event:evt})}),table.on("row-selection-change",evt=>{scope.onrowselectionchange({$event:evt})}),table.on("action",evt=>{scope.onaction({$event:evt})}),table.on("init",()=>{scope.$watch("rows",function(nv,ov){nv&&table.initRows(nv)}),scope.$watch("rowactions",function(nv,ov){nv&&table.setRowActions(nv)})}),table.init()})},tag:"znTable",factory:function(){return{scope:{name:"@",headerheight:"@",rowheight:"@",fill:"@",columns:"=",rows:"=",rowactions:"=",actions:"=",multiselect:"@",pagesize:"@",containerscroll:"@",onrowselect:"&",onrowaction:"&",onrowselectionchange:"&",onaction:"&"},restrict:"A",template:directive.html(),replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).table=directive}(window),function(window){class TextArea{constructor(options){this.options=options,this.value=options.value,this.eventHandlers={}}init(){this.$target=$(this.options.target),this.$target.addClass("zn-textarea"),this.$target.attr("zn-textarea",this.options.name),this.options.error&&this.$target.addClass("error"),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.setValue(this.options.value),this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,evt.name=eventName,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setValue(value){this.value=value,this.$textarea.val(value)}getValue(){return this.value}message(msg,type){let textarea=this;""!=msg?(textarea.$msg.text(msg),"error"==type?textarea.$target.addClass("error"):textarea.$target.addClass("message")):(textarea.$msg.text(""),textarea.$target.removeClass("error").removeClass("message"))}setupUI(){this.$target.html(TextArea.html(this.options)),this.$textarea=this.$target.find(".zn-textarea-input textarea"),this.$msg=this.$target.find(".zn-textarea-msg")}setupEventHandlers(){let textarea=this;textarea.$target.find(".zn-textarea-input textarea").on("change",evt=>{let $input=$(evt.currentTarget),oldValue=textarea.getValue(),newValue=$input.val();textarea.value=newValue,textarea.fireEvent("change",{oldValue:oldValue,newValue:newValue})}),textarea.$target.find(".zn-textarea-input textarea").on("focus",evt=>{textarea.$target.addClass("focused")}),textarea.$target.find(".zn-textarea-input textarea").on("blur",evt=>{textarea.$target.removeClass("focused")})}static get(name){return $(`[zn-textarea='${name}']`).get()[0].znc}static html(options){return`\n      ${options.label?TextArea.htmlLabel(options.label):""}\n      <div class="zn-textarea-input"><textarea value="${options.value||""}" placeholder="${options.placeholder||""}" ${options.readonly?"readonly":""}></textarea></div>\n      <div class="zn-textarea-msg">${options.error||options.message||""}</div>\n      `}static htmlLabel(label){return`<div class="zn-textarea-label">${label}</div>`}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).TextArea=TextArea}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,label:scope.label,value:scope.value,placeholder:scope.placeholder,readonly:"true"===scope.readonly,error:scope.error?scope.error:"",message:scope.message},textarea=new zn.ui.components.TextArea(options);textarea.on("init",()=>{textarea.on("change",evt=>{scope.value=evt.newValue,scope.$apply(),scope.onchange&&scope.onchange({$event:evt})}),scope.$watch("value",(nv,ov)=>textarea.setValue(nv)),scope.$watch("error",(nv,ov)=>textarea.message(nv||"","error")),scope.$watch("message",(nv,ov)=>textarea.message(nv,"message"))}),textarea.init()},tag:"znTextarea",factory:function(){return{scope:{name:"@",label:"@",value:"=",placeholder:"@",readonly:"@",error:"=",message:"=",onchange:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).textarea=directive}(window),function(window){class TextField{constructor(options){this.options=options,this.value=options.value,this.eventHandlers={}}init(){this.$target=$(this.options.target),this.$target.addClass("zn-textfield"),this.$target.attr("zn-textfield",this.options.name),this.options.error&&this.$target.addClass("error"),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,evt.name=eventName,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setValue(value){this.value=value,this.$input.val(value)}getValue(){return this.value}message(msg,type){let textfield=this;""!=msg?(textfield.$msg.text(msg),"error"==type?textfield.$target.addClass("error"):textfield.$target.addClass("message")):(textfield.$msg.text(""),textfield.$target.removeClass("error").removeClass("message"))}setupUI(){this.$target.html(TextField.html(this.options)),this.$input=this.$target.find(".zn-textfield-input input"),this.$msg=this.$target.find(".zn-textfield-msg")}setupEventHandlers(){let textfield=this;textfield.$target.find(".zn-textfield-input input").on("change",evt=>{let $input=$(evt.currentTarget),oldValue=textfield.getValue(),newValue=$input.val();textfield.value=newValue,textfield.fireEvent("change",{oldValue:oldValue,newValue:newValue})}),textfield.$target.find(".zn-textfield-input input").on("keydown",evt=>{13==evt.keyCode&&textfield.fireEvent("action")}),textfield.$target.find(".zn-textfield-input input").on("focus",evt=>{textfield.$target.addClass("focused")}),textfield.$target.find(".zn-textfield-input input").on("blur",evt=>{textfield.$target.removeClass("focused")})}static get(name){return $(`[zn-textfield='${name}']`).get()[0].znc}static html(options){return`\n      ${options.label?TextField.htmlLabel(options.label):""}\n      <div class="zn-textfield-input">\n        ${options.icon?TextField.htmlIcon(options.icon):""}\n        <input type="${options.password?"password":"text"}" value="${options.value||""}" placeholder="${options.placeholder||""}" ${options.readonly?"readonly":""} size="1"/>\n      </div>\n      <div class="zn-textfield-msg">${options.error||options.message||""}</div>\n      `}static htmlIcon(icon){return`<i class="icon ${icon}"></i>`}static htmlLabel(label){return`<div class="zn-textfield-label">${label}</div>`}}"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).TextField=TextField}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,label:scope.label,value:scope.value,placeholder:scope.placeholder,icon:scope.icon,password:"true"===scope.password,readonly:"true"===scope.readonly,error:scope.error?scope.error:"",message:scope.message},textfield=new zn.ui.components.TextField(options);textfield.on("init",()=>{textfield.on("change",evt=>{scope.value=evt.newValue,scope.$apply(),scope.onchange&&scope.onchange({$event:evt})}),textfield.on("action",evt=>scope.onaction({$event:evt})),scope.$watch("value",(nv,ov)=>textfield.setValue(nv)),scope.$watch("error",(nv,ov)=>textfield.message(nv||"","error")),scope.$watch("message",(nv,ov)=>textfield.message(nv,"message"))}),textfield.init()},tag:"znTextfield",factory:function(){return{scope:{name:"@",label:"@",value:"=",placeholder:"@",icon:"@",password:"@",readonly:"@",onaction:"&",error:"=",message:"=",onchange:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).textfield=directive}(window),function(window){"zn.ui.components".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Draggable=class{constructor(options){this.options=options,this.eventHandlers={}}init(){this.$target=$(this.options.target),this.$updateTarget=this.$target,this.options.updateTarget&&(this.$updateTarget=$(this.options.updateTarget)),this.$target.addClass("zn-draggable"),this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,evt.name=eventName,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setupUI(){}setupEventHandlers(){let draggable=this;draggable.$target.on("mousedown",evt=>{evt.preventDefault();let dragState={anchor:{x:evt.pageX,y:evt.pageY},source:draggable.$target,position:draggable.$updateTarget.position(),$updateTarget:draggable.$updateTarget};draggable.dragState=dragState,draggable.$target.addClass("on-drag"),draggable.fireEvent("dragstart",{source:dragState.source,anchor:dragState.anchor}),draggable.setupDragTrackingEventHandlers()})}setupDragTrackingEventHandlers(){let draggable=this;$("body").on("mousemove.dragtracking",function(evt){evt.preventDefault();let dragState=draggable.dragState;if(null!=dragState){var dx=evt.pageX-dragState.anchor.x,dy=evt.pageY-dragState.anchor.y;dragState.by={x:dx,y:dy},draggable.fireEvent("dragmove",{source:dragState.source,from:dragState.anchor,by:dragState.by}),"true"!=draggable.options.tracer&&draggable.updateTarget()}}),$("body").on("mouseup.dragtracking",function(evt){evt.preventDefault();let dragState=draggable.dragState;if(null!=dragState){var dx=evt.pageX-dragState.anchor.x,dy=evt.pageY-dragState.anchor.y;dragState.by={x:dx,y:dy},draggable.fireEvent("dragend",{source:dragState.source,from:dragState.anchor,by:dragState.by}),draggable.$target.removeClass("on-drag"),$("body").off("mousemove.dragtracking"),$("body").off("mouseup.dragtracking"),"true"!=draggable.options.tracer&&draggable.updateTarget()}})}updateTarget(){let dragState=this.dragState,x=dragState.position.left+dragState.by.x,y=dragState.position.top+dragState.by.y;dragState.$updateTarget.css("left",x).css("top",y).css("bottom","unset").css("right","unset")}static get(name){return $(`[zn-draggable='${name}']`).get()[0].znc}}}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){let options={target:element,updateTarget:scope.target,tracker:scope.tracker},draggable=new zn.ui.components.Draggable(options);draggable.on("init",()=>{scope.ondragstart&&draggable.on("dragstart",evt=>scope.ondragstart({$event:evt})),scope.ondragmove&&draggable.on("dragmove",evt=>scope.ondragmove({$event:evt})),scope.ondragend&&draggable.on("dragend",evt=>scope.ondragend({$event:evt}))}),draggable.init()},tag:"znDraggable",factory:function(){return{scope:{name:"@",target:"@",tracker:"@",ondragstart:"&",ondragend:"&",ondragmove:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).draggable=directive}(window),function(window){let fn=function(msg,icon,type){let $toasts=$(".zn-toasts");0==$toasts.get().length&&($("body").append('<div class="zn-toasts"></div>'),$toasts=$(".zn-toasts"));let iconHTML=icon?`<div class='zn-toast-icon'><i class="${icon}"></i></div>`:"",id=zn.shortid();$toasts.append(`\n    <div data-oid="${id}" class="zn-toast ${type||""}">\n      <div class="zn-toast-content">\n        ${iconHTML}<div class="zn-toast-text">${msg}</div>\n      </div>\n    </div>`),window.setTimeout(()=>{let $toasts=$(".zn-toasts");$(`.zn-toast[data-oid="${id}"]`).remove(),0==$toasts.find(".zn-toast").get().length&&$toasts.remove()},4e3),window.setTimeout(()=>$(`.zn-toast[data-oid="${id}"]`).addClass("hide"),200)};fn.Error=(msg=>zn.ui.Toast(msg,null,"error")),fn.Warning=(msg=>zn.ui.Toast(msg,icon,"warn")),"zn.ui".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Toast=fn}(window),function(window){let directive={html:function(){return"<div></div>"}};directive.linkFn=function(scope,element,attrs){let $target=$(element),targetElement=$target.get()[0],ename="click.editable";"Y"==scope.doubleclick&&(ename="dblclick.editable"),$target.addClass("zn-editable");let eh=evt=>{if(evt.preventDefault(),evt.stopPropagation(),$target.hasClass("on-edit"))return;$target.addClass("on-edit"),targetElement.currentValue=$target.text(),$target.html(directive.html.editor());let $editor=$target.find("input");$editor.val(targetElement.currentValue);let updater=()=>{let newValue=$editor.val();$target.text(newValue),newValue!=targetElement.currentValue&&scope.onedit&&scope.onedit({$event:{name:"oninlineedit",source:$target,oldValue:targetElement.currentValue,newValue:newValue}}),$target.removeClass("on-edit"),scope.oneditend&&scope.oneditend({$event:{name:"oninlineeditstart",source:$target}})};$editor.on("blur",evt=>updater()),$editor.on("keydown",evt=>{13==evt.keyCode&&updater(),27==evt.keyCode&&($target.removeClass("on-edit"),$target.text(targetElement.currentValue),scope.oneditcancel&&scope.oneditcancel({$event:{name:"oninlineeditcancel",source:$target}}))}),$editor.focus(),$editor.select(),scope.oneditstart&&scope.oneditstart({$event:{name:"oninlineeditstart",source:$target}})};$target.on("focus",eh),$target.on(ename,eh)},directive.html={},directive.html.editor=function(){return'<input type="text"/>'},directive.tag="znEditable",directive.factory=function(){return{scope:{onedit:"&",oneditstart:"&",oneditend:"&",oneditcancel:"&",doubleclick:"@"},restrict:"A",template:"",replace:!0,link:directive.linkFn}},"zn.ui.components.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).editable=directive}(window),function(window){"zn.designer".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Properties={"shape.resize":!0,"shape.select.stroke":"#CE93D8","shape.select.fill":"rgba(206,147,216,0.2)","shape.select.stroke.size":2,"shape.select.offset":5,"shape.transformer.stroke":"#6a9cb8","shape.transformer.fill":"#039be529","shape.transformer.offset":5,"connector.size":8,"connector.stroke":"rgba(0,255,0,0.1)","connector.fill":"#CE93D8","connector.hilight":"#AB47BC","connector.line.stroke":"#CE93D8","connector.line.hilight":"#ba68c8","connector.line.select":"#8e24aa","rect.fill":"#B3E5FC","rect.stroke":"#039be529","rect.header.fill":"#7ecff5","ellipse.fill":"#C5E1A5","ellipse.stroke":"#8bc34a33","diamond.fill":"#ffcc80","diamond.stroke":"#ff980033","pill.fill":"#C5CAE9","pill.stroke":"#3949ab1c","text.family":"monospace","text.size":12,"text.color":"#0f2c3d","text.style":"normal","text.lineheight":1.5,"subtext.family":"monospace","subtext.size":12,"subtext.color":"#0f2c3d","subtext.style":"normal","subtext.lineheight":1.5,"node.level.offset":10,"node.height":25,"node.mark.color":"#1c4155","list.header.fill":"#7ecff5","hitregion.fill":"rgba(255,0,0,0)","grid.show":!0,"grid.fill":"#ffffff","grid.minorTick.stroke":"#f5f5f5","grid.majorTick.stroke":"#eeeeee","grid.minorTick.size":10,"grid.majorTick.size":100,"grid.snap.size":5,"lanes.show":!0,"lane.header.fill":"#c5e1a5","lane.header.stroke":"#8bc34a5c","lane.separator.stroke":"#cccccc","lane.header.size":25}}(window),function(window){let props=zn.designer.Properties,Component=(zn.designer.Utils,{handleShapeDragEnd:shapeComponent=>{let shape=shapeComponent.$shape;shape.hasName("selected")||Component.snap(shape),Component.fireConnectorPointUpdateEvent(shape),shape.hasName("selected")&&shape.getStage().fire("shape-rect-update",{source:shapeComponent})},handleShapeDragMove:(shapeComponent,event)=>{let shape=shapeComponent.$shape;Component.fireConnectorPointUpdateEvent(shape),shape.hasName("selected")&&Component.moveOtherSelectedObjects(shape.getLayer(),shape,event),shape.getStage().fire("shape-rect-update",{source:shapeComponent})},handleShapeMouseDown:shapeComponent=>{let shape=shapeComponent.$shape,layer=shape.getLayer();shape.hasName("selected")||Component.resetSelection(layer)},handleShapeHover:shapeComponent=>{let shape=shapeComponent.$shape,layer=shape.getLayer();Component.resetConnectors(layer),shape.hasName("transform")||(shape.addName("hover"),Component.showConnectors(shape,!0))},handleShapeClick:shapeComponent=>{let shape=shapeComponent.$shape;shape.getLayer();shape.hasName("transform")||(shape.hasName("selected")?!0===props["shape.resize"]&&Component.handleShapeTransform(shapeComponent):Component.handleShapeSelect(shapeComponent))},handleShapeSelect:shapeComponent=>{let shape=shapeComponent.$shape,layer=shape.getLayer();Component.resetSelection(layer),shape.addName("selected"),Component.showSelection(shape,!0),shape.getStage().fire("shape-select",{source:shapeComponent})},handleShapeSelectAdd:shapeComponent=>{let shape=shapeComponent.$shape;shape.getLayer();shape.hasName("selected")?(shape.removeName("selected"),Component.showSelection(shape,!1)):(shape.addName("selected"),Component.showSelection(shape,!0)),shape.getStage().fire("selection-set-modify",{source:shapeComponent})},handleShapeTransform:shapeComponent=>{let shape=shapeComponent.$shape;shape.getLayer().find(".selected").toArray().length>1||(Component.showSelection(shape,!1),Component.showConnectors(shape,!1),shape.addName("transform"),shape.draggable(!1),shape.getStage().fire("shape-transform",{source:shapeComponent}))},getConnetorLines:shapeComponent=>{if(!shapeComponent.connectorPoints)return[];return Object.values(shapeComponent.connectorPoints).reduce((a,c)=>(c.$shape.$lines&&a.push(...c.$shape.$lines),a),[])},moveOtherSelectedObjects:(layer,shape,event)=>{layer.find(".selected").each(selected=>{if(selected==shape)return;let pos=selected.getPosition();pos.x+=event.evt.movementX,pos.y+=event.evt.movementY,selected.setPosition(pos),Component.fireConnectorPointUpdateEvent(selected)}),layer.batchDraw()},snapOtherSelectedObjects:(layer,shape)=>{layer.find(".selected").each(selected=>{selected!=shape&&(Component.snap(selected),Component.fireConnectorPointUpdateEvent(selected))}),layer.batchDraw()},showConnectors:(shape,state)=>{shape.find(".connector").each(connector=>connector.visible(state)),shape.getLayer().batchDraw()},resetConnectors:layer=>{let currentHover=layer.findOne(".hover");null!=currentHover&&(Component.showConnectors(currentHover,!1),currentHover.removeName("hover"))},showSelection:(shape,state)=>{shape.find(".selection").each(area=>area.visible(state)),shape.getLayer().batchDraw()},resetSelection:layer=>{layer.find(".selected").each(selected=>{Component.showSelection(selected,!1),selected.removeName("selected")})},resetConnectorLineSelection:layer=>{layer.find(".selected").each(selected=>{selected.removeName("selected"),selected.stroke(props["connector.line.stroke"])}),layer.batchDraw()},resetTransform:shapeComponent=>{let shape=shapeComponent.$shape;shape.removeName("transform"),shape.draggable(!0)},fireConnectorPointUpdateEvent:shape=>{let shapeCtx=shape.getAttr("zn-ctx");shape.find(".connector").each(connector=>{let connectorCtx=connector.getAttr("zn-ctx");connector.fire("connector-update",{source:connector,shape:shapeCtx.name,point:connectorCtx.name})})},pointOf:connector=>{let clientRect=connector.getClientRect();return{x:clientRect.x+clientRect.width/2,y:clientRect.y+clientRect.height/2}},snap:shape=>{let snap=shape.getStage().getAttr("snap");if(!snap)return;let v=shape.x();shape.x(v-v%snap),v=shape.y(),shape.y(v-v%snap),shape.getLayer().draw()}});"zn.designer.shape".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Base=Component}(window),function(window){let Component={addGridLines:(layer,s,e,l,i,c,d)=>{for(s+=.5;s<e;){var line=new Konva.Line({points:[s*(1-d),s*d,s*(1-d)+l*d,l*(1-d)+s*d],strokeWidth:1,stroke:c,listening:!1});layer.add(line),s+=i}},blinePoints:(x1,y1,x2,y2,startDir,endDir)=>{let dx=x2-x1,dy=y2-y1,points=[x1,y1];return"top"==startDir?"left"==endDir||"right"==endDir?points.push(x1,y2,x1,y2,x2,y2):points.push(x1,y1+dy/2,x2,y1+dy/2,x2,y2):"right"==startDir?"bottom"==endDir||"top"==endDir?points.push(x2,y1,x2,y1,x2,y2):points.push(x1+dx/2,y1,x1+dx/2,y2,x2,y2):"bottom"==startDir?"left"==endDir||"right"==endDir?points.push(x1,y2,x1,y2,x2,y2):points.push(x1,y1+dy/2,x2,y1+dy/2,x2,y2):"left"==startDir?"bottom"==endDir||"top"==endDir?points.push(x2,y1,x2,y1,x2,y2):points.push(x1+dx/2,y1,x1+dx/2,y2,x2,y2):Math.abs(dx)<Math.abs(dy)?points.push(x1+dx/4,y1,x1+dx/4,y2,x2,y2):points.push(x1,y1+dy/4,x2,y1+dy/4,x2,y2),points},blinePoints1:(x1,y1,x2,y2,startDir,endDir)=>{let dx=x2-x1,dy=y2-y1,points=[x1,y1];return"top"==startDir?("left"==endDir&&points.push(x1,y2,x1,y2,x2,y2),"right"==endDir?points.push(x1,y2,x1,y2,x2,y2):points.push(x1,y1+dy/2,x2,y1+dy/2,x2,y2)):"right"==startDir?"bottom"==endDir||"top"==endDir?points.push(x2,y1,x2,y1,x2,y2):points.push(x1+dx/2,y1,x1+dx/2,y2,x2,y2):"bottom"==startDir?"left"==endDir||"right"==endDir?points.push(x1,y2,x1,y2,x2,y2):points.push(x1,y1+dy/2,x2,y1+dy/2,x2,y2):"left"==startDir?"bottom"==endDir||"top"==endDir?points.push(x2,y1,x2,y1,x2,y2):points.push(x1+dx/2,y1,x1+dx/2,y2,x2,y2):Math.abs(dx)<Math.abs(dy)?points.push(x1+dx/4,y1,x1+dx/4,y2,x2,y2):points.push(x1,y1+dy/4,x2,y1+dy/4,x2,y2),points},getRect:(p0,p1)=>{let rect={x:p0.x,y:p0.y};return p1.x<rect.x&&(rect.x=p1.x),p1.y<rect.y&&(rect.y=p1.y),rect.width=Math.abs(p0.x-p1.x),rect.height=Math.abs(p0.y-p1.y),rect},pointInRect:(p,r)=>p.x>=r.x&&p.y>=r.y&&p.x<=r.x+r.width&&p.y<=r.y+r.height,intersect:(r1,r2)=>{let p={x:r2.x+r2.width,y:r2.y+r2.height};return Component.pointInRect({x:r2.x,y:r2.y},r1)||Component.pointInRect(p,r1)},flattenList:(list,level)=>{let flatList=[];return list.forEach(item=>{let node=Component.cloneItem(item,["$list"]);node.$level=level||0,flatList.push(node),item.$list&&flatList.push(...Component.flattenList(item.$list,(level||0)+1))}),flatList},cloneItem:(item,ignoreFields)=>Object.keys(item).filter(k=>!ignoreFields.includes(k)).reduce((a,c)=>(a[c]=item[c],a),{})};"zn.designer".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Utils=Component}(window),function(window){let props=zn.designer.Properties,utils=zn.designer.Utils,base=zn.designer.shape.Base;"zn.designer.layer".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Grid=class{constructor(stage,options){this.stage=stage,this.options=options,this.addLayerDetails(),this.setupEventHandlers()}addLayerDetails(){let stage=this.stage,layer=this.$layer=new Konva.Layer({name:"grid-layer"});stage.add(layer),this.layer=layer;let w=stage.width(),h=stage.height();this.updateLayer(w,h)}updateLayer(w,h){let layer=this.layer;layer.destroyChildren();let background=new Konva.Rect({x:0,y:0,width:w,height:h,fill:props["grid.fill"]});background.addName("grid"),layer.add(background),this.background=background,props["grid.show"]&&this.addGridLines(w,h),props["lanes.show"]&&this.addLanes(w,h);let boundingBox=new Konva.Rect({x:0,y:0,width:w,height:h,visible:!1,stroke:props["grid.majorTick.stroke"]});layer.add(boundingBox),this.boundingBox=boundingBox}addGridLines(w,h){let layer=this.layer,gridLinesGroup=new Konva.Group({x:0,y:0,width:w,height:h,name:"grid-lines-group"});layer.add(gridLinesGroup),this.gridLinesGroup=gridLinesGroup;let majorTickSize=props["grid.majorTick.size"],minorTickSize=props["grid.minorTick.size"];utils.addGridLines(gridLinesGroup,minorTickSize,w,h,minorTickSize,props["grid.minorTick.stroke"],0),utils.addGridLines(gridLinesGroup,minorTickSize,h,w,minorTickSize,props["grid.minorTick.stroke"],1),utils.addGridLines(gridLinesGroup,majorTickSize,w,h,majorTickSize,props["grid.majorTick.stroke"],0),utils.addGridLines(gridLinesGroup,majorTickSize,h,w,majorTickSize,props["grid.majorTick.stroke"],1)}addLanes(w,h){let layer=this.layer;if(!this.options.lanes||""==this.options.lanes)return;let lanes=this.options.lanes.split("|"),d="left"==this.options.lanesPosition?0:1,numLanes=lanes.length,laneSize=(w*d+h*(1-d))/numLanes;lanes.forEach((laneText,i)=>{let header=new Konva.Rect({x:i*laneSize*d,y:i*laneSize*(1-d),width:laneSize*d+props["lane.header.size"]*(1-d),height:laneSize*(1-d)+props["lane.header.size"]*d,fill:props["lane.header.fill"],stroke:props["lane.header.stroke"],listening:!1});header.addName("lane-header"),layer.add(header);let text=new Konva.Text({x:i*laneSize*d,y:(laneSize+i*laneSize)*(1-d),width:laneSize,height:props["lane.header.size"],text:laneText,align:"center",verticalAlign:"middle",strokeWidth:1,fontFamily:props["text.family"],fontSize:props["text.size"],fontStyle:props["text.style"],lineHeight:props["text.lineheight"],shadowForStrokeEnabled:!1,listening:!1,rotation:-90*(1-d)});if(props["text.stroke"]?text.stroke(props["text.color"]):text.fill(props["text.color"]),text.addName("text"),layer.add(text),i>0){var laneSeparator=new Konva.Line({points:[i*laneSize*d,i*laneSize*(1-d),i*laneSize*d+w*(1-d),h*d+i*laneSize*(1-d)],strokeWidth:1,stroke:props["lane.separator.stroke"],listening:!1});layer.add(laneSeparator)}})}setSize(w,h){this.updateLayer(w,h),this.layer.batchDraw(),this.setupEventHandlers()}setupEventHandlers(){let component=this,stage=component.stage;component.background.on("mouseenter",()=>base.resetConnectors(stage.findOne(".shapes-layer"))),component.background.on("mousedown",event=>{component.mouseDownAt=event,stage.fire("grid-select",{mouseEvent:event})}),component.background.on("mouseup",event=>{component.mouseDownAt&&component.mouseDownAt.evt.layerX==event.evt.layerX&&component.mouseDownAt.evt.layerY==event.evt.layerY&&stage.fire("grid-click",{mouseEvent:event})})}}}(window),function(window){let props=zn.designer.Properties,base=(zn.designer.Utils,zn.designer.shape.Base);"zn.designer.op".split(".").reduce((a,e)=>a[e]=a[e]||{},window).DrawConnector=class{constructor(surface,cp){let op=this;op.cp0=cp,op.cpdir=cp.getAttr("zn-ctx").direction,op.p0=base.pointOf(cp),op.p1={x:op.p0.x,y:op.p0.y},op.surface=surface}start(x,y){let op=this,points=[op.p0.x,op.p0.y,op.p1.x,op.p1.y];op.line=new Konva.Line({points:points,bezier:!1,fill:props["connector.fill"],stroke:props["connector.fill"],strokeWidth:2,hitStrokeWidth:10,dash:[5,5]}),op.surface.dragLayer.add(op.line),op.surface.dragLayer.batchDraw()}update(x,y){let op=this;op.p1.x=x,op.p1.y=y;let points=[op.p0.x,op.p0.y,op.p1.x,op.p1.y];op.line.points(points),op.surface.dragLayer.batchDraw();let connectorPoint=op.surface.stage.getIntersection({x:x,y:y},".connector");null!=connectorPoint&&(op.cp1=connectorPoint)}end(x,y){let op=this;op.p1.x=x,op.p1.y=y,op.line.destroy(),op.surface.dragLayer.batchDraw(),op.cp0&&op.cp1&&op.cp0!=op.cp1&&op.surface.stage.fire("points-connected",{p0:op.cp0,p1:op.cp1})}}}(window),function(window){let props=zn.designer.Properties,utils=zn.designer.Utils;zn.designer.shape.Base;"zn.designer.op".split(".").reduce((a,e)=>a[e]=a[e]||{},window).DrawObject=class{constructor(surface){this.surface=surface}start(x,y){let op=this;op.p0={x:x,y:y},op.p1={x:x,y:y};let r=utils.getRect(op.p0,op.p1);op.drawRect=new Konva.Rect({x:r.x,y:r.y,width:r.width,height:r.height,fill:props["shape.select.fill"],strokeWidth:props["shape.select.stroke.size"],stroke:props["shape.select.stroke"],dash:[4,4]}),op.surface.dragLayer.add(op.drawRect),op.surface.dragLayer.batchDraw()}update(x,y){let op=this;op.p1.x=x,op.p1.y=y;let r=utils.getRect(op.p0,op.p1);op.drawRect.position({x:r.x,y:r.y}),op.drawRect.size({width:r.width,height:r.height}),op.surface.dragLayer.batchDraw()}end(x,y){let op=this;op.p1.x=x,op.p1.y=y,op.drawRect.destroy(),op.surface.dragLayer.batchDraw(),op.p0.x!=op.p1.x&&op.p0.y!=op.p1.y&&op.surface.stage.fire("draw-object",{rect:utils.getRect(op.p0,op.p1)})}}}(window),function(window){let props=zn.designer.Properties,utils=zn.designer.Utils;zn.designer.shape.Base;"zn.designer.op".split(".").reduce((a,e)=>a[e]=a[e]||{},window).SelectObjects=class{constructor(surface){this.surface=surface}start(x,y){let op=this;op.p0={x:x,y:y},op.p1={x:x,y:y};let r=utils.getRect(op.p0,op.p1);op.selectionRect=new Konva.Rect({x:r.x,y:r.y,width:r.width,height:r.height,fill:props["shape.select.fill"],strokeWidth:props["shape.select.stroke.size"],stroke:props["shape.select.stroke"],dash:[4,4],cornerRadius:5}),op.surface.dragLayer.add(op.selectionRect),op.surface.dragLayer.batchDraw()}update(x,y){let op=this;op.p1.x=x,op.p1.y=y;let r=utils.getRect(op.p0,op.p1);op.selectionRect.position({x:r.x,y:r.y}),op.selectionRect.size({width:r.width,height:r.height}),op.surface.dragLayer.batchDraw()}end(x,y){let op=this;op.p1.x=x,op.p1.y=y,op.selectionRect.destroy(),op.surface.dragLayer.batchDraw(),op.p0.x!=op.p1.x&&op.p0.y!=op.p1.y&&op.surface.stage.fire("select-objects",{rect:utils.getRect(op.p0,op.p1)})}}}(window),function(window){let __package="zn.designer.shape",__name="ConnectorLine",props=zn.designer.Properties,utils=zn.designer.Utils,base=zn.designer.shape.Base;__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=class{constructor(cp0,cp1,ctx,oid){this.$class=`${__package}.${__name}`,this.$type="line",this.cp0=cp0,this.cp1=cp1,this.ctx=ctx,this.oid=oid||zn.shortid();let p0=base.pointOf(cp0),p1=base.pointOf(cp1);this.startPointDirection=this.cp0.getAttr("zn-ctx").direction,this.endPointDirection=this.cp1.getAttr("zn-ctx").direction;let bounds=this.bounds(p0,p1);this.$shape=new Konva.Group({x:bounds.x,y:bounds.y,width:bounds.w,height:bounds.h}),this.$shape.setAttr("zn-ctx",ctx),this.$shape.setAttr("zn-oid",this.oid),this.line=new Konva.Arrow({points:utils.blinePoints(bounds.p1.x,bounds.p1.y,bounds.p2.x,bounds.p2.y,this.startPointDirection,this.endPointDirection),bezier:!0,fill:props["connector.line.stroke"],stroke:props["connector.line.stroke"],strokeWidth:2,pointerLength:5,pointerWidth:4,hitStrokeWidth:20}),this.$shape.add(this.line),this.cp0.$lines=this.cp0.$lines||[],this.cp0.$lines.push(this.oid),this.cp1.$lines=this.cp1.$lines||[],this.cp1.$lines.push(this.oid),this.setupEventHandlers()}setupEventHandlers(){let component=this,$shape=component.$shape,line=component.line,updateLine=()=>{let p0=base.pointOf(component.cp0),p1=base.pointOf(component.cp1),bounds=component.bounds(p0,p1);component.$shape.position(bounds),component.$shape.size(bounds);let blinePoints=utils.blinePoints(bounds.p1.x,bounds.p1.y,bounds.p2.x,bounds.p2.y,component.startPointDirection,component.endPointDirection);line.points(blinePoints),line.getLayer().batchDraw()};component.ehname=`eh${(new Date).getTime()}`,component.cp0.on(`connector-update.${component.ehname}`,updateLine),component.cp1.on(`connector-update.${component.ehname}`,updateLine),line.on("mouseover",()=>{line.stroke(props["connector.line.hilight"]),line.getLayer().batchDraw()}),line.on("mouseout",()=>{line.hasName("selected")?line.stroke(props["connector.line.select"]):line.stroke(props["connector.line.stroke"]),line.getLayer().batchDraw()}),line.on("mousedown",()=>{base.resetConnectorLineSelection(line.getLayer()),line.addName("selected"),line.stroke(props["connector.line.select"]),line.getLayer().batchDraw(),line.getStage().fire("connection-select",{source:$shape})})}removePointUpdateEventHandlers(){this.cp0.off(`connector-update.${this.ehname}`),this.cp1.off(`connector-update.${this.ehname}`)}destroy(){let component=this;component.removePointUpdateEventHandlers(),component.cp0.$lines=component.cp0.$lines.filter(id=>id!=component.oid),component.cp1.$lines=component.cp1.$lines.filter(id=>id!=component.oid),component.$shape.destroy()}bounds(p1,p2){let x1=p1.x,y1=p1.y,x2=p2.x,y2=p2.y;return p2.x<x1&&(x1=p2.x),p2.x>x2&&(x2=p2.x),p2.y<y1&&(y1=p2.y),p2.y>y1&&(y2=p2.y),{x:x1,y:y1,w:x2-x1,h:y2-y1,p1:{x:p1.x-x1,y:p1.y-y1},p2:{x:p2.x-x1,y:p2.y-y1}}}direction(lp){let[x1,y1,x2,y2]=lp;return y1==y2&&x2>x1?"R":x1==x2&&y2>y1?"D":y1==y2&&x2<x1?"L":x1==x2&&y2<y1?"U":x1==x2&&y1==y2?"":void 0}offsetPoint(dir,x,y,d){let dx=x,dy=y;return"top"==dir&&(dy-=d),"right"==dir&&(dx+=d),"bottom"==dir&&(dy+=d),"left"==dir&&(dx-=d),{x:dx,y:dy}}pointOnLine(lp,px,py){let rval=!1,lx1=lp[0],ly1=lp[1],lx2=lp[2],ly2=lp[3];return lx1>lx2&&([lx1,lx2]=[lx2,lx1]),ly1>ly2&&([ly1,ly2]=[ly2,ly1]),rval=px>=lx1&&px<=lx2&&py>=ly1&&py<=ly2}pointsOnLine(lp,ps){let component=this,rval=!1;return ps.forEach(p=>{component.pointOnLine(lp,p.x,p.y)&&(rval=!0)}),rval}countDirectionChanges(lps){let component=this,c=0,dir="";return lps.forEach(lp=>{let d=component.direction(lp);""!=d&&d!=dir&&(dir=d,c++)}),c}breakLineSegment(lp,s,e){let[x1,y1,x2,y2]=lp,dir=this.direction(lp),rval=null;return""==dir&&(rval=[[x1,y1,x1,y1],[x1,y1,x1,y1],[x1,y1,x1,y1]]),"R"==dir&&(rval=[[x1,y1,x1+s,y1],[x1+s,y1,x2-e,y1],[x2-e,y1,x2,y1]]),"D"==dir&&(rval=[[x1,y1,x1,y1+s],[x1,y1+s,x1,y2-e],[x1,y2-e,x1,y2]]),"L"==dir&&(rval=[[x1,y1,x1-s,y1],[x1-s,y1,x2+e,y1],[x2+e,y1,x2,y1]]),"U"==dir&&(rval=[[x1,y1,x1,y1-s],[x1,y1-s,x1,y2+e],[x1,y2+e,x1,y2]]),0==s&&rval.shift(),0==e&&rval.pop(),rval}combineLineSegments(ls1,ls2){return[ls1[0],ls1[1],ls1[2],ls1[3],ls1[2],ls1[3],ls2[2],ls2[3]]}generateLinePoints(x1,y1,x2,y2,startDir,endDir){let ox1,oy1,ox2,oy2,component=this;({x:ox1,y:oy1}=component.offsetPoint(startDir,x1,y1,20)),({x:ox2,y:oy2}=component.offsetPoint(endDir,x2,y2,20));let points=[{x:x1,y:y1},{x:y2,y:y2}],spl=null;[[[x1,y1,ox1,oy1],[ox1,oy1,ox1,oy2],[ox1,oy2,ox2,oy2],[ox2,oy2,x2,y2]],[[x1,y1,ox1,oy1],[ox1,oy1,ox2,oy1],[ox2,oy1,ox2,oy2],[ox2,oy2,x2,y2]]].forEach(pathLines=>{component.pointsOnLine(pathLines[1],points)||component.pointsOnLine(pathLines[2],points)||(pathLines.directions=component.countDirectionChanges(pathLines),null==spl?spl=pathLines:pathLines.directions<spl.directions&&(spl=pathLines))});let[ls1,ls2]=component.breakLineSegment(spl[0],0,10),[ls3,ls4,ls5]=component.breakLineSegment(spl[1],10,10),[ls6,ls7,ls8]=component.breakLineSegment(spl[2],10,10),[ls9,ls10]=component.breakLineSegment(spl[3],10,0);return[ls1,component.combineLineSegments(ls2,ls3),ls4,component.combineLineSegments(ls5,ls6),ls7,component.combineLineSegments(ls8,ls9),ls10]}getLinePoints(x1,y1,x2,y2,startDir,endDir){let ox1,oy1,ox2,oy2,component=this;({x:ox1,y:oy1}=component.offsetPoint(startDir,x1,y1,20)),({x:ox2,y:oy2}=component.offsetPoint(endDir,x2,y2,20));let points=[{x:x1,y:y1},{x:y2,y:y2}],spl=null;return[[[x1,y1,ox1,oy1],[ox1,oy1,ox1,oy2],[ox1,oy2,ox2,oy2],[ox2,oy2,x2,y2]],[[x1,y1,ox1,oy1],[ox1,oy1,ox2,oy1],[ox2,oy1,ox2,oy2],[ox2,oy2,x2,y2]]].forEach(pathLines=>{component.pointsOnLine(pathLines[1],points)||component.pointsOnLine(pathLines[2],points)||(pathLines.directions=component.countDirectionChanges(pathLines),null==spl?spl=pathLines:pathLines.directions<spl.directions&&(spl=pathLines))}),[...spl[0],spl[2][0],spl[2][1],...spl[3]]}}}(window),function(window){let __package="zn.designer.shape",__name="ConnectorPoint",props=zn.designer.Properties,base=(zn.designer.Utils,zn.designer.shape.Base);class Component{constructor(x,y,ctx,oid){this.$class=`${__package}.${__name}`,this.$type="point",this.ctx=ctx,this.oid=oid||zn.shortid();let size=props["connector.size"];this.$shape=new Konva.Circle({x:x+.5,y:y+.5,radius:size/2,width:size,height:size,fill:props["connector.fill"],stroke:props["connector.stroke"],strokeWidth:0,visible:!1,hitStrokeWidth:10}),this.$shape.setAttr("zn-ctx",ctx),this.$shape.setAttr("zn-oid",this.oid),this.$shape.addName("connector"),this.setupEventHandlers()}setupEventHandlers(){let component=this,point=component.$shape;point.on("mouseenter",()=>{point.setFill(props["connector.hilight"]),point.getLayer().batchDraw()}),point.on("mouseout",()=>{point.setFill(props["connector.fill"]),point.getLayer().batchDraw()}),point.on("mousedown",evt=>{evt.cancelBubble=!0,point.getStage().fire("connector-select",{source:component})})}destroy(){this.$shape.destroy()}static generateForRectangularShape(shape){return{top:Component.generateForShape(shape,"top"),right:Component.generateForShape(shape,"right"),bottom:Component.generateForShape(shape,"bottom"),left:Component.generateForShape(shape,"left")}}static generateForShape(shape,location){let w=shape.width(),h=shape.height(),parentCtx=shape.getAttr("zn-ctx");return"top"==location?new Component(w/2,-1,{name:"top",text:"Top",parent:{...parentCtx,oid:shape.getAttr("zn-oid")},direction:"top"}):"right"==location?new Component(w+1,h/2,{name:"right",text:"Right",parent:{...parentCtx,oid:shape.getAttr("zn-oid")},direction:"right"}):"bottom"==location?new Component(w/2,h+1,{name:"bottom",text:"Bottom",parent:{...parentCtx,oid:shape.getAttr("zn-oid")},direction:"bottom"}):"left"==location?new Component(-1,h/2,{name:"left",text:"Left",parent:{...parentCtx,oid:shape.getAttr("zn-oid")},direction:"left"}):null}static updateForRectangularShape(rectangularComponent){let w=rectangularComponent.$shape.width(),h=rectangularComponent.$shape.height(),cps=rectangularComponent.connectorPoints;cps&&(cps.top&&cps.top.$shape.position({x:w/2,y:-1}),cps.right&&cps.right.$shape.position({x:w+1,y:h/2}),cps.bottom&&cps.bottom.$shape.position({x:w/2,y:h+1}),cps.left&&cps.left.$shape.position({x:-1,y:h/2}),base.fireConnectorPointUpdateEvent(rectangularComponent.$shape))}}__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=Component}(window),function(window){let __package="zn.designer.shape",__name="Diamond",props=zn.designer.Properties,base=(zn.designer.Utils,zn.designer.shape.Base);__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=class{constructor(x,y,w,h,ctx,oid){this.$class=`${__package}.${__name}`,this.$type="diamond",this.ctx=ctx,this.oid=oid||zn.shortid(),this.$shape=new Konva.Group({x:x,y:y,width:w,height:h,draggable:!0}),this.$shape.setAttr("zn-ctx",ctx),this.$shape.setAttr("zn-oid",this.oid),this.$shape.addName("diamond"),this.addHitRegion(w,h,ctx),this.addSelectArea(w,h,ctx),this.addConnectorPoints(),this.addShapeDetails(w,h,ctx),this.addText(w,h,ctx),this.setupEventHandlers()}addHitRegion(w,h,ctx){let group=this.$shape,hitSize=2*props["connector.size"],hitRegion=new Konva.Rect({x:.5-hitSize,y:.5-hitSize,width:w+2*hitSize,height:h+2*hitSize,strokeWidth:0,fill:props["hitregion.fill"]});hitRegion.addName("hit-region"),group.add(hitRegion),this.hitRegion=hitRegion}addShapeDetails(w,h,ctx){let group=this.$shape,diamond=new Konva.Line({points:[w/2,0,w,h/2,w/2,h,0,h/2],tension:.2,closed:!0,fill:props["diamond.fill"],stroke:props["diamond.stroke"],strokeWidth:3,listening:!1});diamond.addName("diamond"),group.add(diamond),this.diamond=diamond}addSelectArea(w,h,ctx){let group=this.$shape,size=props["shape.select.offset"],selection=new Konva.Line({points:[w/2,-size-2,w+size+2,h/2,w/2,h+size+2,-size-2,h/2],tension:.2,closed:!0,fill:props["shape.select.fill"],strokeWidth:props["shape.select.stroke.size"],stroke:props["shape.select.stroke"],dash:[4,4],visible:!1,listening:!1});selection.addName("selection"),group.add(selection),this.selection=selection}addText(w,h,ctx){let group=this.$shape;if(!this.ctx.text)return;let text=new Konva.Text({x:0,y:0,width:w,height:h,text:ctx.text,align:"center",verticalAlign:"middle",strokeWidth:1,fontFamily:props["text.family"],fontSize:props["text.size"],fontStyle:props["text.style"],lineHeight:props["text.lineheight"],shadowForStrokeEnabled:!1,listening:!1});props["text.stroke"]?text.stroke(props["text.color"]):text.fill(props["text.color"]),text.addName("text"),group.add(text),this.text=text}addConnectorPoints(){let group=this.$shape;this.connectorPoints=zn.designer.shape.ConnectorPoint.generateForRectangularShape(group),Object.values(this.connectorPoints).forEach(point=>group.add(point.$shape))}updateShape(w,h){let s={width:w,height:h};this.$shape.setSize(s);let hitSize=2*props["connector.size"];this.hitRegion.size({width:w+2*hitSize,height:h+2*hitSize}),this.diamond.points([w/2,0,w,h/2,w/2,h,0,h/2]);let offset=props["shape.select.offset"];this.selection.points([w/2,-offset-2,w+offset+2,h/2,w/2,h+offset+2,-offset-2,h/2]),this.text.size(s),zn.designer.shape.ConnectorPoint.updateForRectangularShape(this)}getRect(){let size=this.$shape.getSize(),pos=this.$shape.getPosition();return{x:pos.x,y:pos.y,width:size.width,height:size.height}}setRect(rect){this.$shape.setPosition({x:rect.x,y:rect.y}),this.updateShape(rect.width,rect.height),this.$shape.getLayer().batchDraw()}setText(text){this.ctx.text=text,this.text.text(text),this.$shape.getLayer().batchDraw()}setupEventHandlers(){let component=this,group=component.$shape;group.on("dragend",()=>base.handleShapeDragEnd(component)),group.on("dragmove",event=>base.handleShapeDragMove(component,event)),group.on("mouseenter",()=>base.handleShapeHover(component)),group.on("mousedown",event=>{event.evt.ctrlKey||base.handleShapeMouseDown(component)}),group.on("click",event=>{event.evt.ctrlKey?base.handleShapeSelectAdd(component):base.handleShapeClick(component)})}destroy(){this.$shape.destroy()}connectorLines(){return base.getConnetorLines(this)}}}(window),function(window){let __package="zn.designer.shape",__name="Ellipse",props=zn.designer.Properties,base=(zn.designer.Utils,zn.designer.shape.Base);__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=class{constructor(x,y,w,h,ctx,oid){this.$class=`${__package}.${__name}`,this.$type="ellipse",this.ctx=ctx,this.oid=oid||zn.shortid(),this.$shape=new Konva.Group({x:x,y:y,width:w,height:h,draggable:!0}),this.$shape.setAttr("zn-ctx",ctx),this.$shape.setAttr("zn-oid",this.oid),this.$shape.addName("ellipse"),this.addHitRegion(w,h,ctx),this.addSelectArea(w,h,ctx),this.addConnectorPoints(),this.addShapeDetails(w,h,ctx),this.addText(w,h,ctx),this.setupEventHandlers()}addHitRegion(w,h,ctx){let group=this.$shape,hitSize=2*props["connector.size"],hitRegion=new Konva.Rect({x:.5-hitSize,y:.5-hitSize,width:w+2*hitSize,height:h+2*hitSize,strokeWidth:0,fill:props["hitregion.fill"]});hitRegion.addName("hit-region"),group.add(hitRegion),this.hitRegion=hitRegion}addShapeDetails(w,h,ctx){let group=this.$shape,ellipse=new Konva.Ellipse({x:w/2+.5,y:h/2+.5,radius:{x:w/2,y:h/2},fill:props["ellipse.fill"],stroke:props["ellipse.stroke"],strokeWidth:3,listening:!1});ellipse.addName("ellipse"),group.add(ellipse),this.ellipse=ellipse}addSelectArea(w,h,ctx){let group=this.$shape,size=props["shape.select.offset"],selection=new Konva.Ellipse({x:w/2+.5,y:h/2+.5,radius:{x:w/2+size,y:h/2+size},fill:props["shape.select.fill"],stroke:props["shape.select.stroke"],strokeWidth:props["shape.select.stroke.size"],dash:[4,4],visible:!1,listening:!1});selection.addName("selection"),group.add(selection),this.selection=selection}addText(w,h,ctx){let group=this.$shape;if(!this.ctx.text)return;let text=new Konva.Text({x:0,y:0,width:w,height:h,text:ctx.text,align:"center",verticalAlign:"middle",strokeWidth:1,fontFamily:props["text.family"],fontSize:props["text.size"],fontStyle:props["text.style"],lineHeight:props["text.lineheight"],shadowForStrokeEnabled:!1,listening:!1});props["text.stroke"]?text.stroke(props["text.color"]):text.fill(props["text.color"]),text.addName("text"),group.add(text),this.text=text}addConnectorPoints(){let group=this.$shape;this.connectorPoints=zn.designer.shape.ConnectorPoint.generateForRectangularShape(group),Object.values(this.connectorPoints).forEach(point=>group.add(point.$shape))}updateShape(w,h){let s={width:w,height:h};this.$shape.setSize(s);let hitSize=2*props["connector.size"];this.hitRegion.size({width:w+2*hitSize,height:h+2*hitSize}),this.ellipse.position({x:w/2+.5,y:h/2+.5}),this.ellipse.radius({x:w/2,y:h/2});let offset=props["shape.select.offset"];this.selection.position({x:w/2+.5,y:h/2+.5}),this.selection.radius({x:w/2+offset,y:h/2+offset}),this.text.size(s),zn.designer.shape.ConnectorPoint.updateForRectangularShape(this)}getRect(){let size=this.$shape.getSize(),pos=this.$shape.getPosition();return{x:pos.x,y:pos.y,width:size.width,height:size.height}}setRect(rect){this.$shape.setPosition({x:rect.x,y:rect.y}),this.updateShape(rect.width,rect.height),this.$shape.getLayer().batchDraw()}setText(text){this.ctx.text=text,this.text.text(text),this.$shape.getLayer().batchDraw()}setupEventHandlers(){let component=this,group=component.$shape;group.on("dragend",()=>base.handleShapeDragEnd(component)),group.on("dragmove",event=>base.handleShapeDragMove(component,event)),group.on("mouseenter",()=>base.handleShapeHover(component)),group.on("mousedown",event=>{event.evt.ctrlKey||base.handleShapeMouseDown(component)}),group.on("click",event=>{event.evt.ctrlKey?base.handleShapeSelectAdd(component):base.handleShapeClick(component)})}destroy(){this.$shape.destroy()}connectorLines(){return base.getConnetorLines(this)}}}(window),function(window){let __package="zn.designer.shape",__name="HeaderNode",props=zn.designer.Properties,base=(zn.designer.Utils,zn.designer.shape.Base);__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=class{constructor(x,y,w,h,ctx,oid){this.$class=`${__package}.${__name}`,this.$type="header-node",this.ctx=ctx,this.oid=oid||zn.shortid(),this.$shape=new Konva.Group({x:x,y:y,width:w,height:h}),this.$shape.setAttr("zn-ctx",ctx),this.$shape.setAttr("zn-oid",this.oid),this.$shape.addName("rectangle"),this.addHitRegion(w,h,ctx),this.addConnectorPoints(),this.addShapeDetails(w,h,ctx),this.addText(w,h,ctx),this.setupEventHandlers()}addHitRegion(w,h,ctx){let group=this.$shape,hitSize=2*props["connector.size"],hitRegion=new Konva.Rect({x:-hitSize,y:-hitSize,width:w+2*hitSize,height:h+hitSize,strokeWidth:0,fill:props["hitregion.fill"]});hitRegion.addName("hit-region"),group.add(hitRegion),this.hitRegion=hitRegion}addShapeDetails(w,h,ctx){let group=this.$shape,rect=new Konva.Rect({x:0,y:0,width:w,height:h,fill:props["list.header.fill"],strokeWidth:0,listening:!1});rect.addName("rect"),group.add(rect),this.rect=rect;let line=new Konva.Line({points:[0,h,w,h],stroke:props["rect.stroke"],strokeWidth:1,listening:!1});group.add(line),this.line=line}addText(w,h,ctx){let group=this.$shape,offset=props["node.level.offset"],text=new Konva.Text({x:offset,y:2,width:w-offset,height:h,text:ctx.text,align:"left",verticalAlign:"middle",strokeWidth:1,fontFamily:props["text.family"],fontSize:props["text.size"],fontStyle:props["text.style"],lineHeight:props["text.lineheight"],shadowForStrokeEnabled:!1,listening:!1});props["text.stroke"]?text.stroke(props["text.color"]):text.fill(props["text.color"]),text.addName("text"),group.add(text),this.text=text}addConnectorPoints(){let group=this.$shape;this.connectorPoints={top:zn.designer.shape.ConnectorPoint.generateForShape(group,"top"),left:zn.designer.shape.ConnectorPoint.generateForShape(group,"left"),right:zn.designer.shape.ConnectorPoint.generateForShape(group,"right")},Object.values(this.connectorPoints).forEach(point=>group.add(point.$shape))}updateShape(w,h){let s={width:w,height:h};this.$shape.setSize(s);let hitSize=2*props["connector.size"];this.hitRegion.size({width:w+2*hitSize,height:h+2*hitSize}),this.rect.size(s),this.text.size(s),this.line.points([0,h,w,h]),zn.designer.shape.ConnectorPoint.updateForRectangularShape(this)}getRect(){let size=this.$shape.getSize(),pos=this.$shape.getPosition();return{x:pos.x,y:pos.y,width:size.width,height:size.height}}setupEventHandlers(){let component=this;component.$shape.on("mouseenter",()=>base.handleShapeHover(component))}mark(state){state?this.text.stroke(props["node.mark.color"]):this.text.stroke(props["text.color"]),this.$shape.getLayer().batchDraw()}destroy(){this.$shape.destroy()}connectorLines(){return base.getConnetorLines(this)}}}(window),function(window){let __package="zn.designer.shape",__name="List",props=zn.designer.Properties,base=(zn.designer.Utils,zn.designer.shape.Base);__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=class{constructor(x,y,w,h,ctx,oid){this.$class=`${__package}.${__name}`,this.$type="list",this.ctx=ctx,this.oid=oid||zn.shortid(),this.list=ctx.list,this.ch=25+this.list.length*props["node.height"],h>this.ch&&(this.ch=h),this.nodes=[],this.$shape=new Konva.Group({x:x,y:y,width:w,height:this.ch,draggable:!0}),this.$shape.setAttr("zn-ctx",ctx),this.$shape.setAttr("zn-oid",this.oid),this.$shape.addName("list"),this.addHitRegion(w,h,ctx),this.addSelectArea(w,h,ctx),this.addShapeBackground(w,h,ctx),this.addHeader(w,ctx),this.addShapeDetails(w,h,ctx),this.addShapeForeground(w,h,ctx),this.setupEventHandlers()}addHitRegion(w,h,ctx){let group=this.$shape,hitSize=2*props["connector.size"],hitRegion=new Konva.Rect({x:.5-hitSize,y:.5-hitSize,width:w+2*hitSize,height:this.ch+2*hitSize,strokeWidth:0,fill:props["hitregion.fill"]});hitRegion.addName("hit-region"),group.add(hitRegion),this.hitRegion=hitRegion}addShapeBackground(w,h,ctx){let group=this.$shape,background=new Konva.Rect({x:0,y:0,width:w,height:this.ch,fill:props["rect.fill"],cornerRadius:5,listening:!1});background.addName("background"),group.add(background),this.background=background}addShapeForeground(w,h,ctx){let group=this.$shape,foreground=new Konva.Rect({x:0,y:0,width:w,height:this.ch,stroke:props["rect.stroke"],strokeWidth:3,cornerRadius:5,listening:!1});foreground.addName("foreground"),group.add(foreground),this.foreground=foreground}addSelectArea(w,h,ctx){let group=this.$shape,size=props["shape.select.offset"],selection=new Konva.Rect({x:0-size,y:0-size,width:w+2*size,height:this.ch+2*size,fill:props["shape.select.fill"],strokeWidth:props["shape.select.stroke.size"],stroke:props["shape.select.stroke"],dash:[4,4],visible:!1,listening:!1,cornerRadius:5});selection.addName("selection"),group.add(selection),this.selection=selection}addHeader(w,ctx){let group=this.$shape;this.headerNode=new zn.designer.shape.HeaderNode(0,0,w,props["node.height"],{name:"item$",list:this.oid,type:"list-header",text:ctx.text}),this.headerNode.rect.cornerRadius([5,5,0,0]),group.add(this.headerNode.$shape)}addShapeDetails(w,h,ctx){let component=this,group=component.$shape,y=25;component.list.forEach((e,i)=>{let node=new zn.designer.shape.Node(0,y,w,props["node.height"],{name:`item$${i}`,index:i,list:component.oid,type:"list-item",...e});component.nodes.push(node),group.add(node.$shape),y+=25})}updateShape(w,h){let group=this.$shape,ch=25+this.list.length*props["node.height"],s={width:w,height:ch};group.setSize(s);let hitSize=2*props["connector.size"];this.hitRegion.size({width:w+2*hitSize,height:ch+2*hitSize}),this.background.size(s),this.foreground.size(s);let offset=props["shape.select.offset"];this.selection.size({width:w+2*offset,height:ch+2*offset}),this.headerNode.updateShape(w,25),this.nodes.forEach((node,i)=>node.updateShape(w,25)),zn.designer.shape.ConnectorPoint.updateForRectangularShape(this)}getRect(){let size=this.$shape.getSize(),pos=this.$shape.getPosition();return{x:pos.x,y:pos.y,width:size.width,height:this.ch}}setRect(rect){this.$shape.setPosition({x:rect.x,y:rect.y}),this.updateShape(rect.width,rect.height),this.$shape.getLayer().batchDraw()}setText(text){this.ctx.text=text,this.headerNode.text.text(text),this.$shape.getLayer().batchDraw()}insertNode(ctx,index){let component=this,group=component.$shape,size=component.$shape.getSize(),node=new zn.designer.shape.Node(0,25+25*index,size.width,props["node.height"],{name:`item$${index}`,index:index,list:component.oid,type:"list-item",...ctx});group.add(node.$shape),index?(component.nodes.splice(index,0,node),component.list.splice(index,0,ctx)):(component.nodes.push(node),component.list.push(ctx)),component.nodes.forEach((node,i)=>{node.setIndex(i),node.$shape.y(25+25*i)}),component.updateShape(size.width,50),component.$shape.getLayer().batchDraw()}deleteNode(index){let size=this.$shape.getSize(),node=this.nodes[index],connectorLines=node.connectorLines();node.$shape.getStage().fire("delete-connections",{ids:connectorLines}),node.destroy(),this.nodes.splice(index,1),this.list.splice(index,1),this.nodes.forEach((node,i)=>{node.setIndex(i),node.$shape.y(25+25*i)}),this.updateShape(size.width,50),this.$shape.getLayer().batchDraw()}moveNodeUp(index){if(index<=0)return;let size=this.$shape.getSize(),prevNode=this.nodes[index-1];this.nodes[index-1]=this.nodes[index],this.nodes[index]=prevNode;let prevItem=this.list[index-1];this.list[index-1]=this.list[index],this.list[index]=prevItem,this.nodes.forEach((node,i)=>{node.setIndex(i),node.$shape.y(25+25*i)}),this.updateShape(size.width,50),this.$shape.getLayer().batchDraw()}moveNodeDown(index){if(index>this.nodes.length-1)return;let size=this.$shape.getSize(),nextNode=this.nodes[index+1];this.nodes[index+1]=this.nodes[index],this.nodes[index]=nextNode;let nextItem=this.list[index+1];this.list[index+1]=this.list[index],this.list[index]=nextItem,this.nodes.forEach((node,i)=>{node.setIndex(i),node.$shape.y(25+25*i)}),this.updateShape(size.width,50),this.$shape.getLayer().batchDraw()}setNodeLevel(index,level){index>this.nodes.length-1||(this.nodes[index].setLevel(level),this.list[index].$level=level)}setNodeText(index,text){index>this.nodes.length-1||(this.nodes[index].setText(text),this.list[index].text=text)}setupEventHandlers(){let component=this,group=component.$shape;group.on("dragend",()=>{group.hasName("selected")||base.snap(group),base.fireConnectorPointUpdateEvent(component.headerNode.$shape),component.nodes.forEach(node=>base.fireConnectorPointUpdateEvent(node.$shape)),group.getStage().fire("shape-rect-update",{source:component})}),group.on("dragmove",event=>{base.fireConnectorPointUpdateEvent(component.headerNode.$shape),component.nodes.forEach(node=>base.fireConnectorPointUpdateEvent(node.$shape)),base.moveOtherSelectedObjects(group.getLayer(),group,event),group.getStage().fire("shape-rect-update",{source:component})}),group.on("mousedown",event=>{event.evt.ctrlKey||base.handleShapeMouseDown(component)}),group.on("click",event=>{event.evt.ctrlKey?base.handleShapeSelectAdd(component):base.handleShapeClick(component)})}destroy(){this.$shape.destroy()}connectorLines(){let lines=[];return lines.push(...this.headerNode.connectorLines()),this.nodes.forEach(node=>lines.push(...node.connectorLines())),lines}}}(window),function(window){let __package="zn.designer.shape",__name="Node",props=zn.designer.Properties,base=(zn.designer.Utils,zn.designer.shape.Base);__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=class{constructor(x,y,w,h,ctx,oid){this.$class=`${__package}.${__name}`,this.$type="node",this.ctx=ctx,this.oid=oid||zn.shortid(),this.$shape=new Konva.Group({x:x,y:y,width:w,height:h}),this.$shape.setAttr("zn-ctx",ctx),this.$shape.setAttr("zn-oid",this.oid),this.$shape.addName("rectangle"),this.addHitRegion(w,h,ctx),this.addConnectorPoints(),this.addShapeDetails(w,h,ctx),this.addText(w,h,ctx),this.setupEventHandlers()}addHitRegion(w,h,ctx){let group=this.$shape,hitSize=2*props["connector.size"],hitRegion=new Konva.Rect({x:-hitSize,y:0,width:w+2*hitSize,height:h,strokeWidth:0,fill:props["hitregion.fill"]});hitRegion.addName("hit-region"),group.add(hitRegion),this.hitRegion=hitRegion}addShapeDetails(w,h,ctx){let group=this.$shape,rect=new Konva.Rect({x:0,y:0,width:w,height:h,fill:props["rect.fill"],strokeWidth:0,listening:!1});rect.addName("rect"),group.add(rect),this.rect=rect}addText(w,h,ctx){let group=this.$shape,offset=((ctx.$level||0)+1)*props["node.level.offset"],text=new Konva.Text({x:offset,y:0,width:w-offset-20,height:h,text:ctx.text,align:"left",verticalAlign:"middle",strokeWidth:1,fontFamily:props["text.family"],fontSize:props["text.size"],fontStyle:props["text.style"],lineHeight:props["text.lineheight"],wrap:"none",ellipsis:!0,shadowForStrokeEnabled:!1,listening:!1});props["text.stroke"]?text.stroke(props["text.color"]):text.fill(props["text.color"]),text.addName("text"),group.add(text),this.text=text}addConnectorPoints(){let group=this.$shape;this.connectorPoints={left:zn.designer.shape.ConnectorPoint.generateForShape(group,"left"),right:zn.designer.shape.ConnectorPoint.generateForShape(group,"right")},Object.values(this.connectorPoints).forEach(point=>group.add(point.$shape))}updateShape(w,h){let s={width:w,height:h};this.$shape.setSize(s);let hitSize=2*props["connector.size"];this.hitRegion.size({width:w+2*hitSize,height:h}),this.rect.size(s),this.text.size({width:w-20,height:h}),zn.designer.shape.ConnectorPoint.updateForRectangularShape(this)}setText(text){this.ctx.text=text,this.text.text(text),this.$shape.getLayer().batchDraw()}setLevel(level){this.ctx.$level=level;let size=this.$shape.getSize(),offset=(level+1)*props["node.level.offset"];this.text.x(offset),this.text.width(size.width-offset-20),this.$shape.getLayer().batchDraw()}setIndex(index){this.ctx.index=index,this.connectorPoints.left.ctx.parent.index=index,this.connectorPoints.right.ctx.parent.index=index}getRect(){let size=this.$shape.getSize(),pos=this.$shape.getPosition();return{x:pos.x,y:pos.y,width:size.width,height:size.height}}setupEventHandlers(){let component=this,group=component.$shape;group.on("mouseenter",()=>{group.getParent().hasName("transform")||base.handleShapeHover(component)})}mark(state){state?this.text.stroke(props["node.mark.color"]):this.text.stroke(props["text.color"]),this.$shape.getLayer().batchDraw()}destroy(){this.$shape.destroy()}connectorLines(){return base.getConnetorLines(this)}}}(window),function(window){let __package="zn.designer.shape",__name="Pill",props=zn.designer.Properties,base=(zn.designer.Utils,zn.designer.shape.Base);__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=class{constructor(x,y,w,h,ctx,oid){this.$class=`${__package}.${__name}`,this.$type="pill",this.ctx=ctx,this.oid=oid||zn.shortid(),this.$shape=new Konva.Group({x:x,y:y,width:w,height:h,draggable:!0}),this.$shape.setAttr("zn-ctx",ctx),this.$shape.setAttr("zn-oid",this.oid),this.$shape.addName("pill"),this.addHitRegion(w,h,ctx),this.addSelectArea(w,h,ctx),this.addConnectorPoints(),this.addShapeDetails(w,h,ctx),this.addText(w,h,ctx),this.setupEventHandlers()}addHitRegion(w,h,ctx){let group=this.$shape,hitSize=2*props["connector.size"],hitRegion=new Konva.Rect({x:.5-hitSize,y:.5-hitSize,width:w+2*hitSize,height:h+2*hitSize,strokeWidth:0,fill:props["hitregion.fill"]});hitRegion.addName("hit-region"),group.add(hitRegion),this.hitRegion=hitRegion}addShapeDetails(w,h,ctx){let group=this.$shape,pill=new Konva.Rect({x:0,y:0,width:w,height:h,fill:props["pill.fill"],stroke:props["pill.stroke"],strokeWidth:3,cornerRadius:h/2,listening:!1});pill.addName("pill"),group.add(pill),this.pill=pill}addSelectArea(w,h,ctx){let group=this.$shape,size=props["shape.select.offset"],selection=new Konva.Rect({x:0-size,y:0-size,width:w+2*size,height:h+2*size,fill:props["shape.select.fill"],strokeWidth:props["shape.select.stroke.size"],stroke:props["shape.select.stroke"],cornerRadius:h/2+size,dash:[4,4],visible:!1,listening:!1});selection.addName("selection"),group.add(selection),this.selection=selection}addText(w,h,ctx){let group=this.$shape;if(!this.ctx.text)return;let text=new Konva.Text({x:0,y:0,width:w,height:h,text:ctx.text,align:"center",verticalAlign:"middle",strokeWidth:1,fontFamily:props["text.family"],fontSize:props["text.size"],fontStyle:props["text.style"],lineHeight:props["text.lineheight"],shadowForStrokeEnabled:!1,listening:!1});props["text.stroke"]?text.stroke(props["text.color"]):text.fill(props["text.color"]),text.addName("text"),group.add(text),this.text=text}addConnectorPoints(){let group=this.$shape;this.connectorPoints=zn.designer.shape.ConnectorPoint.generateForRectangularShape(group),Object.values(this.connectorPoints).forEach(point=>group.add(point.$shape))}updateShape(w,h){let s={width:w,height:h};this.$shape.setSize(s);let hitSize=2*props["connector.size"];this.hitRegion.size({width:w+2*hitSize,height:h+2*hitSize}),this.pill.size(s),this.pill.cornerRadius(h/2);let offset=props["shape.select.offset"];this.selection.size({width:w+2*offset,height:h+2*offset}),this.selection.cornerRadius(h/2+offset),this.text.size(s),zn.designer.shape.ConnectorPoint.updateForRectangularShape(this)}getRect(){let size=this.$shape.getSize(),pos=this.$shape.getPosition();return{x:pos.x,y:pos.y,width:size.width,height:size.height}}setRect(rect){this.$shape.setPosition({x:rect.x,y:rect.y}),this.updateShape(rect.width,rect.height),this.$shape.getLayer().batchDraw()}setText(text){this.ctx.text=text,this.text.text(text),this.$shape.getLayer().batchDraw()}setupEventHandlers(){let component=this,group=component.$shape;group.on("dragend",()=>base.handleShapeDragEnd(component)),group.on("dragmove",event=>base.handleShapeDragMove(component,event)),group.on("mouseenter",()=>base.handleShapeHover(component)),group.on("mousedown",event=>{event.evt.ctrlKey||base.handleShapeMouseDown(component)}),group.on("click",event=>{event.evt.ctrlKey?base.handleShapeSelectAdd(component):base.handleShapeClick(component)})}destroy(){this.$shape.destroy()}connectorLines(){return base.getConnetorLines(this)}}}(window),function(window){let __package="zn.designer.shape",__name="Rectangle",props=zn.designer.Properties,base=(zn.designer.Utils,zn.designer.shape.Base);__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=class{constructor(x,y,w,h,ctx,oid){this.$class=`${__package}.${__name}`,this.$type="rectangle",this.ctx=ctx,this.oid=oid||zn.shortid(),this.$shape=new Konva.Group({x:x,y:y,width:w,height:h,draggable:!0}),this.$shape.setAttr("zn-ctx",ctx),this.$shape.setAttr("zn-oid",this.oid),this.$shape.addName("rectangle"),this.addHitRegion(w,h,ctx),this.addSelectArea(w,h,ctx),this.addConnectorPoints(),this.addShapeDetails(w,h,ctx),this.addText(w,h,ctx),this.setupEventHandlers()}addHitRegion(w,h,ctx){let group=this.$shape,hitSize=2*props["connector.size"],hitRegion=new Konva.Rect({x:.5-hitSize,y:.5-hitSize,width:w+2*hitSize,height:h+2*hitSize,strokeWidth:0,fill:props["hitregion.fill"]});hitRegion.addName("hit-region"),group.add(hitRegion),this.hitRegion=hitRegion}addShapeDetails(w,h,ctx){let group=this.$shape,rect=new Konva.Rect({x:.5,y:.5,width:w,height:h,fill:props["rect.fill"],stroke:props["rect.stroke"],strokeWidth:3,cornerRadius:5,listening:!1});rect.addName("rect"),group.add(rect),this.rect=rect}addSelectArea(w,h,ctx){let group=this.$shape,size=props["shape.select.offset"],selection=new Konva.Rect({x:0-size,y:0-size,width:w+2*size,height:h+2*size,fill:props["shape.select.fill"],strokeWidth:props["shape.select.stroke.size"],stroke:props["shape.select.stroke"],dash:[4,4],visible:!1,listening:!1,cornerRadius:5});selection.addName("selection"),group.add(selection),this.selection=selection}addText(w,h,ctx){let group=this.$shape;if(!this.ctx.text)return;let text=new Konva.Text({x:0,y:0,width:w,height:h,text:ctx.text,align:"center",verticalAlign:"middle",strokeWidth:1,fontFamily:props["text.family"],fontSize:props["text.size"],fontStyle:props["text.style"],lineHeight:props["text.lineheight"],shadowForStrokeEnabled:!1,listening:!1});props["text.stroke"]?text.stroke(props["text.color"]):text.fill(props["text.color"]),text.addName("text"),group.add(text),this.text=text}addConnectorPoints(){let group=this.$shape;this.connectorPoints=zn.designer.shape.ConnectorPoint.generateForRectangularShape(group),Object.values(this.connectorPoints).forEach(point=>group.add(point.$shape))}updateShape(w,h){let s={width:w,height:h};this.$shape.setSize(s);let hitSize=2*props["connector.size"];this.hitRegion.size({width:w+2*hitSize,height:h+2*hitSize}),this.rect.size(s);let offset=props["shape.select.offset"];this.selection.size({width:w+2*offset,height:h+2*offset}),this.text.size(s),zn.designer.shape.ConnectorPoint.updateForRectangularShape(this)}getRect(){let size=this.$shape.getSize(),pos=this.$shape.getPosition();return props["connector.size"],{x:pos.x,y:pos.y,width:size.width,height:size.height}}setRect(rect){this.$shape.setPosition({x:rect.x,y:rect.y}),this.updateShape(rect.width,rect.height),this.$shape.getLayer().batchDraw()}setText(text){this.ctx.text=text,this.text.text(text),this.$shape.getLayer().batchDraw()}setupEventHandlers(){let component=this,group=component.$shape;group.on("dragend",()=>base.handleShapeDragEnd(component)),group.on("dragmove",event=>base.handleShapeDragMove(component,event)),group.on("mouseenter",()=>base.handleShapeHover(component)),group.on("mousedown",event=>{event.evt.ctrlKey||base.handleShapeMouseDown(component)}),group.on("click",event=>{event.evt.ctrlKey?base.handleShapeSelectAdd(component):base.handleShapeClick(component)})}destroy(){this.$shape.destroy()}connectorLines(){return base.getConnetorLines(this)}}}(window),function(window){let __package="zn.designer.shape",__name="Transformer",props=zn.designer.Properties,base=zn.designer.shape.Base;__package.split(".").reduce((a,e)=>a[e]=a[e]||{},window)[__name]=class{constructor(layer,target){this.$class=`${__package}.${__name}`,this.target=target,this.$shape=new Konva.Rect({fill:props["shape.transformer.fill"],strokeWidth:0,cornerRadius:5,draggable:!0}),this.$shape.addName("rectangle"),this.targetToTransformer(),layer.add(this.$shape),this.transformer=new Konva.Transformer({rotateEnabled:!1,anchorStroke:props["shape.transformer.stroke"],anchorFill:props["shape.transformer.stroke"],anchorSize:4,borderStroke:props["shape.transformer.stroke"],borderDash:[4,4],strokeWidth:2}),layer.add(this.transformer),this.transformer.nodes([this.$shape]),this.target.$shape.addName("transform"),this.target.$shape.draggable(!1),this.setupEventHandlers()}setupEventHandlers(){let component=this;component.$shape,component.transformer.on("transformstart",evt=>{component.transformerToTarget()}),component.transformer.on("transform",evt=>{component.transformerToTarget(!0),component.target.$shape.getStage().fire("shape-rect-update",{source:component.target}),component.target.$shape.getLayer().batchDraw()}),component.transformer.on("transformend",evt=>{component.transformerToTarget(!0),component.target.$shape.getStage().fire("shape-rect-update",{source:component.target}),component.$shape.getLayer().batchDraw()}),component.$shape.on("dragstart",evt=>{component.transformerToTarget()}),component.$shape.on("dragmove",evt=>{component.transformerToTarget(),component.target.$shape.getStage().fire("shape-rect-update",{source:component.target}),component.target.$shape.getLayer().batchDraw()}),component.$shape.on("dragend",evt=>{component.transformerToTarget(),base.snap(component.target.$shape),component.targetToTransformer(),base.fireConnectorPointUpdateEvent(component.target.$shape),component.target.$shape.getStage().fire("shape-rect-update",{source:component.target}),component.$shape.getLayer().batchDraw(),component.target.$shape.getLayer().batchDraw()})}targetToTransformer(){let pos=this.target.$shape.position(),size=this.target.$shape.size(),offset=props["shape.transformer.offset"]+.5;this.$shape.position({x:pos.x-offset,y:pos.y-offset}),this.$shape.scale({x:1,y:1}),this.$shape.size({width:size.width+2*offset,height:size.height+2*offset})}transformerToTarget(updateShapeSize){let component=this,pos=component.$shape.position(),size=component.transformer.size(),offset=props["shape.transformer.offset"]+.5;component.target.$shape.position({x:pos.x+offset,y:pos.y+offset}),updateShapeSize&&(component.target.$shape.size({width:size.width-2*offset,height:size.height-2*offset}),component.target.updateShape(size.width-2*offset,size.height-2*offset)),base.fireConnectorPointUpdateEvent(component.target.$shape)}destroy(){base.resetTransform(this.target);let layer=this.$shape.getLayer();this.$shape.destroy(),this.transformer.destroy(),layer.batchDraw()}}}(window),function(window){let props=zn.designer.Properties,utils=zn.designer.Utils,base=zn.designer.shape.Base;class Surface{constructor(options){this.options=options,this.eventHandlers={},this.data={shapeComponents:{},lineComponents:{}},this.shapeClasses={rectangle:"zn.designer.shape.Rectangle",diamond:"zn.designer.shape.Diamond",ellipse:"zn.designer.shape.Ellipse",pill:"zn.designer.shape.Pill",list:"zn.designer.shape.List"}}init(){this.$target=$(this.options.target),this.$target.addClass("zn-surface"),this.$target.attr("zn-surface",this.options.name),this.options.width=this.options.width||1500,this.options.height=this.options.height||1500,this.setupUI(),this.setupEventHandlers(),this.$target.get()[0].znc=this,this.fireEvent("init")}on(eventName,eventHandler){(this.eventHandlers[eventName]=this.eventHandlers[eventName]||[]).push(eventHandler)}fireEvent(eventName,event){let evt=event||{};evt.source=this,(this.eventHandlers[eventName]||[]).forEach(eh=>eh(evt))}setupUI(){this.$target.html(Surface.html()),this.$stage=this.$target.find(".zn-surface-stage"),this.$stage.css("width",this.options.width).css("height",this.options.height),this.stage=new Konva.Stage({container:this.$stage.get()[0],width:this.options.width,height:this.options.height}),this.stage.setAttr("snap",props["grid.snap.size"]),this.setupLayers()}setupLayers(){this.gridLayer=new zn.designer.layer.Grid(this.stage,this.options),this.stage.add(this.gridLayer.$layer),this.connectorsLayer=new Konva.Layer({name:"connectors-layer"}),this.stage.add(this.connectorsLayer),this.shapesLayer=new Konva.Layer({name:"shapes-layer"}),this.stage.add(this.shapesLayer),this.dragLayer=new Konva.Layer({name:"drag-layer"}),this.stage.add(this.dragLayer),this.stage.batchDraw()}setupEventHandlers(){let surface=this;surface.stage.on("mousedown",event=>{"position"==surface.mode?(surface.fireEvent("position",{x:event.evt.layerX,y:event.evt.layerY}),surface.mode="select"):surface.operation&&surface.operation.start(event.evt.layerX,event.evt.layerY)}),surface.stage.on("mousemove",event=>{surface.operation&&surface.operation.update(event.evt.layerX,event.evt.layerY)}),surface.stage.on("mouseup",event=>{surface.operation&&(surface.operation.end(event.evt.layerX,event.evt.layerY),surface.operation=null,surface.mode="select")}),surface.stage.on("shape-select",event=>surface.onShapeSelect(event)),surface.stage.on("shape-transform",event=>surface.onShapeTransform(event)),surface.stage.on("grid-select",event=>surface.onGridSelect(event)),surface.stage.on("grid-click",evt=>surface.fireEvent("stage-select",{event:evt})),surface.stage.on("connector-select",evt=>surface.onConnectorSelect(evt)),surface.stage.on("connection-select",evt=>surface.onConnectionSelect(evt)),surface.stage.on("points-connected",evt=>surface.onPointsConnected(evt)),surface.stage.on("select-objects",evt=>surface.onSelectObjects(evt)),surface.stage.on("selection-set-modify",evt=>surface.onSelectionSetModify(evt)),surface.stage.on("draw-object",evt=>surface.onDrawObject(evt)),surface.stage.on("shape-rect-update",evt=>surface.fireEvent("obj-rect-update",{obj:{...evt.source.ctx,oid:evt.source.oid}})),surface.stage.on("delete-connections",evt=>surface.deleteConnections(evt.ids)),surface.$stage.on("keydown",evt=>surface.handleKeyEvents(evt))}handleKeyEvents(evt){"Delete"==evt.key&&this.onDelete(),"c"==evt.key&&evt.ctrlKey&&this.onCopy(),"v"==evt.key&&evt.ctrlKey&&this.onPaste()}onShapeSelect(evt){let surface=this;surface.currentTransformer&&(surface.currentTransformer.destroy(),surface.currentTransformer=null),base.resetConnectorLineSelection(surface.connectorsLayer),surface.data.currentSelection={obj:evt.source.oid},surface.fireEvent("obj-select",{obj:{...evt.source.ctx,oid:evt.source.oid}})}onShapeTransform(evt){let source=evt.source;source.$shape;this.currentTransformer=new zn.designer.shape.Transformer(this.dragLayer,source),this.dragLayer.batchDraw()}onGridSelect(event){let surface=this,selectedItems=surface.shapesLayer.find(".selected").toArray();base.resetSelection(surface.shapesLayer),surface.currentTransformer&&(surface.currentTransformer.destroy(),surface.currentTransformer=null),selectedItems.length>0&&surface.fireEvent("selection-set-change",{selection:[]}),base.resetConnectorLineSelection(surface.connectorsLayer),"position"==surface.mode&&(surface.operation=new zn.designer.op.DrawObject(surface)),"draw"==surface.mode?surface.operation=new zn.designer.op.DrawObject(surface):surface.operation=new zn.designer.op.SelectObjects(surface),surface.operation.start(event.mouseEvent.evt.layerX,event.mouseEvent.evt.layerY),surface.data.currentSelection={}}onConnectorSelect(event){let source=event.source;source.$shape.getAttr("zn-ctx"),source.$shape.getParent().getAttr("zn-ctx");this.operation=new zn.designer.op.DrawConnector(this,source.$shape),this.operation.start()}onPointsConnected(event){let from=event.p0.getAttr("zn-ctx"),to=event.p1.getAttr("zn-ctx"),oid=this.addConnection({...from,oid:event.p0.getAttr("zn-oid")},{...to,oid:event.p1.getAttr("zn-oid")});this.fireEvent("rel-create",{from:{...from,oid:event.p0.getAttr("zn-oid")},to:{...to,oid:event.p1.getAttr("zn-oid")},oid:oid})}onConnectionSelect(evt){let source=evt.source,ctx=source.getAttr("zn-ctx"),selectedItems=this.shapesLayer.find(".selected").toArray();base.resetSelection(this.shapesLayer),selectedItems.length>0&&this.fireEvent("selection-set-change",{selection:[]}),this.data.currentSelection={rel:source.getAttr("zn-oid")},this.fireEvent("rel-select",{rel:{...ctx,oid:source.getAttr("zn-oid")}})}onSelectObjects(evt){base.resetSelection(this.shapesLayer);let selection=[];Object.values(this.data.shapeComponents).filter(shapeComponent=>utils.intersect(evt.rect,shapeComponent.getRect())).forEach(shapeComponent=>{let shape=shapeComponent.$shape;base.showSelection(shape,!0),shape.addName("selected"),selection.push({...shapeComponent.ctx,oid:shapeComponent.oid})}),this.data.currentSelection={set:selection},this.fireEvent("selection-set-change",{selection:selection})}onSelectionSetModify(evt){let selection=[];this.shapesLayer.find(".selected").each(shape=>{selection.push({...shape.getAttr("zn-ctx"),oid:shape.getAttr("zn-oid")})}),this.data.currentSelection={set:selection},this.fireEvent("selection-set-change",{selection:selection})}onDrawObject(evt){this.fireEvent("draw-object",{rect:evt.rect})}onDelete(){let surface=this,objs=[],rels=[];if(surface.data.currentSelection){if(surface.data.currentSelection.obj){let objctx=surface.data.shapeComponents[surface.data.currentSelection.obj].ctx;objs.push({...objctx,oid:surface.data.currentSelection.obj}),rels.push(...surface.getShapeConnections([surface.data.currentSelection.obj])),surface.deleteShape(surface.data.currentSelection.obj)}if(surface.data.currentSelection.rel){let relctx=surface.data.lineComponents[surface.data.currentSelection.rel].ctx;rels.push({...relctx,oid:surface.data.currentSelection.rel}),surface.deleteConnection(surface.data.currentSelection.rel)}if(surface.data.currentSelection.set){let shapeOids=surface.data.currentSelection.set.map(v=>v.oid);rels.push(...surface.getShapeConnections(shapeOids)),surface.deleteShapes(shapeOids)}surface.data.currentSelection={},surface.currentTransformer&&(surface.currentTransformer.destroy(),surface.currentTransformer=null),surface.fireEvent("delete",{objs:objs,rels:rels})}}onCopy(){let surface=this,selectedOids=surface.getSelection();0!=selectedOids.length&&(surface.copyPaste={list:[],count:0},selectedOids.forEach(oid=>{let shapeComponent=surface.data.shapeComponents[oid];surface.copyPaste.list.push(JSON.stringify(surface.shapeComponentData(shapeComponent)))}))}onPaste(){let surface=this;if(!surface.copyPaste||0==surface.copyPaste.list.length)return;zn.designer.shape.Base.resetSelection(surface.shapesLayer),surface.copyPaste.count++;let newSelection=[];surface.copyPaste.list.forEach(item=>{let shapeData=JSON.parse(item),d=10*surface.copyPaste.count;shapeData.rect.x+=d,shapeData.rect.y+=d;let oid=surface.addShape(shapeData.type,shapeData.rect,shapeData.ctx),shapeComponent=surface.data.shapeComponents[oid],$shape=shapeComponent.$shape;$shape.addName("selected"),zn.designer.shape.Base.showSelection($shape,!0),newSelection.push({...shapeComponent.ctx,oid:oid})}),surface.data.currentSelection={set:newSelection},surface.fireEvent("obj-create",{set:newSelection})}reset(){this.shapesLayer.destroyChildren(),this.connectorsLayer.destroyChildren(),this.shapesLayer.batchDraw(),this.connectorsLayer.batchDraw(),this.data={shapeComponents:{},lineComponents:{}}}addShapeComponent(shapeComponent){this.shapesLayer.add(shapeComponent.$shape),this.shapesLayer.batchDraw(),this.data.shapeComponents[shapeComponent.oid]=shapeComponent}addShape(type,rect,ctx,oid){let surface=this,clazz=zn.findClass(surface.shapeClasses[type]);if(null==clazz)return void console.error(`class ${surface.shapeClasses[type]} not found for shape type ${type}`);let shapeComponent=new clazz(rect.x,rect.y,rect.width,rect.height,ctx,oid);return surface.addShapeComponent(shapeComponent),base.snap(shapeComponent.$shape),shapeComponent.oid}deleteShape(id,redraw){if(!this.data.shapeComponents[id])return;let shapeComponent=this.data.shapeComponents[id],shapeConnections=shapeComponent.connectorLines();shapeComponent.destroy(),delete this.data.shapeComponents[id],"N"!==redraw&&this.shapesLayer.batchDraw(),this.deleteConnections(shapeConnections)}deleteShapes(ids){let surface=this;ids.forEach(id=>surface.deleteShape(id,"N")),surface.shapesLayer.batchDraw()}addConnectionComponent(connectorLineComponent){this.connectorsLayer.add(connectorLineComponent.$shape),this.connectorsLayer.batchDraw(),this.data.lineComponents[connectorLineComponent.oid]=connectorLineComponent}addConnection(from,to,oid){let fromCpData=this.cpData(from),toCpData=this.cpData(to),ctx={name:`${fromCpData.name}-${toCpData.name}`,from:fromCpData.cp.ctx,to:toCpData.cp.ctx},connectorLine=new zn.designer.shape.ConnectorLine(fromCpData.cp.$shape,toCpData.cp.$shape,ctx,oid);return this.addConnectionComponent(connectorLine),connectorLine.oid}getShapeConnections(shapeOids){let surface=this,connections=[];return shapeOids.forEach(shapeOid=>{surface.data.shapeComponents[shapeOid].connectorLines().forEach(coid=>connections.push({...surface.data.lineComponents[coid].ctx,oid:coid}))}),connections}deleteConnection(id,redraw){this.data.lineComponents[id]&&(this.data.lineComponents[id].destroy(),delete this.data.lineComponents[id],"N"!==redraw&&this.connectorsLayer.batchDraw())}deleteConnections(ids){let surface=this;ids.forEach(id=>surface.deleteConnection(id,"N")),surface.connectorsLayer.batchDraw()}setMode(mode){this.mode=mode}setSize(w,h){this.$stage.css("width",w).css("height",h),this.stage.width(w),this.stage.height(h),this.gridLayer.setSize(w,h)}getShapeComponent(oid){return this.data.shapeComponents[oid]}getConnectionComponent(oid){return this.data.lineComponents[oid]}getSelection(){let oids=[];return this.shapesLayer.find(".selected").each(shape=>{shape.hasName("transform")||oids.push(shape.getAttr("zn-oid"))}),oids}cpData(ctx){let parent=ctx.parent,map=this.data.shapeComponents,obj=map[parent.oid];return"list-item"==parent.type&&(obj=map[parent.list].nodes[parent.index]),"list-header"==parent.type&&(obj=map[parent.list].headerNode),{cp:obj.connectorPoints[ctx.name],name:`${parent.list?"/"+parent.list:""}/${parent.name}/${ctx.name}`}}shapeComponentData(shapeComponent){return{type:shapeComponent.$type,rect:shapeComponent.getRect(),ctx:shapeComponent.ctx,oid:shapeComponent.oid}}lineComponentData(lineComponent){return{...lineComponent.ctx,oid:lineComponent.oid}}exportData(){let component=this,jsonData={shapes:[],lines:[],stage:{}};return Object.values(component.data.shapeComponents).forEach(shapeComponent=>jsonData.shapes.push(component.shapeComponentData(shapeComponent))),Object.values(component.data.lineComponents).forEach(lineComponent=>jsonData.lines.push(component.lineComponentData(lineComponent))),jsonData.stage={width:component.stage.width(),height:component.stage.height(),lanes:component.options.lanes,lanesPos:component.options.lanesPosition},JSON.parse(JSON.stringify(jsonData))}importData(jsonData){let surface=this;surface.reset(),jsonData.shapes&&jsonData.shapes.forEach(shapeData=>surface.addShape(shapeData.type,shapeData.rect,shapeData.ctx,shapeData.oid)),jsonData.lines&&jsonData.lines.forEach(lineData=>surface.addConnection(lineData.from,lineData.to,lineData.oid)),jsonData.stage&&(surface.options.lanes=jsonData.stage.lanes,surface.options.lanesPosition=jsonData.stage.lanesPos,surface.setSize(jsonData.stage.width,jsonData.stage.height))}exportToJson(){return JSON.stringify(this.exportData())}importFromJson(jsonDataStr){return this.importData(JSON.parse(jsonDataStr))}downloadAsImage(){this.gridLayer.gridLinesGroup.visible(!1),this.gridLayer.boundingBox.visible(!0);let dataURL=this.stage.toDataURL({pixelRatio:1});this.gridLayer.boundingBox.visible(!1),this.gridLayer.gridLinesGroup.visible(!0);var downloadLink=document.createElement("a");downloadLink.download="surface-drawing.png",downloadLink.href=dataURL,document.body.appendChild(downloadLink),downloadLink.click(),document.body.removeChild(downloadLink)}getImageData(){this.gridLayer.gridLinesGroup.visible(!1),this.gridLayer.boundingBox.visible(!0);let dataURL=this.stage.toDataURL({pixelRatio:1});return this.gridLayer.boundingBox.visible(!1),this.gridLayer.gridLinesGroup.visible(!0),dataURL}static get(name){return $(`[zn-surface='${name}']`).get()[0].znc}static html(){return'<div class="zn-surface-stage" tabindex="1"></div>'}}"zn.designer".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Surface=Surface}(window),function(window){let directive={html:function(){return"<div></div>"},linkFn:function(scope,element,attrs){let options={target:element,name:scope.name,width:parseInt(scope.width),height:parseInt(scope.height),lanes:scope.lanes,lanesPosition:scope.lanespos},surface=new zn.designer.Surface(options);surface.on("rel-create",evt=>scope.onrelcreate({$event:evt})),surface.on("rel-select",evt=>scope.onrelselect({$event:evt})),surface.on("obj-create",evt=>scope.onobjcreate({$event:evt})),surface.on("obj-select",evt=>scope.onobjselect({$event:evt})),surface.on("selection-set-change",evt=>scope.onselectionchange({$event:evt})),surface.on("position",evt=>scope.onposition({$event:evt})),surface.on("draw-object",evt=>scope.ondrawobj({$event:evt})),surface.on("delete",evt=>scope.ondelete({$event:evt})),surface.on("stage-select",evt=>scope.onstageselect({$event:evt})),surface.on("obj-rect-update",evt=>scope.onobjrectupdate({$event:evt})),surface.init()},tag:"znSurface",factory:function(){return{scope:{name:"@",width:"@",height:"@",lanes:"@",lanespos:"@",onrelcreate:"&",onrelselect:"&",onobjcreate:"&",onobjselect:"&",onselectionchange:"&",onposition:"&",ondrawobj:"&",ondelete:"&",onstageselect:"&",onobjrectupdate:"&"},restrict:"A",template:"",replace:!0,link:directive.linkFn}}};"zn.designer.ng".split(".").reduce((a,e)=>a[e]=a[e]||{},window).surface=directive}(window),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global=global||self).CodeMirror=factory()}(this,function(){"use strict";var userAgent=navigator.userAgent,platform=navigator.platform,gecko=/gecko\/\d/i.test(userAgent),ie_upto10=/MSIE \d/.test(userAgent),ie_11up=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(userAgent),edge=/Edge\/(\d+)/.exec(userAgent),ie=ie_upto10||ie_11up||edge,ie_version=ie&&(ie_upto10?document.documentMode||6:+(edge||ie_11up)[1]),webkit=!edge&&/WebKit\//.test(userAgent),qtwebkit=webkit&&/Qt\/\d+\.\d+/.test(userAgent),chrome=!edge&&/Chrome\//.test(userAgent),presto=/Opera\//.test(userAgent),safari=/Apple Computer/.test(navigator.vendor),mac_geMountainLion=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(userAgent),phantom=/PhantomJS/.test(userAgent),ios=!edge&&/AppleWebKit/.test(userAgent)&&/Mobile\/\w+/.test(userAgent),android=/Android/.test(userAgent),mobile=ios||android||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent),mac=ios||/Mac/.test(platform),chromeOS=/\bCrOS\b/.test(userAgent),windows=/win/i.test(platform),presto_version=presto&&userAgent.match(/Version\/(\d*\.\d*)/);presto_version&&(presto_version=Number(presto_version[1])),presto_version&&presto_version>=15&&(presto=!1,webkit=!0);var flipCtrlCmd=mac&&(qtwebkit||presto&&(null==presto_version||presto_version<12.11)),captureRightClick=gecko||ie&&ie_version>=9;function classTest(cls){return new RegExp("(^|\\s)"+cls+"(?:$|\\s)\\s*")}var range,rmClass=function(node,cls){var current=node.className,match=classTest(cls).exec(current);if(match){var after=current.slice(match.index+match[0].length);node.className=current.slice(0,match.index)+(after?match[1]+after:"")}};function removeChildren(e){for(var count=e.childNodes.length;count>0;--count)e.removeChild(e.firstChild);return e}function removeChildrenAndAdd(parent,e){return removeChildren(parent).appendChild(e)}function elt(tag,content,className,style){var e=document.createElement(tag);if(className&&(e.className=className),style&&(e.style.cssText=style),"string"==typeof content)e.appendChild(document.createTextNode(content));else if(content)for(var i=0;i<content.length;++i)e.appendChild(content[i]);return e}function eltP(tag,content,className,style){var e=elt(tag,content,className,style);return e.setAttribute("role","presentation"),e}function contains(parent,child){if(3==child.nodeType&&(child=child.parentNode),parent.contains)return parent.contains(child);do{if(11==child.nodeType&&(child=child.host),child==parent)return!0}while(child=child.parentNode)}function activeElt(){var activeElement;try{activeElement=document.activeElement}catch(e){activeElement=document.body||null}for(;activeElement&&activeElement.shadowRoot&&activeElement.shadowRoot.activeElement;)activeElement=activeElement.shadowRoot.activeElement;return activeElement}function addClass(node,cls){var current=node.className;classTest(cls).test(current)||(node.className+=(current?" ":"")+cls)}function joinClasses(a,b){for(var as=a.split(" "),i=0;i<as.length;i++)as[i]&&!classTest(as[i]).test(b)&&(b+=" "+as[i]);return b}range=document.createRange?function(node,start,end,endNode){var r=document.createRange();return r.setEnd(endNode||node,end),r.setStart(node,start),r}:function(node,start,end){var r=document.body.createTextRange();try{r.moveToElementText(node.parentNode)}catch(e){return r}return r.collapse(!0),r.moveEnd("character",end),r.moveStart("character",start),r};var selectInput=function(node){node.select()};function bind(f){var args=Array.prototype.slice.call(arguments,1);return function(){return f.apply(null,args)}}function copyObj(obj,target,overwrite){for(var prop in target||(target={}),obj)!obj.hasOwnProperty(prop)||!1===overwrite&&target.hasOwnProperty(prop)||(target[prop]=obj[prop]);return target}function countColumn(string,end,tabSize,startIndex,startValue){null==end&&-1==(end=string.search(/[^\s\u00a0]/))&&(end=string.length);for(var i=startIndex||0,n=startValue||0;;){var nextTab=string.indexOf("\t",i);if(nextTab<0||nextTab>=end)return n+(end-i);n+=nextTab-i,n+=tabSize-n%tabSize,i=nextTab+1}}ios?selectInput=function(node){node.selectionStart=0,node.selectionEnd=node.value.length}:ie&&(selectInput=function(node){try{node.select()}catch(_e){}});var Delayed=function(){this.id=null,this.f=null,this.time=0,this.handler=bind(this.onTimeout,this)};function indexOf(array,elt){for(var i=0;i<array.length;++i)if(array[i]==elt)return i;return-1}Delayed.prototype.onTimeout=function(self){self.id=0,self.time<=+new Date?self.f():setTimeout(self.handler,self.time-+new Date)},Delayed.prototype.set=function(ms,f){this.f=f;var time=+new Date+ms;(!this.id||time<this.time)&&(clearTimeout(this.id),this.id=setTimeout(this.handler,ms),this.time=time)};var scrollerGap=50,Pass={toString:function(){return"CodeMirror.Pass"}},sel_dontScroll={scroll:!1},sel_mouse={origin:"*mouse"},sel_move={origin:"+move"};function findColumn(string,goal,tabSize){for(var pos=0,col=0;;){var nextTab=string.indexOf("\t",pos);-1==nextTab&&(nextTab=string.length);var skipped=nextTab-pos;if(nextTab==string.length||col+skipped>=goal)return pos+Math.min(skipped,goal-col);if(col+=nextTab-pos,pos=nextTab+1,(col+=tabSize-col%tabSize)>=goal)return pos}}var spaceStrs=[""];function spaceStr(n){for(;spaceStrs.length<=n;)spaceStrs.push(lst(spaceStrs)+" ");return spaceStrs[n]}function lst(arr){return arr[arr.length-1]}function map(array,f){for(var out=[],i=0;i<array.length;i++)out[i]=f(array[i],i);return out}function nothing(){}function createObj(base,props){var inst;return Object.create?inst=Object.create(base):(nothing.prototype=base,inst=new nothing),props&&copyObj(props,inst),inst}var nonASCIISingleCaseWordChar=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function isWordCharBasic(ch){return/\w/.test(ch)||ch>""&&(ch.toUpperCase()!=ch.toLowerCase()||nonASCIISingleCaseWordChar.test(ch))}function isWordChar(ch,helper){return helper?!!(helper.source.indexOf("\\w")>-1&&isWordCharBasic(ch))||helper.test(ch):isWordCharBasic(ch)}function isEmpty(obj){for(var n in obj)if(obj.hasOwnProperty(n)&&obj[n])return!1;return!0}var extendingChars=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function isExtendingChar(ch){return ch.charCodeAt(0)>=768&&extendingChars.test(ch)}function skipExtendingChars(str,pos,dir){for(;(dir<0?pos>0:pos<str.length)&&isExtendingChar(str.charAt(pos));)pos+=dir;return pos}function findFirst(pred,from,to){for(var dir=from>to?-1:1;;){if(from==to)return from;var midF=(from+to)/2,mid=dir<0?Math.ceil(midF):Math.floor(midF);if(mid==from)return pred(mid)?from:to;pred(mid)?to=mid:from=mid+dir}}var bidiOther=null;function getBidiPartAt(order,ch,sticky){var found;bidiOther=null;for(var i=0;i<order.length;++i){var cur=order[i];if(cur.from<ch&&cur.to>ch)return i;cur.to==ch&&(cur.from!=cur.to&&"before"==sticky?found=i:bidiOther=i),cur.from==ch&&(cur.from!=cur.to&&"before"!=sticky?found=i:bidiOther=i)}return null!=found?found:bidiOther}var bidiOrdering=function(){var lowTypes="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",arabicTypes="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";var bidiRE=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,isNeutral=/[stwN]/,isStrong=/[LRr]/,countsAsLeft=/[Lb1n]/,countsAsNum=/[1n]/;function BidiSpan(level,from,to){this.level=level,this.from=from,this.to=to}return function(str,direction){var outerType="ltr"==direction?"L":"R";if(0==str.length||"ltr"==direction&&!bidiRE.test(str))return!1;for(var code,len=str.length,types=[],i=0;i<len;++i)types.push((code=str.charCodeAt(i))<=247?lowTypes.charAt(code):1424<=code&&code<=1524?"R":1536<=code&&code<=1785?arabicTypes.charAt(code-1536):1774<=code&&code<=2220?"r":8192<=code&&code<=8203?"w":8204==code?"b":"L");for(var i$1=0,prev=outerType;i$1<len;++i$1){var type=types[i$1];"m"==type?types[i$1]=prev:prev=type}for(var i$2=0,cur=outerType;i$2<len;++i$2){var type$1=types[i$2];"1"==type$1&&"r"==cur?types[i$2]="n":isStrong.test(type$1)&&(cur=type$1,"r"==type$1&&(types[i$2]="R"))}for(var i$3=1,prev$1=types[0];i$3<len-1;++i$3){var type$2=types[i$3];"+"==type$2&&"1"==prev$1&&"1"==types[i$3+1]?types[i$3]="1":","!=type$2||prev$1!=types[i$3+1]||"1"!=prev$1&&"n"!=prev$1||(types[i$3]=prev$1),prev$1=type$2}for(var i$4=0;i$4<len;++i$4){var type$3=types[i$4];if(","==type$3)types[i$4]="N";else if("%"==type$3){var end=void 0;for(end=i$4+1;end<len&&"%"==types[end];++end);for(var replace=i$4&&"!"==types[i$4-1]||end<len&&"1"==types[end]?"1":"N",j=i$4;j<end;++j)types[j]=replace;i$4=end-1}}for(var i$5=0,cur$1=outerType;i$5<len;++i$5){var type$4=types[i$5];"L"==cur$1&&"1"==type$4?types[i$5]="L":isStrong.test(type$4)&&(cur$1=type$4)}for(var i$6=0;i$6<len;++i$6)if(isNeutral.test(types[i$6])){var end$1=void 0;for(end$1=i$6+1;end$1<len&&isNeutral.test(types[end$1]);++end$1);for(var before="L"==(i$6?types[i$6-1]:outerType),replace$1=before==("L"==(end$1<len?types[end$1]:outerType))?before?"L":"R":outerType,j$1=i$6;j$1<end$1;++j$1)types[j$1]=replace$1;i$6=end$1-1}for(var m,order=[],i$7=0;i$7<len;)if(countsAsLeft.test(types[i$7])){var start=i$7;for(++i$7;i$7<len&&countsAsLeft.test(types[i$7]);++i$7);order.push(new BidiSpan(0,start,i$7))}else{var pos=i$7,at=order.length,isRTL="rtl"==direction?1:0;for(++i$7;i$7<len&&"L"!=types[i$7];++i$7);for(var j$2=pos;j$2<i$7;)if(countsAsNum.test(types[j$2])){pos<j$2&&(order.splice(at,0,new BidiSpan(1,pos,j$2)),at+=isRTL);var nstart=j$2;for(++j$2;j$2<i$7&&countsAsNum.test(types[j$2]);++j$2);order.splice(at,0,new BidiSpan(2,nstart,j$2)),at+=isRTL,pos=j$2}else++j$2;pos<i$7&&order.splice(at,0,new BidiSpan(1,pos,i$7))}return"ltr"==direction&&(1==order[0].level&&(m=str.match(/^\s+/))&&(order[0].from=m[0].length,order.unshift(new BidiSpan(0,0,m[0].length))),1==lst(order).level&&(m=str.match(/\s+$/))&&(lst(order).to-=m[0].length,order.push(new BidiSpan(0,len-m[0].length,len)))),"rtl"==direction?order.reverse():order}}();function getOrder(line,direction){var order=line.order;return null==order&&(order=line.order=bidiOrdering(line.text,direction)),order}var noHandlers=[],on=function(emitter,type,f){if(emitter.addEventListener)emitter.addEventListener(type,f,!1);else if(emitter.attachEvent)emitter.attachEvent("on"+type,f);else{var map=emitter._handlers||(emitter._handlers={});map[type]=(map[type]||noHandlers).concat(f)}};function getHandlers(emitter,type){return emitter._handlers&&emitter._handlers[type]||noHandlers}function off(emitter,type,f){if(emitter.removeEventListener)emitter.removeEventListener(type,f,!1);else if(emitter.detachEvent)emitter.detachEvent("on"+type,f);else{var map=emitter._handlers,arr=map&&map[type];if(arr){var index=indexOf(arr,f);index>-1&&(map[type]=arr.slice(0,index).concat(arr.slice(index+1)))}}}function signal(emitter,type){var handlers=getHandlers(emitter,type);if(handlers.length)for(var args=Array.prototype.slice.call(arguments,2),i=0;i<handlers.length;++i)handlers[i].apply(null,args)}function signalDOMEvent(cm,e,override){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),signal(cm,override||e.type,cm,e),e_defaultPrevented(e)||e.codemirrorIgnore}function signalCursorActivity(cm){var arr=cm._handlers&&cm._handlers.cursorActivity;if(arr)for(var set=cm.curOp.cursorActivityHandlers||(cm.curOp.cursorActivityHandlers=[]),i=0;i<arr.length;++i)-1==indexOf(set,arr[i])&&set.push(arr[i])}function hasHandler(emitter,type){return getHandlers(emitter,type).length>0}function eventMixin(ctor){ctor.prototype.on=function(type,f){on(this,type,f)},ctor.prototype.off=function(type,f){off(this,type,f)}}function e_preventDefault(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function e_stopPropagation(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function e_defaultPrevented(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function e_stop(e){e_preventDefault(e),e_stopPropagation(e)}function e_target(e){return e.target||e.srcElement}function e_button(e){var b=e.which;return null==b&&(1&e.button?b=1:2&e.button?b=3:4&e.button&&(b=2)),mac&&e.ctrlKey&&1==b&&(b=3),b}var zwspSupported,badBidiRects,dragAndDrop=function(){if(ie&&ie_version<9)return!1;var div=elt("div");return"draggable"in div||"dragDrop"in div}();function zeroWidthElement(measure){if(null==zwspSupported){var test=elt("span","​");removeChildrenAndAdd(measure,elt("span",[test,document.createTextNode("x")])),0!=measure.firstChild.offsetHeight&&(zwspSupported=test.offsetWidth<=1&&test.offsetHeight>2&&!(ie&&ie_version<8))}var node=zwspSupported?elt("span","​"):elt("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return node.setAttribute("cm-text",""),node}function hasBadBidiRects(measure){if(null!=badBidiRects)return badBidiRects;var txt=removeChildrenAndAdd(measure,document.createTextNode("AخA")),r0=range(txt,0,1).getBoundingClientRect(),r1=range(txt,1,2).getBoundingClientRect();return removeChildren(measure),!(!r0||r0.left==r0.right)&&(badBidiRects=r1.right-r0.right<3)}var e,splitLinesAuto=3!="\n\nb".split(/\n/).length?function(string){for(var pos=0,result=[],l=string.length;pos<=l;){var nl=string.indexOf("\n",pos);-1==nl&&(nl=string.length);var line=string.slice(pos,"\r"==string.charAt(nl-1)?nl-1:nl),rt=line.indexOf("\r");-1!=rt?(result.push(line.slice(0,rt)),pos+=rt+1):(result.push(line),pos=nl+1)}return result}:function(string){return string.split(/\r\n?|\n/)},hasSelection=window.getSelection?function(te){try{return te.selectionStart!=te.selectionEnd}catch(e){return!1}}:function(te){var range;try{range=te.ownerDocument.selection.createRange()}catch(e){}return!(!range||range.parentElement()!=te)&&0!=range.compareEndPoints("StartToEnd",range)},hasCopyEvent="oncopy"in(e=elt("div"))||(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy),badZoomedRects=null;var modes={},mimeModes={};function resolveMode(spec){if("string"==typeof spec&&mimeModes.hasOwnProperty(spec))spec=mimeModes[spec];else if(spec&&"string"==typeof spec.name&&mimeModes.hasOwnProperty(spec.name)){var found=mimeModes[spec.name];"string"==typeof found&&(found={name:found}),(spec=createObj(found,spec)).name=found.name}else{if("string"==typeof spec&&/^[\w\-]+\/[\w\-]+\+xml$/.test(spec))return resolveMode("application/xml");if("string"==typeof spec&&/^[\w\-]+\/[\w\-]+\+json$/.test(spec))return resolveMode("application/json")}return"string"==typeof spec?{name:spec}:spec||{name:"null"}}function getMode(options,spec){spec=resolveMode(spec);var mfactory=modes[spec.name];if(!mfactory)return getMode(options,"text/plain");var modeObj=mfactory(options,spec);if(modeExtensions.hasOwnProperty(spec.name)){var exts=modeExtensions[spec.name];for(var prop in exts)exts.hasOwnProperty(prop)&&(modeObj.hasOwnProperty(prop)&&(modeObj["_"+prop]=modeObj[prop]),modeObj[prop]=exts[prop])}if(modeObj.name=spec.name,spec.helperType&&(modeObj.helperType=spec.helperType),spec.modeProps)for(var prop$1 in spec.modeProps)modeObj[prop$1]=spec.modeProps[prop$1];return modeObj}var modeExtensions={};function extendMode(mode,properties){copyObj(properties,modeExtensions.hasOwnProperty(mode)?modeExtensions[mode]:modeExtensions[mode]={})}function copyState(mode,state){if(!0===state)return state;if(mode.copyState)return mode.copyState(state);var nstate={};for(var n in state){var val=state[n];val instanceof Array&&(val=val.concat([])),nstate[n]=val}return nstate}function innerMode(mode,state){for(var info;mode.innerMode&&(info=mode.innerMode(state))&&info.mode!=mode;)state=info.state,mode=info.mode;return info||{mode:mode,state:state}}function startState(mode,a1,a2){return!mode.startState||mode.startState(a1,a2)}var StringStream=function(string,tabSize,lineOracle){this.pos=this.start=0,this.string=string,this.tabSize=tabSize||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=lineOracle};function getLine(doc,n){if((n-=doc.first)<0||n>=doc.size)throw new Error("There is no line "+(n+doc.first)+" in the document.");for(var chunk=doc;!chunk.lines;)for(var i=0;;++i){var child=chunk.children[i],sz=child.chunkSize();if(n<sz){chunk=child;break}n-=sz}return chunk.lines[n]}function getBetween(doc,start,end){var out=[],n=start.line;return doc.iter(start.line,end.line+1,function(line){var text=line.text;n==end.line&&(text=text.slice(0,end.ch)),n==start.line&&(text=text.slice(start.ch)),out.push(text),++n}),out}function getLines(doc,from,to){var out=[];return doc.iter(from,to,function(line){out.push(line.text)}),out}function updateLineHeight(line,height){var diff=height-line.height;if(diff)for(var n=line;n;n=n.parent)n.height+=diff}function lineNo(line){if(null==line.parent)return null;for(var cur=line.parent,no=indexOf(cur.lines,line),chunk=cur.parent;chunk;cur=chunk,chunk=chunk.parent)for(var i=0;chunk.children[i]!=cur;++i)no+=chunk.children[i].chunkSize();return no+cur.first}function lineAtHeight(chunk,h){var n=chunk.first;outer:do{for(var i$1=0;i$1<chunk.children.length;++i$1){var child=chunk.children[i$1],ch=child.height;if(h<ch){chunk=child;continue outer}h-=ch,n+=child.chunkSize()}return n}while(!chunk.lines);for(var i=0;i<chunk.lines.length;++i){var lh=chunk.lines[i].height;if(h<lh)break;h-=lh}return n+i}function isLine(doc,l){return l>=doc.first&&l<doc.first+doc.size}function lineNumberFor(options,i){return String(options.lineNumberFormatter(i+options.firstLineNumber))}function Pos(line,ch,sticky){if(void 0===sticky&&(sticky=null),!(this instanceof Pos))return new Pos(line,ch,sticky);this.line=line,this.ch=ch,this.sticky=sticky}function cmp(a,b){return a.line-b.line||a.ch-b.ch}function equalCursorPos(a,b){return a.sticky==b.sticky&&0==cmp(a,b)}function copyPos(x){return Pos(x.line,x.ch)}function maxPos(a,b){return cmp(a,b)<0?b:a}function minPos(a,b){return cmp(a,b)<0?a:b}function clipLine(doc,n){return Math.max(doc.first,Math.min(n,doc.first+doc.size-1))}function clipPos(doc,pos){if(pos.line<doc.first)return Pos(doc.first,0);var last=doc.first+doc.size-1;return pos.line>last?Pos(last,getLine(doc,last).text.length):function(pos,linelen){var ch=pos.ch;return null==ch||ch>linelen?Pos(pos.line,linelen):ch<0?Pos(pos.line,0):pos}(pos,getLine(doc,pos.line).text.length)}function clipPosArray(doc,array){for(var out=[],i=0;i<array.length;i++)out[i]=clipPos(doc,array[i]);return out}StringStream.prototype.eol=function(){return this.pos>=this.string.length},StringStream.prototype.sol=function(){return this.pos==this.lineStart},StringStream.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},StringStream.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},StringStream.prototype.eat=function(match){var ch=this.string.charAt(this.pos);if("string"==typeof match?ch==match:ch&&(match.test?match.test(ch):match(ch)))return++this.pos,ch},StringStream.prototype.eatWhile=function(match){for(var start=this.pos;this.eat(match););return this.pos>start},StringStream.prototype.eatSpace=function(){for(var start=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>start},StringStream.prototype.skipToEnd=function(){this.pos=this.string.length},StringStream.prototype.skipTo=function(ch){var found=this.string.indexOf(ch,this.pos);if(found>-1)return this.pos=found,!0},StringStream.prototype.backUp=function(n){this.pos-=n},StringStream.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=countColumn(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},StringStream.prototype.indentation=function(){return countColumn(this.string,null,this.tabSize)-(this.lineStart?countColumn(this.string,this.lineStart,this.tabSize):0)},StringStream.prototype.match=function(pattern,consume,caseInsensitive){if("string"!=typeof pattern){var match=this.string.slice(this.pos).match(pattern);return match&&match.index>0?null:(match&&!1!==consume&&(this.pos+=match[0].length),match)}var cased=function(str){return caseInsensitive?str.toLowerCase():str};if(cased(this.string.substr(this.pos,pattern.length))==cased(pattern))return!1!==consume&&(this.pos+=pattern.length),!0},StringStream.prototype.current=function(){return this.string.slice(this.start,this.pos)},StringStream.prototype.hideFirstChars=function(n,inner){this.lineStart+=n;try{return inner()}finally{this.lineStart-=n}},StringStream.prototype.lookAhead=function(n){var oracle=this.lineOracle;return oracle&&oracle.lookAhead(n)},StringStream.prototype.baseToken=function(){var oracle=this.lineOracle;return oracle&&oracle.baseToken(this.pos)};var SavedContext=function(state,lookAhead){this.state=state,this.lookAhead=lookAhead},Context=function(doc,state,line,lookAhead){this.state=state,this.doc=doc,this.line=line,this.maxLookAhead=lookAhead||0,this.baseTokens=null,this.baseTokenPos=1};function highlightLine(cm,line,context,forceToEnd){var st=[cm.state.modeGen],lineClasses={};runMode(cm,line.text,cm.doc.mode,context,function(end,style){return st.push(end,style)},lineClasses,forceToEnd);for(var state=context.state,loop=function(o){context.baseTokens=st;var overlay=cm.state.overlays[o],i=1,at=0;context.state=!0,runMode(cm,line.text,overlay.mode,context,function(end,style){for(var start=i;at<end;){var i_end=st[i];i_end>end&&st.splice(i,1,end,st[i+1],i_end),i+=2,at=Math.min(end,i_end)}if(style)if(overlay.opaque)st.splice(start,i-start,end,"overlay "+style),i=start+2;else for(;start<i;start+=2){var cur=st[start+1];st[start+1]=(cur?cur+" ":"")+"overlay "+style}},lineClasses),context.state=state,context.baseTokens=null,context.baseTokenPos=1},o=0;o<cm.state.overlays.length;++o)loop(o);return{styles:st,classes:lineClasses.bgClass||lineClasses.textClass?lineClasses:null}}function getLineStyles(cm,line,updateFrontier){if(!line.styles||line.styles[0]!=cm.state.modeGen){var context=getContextBefore(cm,lineNo(line)),resetState=line.text.length>cm.options.maxHighlightLength&&copyState(cm.doc.mode,context.state),result=highlightLine(cm,line,context);resetState&&(context.state=resetState),line.stateAfter=context.save(!resetState),line.styles=result.styles,result.classes?line.styleClasses=result.classes:line.styleClasses&&(line.styleClasses=null),updateFrontier===cm.doc.highlightFrontier&&(cm.doc.modeFrontier=Math.max(cm.doc.modeFrontier,++cm.doc.highlightFrontier))}return line.styles}function getContextBefore(cm,n,precise){var doc=cm.doc,display=cm.display;if(!doc.mode.startState)return new Context(doc,!0,n);var start=function(cm,n,precise){for(var minindent,minline,doc=cm.doc,lim=precise?-1:n-(cm.doc.mode.innerMode?1e3:100),search=n;search>lim;--search){if(search<=doc.first)return doc.first;var line=getLine(doc,search-1),after=line.stateAfter;if(after&&(!precise||search+(after instanceof SavedContext?after.lookAhead:0)<=doc.modeFrontier))return search;var indented=countColumn(line.text,null,cm.options.tabSize);(null==minline||minindent>indented)&&(minline=search-1,minindent=indented)}return minline}(cm,n,precise),saved=start>doc.first&&getLine(doc,start-1).stateAfter,context=saved?Context.fromSaved(doc,saved,start):new Context(doc,startState(doc.mode),start);return doc.iter(start,n,function(line){processLine(cm,line.text,context);var pos=context.line;line.stateAfter=pos==n-1||pos%5==0||pos>=display.viewFrom&&pos<display.viewTo?context.save():null,context.nextLine()}),precise&&(doc.modeFrontier=context.line),context}function processLine(cm,text,context,startAt){var mode=cm.doc.mode,stream=new StringStream(text,cm.options.tabSize,context);for(stream.start=stream.pos=startAt||0,""==text&&callBlankLine(mode,context.state);!stream.eol();)readToken(mode,stream,context.state),stream.start=stream.pos}function callBlankLine(mode,state){if(mode.blankLine)return mode.blankLine(state);if(mode.innerMode){var inner=innerMode(mode,state);return inner.mode.blankLine?inner.mode.blankLine(inner.state):void 0}}function readToken(mode,stream,state,inner){for(var i=0;i<10;i++){inner&&(inner[0]=innerMode(mode,state).mode);var style=mode.token(stream,state);if(stream.pos>stream.start)return style}throw new Error("Mode "+mode.name+" failed to advance stream.")}Context.prototype.lookAhead=function(n){var line=this.doc.getLine(this.line+n);return null!=line&&n>this.maxLookAhead&&(this.maxLookAhead=n),line},Context.prototype.baseToken=function(n){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=n;)this.baseTokenPos+=2;var type=this.baseTokens[this.baseTokenPos+1];return{type:type&&type.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-n}},Context.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},Context.fromSaved=function(doc,saved,line){return saved instanceof SavedContext?new Context(doc,copyState(doc.mode,saved.state),line,saved.lookAhead):new Context(doc,copyState(doc.mode,saved),line)},Context.prototype.save=function(copy){var state=!1!==copy?copyState(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new SavedContext(state,this.maxLookAhead):state};var Token=function(stream,type,state){this.start=stream.start,this.end=stream.pos,this.string=stream.current(),this.type=type||null,this.state=state};function takeToken(cm,pos,precise,asArray){var style,tokens,doc=cm.doc,mode=doc.mode,line=getLine(doc,(pos=clipPos(doc,pos)).line),context=getContextBefore(cm,pos.line,precise),stream=new StringStream(line.text,cm.options.tabSize,context);for(asArray&&(tokens=[]);(asArray||stream.pos<pos.ch)&&!stream.eol();)stream.start=stream.pos,style=readToken(mode,stream,context.state),asArray&&tokens.push(new Token(stream,style,copyState(doc.mode,context.state)));return asArray?tokens:new Token(stream,style,context.state)}function extractLineClasses(type,output){if(type)for(;;){var lineClass=type.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!lineClass)break;type=type.slice(0,lineClass.index)+type.slice(lineClass.index+lineClass[0].length);var prop=lineClass[1]?"bgClass":"textClass";null==output[prop]?output[prop]=lineClass[2]:new RegExp("(?:^|\\s)"+lineClass[2]+"(?:$|\\s)").test(output[prop])||(output[prop]+=" "+lineClass[2])}return type}function runMode(cm,text,mode,context,f,lineClasses,forceToEnd){var flattenSpans=mode.flattenSpans;null==flattenSpans&&(flattenSpans=cm.options.flattenSpans);var style,curStart=0,curStyle=null,stream=new StringStream(text,cm.options.tabSize,context),inner=cm.options.addModeClass&&[null];for(""==text&&extractLineClasses(callBlankLine(mode,context.state),lineClasses);!stream.eol();){if(stream.pos>cm.options.maxHighlightLength?(flattenSpans=!1,forceToEnd&&processLine(cm,text,context,stream.pos),stream.pos=text.length,style=null):style=extractLineClasses(readToken(mode,stream,context.state,inner),lineClasses),inner){var mName=inner[0].name;mName&&(style="m-"+(style?mName+" "+style:mName))}if(!flattenSpans||curStyle!=style){for(;curStart<stream.start;)f(curStart=Math.min(stream.start,curStart+5e3),curStyle);curStyle=style}stream.start=stream.pos}for(;curStart<stream.pos;){var pos=Math.min(stream.pos,curStart+5e3);f(pos,curStyle),curStart=pos}}var sawReadOnlySpans=!1,sawCollapsedSpans=!1;function MarkedSpan(marker,from,to){this.marker=marker,this.from=from,this.to=to}function getMarkedSpanFor(spans,marker){if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];if(span.marker==marker)return span}}function removeMarkedSpan(spans,span){for(var r,i=0;i<spans.length;++i)spans[i]!=span&&(r||(r=[])).push(spans[i]);return r}function stretchSpansOverChange(doc,change){if(change.full)return null;var oldFirst=isLine(doc,change.from.line)&&getLine(doc,change.from.line).markedSpans,oldLast=isLine(doc,change.to.line)&&getLine(doc,change.to.line).markedSpans;if(!oldFirst&&!oldLast)return null;var startCh=change.from.ch,endCh=change.to.ch,isInsert=0==cmp(change.from,change.to),first=function(old,startCh,isInsert){var nw;if(old)for(var i=0;i<old.length;++i){var span=old[i],marker=span.marker;if(null==span.from||(marker.inclusiveLeft?span.from<=startCh:span.from<startCh)||span.from==startCh&&"bookmark"==marker.type&&(!isInsert||!span.marker.insertLeft)){var endsAfter=null==span.to||(marker.inclusiveRight?span.to>=startCh:span.to>startCh);(nw||(nw=[])).push(new MarkedSpan(marker,span.from,endsAfter?null:span.to))}}return nw}(oldFirst,startCh,isInsert),last=function(old,endCh,isInsert){var nw;if(old)for(var i=0;i<old.length;++i){var span=old[i],marker=span.marker;if(null==span.to||(marker.inclusiveRight?span.to>=endCh:span.to>endCh)||span.from==endCh&&"bookmark"==marker.type&&(!isInsert||span.marker.insertLeft)){var startsBefore=null==span.from||(marker.inclusiveLeft?span.from<=endCh:span.from<endCh);(nw||(nw=[])).push(new MarkedSpan(marker,startsBefore?null:span.from-endCh,null==span.to?null:span.to-endCh))}}return nw}(oldLast,endCh,isInsert),sameLine=1==change.text.length,offset=lst(change.text).length+(sameLine?startCh:0);if(first)for(var i=0;i<first.length;++i){var span=first[i];if(null==span.to){var found=getMarkedSpanFor(last,span.marker);found?sameLine&&(span.to=null==found.to?null:found.to+offset):span.to=startCh}}if(last)for(var i$1=0;i$1<last.length;++i$1){var span$1=last[i$1];if(null!=span$1.to&&(span$1.to+=offset),null==span$1.from)getMarkedSpanFor(first,span$1.marker)||(span$1.from=offset,sameLine&&(first||(first=[])).push(span$1));else span$1.from+=offset,sameLine&&(first||(first=[])).push(span$1)}first&&(first=clearEmptySpans(first)),last&&last!=first&&(last=clearEmptySpans(last));var newMarkers=[first];if(!sameLine){var gapMarkers,gap=change.text.length-2;if(gap>0&&first)for(var i$2=0;i$2<first.length;++i$2)null==first[i$2].to&&(gapMarkers||(gapMarkers=[])).push(new MarkedSpan(first[i$2].marker,null,null));for(var i$3=0;i$3<gap;++i$3)newMarkers.push(gapMarkers);newMarkers.push(last)}return newMarkers}function clearEmptySpans(spans){for(var i=0;i<spans.length;++i){var span=spans[i];null!=span.from&&span.from==span.to&&!1!==span.marker.clearWhenEmpty&&spans.splice(i--,1)}return spans.length?spans:null}function detachMarkedSpans(line){var spans=line.markedSpans;if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.detachLine(line);line.markedSpans=null}}function attachMarkedSpans(line,spans){if(spans){for(var i=0;i<spans.length;++i)spans[i].marker.attachLine(line);line.markedSpans=spans}}function extraLeft(marker){return marker.inclusiveLeft?-1:0}function extraRight(marker){return marker.inclusiveRight?1:0}function compareCollapsedMarkers(a,b){var lenDiff=a.lines.length-b.lines.length;if(0!=lenDiff)return lenDiff;var aPos=a.find(),bPos=b.find(),fromCmp=cmp(aPos.from,bPos.from)||extraLeft(a)-extraLeft(b);if(fromCmp)return-fromCmp;var toCmp=cmp(aPos.to,bPos.to)||extraRight(a)-extraRight(b);return toCmp||b.id-a.id}function collapsedSpanAtSide(line,start){var found,sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp=void 0,i=0;i<sps.length;++i)(sp=sps[i]).marker.collapsed&&null==(start?sp.from:sp.to)&&(!found||compareCollapsedMarkers(found,sp.marker)<0)&&(found=sp.marker);return found}function collapsedSpanAtStart(line){return collapsedSpanAtSide(line,!0)}function collapsedSpanAtEnd(line){return collapsedSpanAtSide(line,!1)}function collapsedSpanAround(line,ch){var found,sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var i=0;i<sps.length;++i){var sp=sps[i];sp.marker.collapsed&&(null==sp.from||sp.from<ch)&&(null==sp.to||sp.to>ch)&&(!found||compareCollapsedMarkers(found,sp.marker)<0)&&(found=sp.marker)}return found}function conflictingCollapsedRange(doc,lineNo,from,to,marker){var line=getLine(doc,lineNo),sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var i=0;i<sps.length;++i){var sp=sps[i];if(sp.marker.collapsed){var found=sp.marker.find(0),fromCmp=cmp(found.from,from)||extraLeft(sp.marker)-extraLeft(marker),toCmp=cmp(found.to,to)||extraRight(sp.marker)-extraRight(marker);if(!(fromCmp>=0&&toCmp<=0||fromCmp<=0&&toCmp>=0)&&(fromCmp<=0&&(sp.marker.inclusiveRight&&marker.inclusiveLeft?cmp(found.to,from)>=0:cmp(found.to,from)>0)||fromCmp>=0&&(sp.marker.inclusiveRight&&marker.inclusiveLeft?cmp(found.from,to)<=0:cmp(found.from,to)<0)))return!0}}}function visualLine(line){for(var merged;merged=collapsedSpanAtStart(line);)line=merged.find(-1,!0).line;return line}function visualLineNo(doc,lineN){var line=getLine(doc,lineN),vis=visualLine(line);return line==vis?lineN:lineNo(vis)}function visualLineEndNo(doc,lineN){if(lineN>doc.lastLine())return lineN;var merged,line=getLine(doc,lineN);if(!lineIsHidden(doc,line))return lineN;for(;merged=collapsedSpanAtEnd(line);)line=merged.find(1,!0).line;return lineNo(line)+1}function lineIsHidden(doc,line){var sps=sawCollapsedSpans&&line.markedSpans;if(sps)for(var sp=void 0,i=0;i<sps.length;++i)if((sp=sps[i]).marker.collapsed){if(null==sp.from)return!0;if(!sp.marker.widgetNode&&0==sp.from&&sp.marker.inclusiveLeft&&lineIsHiddenInner(doc,line,sp))return!0}}function lineIsHiddenInner(doc,line,span){if(null==span.to){var end=span.marker.find(1,!0);return lineIsHiddenInner(doc,end.line,getMarkedSpanFor(end.line.markedSpans,span.marker))}if(span.marker.inclusiveRight&&span.to==line.text.length)return!0;for(var sp=void 0,i=0;i<line.markedSpans.length;++i)if((sp=line.markedSpans[i]).marker.collapsed&&!sp.marker.widgetNode&&sp.from==span.to&&(null==sp.to||sp.to!=span.from)&&(sp.marker.inclusiveLeft||span.marker.inclusiveRight)&&lineIsHiddenInner(doc,line,sp))return!0}function heightAtLine(lineObj){for(var h=0,chunk=(lineObj=visualLine(lineObj)).parent,i=0;i<chunk.lines.length;++i){var line=chunk.lines[i];if(line==lineObj)break;h+=line.height}for(var p=chunk.parent;p;p=(chunk=p).parent)for(var i$1=0;i$1<p.children.length;++i$1){var cur=p.children[i$1];if(cur==chunk)break;h+=cur.height}return h}function lineLength(line){if(0==line.height)return 0;for(var merged,len=line.text.length,cur=line;merged=collapsedSpanAtStart(cur);){var found=merged.find(0,!0);cur=found.from.line,len+=found.from.ch-found.to.ch}for(cur=line;merged=collapsedSpanAtEnd(cur);){var found$1=merged.find(0,!0);len-=cur.text.length-found$1.from.ch,len+=(cur=found$1.to.line).text.length-found$1.to.ch}return len}function findMaxLine(cm){var d=cm.display,doc=cm.doc;d.maxLine=getLine(doc,doc.first),d.maxLineLength=lineLength(d.maxLine),d.maxLineChanged=!0,doc.iter(function(line){var len=lineLength(line);len>d.maxLineLength&&(d.maxLineLength=len,d.maxLine=line)})}var Line=function(text,markedSpans,estimateHeight){this.text=text,attachMarkedSpans(this,markedSpans),this.height=estimateHeight?estimateHeight(this):1};function cleanUpLine(line){line.parent=null,detachMarkedSpans(line)}Line.prototype.lineNo=function(){return lineNo(this)},eventMixin(Line);var styleToClassCache={},styleToClassCacheWithMode={};function interpretTokenStyle(style,options){if(!style||/^\s*$/.test(style))return null;var cache=options.addModeClass?styleToClassCacheWithMode:styleToClassCache;return cache[style]||(cache[style]=style.replace(/\S+/g,"cm-$&"))}function buildLineContent(cm,lineView){var content=eltP("span",null,null,webkit?"padding-right: .1px":null),builder={pre:eltP("pre",[content],"CodeMirror-line"),content:content,col:0,pos:0,cm:cm,trailingSpace:!1,splitSpaces:cm.getOption("lineWrapping")};lineView.measure={};for(var i=0;i<=(lineView.rest?lineView.rest.length:0);i++){var line=i?lineView.rest[i-1]:lineView.line,order=void 0;builder.pos=0,builder.addToken=buildToken,hasBadBidiRects(cm.display.measure)&&(order=getOrder(line,cm.doc.direction))&&(builder.addToken=buildTokenBadBidi(builder.addToken,order)),builder.map=[],insertLineContent(line,builder,getLineStyles(cm,line,lineView!=cm.display.externalMeasured&&lineNo(line))),line.styleClasses&&(line.styleClasses.bgClass&&(builder.bgClass=joinClasses(line.styleClasses.bgClass,builder.bgClass||"")),line.styleClasses.textClass&&(builder.textClass=joinClasses(line.styleClasses.textClass,builder.textClass||""))),0==builder.map.length&&builder.map.push(0,0,builder.content.appendChild(zeroWidthElement(cm.display.measure))),0==i?(lineView.measure.map=builder.map,lineView.measure.cache={}):((lineView.measure.maps||(lineView.measure.maps=[])).push(builder.map),(lineView.measure.caches||(lineView.measure.caches=[])).push({}))}if(webkit){var last=builder.content.lastChild;(/\bcm-tab\b/.test(last.className)||last.querySelector&&last.querySelector(".cm-tab"))&&(builder.content.className="cm-tab-wrap-hack")}return signal(cm,"renderLine",cm,lineView.line,builder.pre),builder.pre.className&&(builder.textClass=joinClasses(builder.pre.className,builder.textClass||"")),builder}function defaultSpecialCharPlaceholder(ch){var token=elt("span","•","cm-invalidchar");return token.title="\\u"+ch.charCodeAt(0).toString(16),token.setAttribute("aria-label",token.title),token}function buildToken(builder,text,style,startStyle,endStyle,css,attributes){if(text){var content,displayText=builder.splitSpaces?function(text,trailingBefore){if(text.length>1&&!/  /.test(text))return text;for(var spaceBefore=trailingBefore,result="",i=0;i<text.length;i++){var ch=text.charAt(i);" "!=ch||!spaceBefore||i!=text.length-1&&32!=text.charCodeAt(i+1)||(ch=" "),result+=ch,spaceBefore=" "==ch}return result}(text,builder.trailingSpace):text,special=builder.cm.state.specialChars,mustWrap=!1;if(special.test(text)){content=document.createDocumentFragment();for(var pos=0;;){special.lastIndex=pos;var m=special.exec(text),skipped=m?m.index-pos:text.length-pos;if(skipped){var txt=document.createTextNode(displayText.slice(pos,pos+skipped));ie&&ie_version<9?content.appendChild(elt("span",[txt])):content.appendChild(txt),builder.map.push(builder.pos,builder.pos+skipped,txt),builder.col+=skipped,builder.pos+=skipped}if(!m)break;pos+=skipped+1;var txt$1=void 0;if("\t"==m[0]){var tabSize=builder.cm.options.tabSize,tabWidth=tabSize-builder.col%tabSize;(txt$1=content.appendChild(elt("span",spaceStr(tabWidth),"cm-tab"))).setAttribute("role","presentation"),txt$1.setAttribute("cm-text","\t"),builder.col+=tabWidth}else"\r"==m[0]||"\n"==m[0]?((txt$1=content.appendChild(elt("span","\r"==m[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",m[0]),builder.col+=1):((txt$1=builder.cm.options.specialCharPlaceholder(m[0])).setAttribute("cm-text",m[0]),ie&&ie_version<9?content.appendChild(elt("span",[txt$1])):content.appendChild(txt$1),builder.col+=1);builder.map.push(builder.pos,builder.pos+1,txt$1),builder.pos++}}else builder.col+=text.length,content=document.createTextNode(displayText),builder.map.push(builder.pos,builder.pos+text.length,content),ie&&ie_version<9&&(mustWrap=!0),builder.pos+=text.length;if(builder.trailingSpace=32==displayText.charCodeAt(text.length-1),style||startStyle||endStyle||mustWrap||css){var fullStyle=style||"";startStyle&&(fullStyle+=startStyle),endStyle&&(fullStyle+=endStyle);var token=elt("span",[content],fullStyle,css);if(attributes)for(var attr in attributes)attributes.hasOwnProperty(attr)&&"style"!=attr&&"class"!=attr&&token.setAttribute(attr,attributes[attr]);return builder.content.appendChild(token)}builder.content.appendChild(content)}}function buildTokenBadBidi(inner,order){return function(builder,text,style,startStyle,endStyle,css,attributes){style=style?style+" cm-force-border":"cm-force-border";for(var start=builder.pos,end=start+text.length;;){for(var part=void 0,i=0;i<order.length&&!((part=order[i]).to>start&&part.from<=start);i++);if(part.to>=end)return inner(builder,text,style,startStyle,endStyle,css,attributes);inner(builder,text.slice(0,part.to-start),style,startStyle,null,css,attributes),startStyle=null,text=text.slice(part.to-start),start=part.to}}}function buildCollapsedSpan(builder,size,marker,ignoreWidget){var widget=!ignoreWidget&&marker.widgetNode;widget&&builder.map.push(builder.pos,builder.pos+size,widget),!ignoreWidget&&builder.cm.display.input.needsContentAttribute&&(widget||(widget=builder.content.appendChild(document.createElement("span"))),widget.setAttribute("cm-marker",marker.id)),widget&&(builder.cm.display.input.setUneditable(widget),builder.content.appendChild(widget)),builder.pos+=size,builder.trailingSpace=!1}function insertLineContent(line,builder,styles){var spans=line.markedSpans,allText=line.text,at=0;if(spans)for(var style,css,spanStyle,spanEndStyle,spanStartStyle,collapsed,attributes,len=allText.length,pos=0,i=1,text="",nextChange=0;;){if(nextChange==pos){spanStyle=spanEndStyle=spanStartStyle=css="",attributes=null,collapsed=null,nextChange=1/0;for(var foundBookmarks=[],endStyles=void 0,j=0;j<spans.length;++j){var sp=spans[j],m=sp.marker;if("bookmark"==m.type&&sp.from==pos&&m.widgetNode)foundBookmarks.push(m);else if(sp.from<=pos&&(null==sp.to||sp.to>pos||m.collapsed&&sp.to==pos&&sp.from==pos)){if(null!=sp.to&&sp.to!=pos&&nextChange>sp.to&&(nextChange=sp.to,spanEndStyle=""),m.className&&(spanStyle+=" "+m.className),m.css&&(css=(css?css+";":"")+m.css),m.startStyle&&sp.from==pos&&(spanStartStyle+=" "+m.startStyle),m.endStyle&&sp.to==nextChange&&(endStyles||(endStyles=[])).push(m.endStyle,sp.to),m.title&&((attributes||(attributes={})).title=m.title),m.attributes)for(var attr in m.attributes)(attributes||(attributes={}))[attr]=m.attributes[attr];m.collapsed&&(!collapsed||compareCollapsedMarkers(collapsed.marker,m)<0)&&(collapsed=sp)}else sp.from>pos&&nextChange>sp.from&&(nextChange=sp.from)}if(endStyles)for(var j$1=0;j$1<endStyles.length;j$1+=2)endStyles[j$1+1]==nextChange&&(spanEndStyle+=" "+endStyles[j$1]);if(!collapsed||collapsed.from==pos)for(var j$2=0;j$2<foundBookmarks.length;++j$2)buildCollapsedSpan(builder,0,foundBookmarks[j$2]);if(collapsed&&(collapsed.from||0)==pos){if(buildCollapsedSpan(builder,(null==collapsed.to?len+1:collapsed.to)-pos,collapsed.marker,null==collapsed.from),null==collapsed.to)return;collapsed.to==pos&&(collapsed=!1)}}if(pos>=len)break;for(var upto=Math.min(len,nextChange);;){if(text){var end=pos+text.length;if(!collapsed){var tokenText=end>upto?text.slice(0,upto-pos):text;builder.addToken(builder,tokenText,style?style+spanStyle:spanStyle,spanStartStyle,pos+tokenText.length==nextChange?spanEndStyle:"",css,attributes)}if(end>=upto){text=text.slice(upto-pos),pos=upto;break}pos=end,spanStartStyle=""}text=allText.slice(at,at=styles[i++]),style=interpretTokenStyle(styles[i++],builder.cm.options)}}else for(var i$1=1;i$1<styles.length;i$1+=2)builder.addToken(builder,allText.slice(at,at=styles[i$1]),interpretTokenStyle(styles[i$1+1],builder.cm.options))}function LineView(doc,line,lineN){this.line=line,this.rest=function(line){for(var merged,lines;merged=collapsedSpanAtEnd(line);)line=merged.find(1,!0).line,(lines||(lines=[])).push(line);return lines}(line),this.size=this.rest?lineNo(lst(this.rest))-lineN+1:1,this.node=this.text=null,this.hidden=lineIsHidden(doc,line)}function buildViewArray(cm,from,to){for(var nextPos,array=[],pos=from;pos<to;pos=nextPos){var view=new LineView(cm.doc,getLine(cm.doc,pos),pos);nextPos=pos+view.size,array.push(view)}return array}var operationGroup=null;var orphanDelayedCallbacks=null;function signalLater(emitter,type){var arr=getHandlers(emitter,type);if(arr.length){var list,args=Array.prototype.slice.call(arguments,2);operationGroup?list=operationGroup.delayedCallbacks:orphanDelayedCallbacks?list=orphanDelayedCallbacks:(list=orphanDelayedCallbacks=[],setTimeout(fireOrphanDelayed,0));for(var loop=function(i){list.push(function(){return arr[i].apply(null,args)})},i=0;i<arr.length;++i)loop(i)}}function fireOrphanDelayed(){var delayed=orphanDelayedCallbacks;orphanDelayedCallbacks=null;for(var i=0;i<delayed.length;++i)delayed[i]()}function updateLineForChanges(cm,lineView,lineN,dims){for(var j=0;j<lineView.changes.length;j++){var type=lineView.changes[j];"text"==type?updateLineText(cm,lineView):"gutter"==type?updateLineGutter(cm,lineView,lineN,dims):"class"==type?updateLineClasses(cm,lineView):"widget"==type&&updateLineWidgets(cm,lineView,dims)}lineView.changes=null}function ensureLineWrapped(lineView){return lineView.node==lineView.text&&(lineView.node=elt("div",null,null,"position: relative"),lineView.text.parentNode&&lineView.text.parentNode.replaceChild(lineView.node,lineView.text),lineView.node.appendChild(lineView.text),ie&&ie_version<8&&(lineView.node.style.zIndex=2)),lineView.node}function getLineContent(cm,lineView){var ext=cm.display.externalMeasured;return ext&&ext.line==lineView.line?(cm.display.externalMeasured=null,lineView.measure=ext.measure,ext.built):buildLineContent(cm,lineView)}function updateLineText(cm,lineView){var cls=lineView.text.className,built=getLineContent(cm,lineView);lineView.text==lineView.node&&(lineView.node=built.pre),lineView.text.parentNode.replaceChild(built.pre,lineView.text),lineView.text=built.pre,built.bgClass!=lineView.bgClass||built.textClass!=lineView.textClass?(lineView.bgClass=built.bgClass,lineView.textClass=built.textClass,updateLineClasses(cm,lineView)):cls&&(lineView.text.className=cls)}function updateLineClasses(cm,lineView){!function(cm,lineView){var cls=lineView.bgClass?lineView.bgClass+" "+(lineView.line.bgClass||""):lineView.line.bgClass;if(cls&&(cls+=" CodeMirror-linebackground"),lineView.background)cls?lineView.background.className=cls:(lineView.background.parentNode.removeChild(lineView.background),lineView.background=null);else if(cls){var wrap=ensureLineWrapped(lineView);lineView.background=wrap.insertBefore(elt("div",null,cls),wrap.firstChild),cm.display.input.setUneditable(lineView.background)}}(cm,lineView),lineView.line.wrapClass?ensureLineWrapped(lineView).className=lineView.line.wrapClass:lineView.node!=lineView.text&&(lineView.node.className="");var textClass=lineView.textClass?lineView.textClass+" "+(lineView.line.textClass||""):lineView.line.textClass;lineView.text.className=textClass||""}function updateLineGutter(cm,lineView,lineN,dims){if(lineView.gutter&&(lineView.node.removeChild(lineView.gutter),lineView.gutter=null),lineView.gutterBackground&&(lineView.node.removeChild(lineView.gutterBackground),lineView.gutterBackground=null),lineView.line.gutterClass){var wrap=ensureLineWrapped(lineView);lineView.gutterBackground=elt("div",null,"CodeMirror-gutter-background "+lineView.line.gutterClass,"left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px; width: "+dims.gutterTotalWidth+"px"),cm.display.input.setUneditable(lineView.gutterBackground),wrap.insertBefore(lineView.gutterBackground,lineView.text)}var markers=lineView.line.gutterMarkers;if(cm.options.lineNumbers||markers){var wrap$1=ensureLineWrapped(lineView),gutterWrap=lineView.gutter=elt("div",null,"CodeMirror-gutter-wrapper","left: "+(cm.options.fixedGutter?dims.fixedPos:-dims.gutterTotalWidth)+"px");if(cm.display.input.setUneditable(gutterWrap),wrap$1.insertBefore(gutterWrap,lineView.text),lineView.line.gutterClass&&(gutterWrap.className+=" "+lineView.line.gutterClass),!cm.options.lineNumbers||markers&&markers["CodeMirror-linenumbers"]||(lineView.lineNumber=gutterWrap.appendChild(elt("div",lineNumberFor(cm.options,lineN),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+dims.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+cm.display.lineNumInnerWidth+"px"))),markers)for(var k=0;k<cm.display.gutterSpecs.length;++k){var id=cm.display.gutterSpecs[k].className,found=markers.hasOwnProperty(id)&&markers[id];found&&gutterWrap.appendChild(elt("div",[found],"CodeMirror-gutter-elt","left: "+dims.gutterLeft[id]+"px; width: "+dims.gutterWidth[id]+"px"))}}}function updateLineWidgets(cm,lineView,dims){lineView.alignable&&(lineView.alignable=null);for(var isWidget=classTest("CodeMirror-linewidget"),node=lineView.node.firstChild,next=void 0;node;node=next)next=node.nextSibling,isWidget.test(node.className)&&lineView.node.removeChild(node);insertLineWidgets(cm,lineView,dims)}function buildLineElement(cm,lineView,lineN,dims){var built=getLineContent(cm,lineView);return lineView.text=lineView.node=built.pre,built.bgClass&&(lineView.bgClass=built.bgClass),built.textClass&&(lineView.textClass=built.textClass),updateLineClasses(cm,lineView),updateLineGutter(cm,lineView,lineN,dims),insertLineWidgets(cm,lineView,dims),lineView.node}function insertLineWidgets(cm,lineView,dims){if(insertLineWidgetsFor(cm,lineView.line,lineView,dims,!0),lineView.rest)for(var i=0;i<lineView.rest.length;i++)insertLineWidgetsFor(cm,lineView.rest[i],lineView,dims,!1)}function insertLineWidgetsFor(cm,line,lineView,dims,allowAbove){if(line.widgets)for(var wrap=ensureLineWrapped(lineView),i=0,ws=line.widgets;i<ws.length;++i){var widget=ws[i],node=elt("div",[widget.node],"CodeMirror-linewidget"+(widget.className?" "+widget.className:""));widget.handleMouseEvents||node.setAttribute("cm-ignore-events","true"),positionLineWidget(widget,node,lineView,dims),cm.display.input.setUneditable(node),allowAbove&&widget.above?wrap.insertBefore(node,lineView.gutter||lineView.text):wrap.appendChild(node),signalLater(widget,"redraw")}}function positionLineWidget(widget,node,lineView,dims){if(widget.noHScroll){(lineView.alignable||(lineView.alignable=[])).push(node);var width=dims.wrapperWidth;node.style.left=dims.fixedPos+"px",widget.coverGutter||(width-=dims.gutterTotalWidth,node.style.paddingLeft=dims.gutterTotalWidth+"px"),node.style.width=width+"px"}widget.coverGutter&&(node.style.zIndex=5,node.style.position="relative",widget.noHScroll||(node.style.marginLeft=-dims.gutterTotalWidth+"px"))}function widgetHeight(widget){if(null!=widget.height)return widget.height;var cm=widget.doc.cm;if(!cm)return 0;if(!contains(document.body,widget.node)){var parentStyle="position: relative;";widget.coverGutter&&(parentStyle+="margin-left: -"+cm.display.gutters.offsetWidth+"px;"),widget.noHScroll&&(parentStyle+="width: "+cm.display.wrapper.clientWidth+"px;"),removeChildrenAndAdd(cm.display.measure,elt("div",[widget.node],null,parentStyle))}return widget.height=widget.node.parentNode.offsetHeight}function eventInWidget(display,e){for(var n=e_target(e);n!=display.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==display.sizer&&n!=display.mover)return!0}function paddingTop(display){return display.lineSpace.offsetTop}function paddingVert(display){return display.mover.offsetHeight-display.lineSpace.offsetHeight}function paddingH(display){if(display.cachedPaddingH)return display.cachedPaddingH;var e=removeChildrenAndAdd(display.measure,elt("pre","x","CodeMirror-line-like")),style=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,data={left:parseInt(style.paddingLeft),right:parseInt(style.paddingRight)};return isNaN(data.left)||isNaN(data.right)||(display.cachedPaddingH=data),data}function scrollGap(cm){return scrollerGap-cm.display.nativeBarWidth}function displayWidth(cm){return cm.display.scroller.clientWidth-scrollGap(cm)-cm.display.barWidth}function displayHeight(cm){return cm.display.scroller.clientHeight-scrollGap(cm)-cm.display.barHeight}function mapFromLineView(lineView,line,lineN){if(lineView.line==line)return{map:lineView.measure.map,cache:lineView.measure.cache};for(var i=0;i<lineView.rest.length;i++)if(lineView.rest[i]==line)return{map:lineView.measure.maps[i],cache:lineView.measure.caches[i]};for(var i$1=0;i$1<lineView.rest.length;i$1++)if(lineNo(lineView.rest[i$1])>lineN)return{map:lineView.measure.maps[i$1],cache:lineView.measure.caches[i$1],before:!0}}function measureChar(cm,line,ch,bias){return measureCharPrepared(cm,prepareMeasureForLine(cm,line),ch,bias)}function findViewForLine(cm,lineN){if(lineN>=cm.display.viewFrom&&lineN<cm.display.viewTo)return cm.display.view[findViewIndex(cm,lineN)];var ext=cm.display.externalMeasured;return ext&&lineN>=ext.lineN&&lineN<ext.lineN+ext.size?ext:void 0}function prepareMeasureForLine(cm,line){var lineN=lineNo(line),view=findViewForLine(cm,lineN);view&&!view.text?view=null:view&&view.changes&&(updateLineForChanges(cm,view,lineN,getDimensions(cm)),cm.curOp.forceUpdate=!0),view||(view=function(cm,line){var lineN=lineNo(line=visualLine(line)),view=cm.display.externalMeasured=new LineView(cm.doc,line,lineN);view.lineN=lineN;var built=view.built=buildLineContent(cm,view);return view.text=built.pre,removeChildrenAndAdd(cm.display.lineMeasure,built.pre),view}(cm,line));var info=mapFromLineView(view,line,lineN);return{line:line,view:view,rect:null,map:info.map,cache:info.cache,before:info.before,hasHeights:!1}}function measureCharPrepared(cm,prepared,ch,bias,varHeight){prepared.before&&(ch=-1);var found,key=ch+(bias||"");return prepared.cache.hasOwnProperty(key)?found=prepared.cache[key]:(prepared.rect||(prepared.rect=prepared.view.text.getBoundingClientRect()),prepared.hasHeights||(!function(cm,lineView,rect){var wrapping=cm.options.lineWrapping,curWidth=wrapping&&displayWidth(cm);if(!lineView.measure.heights||wrapping&&lineView.measure.width!=curWidth){var heights=lineView.measure.heights=[];if(wrapping){lineView.measure.width=curWidth;for(var rects=lineView.text.firstChild.getClientRects(),i=0;i<rects.length-1;i++){var cur=rects[i],next=rects[i+1];Math.abs(cur.bottom-next.bottom)>2&&heights.push((cur.bottom+next.top)/2-rect.top)}}heights.push(rect.bottom-rect.top)}}(cm,prepared.view,prepared.rect),prepared.hasHeights=!0),(found=function(cm,prepared,ch,bias){var rect,place=nodeAndOffsetInLineMap(prepared.map,ch,bias),node=place.node,start=place.start,end=place.end,collapse=place.collapse;if(3==node.nodeType){for(var i$1=0;i$1<4;i$1++){for(;start&&isExtendingChar(prepared.line.text.charAt(place.coverStart+start));)--start;for(;place.coverStart+end<place.coverEnd&&isExtendingChar(prepared.line.text.charAt(place.coverStart+end));)++end;if((rect=ie&&ie_version<9&&0==start&&end==place.coverEnd-place.coverStart?node.parentNode.getBoundingClientRect():getUsefulRect(range(node,start,end).getClientRects(),bias)).left||rect.right||0==start)break;end=start,start-=1,collapse="right"}ie&&ie_version<11&&(rect=function(measure,rect){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(measure){if(null!=badZoomedRects)return badZoomedRects;var node=removeChildrenAndAdd(measure,elt("span","x")),normal=node.getBoundingClientRect(),fromRange=range(node,0,1).getBoundingClientRect();return badZoomedRects=Math.abs(normal.left-fromRange.left)>1}(measure))return rect;var scaleX=screen.logicalXDPI/screen.deviceXDPI,scaleY=screen.logicalYDPI/screen.deviceYDPI;return{left:rect.left*scaleX,right:rect.right*scaleX,top:rect.top*scaleY,bottom:rect.bottom*scaleY}}(cm.display.measure,rect))}else{var rects;start>0&&(collapse=bias="right"),rect=cm.options.lineWrapping&&(rects=node.getClientRects()).length>1?rects["right"==bias?rects.length-1:0]:node.getBoundingClientRect()}if(ie&&ie_version<9&&!start&&(!rect||!rect.left&&!rect.right)){var rSpan=node.parentNode.getClientRects()[0];rect=rSpan?{left:rSpan.left,right:rSpan.left+charWidth(cm.display),top:rSpan.top,bottom:rSpan.bottom}:nullRect}for(var rtop=rect.top-prepared.rect.top,rbot=rect.bottom-prepared.rect.top,mid=(rtop+rbot)/2,heights=prepared.view.measure.heights,i=0;i<heights.length-1&&!(mid<heights[i]);i++);var top=i?heights[i-1]:0,bot=heights[i],result={left:("right"==collapse?rect.right:rect.left)-prepared.rect.left,right:("left"==collapse?rect.left:rect.right)-prepared.rect.left,top:top,bottom:bot};rect.left||rect.right||(result.bogus=!0);cm.options.singleCursorHeightPerLine||(result.rtop=rtop,result.rbottom=rbot);return result}(cm,prepared,ch,bias)).bogus||(prepared.cache[key]=found)),{left:found.left,right:found.right,top:varHeight?found.rtop:found.top,bottom:varHeight?found.rbottom:found.bottom}}var measureText,nullRect={left:0,right:0,top:0,bottom:0};function nodeAndOffsetInLineMap(map,ch,bias){for(var node,start,end,collapse,mStart,mEnd,i=0;i<map.length;i+=3)if(mStart=map[i],mEnd=map[i+1],ch<mStart?(start=0,end=1,collapse="left"):ch<mEnd?end=(start=ch-mStart)+1:(i==map.length-3||ch==mEnd&&map[i+3]>ch)&&(start=(end=mEnd-mStart)-1,ch>=mEnd&&(collapse="right")),null!=start){if(node=map[i+2],mStart==mEnd&&bias==(node.insertLeft?"left":"right")&&(collapse=bias),"left"==bias&&0==start)for(;i&&map[i-2]==map[i-3]&&map[i-1].insertLeft;)node=map[2+(i-=3)],collapse="left";if("right"==bias&&start==mEnd-mStart)for(;i<map.length-3&&map[i+3]==map[i+4]&&!map[i+5].insertLeft;)node=map[(i+=3)+2],collapse="right";break}return{node:node,start:start,end:end,collapse:collapse,coverStart:mStart,coverEnd:mEnd}}function getUsefulRect(rects,bias){var rect=nullRect;if("left"==bias)for(var i=0;i<rects.length&&(rect=rects[i]).left==rect.right;i++);else for(var i$1=rects.length-1;i$1>=0&&(rect=rects[i$1]).left==rect.right;i$1--);return rect}function clearLineMeasurementCacheFor(lineView){if(lineView.measure&&(lineView.measure.cache={},lineView.measure.heights=null,lineView.rest))for(var i=0;i<lineView.rest.length;i++)lineView.measure.caches[i]={}}function clearLineMeasurementCache(cm){cm.display.externalMeasure=null,removeChildren(cm.display.lineMeasure);for(var i=0;i<cm.display.view.length;i++)clearLineMeasurementCacheFor(cm.display.view[i])}function clearCaches(cm){clearLineMeasurementCache(cm),cm.display.cachedCharWidth=cm.display.cachedTextHeight=cm.display.cachedPaddingH=null,cm.options.lineWrapping||(cm.display.maxLineChanged=!0),cm.display.lineNumChars=null}function pageScrollX(){return chrome&&android?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function pageScrollY(){return chrome&&android?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function widgetTopHeight(lineObj){var height=0;if(lineObj.widgets)for(var i=0;i<lineObj.widgets.length;++i)lineObj.widgets[i].above&&(height+=widgetHeight(lineObj.widgets[i]));return height}function intoCoordSystem(cm,lineObj,rect,context,includeWidgets){if(!includeWidgets){var height=widgetTopHeight(lineObj);rect.top+=height,rect.bottom+=height}if("line"==context)return rect;context||(context="local");var yOff=heightAtLine(lineObj);if("local"==context?yOff+=paddingTop(cm.display):yOff-=cm.display.viewOffset,"page"==context||"window"==context){var lOff=cm.display.lineSpace.getBoundingClientRect();yOff+=lOff.top+("window"==context?0:pageScrollY());var xOff=lOff.left+("window"==context?0:pageScrollX());rect.left+=xOff,rect.right+=xOff}return rect.top+=yOff,rect.bottom+=yOff,rect}function fromCoordSystem(cm,coords,context){if("div"==context)return coords;var left=coords.left,top=coords.top;if("page"==context)left-=pageScrollX(),top-=pageScrollY();else if("local"==context||!context){var localBox=cm.display.sizer.getBoundingClientRect();left+=localBox.left,top+=localBox.top}var lineSpaceBox=cm.display.lineSpace.getBoundingClientRect();return{left:left-lineSpaceBox.left,top:top-lineSpaceBox.top}}function charCoords(cm,pos,context,lineObj,bias){return lineObj||(lineObj=getLine(cm.doc,pos.line)),intoCoordSystem(cm,lineObj,measureChar(cm,lineObj,pos.ch,bias),context)}function cursorCoords(cm,pos,context,lineObj,preparedMeasure,varHeight){function get(ch,right){var m=measureCharPrepared(cm,preparedMeasure,ch,right?"right":"left",varHeight);return right?m.left=m.right:m.right=m.left,intoCoordSystem(cm,lineObj,m,context)}lineObj=lineObj||getLine(cm.doc,pos.line),preparedMeasure||(preparedMeasure=prepareMeasureForLine(cm,lineObj));var order=getOrder(lineObj,cm.doc.direction),ch=pos.ch,sticky=pos.sticky;if(ch>=lineObj.text.length?(ch=lineObj.text.length,sticky="before"):ch<=0&&(ch=0,sticky="after"),!order)return get("before"==sticky?ch-1:ch,"before"==sticky);function getBidi(ch,partPos,invert){var right=1==order[partPos].level;return get(invert?ch-1:ch,right!=invert)}var partPos=getBidiPartAt(order,ch,sticky),other=bidiOther,val=getBidi(ch,partPos,"before"==sticky);return null!=other&&(val.other=getBidi(ch,other,"before"!=sticky)),val}function estimateCoords(cm,pos){var left=0;pos=clipPos(cm.doc,pos),cm.options.lineWrapping||(left=charWidth(cm.display)*pos.ch);var lineObj=getLine(cm.doc,pos.line),top=heightAtLine(lineObj)+paddingTop(cm.display);return{left:left,right:left,top:top,bottom:top+lineObj.height}}function PosWithInfo(line,ch,sticky,outside,xRel){var pos=Pos(line,ch,sticky);return pos.xRel=xRel,outside&&(pos.outside=outside),pos}function coordsChar(cm,x,y){var doc=cm.doc;if((y+=cm.display.viewOffset)<0)return PosWithInfo(doc.first,0,null,-1,-1);var lineN=lineAtHeight(doc,y),last=doc.first+doc.size-1;if(lineN>last)return PosWithInfo(doc.first+doc.size-1,getLine(doc,last).text.length,null,1,1);x<0&&(x=0);for(var lineObj=getLine(doc,lineN);;){var found=coordsCharInner(cm,lineObj,lineN,x,y),collapsed=collapsedSpanAround(lineObj,found.ch+(found.xRel>0||found.outside>0?1:0));if(!collapsed)return found;var rangeEnd=collapsed.find(1);if(rangeEnd.line==lineN)return rangeEnd;lineObj=getLine(doc,lineN=rangeEnd.line)}}function wrappedLineExtent(cm,lineObj,preparedMeasure,y){y-=widgetTopHeight(lineObj);var end=lineObj.text.length,begin=findFirst(function(ch){return measureCharPrepared(cm,preparedMeasure,ch-1).bottom<=y},end,0);return{begin:begin,end:end=findFirst(function(ch){return measureCharPrepared(cm,preparedMeasure,ch).top>y},begin,end)}}function wrappedLineExtentChar(cm,lineObj,preparedMeasure,target){return preparedMeasure||(preparedMeasure=prepareMeasureForLine(cm,lineObj)),wrappedLineExtent(cm,lineObj,preparedMeasure,intoCoordSystem(cm,lineObj,measureCharPrepared(cm,preparedMeasure,target),"line").top)}function boxIsAfter(box,x,y,left){return!(box.bottom<=y)&&(box.top>y||(left?box.left:box.right)>x)}function coordsCharInner(cm,lineObj,lineNo,x,y){y-=heightAtLine(lineObj);var preparedMeasure=prepareMeasureForLine(cm,lineObj),widgetHeight=widgetTopHeight(lineObj),begin=0,end=lineObj.text.length,ltr=!0,order=getOrder(lineObj,cm.doc.direction);if(order){var part=(cm.options.lineWrapping?function(cm,lineObj,_lineNo,preparedMeasure,order,x,y){var ref=wrappedLineExtent(cm,lineObj,preparedMeasure,y),begin=ref.begin,end=ref.end;/\s/.test(lineObj.text.charAt(end-1))&&end--;for(var part=null,closestDist=null,i=0;i<order.length;i++){var p=order[i];if(!(p.from>=end||p.to<=begin)){var ltr=1!=p.level,endX=measureCharPrepared(cm,preparedMeasure,ltr?Math.min(end,p.to)-1:Math.max(begin,p.from)).right,dist=endX<x?x-endX+1e9:endX-x;(!part||closestDist>dist)&&(part=p,closestDist=dist)}}part||(part=order[order.length-1]);part.from<begin&&(part={from:begin,to:part.to,level:part.level});part.to>end&&(part={from:part.from,to:end,level:part.level});return part}:function(cm,lineObj,lineNo,preparedMeasure,order,x,y){var index=findFirst(function(i){var part=order[i],ltr=1!=part.level;return boxIsAfter(cursorCoords(cm,Pos(lineNo,ltr?part.to:part.from,ltr?"before":"after"),"line",lineObj,preparedMeasure),x,y,!0)},0,order.length-1),part=order[index];if(index>0){var ltr=1!=part.level,start=cursorCoords(cm,Pos(lineNo,ltr?part.from:part.to,ltr?"after":"before"),"line",lineObj,preparedMeasure);boxIsAfter(start,x,y,!0)&&start.top>y&&(part=order[index-1])}return part})(cm,lineObj,lineNo,preparedMeasure,order,x,y);begin=(ltr=1!=part.level)?part.from:part.to-1,end=ltr?part.to:part.from-1}var baseX,sticky,chAround=null,boxAround=null,ch=findFirst(function(ch){var box=measureCharPrepared(cm,preparedMeasure,ch);return box.top+=widgetHeight,box.bottom+=widgetHeight,!!boxIsAfter(box,x,y,!1)&&(box.top<=y&&box.left<=x&&(chAround=ch,boxAround=box),!0)},begin,end),outside=!1;if(boxAround){var atLeft=x-boxAround.left<boxAround.right-x,atStart=atLeft==ltr;ch=chAround+(atStart?0:1),sticky=atStart?"after":"before",baseX=atLeft?boxAround.left:boxAround.right}else{ltr||ch!=end&&ch!=begin||ch++,sticky=0==ch?"after":ch==lineObj.text.length?"before":measureCharPrepared(cm,preparedMeasure,ch-(ltr?1:0)).bottom+widgetHeight<=y==ltr?"after":"before";var coords=cursorCoords(cm,Pos(lineNo,ch,sticky),"line",lineObj,preparedMeasure);baseX=coords.left,outside=y<coords.top?-1:y>=coords.bottom?1:0}return PosWithInfo(lineNo,ch=skipExtendingChars(lineObj.text,ch,1),sticky,outside,x-baseX)}function textHeight(display){if(null!=display.cachedTextHeight)return display.cachedTextHeight;if(null==measureText){measureText=elt("pre",null,"CodeMirror-line-like");for(var i=0;i<49;++i)measureText.appendChild(document.createTextNode("x")),measureText.appendChild(elt("br"));measureText.appendChild(document.createTextNode("x"))}removeChildrenAndAdd(display.measure,measureText);var height=measureText.offsetHeight/50;return height>3&&(display.cachedTextHeight=height),removeChildren(display.measure),height||1}function charWidth(display){if(null!=display.cachedCharWidth)return display.cachedCharWidth;var anchor=elt("span","xxxxxxxxxx"),pre=elt("pre",[anchor],"CodeMirror-line-like");removeChildrenAndAdd(display.measure,pre);var rect=anchor.getBoundingClientRect(),width=(rect.right-rect.left)/10;return width>2&&(display.cachedCharWidth=width),width||10}function getDimensions(cm){for(var d=cm.display,left={},width={},gutterLeft=d.gutters.clientLeft,n=d.gutters.firstChild,i=0;n;n=n.nextSibling,++i){var id=cm.display.gutterSpecs[i].className;left[id]=n.offsetLeft+n.clientLeft+gutterLeft,width[id]=n.clientWidth}return{fixedPos:compensateForHScroll(d),gutterTotalWidth:d.gutters.offsetWidth,gutterLeft:left,gutterWidth:width,wrapperWidth:d.wrapper.clientWidth}}function compensateForHScroll(display){return display.scroller.getBoundingClientRect().left-display.sizer.getBoundingClientRect().left}function estimateHeight(cm){var th=textHeight(cm.display),wrapping=cm.options.lineWrapping,perLine=wrapping&&Math.max(5,cm.display.scroller.clientWidth/charWidth(cm.display)-3);return function(line){if(lineIsHidden(cm.doc,line))return 0;var widgetsHeight=0;if(line.widgets)for(var i=0;i<line.widgets.length;i++)line.widgets[i].height&&(widgetsHeight+=line.widgets[i].height);return wrapping?widgetsHeight+(Math.ceil(line.text.length/perLine)||1)*th:widgetsHeight+th}}function estimateLineHeights(cm){var doc=cm.doc,est=estimateHeight(cm);doc.iter(function(line){var estHeight=est(line);estHeight!=line.height&&updateLineHeight(line,estHeight)})}function posFromMouse(cm,e,liberal,forRect){var display=cm.display;if(!liberal&&"true"==e_target(e).getAttribute("cm-not-content"))return null;var x,y,space=display.lineSpace.getBoundingClientRect();try{x=e.clientX-space.left,y=e.clientY-space.top}catch(e$1){return null}var line,coords=coordsChar(cm,x,y);if(forRect&&coords.xRel>0&&(line=getLine(cm.doc,coords.line).text).length==coords.ch){var colDiff=countColumn(line,line.length,cm.options.tabSize)-line.length;coords=Pos(coords.line,Math.max(0,Math.round((x-paddingH(cm.display).left)/charWidth(cm.display))-colDiff))}return coords}function findViewIndex(cm,n){if(n>=cm.display.viewTo)return null;if((n-=cm.display.viewFrom)<0)return null;for(var view=cm.display.view,i=0;i<view.length;i++)if((n-=view[i].size)<0)return i}function regChange(cm,from,to,lendiff){null==from&&(from=cm.doc.first),null==to&&(to=cm.doc.first+cm.doc.size),lendiff||(lendiff=0);var display=cm.display;if(lendiff&&to<display.viewTo&&(null==display.updateLineNumbers||display.updateLineNumbers>from)&&(display.updateLineNumbers=from),cm.curOp.viewChanged=!0,from>=display.viewTo)sawCollapsedSpans&&visualLineNo(cm.doc,from)<display.viewTo&&resetView(cm);else if(to<=display.viewFrom)sawCollapsedSpans&&visualLineEndNo(cm.doc,to+lendiff)>display.viewFrom?resetView(cm):(display.viewFrom+=lendiff,display.viewTo+=lendiff);else if(from<=display.viewFrom&&to>=display.viewTo)resetView(cm);else if(from<=display.viewFrom){var cut=viewCuttingPoint(cm,to,to+lendiff,1);cut?(display.view=display.view.slice(cut.index),display.viewFrom=cut.lineN,display.viewTo+=lendiff):resetView(cm)}else if(to>=display.viewTo){var cut$1=viewCuttingPoint(cm,from,from,-1);cut$1?(display.view=display.view.slice(0,cut$1.index),display.viewTo=cut$1.lineN):resetView(cm)}else{var cutTop=viewCuttingPoint(cm,from,from,-1),cutBot=viewCuttingPoint(cm,to,to+lendiff,1);cutTop&&cutBot?(display.view=display.view.slice(0,cutTop.index).concat(buildViewArray(cm,cutTop.lineN,cutBot.lineN)).concat(display.view.slice(cutBot.index)),display.viewTo+=lendiff):resetView(cm)}var ext=display.externalMeasured;ext&&(to<ext.lineN?ext.lineN+=lendiff:from<ext.lineN+ext.size&&(display.externalMeasured=null))}function regLineChange(cm,line,type){cm.curOp.viewChanged=!0;var display=cm.display,ext=cm.display.externalMeasured;if(ext&&line>=ext.lineN&&line<ext.lineN+ext.size&&(display.externalMeasured=null),!(line<display.viewFrom||line>=display.viewTo)){var lineView=display.view[findViewIndex(cm,line)];if(null!=lineView.node){var arr=lineView.changes||(lineView.changes=[]);-1==indexOf(arr,type)&&arr.push(type)}}}function resetView(cm){cm.display.viewFrom=cm.display.viewTo=cm.doc.first,cm.display.view=[],cm.display.viewOffset=0}function viewCuttingPoint(cm,oldN,newN,dir){var diff,index=findViewIndex(cm,oldN),view=cm.display.view;if(!sawCollapsedSpans||newN==cm.doc.first+cm.doc.size)return{index:index,lineN:newN};for(var n=cm.display.viewFrom,i=0;i<index;i++)n+=view[i].size;if(n!=oldN){if(dir>0){if(index==view.length-1)return null;diff=n+view[index].size-oldN,index++}else diff=n-oldN;oldN+=diff,newN+=diff}for(;visualLineNo(cm.doc,newN)!=newN;){if(index==(dir<0?0:view.length-1))return null;newN+=dir*view[index-(dir<0?1:0)].size,index+=dir}return{index:index,lineN:newN}}function countDirtyView(cm){for(var view=cm.display.view,dirty=0,i=0;i<view.length;i++){var lineView=view[i];lineView.hidden||lineView.node&&!lineView.changes||++dirty}return dirty}function updateSelection(cm){cm.display.input.showSelection(cm.display.input.prepareSelection())}function prepareSelection(cm,primary){void 0===primary&&(primary=!0);for(var doc=cm.doc,result={},curFragment=result.cursors=document.createDocumentFragment(),selFragment=result.selection=document.createDocumentFragment(),i=0;i<doc.sel.ranges.length;i++)if(primary||i!=doc.sel.primIndex){var range=doc.sel.ranges[i];if(!(range.from().line>=cm.display.viewTo||range.to().line<cm.display.viewFrom)){var collapsed=range.empty();(collapsed||cm.options.showCursorWhenSelecting)&&drawSelectionCursor(cm,range.head,curFragment),collapsed||drawSelectionRange(cm,range,selFragment)}}return result}function drawSelectionCursor(cm,head,output){var pos=cursorCoords(cm,head,"div",null,null,!cm.options.singleCursorHeightPerLine),cursor=output.appendChild(elt("div"," ","CodeMirror-cursor"));if(cursor.style.left=pos.left+"px",cursor.style.top=pos.top+"px",cursor.style.height=Math.max(0,pos.bottom-pos.top)*cm.options.cursorHeight+"px",pos.other){var otherCursor=output.appendChild(elt("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));otherCursor.style.display="",otherCursor.style.left=pos.other.left+"px",otherCursor.style.top=pos.other.top+"px",otherCursor.style.height=.85*(pos.other.bottom-pos.other.top)+"px"}}function cmpCoords(a,b){return a.top-b.top||a.left-b.left}function drawSelectionRange(cm,range,output){var display=cm.display,doc=cm.doc,fragment=document.createDocumentFragment(),padding=paddingH(cm.display),leftSide=padding.left,rightSide=Math.max(display.sizerWidth,displayWidth(cm)-display.sizer.offsetLeft)-padding.right,docLTR="ltr"==doc.direction;function add(left,top,width,bottom){top<0&&(top=0),top=Math.round(top),bottom=Math.round(bottom),fragment.appendChild(elt("div",null,"CodeMirror-selected","position: absolute; left: "+left+"px;\n                             top: "+top+"px; width: "+(null==width?rightSide-left:width)+"px;\n                             height: "+(bottom-top)+"px"))}function drawForLine(line,fromArg,toArg){var start,end,lineObj=getLine(doc,line),lineLen=lineObj.text.length;function coords(ch,bias){return charCoords(cm,Pos(line,ch),"div",lineObj,bias)}function wrapX(pos,dir,side){var extent=wrappedLineExtentChar(cm,lineObj,null,pos),prop="ltr"==dir==("after"==side)?"left":"right";return coords("after"==side?extent.begin:extent.end-(/\s/.test(lineObj.text.charAt(extent.end-1))?2:1),prop)[prop]}var order=getOrder(lineObj,doc.direction);return function(order,from,to,f){if(!order)return f(from,to,"ltr",0);for(var found=!1,i=0;i<order.length;++i){var part=order[i];(part.from<to&&part.to>from||from==to&&part.to==from)&&(f(Math.max(part.from,from),Math.min(part.to,to),1==part.level?"rtl":"ltr",i),found=!0)}found||f(from,to,"ltr")}(order,fromArg||0,null==toArg?lineLen:toArg,function(from,to,dir,i){var ltr="ltr"==dir,fromPos=coords(from,ltr?"left":"right"),toPos=coords(to-1,ltr?"right":"left"),openStart=null==fromArg&&0==from,openEnd=null==toArg&&to==lineLen,first=0==i,last=!order||i==order.length-1;if(toPos.top-fromPos.top<=3){var openRight=(docLTR?openEnd:openStart)&&last,left=(docLTR?openStart:openEnd)&&first?leftSide:(ltr?fromPos:toPos).left,right=openRight?rightSide:(ltr?toPos:fromPos).right;add(left,fromPos.top,right-left,fromPos.bottom)}else{var topLeft,topRight,botLeft,botRight;ltr?(topLeft=docLTR&&openStart&&first?leftSide:fromPos.left,topRight=docLTR?rightSide:wrapX(from,dir,"before"),botLeft=docLTR?leftSide:wrapX(to,dir,"after"),botRight=docLTR&&openEnd&&last?rightSide:toPos.right):(topLeft=docLTR?wrapX(from,dir,"before"):leftSide,topRight=!docLTR&&openStart&&first?rightSide:fromPos.right,botLeft=!docLTR&&openEnd&&last?leftSide:toPos.left,botRight=docLTR?wrapX(to,dir,"after"):rightSide),add(topLeft,fromPos.top,topRight-topLeft,fromPos.bottom),fromPos.bottom<toPos.top&&add(leftSide,fromPos.bottom,null,toPos.top),add(botLeft,toPos.top,botRight-botLeft,toPos.bottom)}(!start||cmpCoords(fromPos,start)<0)&&(start=fromPos),cmpCoords(toPos,start)<0&&(start=toPos),(!end||cmpCoords(fromPos,end)<0)&&(end=fromPos),cmpCoords(toPos,end)<0&&(end=toPos)}),{start:start,end:end}}var sFrom=range.from(),sTo=range.to();if(sFrom.line==sTo.line)drawForLine(sFrom.line,sFrom.ch,sTo.ch);else{var fromLine=getLine(doc,sFrom.line),toLine=getLine(doc,sTo.line),singleVLine=visualLine(fromLine)==visualLine(toLine),leftEnd=drawForLine(sFrom.line,sFrom.ch,singleVLine?fromLine.text.length+1:null).end,rightStart=drawForLine(sTo.line,singleVLine?0:null,sTo.ch).start;singleVLine&&(leftEnd.top<rightStart.top-2?(add(leftEnd.right,leftEnd.top,null,leftEnd.bottom),add(leftSide,rightStart.top,rightStart.left,rightStart.bottom)):add(leftEnd.right,leftEnd.top,rightStart.left-leftEnd.right,leftEnd.bottom)),leftEnd.bottom<rightStart.top&&add(leftSide,leftEnd.bottom,null,rightStart.top)}output.appendChild(fragment)}function restartBlink(cm){if(cm.state.focused){var display=cm.display;clearInterval(display.blinker);var on=!0;display.cursorDiv.style.visibility="",cm.options.cursorBlinkRate>0?display.blinker=setInterval(function(){return display.cursorDiv.style.visibility=(on=!on)?"":"hidden"},cm.options.cursorBlinkRate):cm.options.cursorBlinkRate<0&&(display.cursorDiv.style.visibility="hidden")}}function ensureFocus(cm){cm.state.focused||(cm.display.input.focus(),onFocus(cm))}function delayBlurEvent(cm){cm.state.delayingBlurEvent=!0,setTimeout(function(){cm.state.delayingBlurEvent&&(cm.state.delayingBlurEvent=!1,onBlur(cm))},100)}function onFocus(cm,e){cm.state.delayingBlurEvent&&(cm.state.delayingBlurEvent=!1),"nocursor"!=cm.options.readOnly&&(cm.state.focused||(signal(cm,"focus",cm,e),cm.state.focused=!0,addClass(cm.display.wrapper,"CodeMirror-focused"),cm.curOp||cm.display.selForContextMenu==cm.doc.sel||(cm.display.input.reset(),webkit&&setTimeout(function(){return cm.display.input.reset(!0)},20)),cm.display.input.receivedFocus()),restartBlink(cm))}function onBlur(cm,e){cm.state.delayingBlurEvent||(cm.state.focused&&(signal(cm,"blur",cm,e),cm.state.focused=!1,rmClass(cm.display.wrapper,"CodeMirror-focused")),clearInterval(cm.display.blinker),setTimeout(function(){cm.state.focused||(cm.display.shift=!1)},150))}function updateHeightsInViewport(cm){for(var display=cm.display,prevBottom=display.lineDiv.offsetTop,i=0;i<display.view.length;i++){var cur=display.view[i],wrapping=cm.options.lineWrapping,height=void 0,width=0;if(!cur.hidden){if(ie&&ie_version<8){var bot=cur.node.offsetTop+cur.node.offsetHeight;height=bot-prevBottom,prevBottom=bot}else{var box=cur.node.getBoundingClientRect();height=box.bottom-box.top,!wrapping&&cur.text.firstChild&&(width=cur.text.firstChild.getBoundingClientRect().right-box.left-1)}var diff=cur.line.height-height;if((diff>.005||diff<-.005)&&(updateLineHeight(cur.line,height),updateWidgetHeight(cur.line),cur.rest))for(var j=0;j<cur.rest.length;j++)updateWidgetHeight(cur.rest[j]);if(width>cm.display.sizerWidth){var chWidth=Math.ceil(width/charWidth(cm.display));chWidth>cm.display.maxLineLength&&(cm.display.maxLineLength=chWidth,cm.display.maxLine=cur.line,cm.display.maxLineChanged=!0)}}}}function updateWidgetHeight(line){if(line.widgets)for(var i=0;i<line.widgets.length;++i){var w=line.widgets[i],parent=w.node.parentNode;parent&&(w.height=parent.offsetHeight)}}function visibleLines(display,doc,viewport){var top=viewport&&null!=viewport.top?Math.max(0,viewport.top):display.scroller.scrollTop;top=Math.floor(top-paddingTop(display));var bottom=viewport&&null!=viewport.bottom?viewport.bottom:top+display.wrapper.clientHeight,from=lineAtHeight(doc,top),to=lineAtHeight(doc,bottom);if(viewport&&viewport.ensure){var ensureFrom=viewport.ensure.from.line,ensureTo=viewport.ensure.to.line;ensureFrom<from?(from=ensureFrom,to=lineAtHeight(doc,heightAtLine(getLine(doc,ensureFrom))+display.wrapper.clientHeight)):Math.min(ensureTo,doc.lastLine())>=to&&(from=lineAtHeight(doc,heightAtLine(getLine(doc,ensureTo))-display.wrapper.clientHeight),to=ensureTo)}return{from:from,to:Math.max(to,from+1)}}function calculateScrollPos(cm,rect){var display=cm.display,snapMargin=textHeight(cm.display);rect.top<0&&(rect.top=0);var screentop=cm.curOp&&null!=cm.curOp.scrollTop?cm.curOp.scrollTop:display.scroller.scrollTop,screen=displayHeight(cm),result={};rect.bottom-rect.top>screen&&(rect.bottom=rect.top+screen);var docBottom=cm.doc.height+paddingVert(display),atTop=rect.top<snapMargin,atBottom=rect.bottom>docBottom-snapMargin;if(rect.top<screentop)result.scrollTop=atTop?0:rect.top;else if(rect.bottom>screentop+screen){var newTop=Math.min(rect.top,(atBottom?docBottom:rect.bottom)-screen);newTop!=screentop&&(result.scrollTop=newTop)}var screenleft=cm.curOp&&null!=cm.curOp.scrollLeft?cm.curOp.scrollLeft:display.scroller.scrollLeft,screenw=displayWidth(cm)-(cm.options.fixedGutter?display.gutters.offsetWidth:0),tooWide=rect.right-rect.left>screenw;return tooWide&&(rect.right=rect.left+screenw),rect.left<10?result.scrollLeft=0:rect.left<screenleft?result.scrollLeft=Math.max(0,rect.left-(tooWide?0:10)):rect.right>screenw+screenleft-3&&(result.scrollLeft=rect.right+(tooWide?0:10)-screenw),result}function addToScrollTop(cm,top){null!=top&&(resolveScrollToPos(cm),cm.curOp.scrollTop=(null==cm.curOp.scrollTop?cm.doc.scrollTop:cm.curOp.scrollTop)+top)}function ensureCursorVisible(cm){resolveScrollToPos(cm);var cur=cm.getCursor();cm.curOp.scrollToPos={from:cur,to:cur,margin:cm.options.cursorScrollMargin}}function scrollToCoords(cm,x,y){null==x&&null==y||resolveScrollToPos(cm),null!=x&&(cm.curOp.scrollLeft=x),null!=y&&(cm.curOp.scrollTop=y)}function resolveScrollToPos(cm){var range=cm.curOp.scrollToPos;range&&(cm.curOp.scrollToPos=null,scrollToCoordsRange(cm,estimateCoords(cm,range.from),estimateCoords(cm,range.to),range.margin))}function scrollToCoordsRange(cm,from,to,margin){var sPos=calculateScrollPos(cm,{left:Math.min(from.left,to.left),top:Math.min(from.top,to.top)-margin,right:Math.max(from.right,to.right),bottom:Math.max(from.bottom,to.bottom)+margin});scrollToCoords(cm,sPos.scrollLeft,sPos.scrollTop)}function updateScrollTop(cm,val){Math.abs(cm.doc.scrollTop-val)<2||(gecko||updateDisplaySimple(cm,{top:val}),setScrollTop(cm,val,!0),gecko&&updateDisplaySimple(cm),startWorker(cm,100))}function setScrollTop(cm,val,forceScroll){val=Math.max(0,Math.min(cm.display.scroller.scrollHeight-cm.display.scroller.clientHeight,val)),(cm.display.scroller.scrollTop!=val||forceScroll)&&(cm.doc.scrollTop=val,cm.display.scrollbars.setScrollTop(val),cm.display.scroller.scrollTop!=val&&(cm.display.scroller.scrollTop=val))}function setScrollLeft(cm,val,isScroller,forceScroll){val=Math.max(0,Math.min(val,cm.display.scroller.scrollWidth-cm.display.scroller.clientWidth)),(isScroller?val==cm.doc.scrollLeft:Math.abs(cm.doc.scrollLeft-val)<2)&&!forceScroll||(cm.doc.scrollLeft=val,alignHorizontally(cm),cm.display.scroller.scrollLeft!=val&&(cm.display.scroller.scrollLeft=val),cm.display.scrollbars.setScrollLeft(val))}function measureForScrollbars(cm){var d=cm.display,gutterW=d.gutters.offsetWidth,docH=Math.round(cm.doc.height+paddingVert(cm.display));return{clientHeight:d.scroller.clientHeight,viewHeight:d.wrapper.clientHeight,scrollWidth:d.scroller.scrollWidth,clientWidth:d.scroller.clientWidth,viewWidth:d.wrapper.clientWidth,barLeft:cm.options.fixedGutter?gutterW:0,docHeight:docH,scrollHeight:docH+scrollGap(cm)+d.barHeight,nativeBarWidth:d.nativeBarWidth,gutterWidth:gutterW}}var NativeScrollbars=function(place,scroll,cm){this.cm=cm;var vert=this.vert=elt("div",[elt("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),horiz=this.horiz=elt("div",[elt("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");vert.tabIndex=horiz.tabIndex=-1,place(vert),place(horiz),on(vert,"scroll",function(){vert.clientHeight&&scroll(vert.scrollTop,"vertical")}),on(horiz,"scroll",function(){horiz.clientWidth&&scroll(horiz.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,ie&&ie_version<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};NativeScrollbars.prototype.update=function(measure){var needsH=measure.scrollWidth>measure.clientWidth+1,needsV=measure.scrollHeight>measure.clientHeight+1,sWidth=measure.nativeBarWidth;if(needsV){this.vert.style.display="block",this.vert.style.bottom=needsH?sWidth+"px":"0";var totalHeight=measure.viewHeight-(needsH?sWidth:0);this.vert.firstChild.style.height=Math.max(0,measure.scrollHeight-measure.clientHeight+totalHeight)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(needsH){this.horiz.style.display="block",this.horiz.style.right=needsV?sWidth+"px":"0",this.horiz.style.left=measure.barLeft+"px";var totalWidth=measure.viewWidth-measure.barLeft-(needsV?sWidth:0);this.horiz.firstChild.style.width=Math.max(0,measure.scrollWidth-measure.clientWidth+totalWidth)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&measure.clientHeight>0&&(0==sWidth&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:needsV?sWidth:0,bottom:needsH?sWidth:0}},NativeScrollbars.prototype.setScrollLeft=function(pos){this.horiz.scrollLeft!=pos&&(this.horiz.scrollLeft=pos),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},NativeScrollbars.prototype.setScrollTop=function(pos){this.vert.scrollTop!=pos&&(this.vert.scrollTop=pos),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},NativeScrollbars.prototype.zeroWidthHack=function(){var w=mac&&!mac_geMountainLion?"12px":"18px";this.horiz.style.height=this.vert.style.width=w,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Delayed,this.disableVert=new Delayed},NativeScrollbars.prototype.enableZeroWidthBar=function(bar,delay,type){bar.style.pointerEvents="auto",delay.set(1e3,function maybeDisable(){var box=bar.getBoundingClientRect();("vert"==type?document.elementFromPoint(box.right-1,(box.top+box.bottom)/2):document.elementFromPoint((box.right+box.left)/2,box.bottom-1))!=bar?bar.style.pointerEvents="none":delay.set(1e3,maybeDisable)})},NativeScrollbars.prototype.clear=function(){var parent=this.horiz.parentNode;parent.removeChild(this.horiz),parent.removeChild(this.vert)};var NullScrollbars=function(){};function updateScrollbars(cm,measure){measure||(measure=measureForScrollbars(cm));var startWidth=cm.display.barWidth,startHeight=cm.display.barHeight;updateScrollbarsInner(cm,measure);for(var i=0;i<4&&startWidth!=cm.display.barWidth||startHeight!=cm.display.barHeight;i++)startWidth!=cm.display.barWidth&&cm.options.lineWrapping&&updateHeightsInViewport(cm),updateScrollbarsInner(cm,measureForScrollbars(cm)),startWidth=cm.display.barWidth,startHeight=cm.display.barHeight}function updateScrollbarsInner(cm,measure){var d=cm.display,sizes=d.scrollbars.update(measure);d.sizer.style.paddingRight=(d.barWidth=sizes.right)+"px",d.sizer.style.paddingBottom=(d.barHeight=sizes.bottom)+"px",d.heightForcer.style.borderBottom=sizes.bottom+"px solid transparent",sizes.right&&sizes.bottom?(d.scrollbarFiller.style.display="block",d.scrollbarFiller.style.height=sizes.bottom+"px",d.scrollbarFiller.style.width=sizes.right+"px"):d.scrollbarFiller.style.display="",sizes.bottom&&cm.options.coverGutterNextToScrollbar&&cm.options.fixedGutter?(d.gutterFiller.style.display="block",d.gutterFiller.style.height=sizes.bottom+"px",d.gutterFiller.style.width=measure.gutterWidth+"px"):d.gutterFiller.style.display=""}NullScrollbars.prototype.update=function(){return{bottom:0,right:0}},NullScrollbars.prototype.setScrollLeft=function(){},NullScrollbars.prototype.setScrollTop=function(){},NullScrollbars.prototype.clear=function(){};var scrollbarModel={native:NativeScrollbars,null:NullScrollbars};function initScrollbars(cm){cm.display.scrollbars&&(cm.display.scrollbars.clear(),cm.display.scrollbars.addClass&&rmClass(cm.display.wrapper,cm.display.scrollbars.addClass)),cm.display.scrollbars=new scrollbarModel[cm.options.scrollbarStyle](function(node){cm.display.wrapper.insertBefore(node,cm.display.scrollbarFiller),on(node,"mousedown",function(){cm.state.focused&&setTimeout(function(){return cm.display.input.focus()},0)}),node.setAttribute("cm-not-content","true")},function(pos,axis){"horizontal"==axis?setScrollLeft(cm,pos):updateScrollTop(cm,pos)},cm),cm.display.scrollbars.addClass&&addClass(cm.display.wrapper,cm.display.scrollbars.addClass)}var nextOpId=0;function startOperation(cm){var op;cm.curOp={cm:cm,viewChanged:!1,startHeight:cm.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++nextOpId},op=cm.curOp,operationGroup?operationGroup.ops.push(op):op.ownsGroup=operationGroup={ops:[op],delayedCallbacks:[]}}function endOperation(cm){var op=cm.curOp;op&&function(op,endCb){var group=op.ownsGroup;if(group)try{!function(group){var callbacks=group.delayedCallbacks,i=0;do{for(;i<callbacks.length;i++)callbacks[i].call(null);for(var j=0;j<group.ops.length;j++){var op=group.ops[j];if(op.cursorActivityHandlers)for(;op.cursorActivityCalled<op.cursorActivityHandlers.length;)op.cursorActivityHandlers[op.cursorActivityCalled++].call(null,op.cm)}}while(i<callbacks.length)}(group)}finally{operationGroup=null,endCb(group)}}(op,function(group){for(var i=0;i<group.ops.length;i++)group.ops[i].cm.curOp=null;!function(group){for(var ops=group.ops,i=0;i<ops.length;i++)endOperation_R1(ops[i]);for(var i$1=0;i$1<ops.length;i$1++)(op=ops[i$1]).updatedDisplay=op.mustUpdate&&updateDisplayIfNeeded(op.cm,op.update);var op;for(var i$2=0;i$2<ops.length;i$2++)endOperation_R2(ops[i$2]);for(var i$3=0;i$3<ops.length;i$3++)endOperation_W2(ops[i$3]);for(var i$4=0;i$4<ops.length;i$4++)endOperation_finish(ops[i$4])}(group)})}function endOperation_R1(op){var cm=op.cm,display=cm.display;!function(cm){var display=cm.display;!display.scrollbarsClipped&&display.scroller.offsetWidth&&(display.nativeBarWidth=display.scroller.offsetWidth-display.scroller.clientWidth,display.heightForcer.style.height=scrollGap(cm)+"px",display.sizer.style.marginBottom=-display.nativeBarWidth+"px",display.sizer.style.borderRightWidth=scrollGap(cm)+"px",display.scrollbarsClipped=!0)}(cm),op.updateMaxLine&&findMaxLine(cm),op.mustUpdate=op.viewChanged||op.forceUpdate||null!=op.scrollTop||op.scrollToPos&&(op.scrollToPos.from.line<display.viewFrom||op.scrollToPos.to.line>=display.viewTo)||display.maxLineChanged&&cm.options.lineWrapping,op.update=op.mustUpdate&&new DisplayUpdate(cm,op.mustUpdate&&{top:op.scrollTop,ensure:op.scrollToPos},op.forceUpdate)}function endOperation_R2(op){var cm=op.cm,display=cm.display;op.updatedDisplay&&updateHeightsInViewport(cm),op.barMeasure=measureForScrollbars(cm),display.maxLineChanged&&!cm.options.lineWrapping&&(op.adjustWidthTo=measureChar(cm,display.maxLine,display.maxLine.text.length).left+3,cm.display.sizerWidth=op.adjustWidthTo,op.barMeasure.scrollWidth=Math.max(display.scroller.clientWidth,display.sizer.offsetLeft+op.adjustWidthTo+scrollGap(cm)+cm.display.barWidth),op.maxScrollLeft=Math.max(0,display.sizer.offsetLeft+op.adjustWidthTo-displayWidth(cm))),(op.updatedDisplay||op.selectionChanged)&&(op.preparedSelection=display.input.prepareSelection())}function endOperation_W2(op){var cm=op.cm;null!=op.adjustWidthTo&&(cm.display.sizer.style.minWidth=op.adjustWidthTo+"px",op.maxScrollLeft<cm.doc.scrollLeft&&setScrollLeft(cm,Math.min(cm.display.scroller.scrollLeft,op.maxScrollLeft),!0),cm.display.maxLineChanged=!1);var takeFocus=op.focus&&op.focus==activeElt();op.preparedSelection&&cm.display.input.showSelection(op.preparedSelection,takeFocus),(op.updatedDisplay||op.startHeight!=cm.doc.height)&&updateScrollbars(cm,op.barMeasure),op.updatedDisplay&&setDocumentHeight(cm,op.barMeasure),op.selectionChanged&&restartBlink(cm),cm.state.focused&&op.updateInput&&cm.display.input.reset(op.typing),takeFocus&&ensureFocus(op.cm)}function endOperation_finish(op){var cm=op.cm,display=cm.display,doc=cm.doc;(op.updatedDisplay&&postUpdateDisplay(cm,op.update),null==display.wheelStartX||null==op.scrollTop&&null==op.scrollLeft&&!op.scrollToPos||(display.wheelStartX=display.wheelStartY=null),null!=op.scrollTop&&setScrollTop(cm,op.scrollTop,op.forceScroll),null!=op.scrollLeft&&setScrollLeft(cm,op.scrollLeft,!0,!0),op.scrollToPos)&&function(cm,rect){if(!signalDOMEvent(cm,"scrollCursorIntoView")){var display=cm.display,box=display.sizer.getBoundingClientRect(),doScroll=null;if(rect.top+box.top<0?doScroll=!0:rect.bottom+box.top>(window.innerHeight||document.documentElement.clientHeight)&&(doScroll=!1),null!=doScroll&&!phantom){var scrollNode=elt("div","​",null,"position: absolute;\n                         top: "+(rect.top-display.viewOffset-paddingTop(cm.display))+"px;\n                         height: "+(rect.bottom-rect.top+scrollGap(cm)+display.barHeight)+"px;\n                         left: "+rect.left+"px; width: "+Math.max(2,rect.right-rect.left)+"px;");cm.display.lineSpace.appendChild(scrollNode),scrollNode.scrollIntoView(doScroll),cm.display.lineSpace.removeChild(scrollNode)}}}(cm,function(cm,pos,end,margin){var rect;null==margin&&(margin=0),cm.options.lineWrapping||pos!=end||(end="before"==(pos=pos.ch?Pos(pos.line,"before"==pos.sticky?pos.ch-1:pos.ch,"after"):pos).sticky?Pos(pos.line,pos.ch+1,"before"):pos);for(var limit=0;limit<5;limit++){var changed=!1,coords=cursorCoords(cm,pos),endCoords=end&&end!=pos?cursorCoords(cm,end):coords,scrollPos=calculateScrollPos(cm,rect={left:Math.min(coords.left,endCoords.left),top:Math.min(coords.top,endCoords.top)-margin,right:Math.max(coords.left,endCoords.left),bottom:Math.max(coords.bottom,endCoords.bottom)+margin}),startTop=cm.doc.scrollTop,startLeft=cm.doc.scrollLeft;if(null!=scrollPos.scrollTop&&(updateScrollTop(cm,scrollPos.scrollTop),Math.abs(cm.doc.scrollTop-startTop)>1&&(changed=!0)),null!=scrollPos.scrollLeft&&(setScrollLeft(cm,scrollPos.scrollLeft),Math.abs(cm.doc.scrollLeft-startLeft)>1&&(changed=!0)),!changed)break}return rect}(cm,clipPos(doc,op.scrollToPos.from),clipPos(doc,op.scrollToPos.to),op.scrollToPos.margin));var hidden=op.maybeHiddenMarkers,unhidden=op.maybeUnhiddenMarkers;if(hidden)for(var i=0;i<hidden.length;++i)hidden[i].lines.length||signal(hidden[i],"hide");if(unhidden)for(var i$1=0;i$1<unhidden.length;++i$1)unhidden[i$1].lines.length&&signal(unhidden[i$1],"unhide");display.wrapper.offsetHeight&&(doc.scrollTop=cm.display.scroller.scrollTop),op.changeObjs&&signal(cm,"changes",cm,op.changeObjs),op.update&&op.update.finish()}function runInOp(cm,f){if(cm.curOp)return f();startOperation(cm);try{return f()}finally{endOperation(cm)}}function operation(cm,f){return function(){if(cm.curOp)return f.apply(cm,arguments);startOperation(cm);try{return f.apply(cm,arguments)}finally{endOperation(cm)}}}function methodOp(f){return function(){if(this.curOp)return f.apply(this,arguments);startOperation(this);try{return f.apply(this,arguments)}finally{endOperation(this)}}}function docMethodOp(f){return function(){var cm=this.cm;if(!cm||cm.curOp)return f.apply(this,arguments);startOperation(cm);try{return f.apply(this,arguments)}finally{endOperation(cm)}}}function startWorker(cm,time){cm.doc.highlightFrontier<cm.display.viewTo&&cm.state.highlight.set(time,bind(highlightWorker,cm))}function highlightWorker(cm){var doc=cm.doc;if(!(doc.highlightFrontier>=cm.display.viewTo)){var end=+new Date+cm.options.workTime,context=getContextBefore(cm,doc.highlightFrontier),changedLines=[];doc.iter(context.line,Math.min(doc.first+doc.size,cm.display.viewTo+500),function(line){if(context.line>=cm.display.viewFrom){var oldStyles=line.styles,resetState=line.text.length>cm.options.maxHighlightLength?copyState(doc.mode,context.state):null,highlighted=highlightLine(cm,line,context,!0);resetState&&(context.state=resetState),line.styles=highlighted.styles;var oldCls=line.styleClasses,newCls=highlighted.classes;newCls?line.styleClasses=newCls:oldCls&&(line.styleClasses=null);for(var ischange=!oldStyles||oldStyles.length!=line.styles.length||oldCls!=newCls&&(!oldCls||!newCls||oldCls.bgClass!=newCls.bgClass||oldCls.textClass!=newCls.textClass),i=0;!ischange&&i<oldStyles.length;++i)ischange=oldStyles[i]!=line.styles[i];ischange&&changedLines.push(context.line),line.stateAfter=context.save(),context.nextLine()}else line.text.length<=cm.options.maxHighlightLength&&processLine(cm,line.text,context),line.stateAfter=context.line%5==0?context.save():null,context.nextLine();if(+new Date>end)return startWorker(cm,cm.options.workDelay),!0}),doc.highlightFrontier=context.line,doc.modeFrontier=Math.max(doc.modeFrontier,context.line),changedLines.length&&runInOp(cm,function(){for(var i=0;i<changedLines.length;i++)regLineChange(cm,changedLines[i],"text")})}}var DisplayUpdate=function(cm,viewport,force){var display=cm.display;this.viewport=viewport,this.visible=visibleLines(display,cm.doc,viewport),this.editorIsHidden=!display.wrapper.offsetWidth,this.wrapperHeight=display.wrapper.clientHeight,this.wrapperWidth=display.wrapper.clientWidth,this.oldDisplayWidth=displayWidth(cm),this.force=force,this.dims=getDimensions(cm),this.events=[]};function updateDisplayIfNeeded(cm,update){var display=cm.display,doc=cm.doc;if(update.editorIsHidden)return resetView(cm),!1;if(!update.force&&update.visible.from>=display.viewFrom&&update.visible.to<=display.viewTo&&(null==display.updateLineNumbers||display.updateLineNumbers>=display.viewTo)&&display.renderedView==display.view&&0==countDirtyView(cm))return!1;maybeUpdateLineNumberWidth(cm)&&(resetView(cm),update.dims=getDimensions(cm));var end=doc.first+doc.size,from=Math.max(update.visible.from-cm.options.viewportMargin,doc.first),to=Math.min(end,update.visible.to+cm.options.viewportMargin);display.viewFrom<from&&from-display.viewFrom<20&&(from=Math.max(doc.first,display.viewFrom)),display.viewTo>to&&display.viewTo-to<20&&(to=Math.min(end,display.viewTo)),sawCollapsedSpans&&(from=visualLineNo(cm.doc,from),to=visualLineEndNo(cm.doc,to));var different=from!=display.viewFrom||to!=display.viewTo||display.lastWrapHeight!=update.wrapperHeight||display.lastWrapWidth!=update.wrapperWidth;!function(cm,from,to){var display=cm.display;0==display.view.length||from>=display.viewTo||to<=display.viewFrom?(display.view=buildViewArray(cm,from,to),display.viewFrom=from):(display.viewFrom>from?display.view=buildViewArray(cm,from,display.viewFrom).concat(display.view):display.viewFrom<from&&(display.view=display.view.slice(findViewIndex(cm,from))),display.viewFrom=from,display.viewTo<to?display.view=display.view.concat(buildViewArray(cm,display.viewTo,to)):display.viewTo>to&&(display.view=display.view.slice(0,findViewIndex(cm,to)))),display.viewTo=to}(cm,from,to),display.viewOffset=heightAtLine(getLine(cm.doc,display.viewFrom)),cm.display.mover.style.top=display.viewOffset+"px";var toUpdate=countDirtyView(cm);if(!different&&0==toUpdate&&!update.force&&display.renderedView==display.view&&(null==display.updateLineNumbers||display.updateLineNumbers>=display.viewTo))return!1;var selSnapshot=function(cm){if(cm.hasFocus())return null;var active=activeElt();if(!active||!contains(cm.display.lineDiv,active))return null;var result={activeElt:active};if(window.getSelection){var sel=window.getSelection();sel.anchorNode&&sel.extend&&contains(cm.display.lineDiv,sel.anchorNode)&&(result.anchorNode=sel.anchorNode,result.anchorOffset=sel.anchorOffset,result.focusNode=sel.focusNode,result.focusOffset=sel.focusOffset)}return result}(cm);return toUpdate>4&&(display.lineDiv.style.display="none"),function(cm,updateNumbersFrom,dims){var display=cm.display,lineNumbers=cm.options.lineNumbers,container=display.lineDiv,cur=container.firstChild;function rm(node){var next=node.nextSibling;return webkit&&mac&&cm.display.currentWheelTarget==node?node.style.display="none":node.parentNode.removeChild(node),next}for(var view=display.view,lineN=display.viewFrom,i=0;i<view.length;i++){var lineView=view[i];if(lineView.hidden);else if(lineView.node&&lineView.node.parentNode==container){for(;cur!=lineView.node;)cur=rm(cur);var updateNumber=lineNumbers&&null!=updateNumbersFrom&&updateNumbersFrom<=lineN&&lineView.lineNumber;lineView.changes&&(indexOf(lineView.changes,"gutter")>-1&&(updateNumber=!1),updateLineForChanges(cm,lineView,lineN,dims)),updateNumber&&(removeChildren(lineView.lineNumber),lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options,lineN)))),cur=lineView.node.nextSibling}else{var node=buildLineElement(cm,lineView,lineN,dims);container.insertBefore(node,cur)}lineN+=lineView.size}for(;cur;)cur=rm(cur)}(cm,display.updateLineNumbers,update.dims),toUpdate>4&&(display.lineDiv.style.display=""),display.renderedView=display.view,function(snapshot){if(snapshot&&snapshot.activeElt&&snapshot.activeElt!=activeElt()&&(snapshot.activeElt.focus(),!/^(INPUT|TEXTAREA)$/.test(snapshot.activeElt.nodeName)&&snapshot.anchorNode&&contains(document.body,snapshot.anchorNode)&&contains(document.body,snapshot.focusNode))){var sel=window.getSelection(),range=document.createRange();range.setEnd(snapshot.anchorNode,snapshot.anchorOffset),range.collapse(!1),sel.removeAllRanges(),sel.addRange(range),sel.extend(snapshot.focusNode,snapshot.focusOffset)}}(selSnapshot),removeChildren(display.cursorDiv),removeChildren(display.selectionDiv),display.gutters.style.height=display.sizer.style.minHeight=0,different&&(display.lastWrapHeight=update.wrapperHeight,display.lastWrapWidth=update.wrapperWidth,startWorker(cm,400)),display.updateLineNumbers=null,!0}function postUpdateDisplay(cm,update){for(var viewport=update.viewport,first=!0;;first=!1){if(first&&cm.options.lineWrapping&&update.oldDisplayWidth!=displayWidth(cm))first&&(update.visible=visibleLines(cm.display,cm.doc,viewport));else if(viewport&&null!=viewport.top&&(viewport={top:Math.min(cm.doc.height+paddingVert(cm.display)-displayHeight(cm),viewport.top)}),update.visible=visibleLines(cm.display,cm.doc,viewport),update.visible.from>=cm.display.viewFrom&&update.visible.to<=cm.display.viewTo)break;if(!updateDisplayIfNeeded(cm,update))break;updateHeightsInViewport(cm);var barMeasure=measureForScrollbars(cm);updateSelection(cm),updateScrollbars(cm,barMeasure),setDocumentHeight(cm,barMeasure),update.force=!1}update.signal(cm,"update",cm),cm.display.viewFrom==cm.display.reportedViewFrom&&cm.display.viewTo==cm.display.reportedViewTo||(update.signal(cm,"viewportChange",cm,cm.display.viewFrom,cm.display.viewTo),cm.display.reportedViewFrom=cm.display.viewFrom,cm.display.reportedViewTo=cm.display.viewTo)}function updateDisplaySimple(cm,viewport){var update=new DisplayUpdate(cm,viewport);if(updateDisplayIfNeeded(cm,update)){updateHeightsInViewport(cm),postUpdateDisplay(cm,update);var barMeasure=measureForScrollbars(cm);updateSelection(cm),updateScrollbars(cm,barMeasure),setDocumentHeight(cm,barMeasure),update.finish()}}function updateGutterSpace(display){var width=display.gutters.offsetWidth;display.sizer.style.marginLeft=width+"px"}function setDocumentHeight(cm,measure){cm.display.sizer.style.minHeight=measure.docHeight+"px",cm.display.heightForcer.style.top=measure.docHeight+"px",cm.display.gutters.style.height=measure.docHeight+cm.display.barHeight+scrollGap(cm)+"px"}function alignHorizontally(cm){var display=cm.display,view=display.view;if(display.alignWidgets||display.gutters.firstChild&&cm.options.fixedGutter){for(var comp=compensateForHScroll(display)-display.scroller.scrollLeft+cm.doc.scrollLeft,gutterW=display.gutters.offsetWidth,left=comp+"px",i=0;i<view.length;i++)if(!view[i].hidden){cm.options.fixedGutter&&(view[i].gutter&&(view[i].gutter.style.left=left),view[i].gutterBackground&&(view[i].gutterBackground.style.left=left));var align=view[i].alignable;if(align)for(var j=0;j<align.length;j++)align[j].style.left=left}cm.options.fixedGutter&&(display.gutters.style.left=comp+gutterW+"px")}}function maybeUpdateLineNumberWidth(cm){if(!cm.options.lineNumbers)return!1;var doc=cm.doc,last=lineNumberFor(cm.options,doc.first+doc.size-1),display=cm.display;if(last.length!=display.lineNumChars){var test=display.measure.appendChild(elt("div",[elt("div",last)],"CodeMirror-linenumber CodeMirror-gutter-elt")),innerW=test.firstChild.offsetWidth,padding=test.offsetWidth-innerW;return display.lineGutter.style.width="",display.lineNumInnerWidth=Math.max(innerW,display.lineGutter.offsetWidth-padding)+1,display.lineNumWidth=display.lineNumInnerWidth+padding,display.lineNumChars=display.lineNumInnerWidth?last.length:-1,display.lineGutter.style.width=display.lineNumWidth+"px",updateGutterSpace(cm.display),!0}return!1}function getGutters(gutters,lineNumbers){for(var result=[],sawLineNumbers=!1,i=0;i<gutters.length;i++){var name=gutters[i],style=null;if("string"!=typeof name&&(style=name.style,name=name.className),"CodeMirror-linenumbers"==name){if(!lineNumbers)continue;sawLineNumbers=!0}result.push({className:name,style:style})}return lineNumbers&&!sawLineNumbers&&result.push({className:"CodeMirror-linenumbers",style:null}),result}function renderGutters(display){var gutters=display.gutters,specs=display.gutterSpecs;removeChildren(gutters),display.lineGutter=null;for(var i=0;i<specs.length;++i){var ref=specs[i],className=ref.className,style=ref.style,gElt=gutters.appendChild(elt("div",null,"CodeMirror-gutter "+className));style&&(gElt.style.cssText=style),"CodeMirror-linenumbers"==className&&(display.lineGutter=gElt,gElt.style.width=(display.lineNumWidth||1)+"px")}gutters.style.display=specs.length?"":"none",updateGutterSpace(display)}function updateGutters(cm){renderGutters(cm.display),regChange(cm),alignHorizontally(cm)}DisplayUpdate.prototype.signal=function(emitter,type){hasHandler(emitter,type)&&this.events.push(arguments)},DisplayUpdate.prototype.finish=function(){for(var i=0;i<this.events.length;i++)signal.apply(null,this.events[i])};var wheelSamples=0,wheelPixelsPerUnit=null;function wheelEventDelta(e){var dx=e.wheelDeltaX,dy=e.wheelDeltaY;return null==dx&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(dx=e.detail),null==dy&&e.detail&&e.axis==e.VERTICAL_AXIS?dy=e.detail:null==dy&&(dy=e.wheelDelta),{x:dx,y:dy}}function wheelEventPixels(e){var delta=wheelEventDelta(e);return delta.x*=wheelPixelsPerUnit,delta.y*=wheelPixelsPerUnit,delta}function onScrollWheel(cm,e){var delta=wheelEventDelta(e),dx=delta.x,dy=delta.y,display=cm.display,scroll=display.scroller,canScrollX=scroll.scrollWidth>scroll.clientWidth,canScrollY=scroll.scrollHeight>scroll.clientHeight;if(dx&&canScrollX||dy&&canScrollY){if(dy&&mac&&webkit)outer:for(var cur=e.target,view=display.view;cur!=scroll;cur=cur.parentNode)for(var i=0;i<view.length;i++)if(view[i].node==cur){cm.display.currentWheelTarget=cur;break outer}if(dx&&!gecko&&!presto&&null!=wheelPixelsPerUnit)return dy&&canScrollY&&updateScrollTop(cm,Math.max(0,scroll.scrollTop+dy*wheelPixelsPerUnit)),setScrollLeft(cm,Math.max(0,scroll.scrollLeft+dx*wheelPixelsPerUnit)),(!dy||dy&&canScrollY)&&e_preventDefault(e),void(display.wheelStartX=null);if(dy&&null!=wheelPixelsPerUnit){var pixels=dy*wheelPixelsPerUnit,top=cm.doc.scrollTop,bot=top+display.wrapper.clientHeight;pixels<0?top=Math.max(0,top+pixels-50):bot=Math.min(cm.doc.height,bot+pixels+50),updateDisplaySimple(cm,{top:top,bottom:bot})}wheelSamples<20&&(null==display.wheelStartX?(display.wheelStartX=scroll.scrollLeft,display.wheelStartY=scroll.scrollTop,display.wheelDX=dx,display.wheelDY=dy,setTimeout(function(){if(null!=display.wheelStartX){var movedX=scroll.scrollLeft-display.wheelStartX,movedY=scroll.scrollTop-display.wheelStartY,sample=movedY&&display.wheelDY&&movedY/display.wheelDY||movedX&&display.wheelDX&&movedX/display.wheelDX;display.wheelStartX=display.wheelStartY=null,sample&&(wheelPixelsPerUnit=(wheelPixelsPerUnit*wheelSamples+sample)/(wheelSamples+1),++wheelSamples)}},200)):(display.wheelDX+=dx,display.wheelDY+=dy))}}ie?wheelPixelsPerUnit=-.53:gecko?wheelPixelsPerUnit=15:chrome?wheelPixelsPerUnit=-.7:safari&&(wheelPixelsPerUnit=-1/3);var Selection=function(ranges,primIndex){this.ranges=ranges,this.primIndex=primIndex};Selection.prototype.primary=function(){return this.ranges[this.primIndex]},Selection.prototype.equals=function(other){if(other==this)return!0;if(other.primIndex!=this.primIndex||other.ranges.length!=this.ranges.length)return!1;for(var i=0;i<this.ranges.length;i++){var here=this.ranges[i],there=other.ranges[i];if(!equalCursorPos(here.anchor,there.anchor)||!equalCursorPos(here.head,there.head))return!1}return!0},Selection.prototype.deepCopy=function(){for(var out=[],i=0;i<this.ranges.length;i++)out[i]=new Range(copyPos(this.ranges[i].anchor),copyPos(this.ranges[i].head));return new Selection(out,this.primIndex)},Selection.prototype.somethingSelected=function(){for(var i=0;i<this.ranges.length;i++)if(!this.ranges[i].empty())return!0;return!1},Selection.prototype.contains=function(pos,end){end||(end=pos);for(var i=0;i<this.ranges.length;i++){var range=this.ranges[i];if(cmp(end,range.from())>=0&&cmp(pos,range.to())<=0)return i}return-1};var Range=function(anchor,head){this.anchor=anchor,this.head=head};function normalizeSelection(cm,ranges,primIndex){var mayTouch=cm&&cm.options.selectionsMayTouch,prim=ranges[primIndex];ranges.sort(function(a,b){return cmp(a.from(),b.from())}),primIndex=indexOf(ranges,prim);for(var i=1;i<ranges.length;i++){var cur=ranges[i],prev=ranges[i-1],diff=cmp(prev.to(),cur.from());if(mayTouch&&!cur.empty()?diff>0:diff>=0){var from=minPos(prev.from(),cur.from()),to=maxPos(prev.to(),cur.to()),inv=prev.empty()?cur.from()==cur.head:prev.from()==prev.head;i<=primIndex&&--primIndex,ranges.splice(--i,2,new Range(inv?to:from,inv?from:to))}}return new Selection(ranges,primIndex)}function simpleSelection(anchor,head){return new Selection([new Range(anchor,head||anchor)],0)}function changeEnd(change){return change.text?Pos(change.from.line+change.text.length-1,lst(change.text).length+(1==change.text.length?change.from.ch:0)):change.to}function adjustForChange(pos,change){if(cmp(pos,change.from)<0)return pos;if(cmp(pos,change.to)<=0)return changeEnd(change);var line=pos.line+change.text.length-(change.to.line-change.from.line)-1,ch=pos.ch;return pos.line==change.to.line&&(ch+=changeEnd(change).ch-change.to.ch),Pos(line,ch)}function computeSelAfterChange(doc,change){for(var out=[],i=0;i<doc.sel.ranges.length;i++){var range=doc.sel.ranges[i];out.push(new Range(adjustForChange(range.anchor,change),adjustForChange(range.head,change)))}return normalizeSelection(doc.cm,out,doc.sel.primIndex)}function offsetPos(pos,old,nw){return pos.line==old.line?Pos(nw.line,pos.ch-old.ch+nw.ch):Pos(nw.line+(pos.line-old.line),pos.ch)}function loadMode(cm){cm.doc.mode=getMode(cm.options,cm.doc.modeOption),resetModeState(cm)}function resetModeState(cm){cm.doc.iter(function(line){line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null)}),cm.doc.modeFrontier=cm.doc.highlightFrontier=cm.doc.first,startWorker(cm,100),cm.state.modeGen++,cm.curOp&&regChange(cm)}function isWholeLineUpdate(doc,change){return 0==change.from.ch&&0==change.to.ch&&""==lst(change.text)&&(!doc.cm||doc.cm.options.wholeLineUpdateBefore)}function updateDoc(doc,change,markedSpans,estimateHeight){function spansFor(n){return markedSpans?markedSpans[n]:null}function update(line,text,spans){!function(line,text,markedSpans,estimateHeight){line.text=text,line.stateAfter&&(line.stateAfter=null),line.styles&&(line.styles=null),null!=line.order&&(line.order=null),detachMarkedSpans(line),attachMarkedSpans(line,markedSpans);var estHeight=estimateHeight?estimateHeight(line):1;estHeight!=line.height&&updateLineHeight(line,estHeight)}(line,text,spans,estimateHeight),signalLater(line,"change",line,change)}function linesFor(start,end){for(var result=[],i=start;i<end;++i)result.push(new Line(text[i],spansFor(i),estimateHeight));return result}var from=change.from,to=change.to,text=change.text,firstLine=getLine(doc,from.line),lastLine=getLine(doc,to.line),lastText=lst(text),lastSpans=spansFor(text.length-1),nlines=to.line-from.line;if(change.full)doc.insert(0,linesFor(0,text.length)),doc.remove(text.length,doc.size-text.length);else if(isWholeLineUpdate(doc,change)){var added=linesFor(0,text.length-1);update(lastLine,lastLine.text,lastSpans),nlines&&doc.remove(from.line,nlines),added.length&&doc.insert(from.line,added)}else if(firstLine==lastLine)if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+lastText+firstLine.text.slice(to.ch),lastSpans);else{var added$1=linesFor(1,text.length-1);added$1.push(new Line(lastText+firstLine.text.slice(to.ch),lastSpans,estimateHeight)),update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),doc.insert(from.line+1,added$1)}else if(1==text.length)update(firstLine,firstLine.text.slice(0,from.ch)+text[0]+lastLine.text.slice(to.ch),spansFor(0)),doc.remove(from.line+1,nlines);else{update(firstLine,firstLine.text.slice(0,from.ch)+text[0],spansFor(0)),update(lastLine,lastText+lastLine.text.slice(to.ch),lastSpans);var added$2=linesFor(1,text.length-1);nlines>1&&doc.remove(from.line+1,nlines-1),doc.insert(from.line+1,added$2)}signalLater(doc,"change",doc,change)}function linkedDocs(doc,f,sharedHistOnly){!function propagate(doc,skip,sharedHist){if(doc.linked)for(var i=0;i<doc.linked.length;++i){var rel=doc.linked[i];if(rel.doc!=skip){var shared=sharedHist&&rel.sharedHist;sharedHistOnly&&!shared||(f(rel.doc,shared),propagate(rel.doc,doc,shared))}}}(doc,null,!0)}function attachDoc(cm,doc){if(doc.cm)throw new Error("This document is already in use.");cm.doc=doc,doc.cm=cm,estimateLineHeights(cm),loadMode(cm),setDirectionClass(cm),cm.options.lineWrapping||findMaxLine(cm),cm.options.mode=doc.modeOption,regChange(cm)}function setDirectionClass(cm){("rtl"==cm.doc.direction?addClass:rmClass)(cm.display.lineDiv,"CodeMirror-rtl")}function History(startGen){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=startGen||1}function historyChangeFromChange(doc,change){var histChange={from:copyPos(change.from),to:changeEnd(change),text:getBetween(doc,change.from,change.to)};return attachLocalSpans(doc,histChange,change.from.line,change.to.line+1),linkedDocs(doc,function(doc){return attachLocalSpans(doc,histChange,change.from.line,change.to.line+1)},!0),histChange}function clearSelectionEvents(array){for(;array.length;){if(!lst(array).ranges)break;array.pop()}}function addChangeToHistory(doc,change,selAfter,opId){var hist=doc.history;hist.undone.length=0;var cur,last,time=+new Date;if((hist.lastOp==opId||hist.lastOrigin==change.origin&&change.origin&&("+"==change.origin.charAt(0)&&hist.lastModTime>time-(doc.cm?doc.cm.options.historyEventDelay:500)||"*"==change.origin.charAt(0)))&&(cur=function(hist,force){return force?(clearSelectionEvents(hist.done),lst(hist.done)):hist.done.length&&!lst(hist.done).ranges?lst(hist.done):hist.done.length>1&&!hist.done[hist.done.length-2].ranges?(hist.done.pop(),lst(hist.done)):void 0}(hist,hist.lastOp==opId)))last=lst(cur.changes),0==cmp(change.from,change.to)&&0==cmp(change.from,last.to)?last.to=changeEnd(change):cur.changes.push(historyChangeFromChange(doc,change));else{var before=lst(hist.done);for(before&&before.ranges||pushSelectionToHistory(doc.sel,hist.done),cur={changes:[historyChangeFromChange(doc,change)],generation:hist.generation},hist.done.push(cur);hist.done.length>hist.undoDepth;)hist.done.shift(),hist.done[0].ranges||hist.done.shift()}hist.done.push(selAfter),hist.generation=++hist.maxGeneration,hist.lastModTime=hist.lastSelTime=time,hist.lastOp=hist.lastSelOp=opId,hist.lastOrigin=hist.lastSelOrigin=change.origin,last||signal(doc,"historyAdded")}function addSelectionToHistory(doc,sel,opId,options){var hist=doc.history,origin=options&&options.origin;opId==hist.lastSelOp||origin&&hist.lastSelOrigin==origin&&(hist.lastModTime==hist.lastSelTime&&hist.lastOrigin==origin||function(doc,origin,prev,sel){var ch=origin.charAt(0);return"*"==ch||"+"==ch&&prev.ranges.length==sel.ranges.length&&prev.somethingSelected()==sel.somethingSelected()&&new Date-doc.history.lastSelTime<=(doc.cm?doc.cm.options.historyEventDelay:500)}(doc,origin,lst(hist.done),sel))?hist.done[hist.done.length-1]=sel:pushSelectionToHistory(sel,hist.done),hist.lastSelTime=+new Date,hist.lastSelOrigin=origin,hist.lastSelOp=opId,options&&!1!==options.clearRedo&&clearSelectionEvents(hist.undone)}function pushSelectionToHistory(sel,dest){var top=lst(dest);top&&top.ranges&&top.equals(sel)||dest.push(sel)}function attachLocalSpans(doc,change,from,to){var existing=change["spans_"+doc.id],n=0;doc.iter(Math.max(doc.first,from),Math.min(doc.first+doc.size,to),function(line){line.markedSpans&&((existing||(existing=change["spans_"+doc.id]={}))[n]=line.markedSpans),++n})}function removeClearedSpans(spans){if(!spans)return null;for(var out,i=0;i<spans.length;++i)spans[i].marker.explicitlyCleared?out||(out=spans.slice(0,i)):out&&out.push(spans[i]);return out?out.length?out:null:spans}function mergeOldSpans(doc,change){var old=function(doc,change){var found=change["spans_"+doc.id];if(!found)return null;for(var nw=[],i=0;i<change.text.length;++i)nw.push(removeClearedSpans(found[i]));return nw}(doc,change),stretched=stretchSpansOverChange(doc,change);if(!old)return stretched;if(!stretched)return old;for(var i=0;i<old.length;++i){var oldCur=old[i],stretchCur=stretched[i];if(oldCur&&stretchCur)spans:for(var j=0;j<stretchCur.length;++j){for(var span=stretchCur[j],k=0;k<oldCur.length;++k)if(oldCur[k].marker==span.marker)continue spans;oldCur.push(span)}else stretchCur&&(old[i]=stretchCur)}return old}function copyHistoryArray(events,newGroup,instantiateSel){for(var copy=[],i=0;i<events.length;++i){var event=events[i];if(event.ranges)copy.push(instantiateSel?Selection.prototype.deepCopy.call(event):event);else{var changes=event.changes,newChanges=[];copy.push({changes:newChanges});for(var j=0;j<changes.length;++j){var change=changes[j],m=void 0;if(newChanges.push({from:change.from,to:change.to,text:change.text}),newGroup)for(var prop in change)(m=prop.match(/^spans_(\d+)$/))&&indexOf(newGroup,Number(m[1]))>-1&&(lst(newChanges)[prop]=change[prop],delete change[prop])}}}return copy}function extendRange(range,head,other,extend){if(extend){var anchor=range.anchor;if(other){var posBefore=cmp(head,anchor)<0;posBefore!=cmp(other,anchor)<0?(anchor=head,head=other):posBefore!=cmp(head,other)<0&&(head=other)}return new Range(anchor,head)}return new Range(other||head,head)}function extendSelection(doc,head,other,options,extend){null==extend&&(extend=doc.cm&&(doc.cm.display.shift||doc.extend)),setSelection(doc,new Selection([extendRange(doc.sel.primary(),head,other,extend)],0),options)}function extendSelections(doc,heads,options){for(var out=[],extend=doc.cm&&(doc.cm.display.shift||doc.extend),i=0;i<doc.sel.ranges.length;i++)out[i]=extendRange(doc.sel.ranges[i],heads[i],null,extend);setSelection(doc,normalizeSelection(doc.cm,out,doc.sel.primIndex),options)}function replaceOneSelection(doc,i,range,options){var ranges=doc.sel.ranges.slice(0);ranges[i]=range,setSelection(doc,normalizeSelection(doc.cm,ranges,doc.sel.primIndex),options)}function setSimpleSelection(doc,anchor,head,options){setSelection(doc,simpleSelection(anchor,head),options)}function setSelectionReplaceHistory(doc,sel,options){var done=doc.history.done,last=lst(done);last&&last.ranges?(done[done.length-1]=sel,setSelectionNoUndo(doc,sel,options)):setSelection(doc,sel,options)}function setSelection(doc,sel,options){setSelectionNoUndo(doc,sel,options),addSelectionToHistory(doc,doc.sel,doc.cm?doc.cm.curOp.id:NaN,options)}function setSelectionNoUndo(doc,sel,options){(hasHandler(doc,"beforeSelectionChange")||doc.cm&&hasHandler(doc.cm,"beforeSelectionChange"))&&(sel=function(doc,sel,options){var obj={ranges:sel.ranges,update:function(ranges){this.ranges=[];for(var i=0;i<ranges.length;i++)this.ranges[i]=new Range(clipPos(doc,ranges[i].anchor),clipPos(doc,ranges[i].head))},origin:options&&options.origin};return signal(doc,"beforeSelectionChange",doc,obj),doc.cm&&signal(doc.cm,"beforeSelectionChange",doc.cm,obj),obj.ranges!=sel.ranges?normalizeSelection(doc.cm,obj.ranges,obj.ranges.length-1):sel}(doc,sel,options)),setSelectionInner(doc,skipAtomicInSelection(doc,sel,options&&options.bias||(cmp(sel.primary().head,doc.sel.primary().head)<0?-1:1),!0)),options&&!1===options.scroll||!doc.cm||ensureCursorVisible(doc.cm)}function setSelectionInner(doc,sel){sel.equals(doc.sel)||(doc.sel=sel,doc.cm&&(doc.cm.curOp.updateInput=1,doc.cm.curOp.selectionChanged=!0,signalCursorActivity(doc.cm)),signalLater(doc,"cursorActivity",doc))}function reCheckSelection(doc){setSelectionInner(doc,skipAtomicInSelection(doc,doc.sel,null,!1))}function skipAtomicInSelection(doc,sel,bias,mayClear){for(var out,i=0;i<sel.ranges.length;i++){var range=sel.ranges[i],old=sel.ranges.length==doc.sel.ranges.length&&doc.sel.ranges[i],newAnchor=skipAtomic(doc,range.anchor,old&&old.anchor,bias,mayClear),newHead=skipAtomic(doc,range.head,old&&old.head,bias,mayClear);(out||newAnchor!=range.anchor||newHead!=range.head)&&(out||(out=sel.ranges.slice(0,i)),out[i]=new Range(newAnchor,newHead))}return out?normalizeSelection(doc.cm,out,sel.primIndex):sel}function skipAtomicInner(doc,pos,oldPos,dir,mayClear){var line=getLine(doc,pos.line);if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var sp=line.markedSpans[i],m=sp.marker,preventCursorLeft="selectLeft"in m?!m.selectLeft:m.inclusiveLeft,preventCursorRight="selectRight"in m?!m.selectRight:m.inclusiveRight;if((null==sp.from||(preventCursorLeft?sp.from<=pos.ch:sp.from<pos.ch))&&(null==sp.to||(preventCursorRight?sp.to>=pos.ch:sp.to>pos.ch))){if(mayClear&&(signal(m,"beforeCursorEnter"),m.explicitlyCleared)){if(line.markedSpans){--i;continue}break}if(!m.atomic)continue;if(oldPos){var near=m.find(dir<0?1:-1),diff=void 0;if((dir<0?preventCursorRight:preventCursorLeft)&&(near=movePos(doc,near,-dir,near&&near.line==pos.line?line:null)),near&&near.line==pos.line&&(diff=cmp(near,oldPos))&&(dir<0?diff<0:diff>0))return skipAtomicInner(doc,near,pos,dir,mayClear)}var far=m.find(dir<0?-1:1);return(dir<0?preventCursorLeft:preventCursorRight)&&(far=movePos(doc,far,dir,far.line==pos.line?line:null)),far?skipAtomicInner(doc,far,pos,dir,mayClear):null}}return pos}function skipAtomic(doc,pos,oldPos,bias,mayClear){var dir=bias||1,found=skipAtomicInner(doc,pos,oldPos,dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,dir,!0)||skipAtomicInner(doc,pos,oldPos,-dir,mayClear)||!mayClear&&skipAtomicInner(doc,pos,oldPos,-dir,!0);return found||(doc.cantEdit=!0,Pos(doc.first,0))}function movePos(doc,pos,dir,line){return dir<0&&0==pos.ch?pos.line>doc.first?clipPos(doc,Pos(pos.line-1)):null:dir>0&&pos.ch==(line||getLine(doc,pos.line)).text.length?pos.line<doc.first+doc.size-1?Pos(pos.line+1,0):null:new Pos(pos.line,pos.ch+dir)}function selectAll(cm){cm.setSelection(Pos(cm.firstLine(),0),Pos(cm.lastLine()),sel_dontScroll)}function filterChange(doc,change,update){var obj={canceled:!1,from:change.from,to:change.to,text:change.text,origin:change.origin,cancel:function(){return obj.canceled=!0}};return update&&(obj.update=function(from,to,text,origin){from&&(obj.from=clipPos(doc,from)),to&&(obj.to=clipPos(doc,to)),text&&(obj.text=text),void 0!==origin&&(obj.origin=origin)}),signal(doc,"beforeChange",doc,obj),doc.cm&&signal(doc.cm,"beforeChange",doc.cm,obj),obj.canceled?(doc.cm&&(doc.cm.curOp.updateInput=2),null):{from:obj.from,to:obj.to,text:obj.text,origin:obj.origin}}function makeChange(doc,change,ignoreReadOnly){if(doc.cm){if(!doc.cm.curOp)return operation(doc.cm,makeChange)(doc,change,ignoreReadOnly);if(doc.cm.state.suppressEdits)return}if(!(hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"))||(change=filterChange(doc,change,!0))){var split=sawReadOnlySpans&&!ignoreReadOnly&&function(doc,from,to){var markers=null;if(doc.iter(from.line,to.line+1,function(line){if(line.markedSpans)for(var i=0;i<line.markedSpans.length;++i){var mark=line.markedSpans[i].marker;!mark.readOnly||markers&&-1!=indexOf(markers,mark)||(markers||(markers=[])).push(mark)}}),!markers)return null;for(var parts=[{from:from,to:to}],i=0;i<markers.length;++i)for(var mk=markers[i],m=mk.find(0),j=0;j<parts.length;++j){var p=parts[j];if(!(cmp(p.to,m.from)<0||cmp(p.from,m.to)>0)){var newParts=[j,1],dfrom=cmp(p.from,m.from),dto=cmp(p.to,m.to);(dfrom<0||!mk.inclusiveLeft&&!dfrom)&&newParts.push({from:p.from,to:m.from}),(dto>0||!mk.inclusiveRight&&!dto)&&newParts.push({from:m.to,to:p.to}),parts.splice.apply(parts,newParts),j+=newParts.length-3}}return parts}(doc,change.from,change.to);if(split)for(var i=split.length-1;i>=0;--i)makeChangeInner(doc,{from:split[i].from,to:split[i].to,text:i?[""]:change.text,origin:change.origin});else makeChangeInner(doc,change)}}function makeChangeInner(doc,change){if(1!=change.text.length||""!=change.text[0]||0!=cmp(change.from,change.to)){var selAfter=computeSelAfterChange(doc,change);addChangeToHistory(doc,change,selAfter,doc.cm?doc.cm.curOp.id:NaN),makeChangeSingleDoc(doc,change,selAfter,stretchSpansOverChange(doc,change));var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,stretchSpansOverChange(doc,change))})}}function makeChangeFromHistory(doc,type,allowSelectionOnly){var suppress=doc.cm&&doc.cm.state.suppressEdits;if(!suppress||allowSelectionOnly){for(var event,hist=doc.history,selAfter=doc.sel,source="undo"==type?hist.done:hist.undone,dest="undo"==type?hist.undone:hist.done,i=0;i<source.length&&(event=source[i],allowSelectionOnly?!event.ranges||event.equals(doc.sel):event.ranges);i++);if(i!=source.length){for(hist.lastOrigin=hist.lastSelOrigin=null;;){if(!(event=source.pop()).ranges){if(suppress)return void source.push(event);break}if(pushSelectionToHistory(event,dest),allowSelectionOnly&&!event.equals(doc.sel))return void setSelection(doc,event,{clearRedo:!1});selAfter=event}var antiChanges=[];pushSelectionToHistory(selAfter,dest),dest.push({changes:antiChanges,generation:hist.generation}),hist.generation=event.generation||++hist.maxGeneration;for(var filter=hasHandler(doc,"beforeChange")||doc.cm&&hasHandler(doc.cm,"beforeChange"),loop=function(i){var change=event.changes[i];if(change.origin=type,filter&&!filterChange(doc,change,!1))return source.length=0,{};antiChanges.push(historyChangeFromChange(doc,change));var after=i?computeSelAfterChange(doc,change):lst(source);makeChangeSingleDoc(doc,change,after,mergeOldSpans(doc,change)),!i&&doc.cm&&doc.cm.scrollIntoView({from:change.from,to:changeEnd(change)});var rebased=[];linkedDocs(doc,function(doc,sharedHist){sharedHist||-1!=indexOf(rebased,doc.history)||(rebaseHist(doc.history,change),rebased.push(doc.history)),makeChangeSingleDoc(doc,change,null,mergeOldSpans(doc,change))})},i$1=event.changes.length-1;i$1>=0;--i$1){var returned=loop(i$1);if(returned)return returned.v}}}}function shiftDoc(doc,distance){if(0!=distance&&(doc.first+=distance,doc.sel=new Selection(map(doc.sel.ranges,function(range){return new Range(Pos(range.anchor.line+distance,range.anchor.ch),Pos(range.head.line+distance,range.head.ch))}),doc.sel.primIndex),doc.cm)){regChange(doc.cm,doc.first,doc.first-distance,distance);for(var d=doc.cm.display,l=d.viewFrom;l<d.viewTo;l++)regLineChange(doc.cm,l,"gutter")}}function makeChangeSingleDoc(doc,change,selAfter,spans){if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,makeChangeSingleDoc)(doc,change,selAfter,spans);if(change.to.line<doc.first)shiftDoc(doc,change.text.length-1-(change.to.line-change.from.line));else if(!(change.from.line>doc.lastLine())){if(change.from.line<doc.first){var shift=change.text.length-1-(doc.first-change.from.line);shiftDoc(doc,shift),change={from:Pos(doc.first,0),to:Pos(change.to.line+shift,change.to.ch),text:[lst(change.text)],origin:change.origin}}var last=doc.lastLine();change.to.line>last&&(change={from:change.from,to:Pos(last,getLine(doc,last).text.length),text:[change.text[0]],origin:change.origin}),change.removed=getBetween(doc,change.from,change.to),selAfter||(selAfter=computeSelAfterChange(doc,change)),doc.cm?function(cm,change,spans){var doc=cm.doc,display=cm.display,from=change.from,to=change.to,recomputeMaxLength=!1,checkWidthStart=from.line;cm.options.lineWrapping||(checkWidthStart=lineNo(visualLine(getLine(doc,from.line))),doc.iter(checkWidthStart,to.line+1,function(line){if(line==display.maxLine)return recomputeMaxLength=!0,!0}));doc.sel.contains(change.from,change.to)>-1&&signalCursorActivity(cm);updateDoc(doc,change,spans,estimateHeight(cm)),cm.options.lineWrapping||(doc.iter(checkWidthStart,from.line+change.text.length,function(line){var len=lineLength(line);len>display.maxLineLength&&(display.maxLine=line,display.maxLineLength=len,display.maxLineChanged=!0,recomputeMaxLength=!1)}),recomputeMaxLength&&(cm.curOp.updateMaxLine=!0));(function(doc,n){if(doc.modeFrontier=Math.min(doc.modeFrontier,n),!(doc.highlightFrontier<n-10)){for(var start=doc.first,line=n-1;line>start;line--){var saved=getLine(doc,line).stateAfter;if(saved&&(!(saved instanceof SavedContext)||line+saved.lookAhead<n)){start=line+1;break}}doc.highlightFrontier=Math.min(doc.highlightFrontier,start)}})(doc,from.line),startWorker(cm,400);var lendiff=change.text.length-(to.line-from.line)-1;change.full?regChange(cm):from.line!=to.line||1!=change.text.length||isWholeLineUpdate(cm.doc,change)?regChange(cm,from.line,to.line+1,lendiff):regLineChange(cm,from.line,"text");var changesHandler=hasHandler(cm,"changes"),changeHandler=hasHandler(cm,"change");if(changeHandler||changesHandler){var obj={from:from,to:to,text:change.text,removed:change.removed,origin:change.origin};changeHandler&&signalLater(cm,"change",cm,obj),changesHandler&&(cm.curOp.changeObjs||(cm.curOp.changeObjs=[])).push(obj)}cm.display.selForContextMenu=null}(doc.cm,change,spans):updateDoc(doc,change,spans),setSelectionNoUndo(doc,selAfter,sel_dontScroll),doc.cantEdit&&skipAtomic(doc,Pos(doc.firstLine(),0))&&(doc.cantEdit=!1)}}function replaceRange(doc,code,from,to,origin){var assign;to||(to=from),cmp(to,from)<0&&(from=(assign=[to,from])[0],to=assign[1]),"string"==typeof code&&(code=doc.splitLines(code)),makeChange(doc,{from:from,to:to,text:code,origin:origin})}function rebaseHistSelSingle(pos,from,to,diff){to<pos.line?pos.line+=diff:from<pos.line&&(pos.line=from,pos.ch=0)}function rebaseHistArray(array,from,to,diff){for(var i=0;i<array.length;++i){var sub=array[i],ok=!0;if(sub.ranges){sub.copied||((sub=array[i]=sub.deepCopy()).copied=!0);for(var j=0;j<sub.ranges.length;j++)rebaseHistSelSingle(sub.ranges[j].anchor,from,to,diff),rebaseHistSelSingle(sub.ranges[j].head,from,to,diff)}else{for(var j$1=0;j$1<sub.changes.length;++j$1){var cur=sub.changes[j$1];if(to<cur.from.line)cur.from=Pos(cur.from.line+diff,cur.from.ch),cur.to=Pos(cur.to.line+diff,cur.to.ch);else if(from<=cur.to.line){ok=!1;break}}ok||(array.splice(0,i+1),i=0)}}}function rebaseHist(hist,change){var from=change.from.line,to=change.to.line,diff=change.text.length-(to-from)-1;rebaseHistArray(hist.done,from,to,diff),rebaseHistArray(hist.undone,from,to,diff)}function changeLine(doc,handle,changeType,op){var no=handle,line=handle;return"number"==typeof handle?line=getLine(doc,clipLine(doc,handle)):no=lineNo(handle),null==no?null:(op(line,no)&&doc.cm&&regLineChange(doc.cm,no,changeType),line)}function LeafChunk(lines){this.lines=lines,this.parent=null;for(var height=0,i=0;i<lines.length;++i)lines[i].parent=this,height+=lines[i].height;this.height=height}function BranchChunk(children){this.children=children;for(var size=0,height=0,i=0;i<children.length;++i){var ch=children[i];size+=ch.chunkSize(),height+=ch.height,ch.parent=this}this.size=size,this.height=height,this.parent=null}Range.prototype.from=function(){return minPos(this.anchor,this.head)},Range.prototype.to=function(){return maxPos(this.anchor,this.head)},Range.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},LeafChunk.prototype={chunkSize:function(){return this.lines.length},removeInner:function(at,n){for(var i=at,e=at+n;i<e;++i){var line=this.lines[i];this.height-=line.height,cleanUpLine(line),signalLater(line,"delete")}this.lines.splice(at,n)},collapse:function(lines){lines.push.apply(lines,this.lines)},insertInner:function(at,lines,height){this.height+=height,this.lines=this.lines.slice(0,at).concat(lines).concat(this.lines.slice(at));for(var i=0;i<lines.length;++i)lines[i].parent=this},iterN:function(at,n,op){for(var e=at+n;at<e;++at)if(op(this.lines[at]))return!0}},BranchChunk.prototype={chunkSize:function(){return this.size},removeInner:function(at,n){this.size-=n;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var rm=Math.min(n,sz-at),oldHeight=child.height;if(child.removeInner(at,rm),this.height-=oldHeight-child.height,sz==rm&&(this.children.splice(i--,1),child.parent=null),0==(n-=rm))break;at=0}else at-=sz}if(this.size-n<25&&(this.children.length>1||!(this.children[0]instanceof LeafChunk))){var lines=[];this.collapse(lines),this.children=[new LeafChunk(lines)],this.children[0].parent=this}},collapse:function(lines){for(var i=0;i<this.children.length;++i)this.children[i].collapse(lines)},insertInner:function(at,lines,height){this.size+=lines.length,this.height+=height;for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<=sz){if(child.insertInner(at,lines,height),child.lines&&child.lines.length>50){for(var remaining=child.lines.length%25+25,pos=remaining;pos<child.lines.length;){var leaf=new LeafChunk(child.lines.slice(pos,pos+=25));child.height-=leaf.height,this.children.splice(++i,0,leaf),leaf.parent=this}child.lines=child.lines.slice(0,remaining),this.maybeSpill()}break}at-=sz}},maybeSpill:function(){if(!(this.children.length<=10)){var me=this;do{var sibling=new BranchChunk(me.children.splice(me.children.length-5,5));if(me.parent){me.size-=sibling.size,me.height-=sibling.height;var myIndex=indexOf(me.parent.children,me);me.parent.children.splice(myIndex+1,0,sibling)}else{var copy=new BranchChunk(me.children);copy.parent=me,me.children=[copy,sibling],me=copy}sibling.parent=me.parent}while(me.children.length>10);me.parent.maybeSpill()}},iterN:function(at,n,op){for(var i=0;i<this.children.length;++i){var child=this.children[i],sz=child.chunkSize();if(at<sz){var used=Math.min(n,sz-at);if(child.iterN(at,used,op))return!0;if(0==(n-=used))break;at=0}else at-=sz}}};var LineWidget=function(doc,node,options){if(options)for(var opt in options)options.hasOwnProperty(opt)&&(this[opt]=options[opt]);this.doc=doc,this.node=node};function adjustScrollWhenAboveVisible(cm,line,diff){heightAtLine(line)<(cm.curOp&&cm.curOp.scrollTop||cm.doc.scrollTop)&&addToScrollTop(cm,diff)}LineWidget.prototype.clear=function(){var cm=this.doc.cm,ws=this.line.widgets,line=this.line,no=lineNo(line);if(null!=no&&ws){for(var i=0;i<ws.length;++i)ws[i]==this&&ws.splice(i--,1);ws.length||(line.widgets=null);var height=widgetHeight(this);updateLineHeight(line,Math.max(0,line.height-height)),cm&&(runInOp(cm,function(){adjustScrollWhenAboveVisible(cm,line,-height),regLineChange(cm,no,"widget")}),signalLater(cm,"lineWidgetCleared",cm,this,no))}},LineWidget.prototype.changed=function(){var this$1=this,oldH=this.height,cm=this.doc.cm,line=this.line;this.height=null;var diff=widgetHeight(this)-oldH;diff&&(lineIsHidden(this.doc,line)||updateLineHeight(line,line.height+diff),cm&&runInOp(cm,function(){cm.curOp.forceUpdate=!0,adjustScrollWhenAboveVisible(cm,line,diff),signalLater(cm,"lineWidgetChanged",cm,this$1,lineNo(line))}))},eventMixin(LineWidget);var nextMarkerId=0,TextMarker=function(doc,type){this.lines=[],this.type=type,this.doc=doc,this.id=++nextMarkerId};function markText(doc,from,to,options,type){if(options&&options.shared)return function(doc,from,to,options,type){(options=copyObj(options)).shared=!1;var markers=[markText(doc,from,to,options,type)],primary=markers[0],widget=options.widgetNode;return linkedDocs(doc,function(doc){widget&&(options.widgetNode=widget.cloneNode(!0)),markers.push(markText(doc,clipPos(doc,from),clipPos(doc,to),options,type));for(var i=0;i<doc.linked.length;++i)if(doc.linked[i].isParent)return;primary=lst(markers)}),new SharedTextMarker(markers,primary)}(doc,from,to,options,type);if(doc.cm&&!doc.cm.curOp)return operation(doc.cm,markText)(doc,from,to,options,type);var marker=new TextMarker(doc,type),diff=cmp(from,to);if(options&&copyObj(options,marker,!1),diff>0||0==diff&&!1!==marker.clearWhenEmpty)return marker;if(marker.replacedWith&&(marker.collapsed=!0,marker.widgetNode=eltP("span",[marker.replacedWith],"CodeMirror-widget"),options.handleMouseEvents||marker.widgetNode.setAttribute("cm-ignore-events","true"),options.insertLeft&&(marker.widgetNode.insertLeft=!0)),marker.collapsed){if(conflictingCollapsedRange(doc,from.line,from,to,marker)||from.line!=to.line&&conflictingCollapsedRange(doc,to.line,from,to,marker))throw new Error("Inserting collapsed marker partially overlapping an existing one");sawCollapsedSpans=!0}marker.addToHistory&&addChangeToHistory(doc,{from:from,to:to,origin:"markText"},doc.sel,NaN);var updateMaxLine,curLine=from.line,cm=doc.cm;if(doc.iter(curLine,to.line+1,function(line){cm&&marker.collapsed&&!cm.options.lineWrapping&&visualLine(line)==cm.display.maxLine&&(updateMaxLine=!0),marker.collapsed&&curLine!=from.line&&updateLineHeight(line,0),function(line,span){line.markedSpans=line.markedSpans?line.markedSpans.concat([span]):[span],span.marker.attachLine(line)}(line,new MarkedSpan(marker,curLine==from.line?from.ch:null,curLine==to.line?to.ch:null)),++curLine}),marker.collapsed&&doc.iter(from.line,to.line+1,function(line){lineIsHidden(doc,line)&&updateLineHeight(line,0)}),marker.clearOnEnter&&on(marker,"beforeCursorEnter",function(){return marker.clear()}),marker.readOnly&&(sawReadOnlySpans=!0,(doc.history.done.length||doc.history.undone.length)&&doc.clearHistory()),marker.collapsed&&(marker.id=++nextMarkerId,marker.atomic=!0),cm){if(updateMaxLine&&(cm.curOp.updateMaxLine=!0),marker.collapsed)regChange(cm,from.line,to.line+1);else if(marker.className||marker.startStyle||marker.endStyle||marker.css||marker.attributes||marker.title)for(var i=from.line;i<=to.line;i++)regLineChange(cm,i,"text");marker.atomic&&reCheckSelection(cm.doc),signalLater(cm,"markerAdded",cm,marker)}return marker}TextMarker.prototype.clear=function(){if(!this.explicitlyCleared){var cm=this.doc.cm,withOp=cm&&!cm.curOp;if(withOp&&startOperation(cm),hasHandler(this,"clear")){var found=this.find();found&&signalLater(this,"clear",found.from,found.to)}for(var min=null,max=null,i=0;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);cm&&!this.collapsed?regLineChange(cm,lineNo(line),"text"):cm&&(null!=span.to&&(max=lineNo(line)),null!=span.from&&(min=lineNo(line))),line.markedSpans=removeMarkedSpan(line.markedSpans,span),null==span.from&&this.collapsed&&!lineIsHidden(this.doc,line)&&cm&&updateLineHeight(line,textHeight(cm.display))}if(cm&&this.collapsed&&!cm.options.lineWrapping)for(var i$1=0;i$1<this.lines.length;++i$1){var visual=visualLine(this.lines[i$1]),len=lineLength(visual);len>cm.display.maxLineLength&&(cm.display.maxLine=visual,cm.display.maxLineLength=len,cm.display.maxLineChanged=!0)}null!=min&&cm&&this.collapsed&&regChange(cm,min,max+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,cm&&reCheckSelection(cm.doc)),cm&&signalLater(cm,"markerCleared",cm,this,min,max),withOp&&endOperation(cm),this.parent&&this.parent.clear()}},TextMarker.prototype.find=function(side,lineObj){var from,to;null==side&&"bookmark"==this.type&&(side=1);for(var i=0;i<this.lines.length;++i){var line=this.lines[i],span=getMarkedSpanFor(line.markedSpans,this);if(null!=span.from&&(from=Pos(lineObj?line:lineNo(line),span.from),-1==side))return from;if(null!=span.to&&(to=Pos(lineObj?line:lineNo(line),span.to),1==side))return to}return from&&{from:from,to:to}},TextMarker.prototype.changed=function(){var this$1=this,pos=this.find(-1,!0),widget=this,cm=this.doc.cm;pos&&cm&&runInOp(cm,function(){var line=pos.line,lineN=lineNo(pos.line),view=findViewForLine(cm,lineN);if(view&&(clearLineMeasurementCacheFor(view),cm.curOp.selectionChanged=cm.curOp.forceUpdate=!0),cm.curOp.updateMaxLine=!0,!lineIsHidden(widget.doc,line)&&null!=widget.height){var oldHeight=widget.height;widget.height=null;var dHeight=widgetHeight(widget)-oldHeight;dHeight&&updateLineHeight(line,line.height+dHeight)}signalLater(cm,"markerChanged",cm,this$1)})},TextMarker.prototype.attachLine=function(line){if(!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;op.maybeHiddenMarkers&&-1!=indexOf(op.maybeHiddenMarkers,this)||(op.maybeUnhiddenMarkers||(op.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(line)},TextMarker.prototype.detachLine=function(line){if(this.lines.splice(indexOf(this.lines,line),1),!this.lines.length&&this.doc.cm){var op=this.doc.cm.curOp;(op.maybeHiddenMarkers||(op.maybeHiddenMarkers=[])).push(this)}},eventMixin(TextMarker);var SharedTextMarker=function(markers,primary){this.markers=markers,this.primary=primary;for(var i=0;i<markers.length;++i)markers[i].parent=this};function findSharedMarkers(doc){return doc.findMarks(Pos(doc.first,0),doc.clipPos(Pos(doc.lastLine())),function(m){return m.parent})}function detachSharedMarkers(markers){for(var loop=function(i){var marker=markers[i],linked=[marker.primary.doc];linkedDocs(marker.primary.doc,function(d){return linked.push(d)});for(var j=0;j<marker.markers.length;j++){var subMarker=marker.markers[j];-1==indexOf(linked,subMarker.doc)&&(subMarker.parent=null,marker.markers.splice(j--,1))}},i=0;i<markers.length;i++)loop(i)}SharedTextMarker.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var i=0;i<this.markers.length;++i)this.markers[i].clear();signalLater(this,"clear")}},SharedTextMarker.prototype.find=function(side,lineObj){return this.primary.find(side,lineObj)},eventMixin(SharedTextMarker);var nextDocId=0,Doc=function(text,mode,firstLine,lineSep,direction){if(!(this instanceof Doc))return new Doc(text,mode,firstLine,lineSep,direction);null==firstLine&&(firstLine=0),BranchChunk.call(this,[new LeafChunk([new Line("",null)])]),this.first=firstLine,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=firstLine;var start=Pos(firstLine,0);this.sel=simpleSelection(start),this.history=new History(null),this.id=++nextDocId,this.modeOption=mode,this.lineSep=lineSep,this.direction="rtl"==direction?"rtl":"ltr",this.extend=!1,"string"==typeof text&&(text=this.splitLines(text)),updateDoc(this,{from:start,to:start,text:text}),setSelection(this,simpleSelection(start),sel_dontScroll)};Doc.prototype=createObj(BranchChunk.prototype,{constructor:Doc,iter:function(from,to,op){op?this.iterN(from-this.first,to-from,op):this.iterN(this.first,this.first+this.size,from)},insert:function(at,lines){for(var height=0,i=0;i<lines.length;++i)height+=lines[i].height;this.insertInner(at-this.first,lines,height)},remove:function(at,n){this.removeInner(at-this.first,n)},getValue:function(lineSep){var lines=getLines(this,this.first,this.first+this.size);return!1===lineSep?lines:lines.join(lineSep||this.lineSeparator())},setValue:docMethodOp(function(code){var top=Pos(this.first,0),last=this.first+this.size-1;makeChange(this,{from:top,to:Pos(last,getLine(this,last).text.length),text:this.splitLines(code),origin:"setValue",full:!0},!0),this.cm&&scrollToCoords(this.cm,0,0),setSelection(this,simpleSelection(top),sel_dontScroll)}),replaceRange:function(code,from,to,origin){replaceRange(this,code,from=clipPos(this,from),to=to?clipPos(this,to):from,origin)},getRange:function(from,to,lineSep){var lines=getBetween(this,clipPos(this,from),clipPos(this,to));return!1===lineSep?lines:lines.join(lineSep||this.lineSeparator())},getLine:function(line){var l=this.getLineHandle(line);return l&&l.text},getLineHandle:function(line){if(isLine(this,line))return getLine(this,line)},getLineNumber:function(line){return lineNo(line)},getLineHandleVisualStart:function(line){return"number"==typeof line&&(line=getLine(this,line)),visualLine(line)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(pos){return clipPos(this,pos)},getCursor:function(start){var range=this.sel.primary();return null==start||"head"==start?range.head:"anchor"==start?range.anchor:"end"==start||"to"==start||!1===start?range.to():range.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:docMethodOp(function(line,ch,options){setSimpleSelection(this,clipPos(this,"number"==typeof line?Pos(line,ch||0):line),null,options)}),setSelection:docMethodOp(function(anchor,head,options){setSimpleSelection(this,clipPos(this,anchor),clipPos(this,head||anchor),options)}),extendSelection:docMethodOp(function(head,other,options){extendSelection(this,clipPos(this,head),other&&clipPos(this,other),options)}),extendSelections:docMethodOp(function(heads,options){extendSelections(this,clipPosArray(this,heads),options)}),extendSelectionsBy:docMethodOp(function(f,options){extendSelections(this,clipPosArray(this,map(this.sel.ranges,f)),options)}),setSelections:docMethodOp(function(ranges,primary,options){if(ranges.length){for(var out=[],i=0;i<ranges.length;i++)out[i]=new Range(clipPos(this,ranges[i].anchor),clipPos(this,ranges[i].head));null==primary&&(primary=Math.min(ranges.length-1,this.sel.primIndex)),setSelection(this,normalizeSelection(this.cm,out,primary),options)}}),addSelection:docMethodOp(function(anchor,head,options){var ranges=this.sel.ranges.slice(0);ranges.push(new Range(clipPos(this,anchor),clipPos(this,head||anchor))),setSelection(this,normalizeSelection(this.cm,ranges,ranges.length-1),options)}),getSelection:function(lineSep){for(var lines,ranges=this.sel.ranges,i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());lines=lines?lines.concat(sel):sel}return!1===lineSep?lines:lines.join(lineSep||this.lineSeparator())},getSelections:function(lineSep){for(var parts=[],ranges=this.sel.ranges,i=0;i<ranges.length;i++){var sel=getBetween(this,ranges[i].from(),ranges[i].to());!1!==lineSep&&(sel=sel.join(lineSep||this.lineSeparator())),parts[i]=sel}return parts},replaceSelection:function(code,collapse,origin){for(var dup=[],i=0;i<this.sel.ranges.length;i++)dup[i]=code;this.replaceSelections(dup,collapse,origin||"+input")},replaceSelections:docMethodOp(function(code,collapse,origin){for(var changes=[],sel=this.sel,i=0;i<sel.ranges.length;i++){var range=sel.ranges[i];changes[i]={from:range.from(),to:range.to(),text:this.splitLines(code[i]),origin:origin}}for(var newSel=collapse&&"end"!=collapse&&function(doc,changes,hint){for(var out=[],oldPrev=Pos(doc.first,0),newPrev=oldPrev,i=0;i<changes.length;i++){var change=changes[i],from=offsetPos(change.from,oldPrev,newPrev),to=offsetPos(changeEnd(change),oldPrev,newPrev);if(oldPrev=change.to,newPrev=to,"around"==hint){var range=doc.sel.ranges[i],inv=cmp(range.head,range.anchor)<0;out[i]=new Range(inv?to:from,inv?from:to)}else out[i]=new Range(from,from)}return new Selection(out,doc.sel.primIndex)}(this,changes,collapse),i$1=changes.length-1;i$1>=0;i$1--)makeChange(this,changes[i$1]);newSel?setSelectionReplaceHistory(this,newSel):this.cm&&ensureCursorVisible(this.cm)}),undo:docMethodOp(function(){makeChangeFromHistory(this,"undo")}),redo:docMethodOp(function(){makeChangeFromHistory(this,"redo")}),undoSelection:docMethodOp(function(){makeChangeFromHistory(this,"undo",!0)}),redoSelection:docMethodOp(function(){makeChangeFromHistory(this,"redo",!0)}),setExtending:function(val){this.extend=val},getExtending:function(){return this.extend},historySize:function(){for(var hist=this.history,done=0,undone=0,i=0;i<hist.done.length;i++)hist.done[i].ranges||++done;for(var i$1=0;i$1<hist.undone.length;i$1++)hist.undone[i$1].ranges||++undone;return{undo:done,redo:undone}},clearHistory:function(){var this$1=this;this.history=new History(this.history.maxGeneration),linkedDocs(this,function(doc){return doc.history=this$1.history},!0)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(forceSplit){return forceSplit&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(gen){return this.history.generation==(gen||this.cleanGeneration)},getHistory:function(){return{done:copyHistoryArray(this.history.done),undone:copyHistoryArray(this.history.undone)}},setHistory:function(histData){var hist=this.history=new History(this.history.maxGeneration);hist.done=copyHistoryArray(histData.done.slice(0),null,!0),hist.undone=copyHistoryArray(histData.undone.slice(0),null,!0)},setGutterMarker:docMethodOp(function(line,gutterID,value){return changeLine(this,line,"gutter",function(line){var markers=line.gutterMarkers||(line.gutterMarkers={});return markers[gutterID]=value,!value&&isEmpty(markers)&&(line.gutterMarkers=null),!0})}),clearGutter:docMethodOp(function(gutterID){var this$1=this;this.iter(function(line){line.gutterMarkers&&line.gutterMarkers[gutterID]&&changeLine(this$1,line,"gutter",function(){return line.gutterMarkers[gutterID]=null,isEmpty(line.gutterMarkers)&&(line.gutterMarkers=null),!0})})}),lineInfo:function(line){var n;if("number"==typeof line){if(!isLine(this,line))return null;if(n=line,!(line=getLine(this,line)))return null}else if(null==(n=lineNo(line)))return null;return{line:n,handle:line,text:line.text,gutterMarkers:line.gutterMarkers,textClass:line.textClass,bgClass:line.bgClass,wrapClass:line.wrapClass,widgets:line.widgets}},addLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,"gutter"==where?"gutter":"class",function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"gutter"==where?"gutterClass":"wrapClass";if(line[prop]){if(classTest(cls).test(line[prop]))return!1;line[prop]+=" "+cls}else line[prop]=cls;return!0})}),removeLineClass:docMethodOp(function(handle,where,cls){return changeLine(this,handle,"gutter"==where?"gutter":"class",function(line){var prop="text"==where?"textClass":"background"==where?"bgClass":"gutter"==where?"gutterClass":"wrapClass",cur=line[prop];if(!cur)return!1;if(null==cls)line[prop]=null;else{var found=cur.match(classTest(cls));if(!found)return!1;var end=found.index+found[0].length;line[prop]=cur.slice(0,found.index)+(found.index&&end!=cur.length?" ":"")+cur.slice(end)||null}return!0})}),addLineWidget:docMethodOp(function(handle,node,options){return function(doc,handle,node,options){var widget=new LineWidget(doc,node,options),cm=doc.cm;return cm&&widget.noHScroll&&(cm.display.alignWidgets=!0),changeLine(doc,handle,"widget",function(line){var widgets=line.widgets||(line.widgets=[]);if(null==widget.insertAt?widgets.push(widget):widgets.splice(Math.min(widgets.length-1,Math.max(0,widget.insertAt)),0,widget),widget.line=line,cm&&!lineIsHidden(doc,line)){var aboveVisible=heightAtLine(line)<doc.scrollTop;updateLineHeight(line,line.height+widgetHeight(widget)),aboveVisible&&addToScrollTop(cm,widget.height),cm.curOp.forceUpdate=!0}return!0}),cm&&signalLater(cm,"lineWidgetAdded",cm,widget,"number"==typeof handle?handle:lineNo(handle)),widget}(this,handle,node,options)}),removeLineWidget:function(widget){widget.clear()},markText:function(from,to,options){return markText(this,clipPos(this,from),clipPos(this,to),options,options&&options.type||"range")},setBookmark:function(pos,options){var realOpts={replacedWith:options&&(null==options.nodeType?options.widget:options),insertLeft:options&&options.insertLeft,clearWhenEmpty:!1,shared:options&&options.shared,handleMouseEvents:options&&options.handleMouseEvents};return markText(this,pos=clipPos(this,pos),pos,realOpts,"bookmark")},findMarksAt:function(pos){var markers=[],spans=getLine(this,(pos=clipPos(this,pos)).line).markedSpans;if(spans)for(var i=0;i<spans.length;++i){var span=spans[i];(null==span.from||span.from<=pos.ch)&&(null==span.to||span.to>=pos.ch)&&markers.push(span.marker.parent||span.marker)}return markers},findMarks:function(from,to,filter){from=clipPos(this,from),to=clipPos(this,to);var found=[],lineNo=from.line;return this.iter(from.line,to.line+1,function(line){var spans=line.markedSpans;if(spans)for(var i=0;i<spans.length;i++){var span=spans[i];null!=span.to&&lineNo==from.line&&from.ch>=span.to||null==span.from&&lineNo!=from.line||null!=span.from&&lineNo==to.line&&span.from>=to.ch||filter&&!filter(span.marker)||found.push(span.marker.parent||span.marker)}++lineNo}),found},getAllMarks:function(){var markers=[];return this.iter(function(line){var sps=line.markedSpans;if(sps)for(var i=0;i<sps.length;++i)null!=sps[i].from&&markers.push(sps[i].marker)}),markers},posFromIndex:function(off){var ch,lineNo=this.first,sepSize=this.lineSeparator().length;return this.iter(function(line){var sz=line.text.length+sepSize;if(sz>off)return ch=off,!0;off-=sz,++lineNo}),clipPos(this,Pos(lineNo,ch))},indexFromPos:function(coords){var index=(coords=clipPos(this,coords)).ch;if(coords.line<this.first||coords.ch<0)return 0;var sepSize=this.lineSeparator().length;return this.iter(this.first,coords.line,function(line){index+=line.text.length+sepSize}),index},copy:function(copyHistory){var doc=new Doc(getLines(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return doc.scrollTop=this.scrollTop,doc.scrollLeft=this.scrollLeft,doc.sel=this.sel,doc.extend=!1,copyHistory&&(doc.history.undoDepth=this.history.undoDepth,doc.setHistory(this.getHistory())),doc},linkedDoc:function(options){options||(options={});var from=this.first,to=this.first+this.size;null!=options.from&&options.from>from&&(from=options.from),null!=options.to&&options.to<to&&(to=options.to);var copy=new Doc(getLines(this,from,to),options.mode||this.modeOption,from,this.lineSep,this.direction);return options.sharedHist&&(copy.history=this.history),(this.linked||(this.linked=[])).push({doc:copy,sharedHist:options.sharedHist}),copy.linked=[{doc:this,isParent:!0,sharedHist:options.sharedHist}],function(doc,markers){for(var i=0;i<markers.length;i++){var marker=markers[i],pos=marker.find(),mFrom=doc.clipPos(pos.from),mTo=doc.clipPos(pos.to);if(cmp(mFrom,mTo)){var subMark=markText(doc,mFrom,mTo,marker.primary,marker.primary.type);marker.markers.push(subMark),subMark.parent=marker}}}(copy,findSharedMarkers(this)),copy},unlinkDoc:function(other){if(other instanceof CodeMirror&&(other=other.doc),this.linked)for(var i=0;i<this.linked.length;++i){if(this.linked[i].doc==other){this.linked.splice(i,1),other.unlinkDoc(this),detachSharedMarkers(findSharedMarkers(this));break}}if(other.history==this.history){var splitIds=[other.id];linkedDocs(other,function(doc){return splitIds.push(doc.id)},!0),other.history=new History(null),other.history.done=copyHistoryArray(this.history.done,splitIds),other.history.undone=copyHistoryArray(this.history.undone,splitIds)}},iterLinkedDocs:function(f){linkedDocs(this,f)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(str){return this.lineSep?str.split(this.lineSep):splitLinesAuto(str)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:docMethodOp(function(dir){var cm;("rtl"!=dir&&(dir="ltr"),dir!=this.direction)&&(this.direction=dir,this.iter(function(line){return line.order=null}),this.cm&&runInOp(cm=this.cm,function(){setDirectionClass(cm),regChange(cm)}))})}),Doc.prototype.eachLine=Doc.prototype.iter;var lastDrop=0;function onDrop(e){var cm=this;if(clearDragCursor(cm),!signalDOMEvent(cm,e)&&!eventInWidget(cm.display,e)){e_preventDefault(e),ie&&(lastDrop=+new Date);var pos=posFromMouse(cm,e,!0),files=e.dataTransfer.files;if(pos&&!cm.isReadOnly())if(files&&files.length&&window.FileReader&&window.File)for(var n=files.length,text=Array(n),read=0,markAsReadAndPasteIfAllFilesAreRead=function(){++read==n&&operation(cm,function(){var change={from:pos=clipPos(cm.doc,pos),to:pos,text:cm.doc.splitLines(text.filter(function(t){return null!=t}).join(cm.doc.lineSeparator())),origin:"paste"};makeChange(cm.doc,change),setSelectionReplaceHistory(cm.doc,simpleSelection(clipPos(cm.doc,pos),clipPos(cm.doc,changeEnd(change))))})()},readTextFromFile=function(file,i){if(cm.options.allowDropFileTypes&&-1==indexOf(cm.options.allowDropFileTypes,file.type))markAsReadAndPasteIfAllFilesAreRead();else{var reader=new FileReader;reader.onerror=function(){return markAsReadAndPasteIfAllFilesAreRead()},reader.onload=function(){var content=reader.result;/[\x00-\x08\x0e-\x1f]{2}/.test(content)?markAsReadAndPasteIfAllFilesAreRead():(text[i]=content,markAsReadAndPasteIfAllFilesAreRead())},reader.readAsText(file)}},i=0;i<files.length;i++)readTextFromFile(files[i],i);else{if(cm.state.draggingText&&cm.doc.sel.contains(pos)>-1)return cm.state.draggingText(e),void setTimeout(function(){return cm.display.input.focus()},20);try{var text$1=e.dataTransfer.getData("Text");if(text$1){var selected;if(cm.state.draggingText&&!cm.state.draggingText.copy&&(selected=cm.listSelections()),setSelectionNoUndo(cm.doc,simpleSelection(pos,pos)),selected)for(var i$1=0;i$1<selected.length;++i$1)replaceRange(cm.doc,"",selected[i$1].anchor,selected[i$1].head,"drag");cm.replaceSelection(text$1,"around","paste"),cm.display.input.focus()}}catch(e$1){}}}}function clearDragCursor(cm){cm.display.dragCursor&&(cm.display.lineSpace.removeChild(cm.display.dragCursor),cm.display.dragCursor=null)}function forEachCodeMirror(f){if(document.getElementsByClassName){for(var byClass=document.getElementsByClassName("CodeMirror"),editors=[],i=0;i<byClass.length;i++){var cm=byClass[i].CodeMirror;cm&&editors.push(cm)}editors.length&&editors[0].operation(function(){for(var i=0;i<editors.length;i++)f(editors[i])})}}var globalsRegistered=!1;function ensureGlobalHandlers(){var resizeTimer;globalsRegistered||(on(window,"resize",function(){null==resizeTimer&&(resizeTimer=setTimeout(function(){resizeTimer=null,forEachCodeMirror(onResize)},100))}),on(window,"blur",function(){return forEachCodeMirror(onBlur)}),globalsRegistered=!0)}function onResize(cm){var d=cm.display;d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null,d.scrollbarsClipped=!1,cm.setSize()}for(var keyNames={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",224:"Mod",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},i=0;i<10;i++)keyNames[i+48]=keyNames[i+96]=String(i);for(var i$1=65;i$1<=90;i$1++)keyNames[i$1]=String.fromCharCode(i$1);for(var i$2=1;i$2<=12;i$2++)keyNames[i$2+111]=keyNames[i$2+63235]="F"+i$2;var keyMap={};function normalizeKeyName(name){var alt,ctrl,shift,cmd,parts=name.split(/-(?!$)/);name=parts[parts.length-1];for(var i=0;i<parts.length-1;i++){var mod=parts[i];if(/^(cmd|meta|m)$/i.test(mod))cmd=!0;else if(/^a(lt)?$/i.test(mod))alt=!0;else if(/^(c|ctrl|control)$/i.test(mod))ctrl=!0;else{if(!/^s(hift)?$/i.test(mod))throw new Error("Unrecognized modifier name: "+mod);shift=!0}}return alt&&(name="Alt-"+name),ctrl&&(name="Ctrl-"+name),cmd&&(name="Cmd-"+name),shift&&(name="Shift-"+name),name}function normalizeKeyMap(keymap){var copy={};for(var keyname in keymap)if(keymap.hasOwnProperty(keyname)){var value=keymap[keyname];if(/^(name|fallthrough|(de|at)tach)$/.test(keyname))continue;if("..."==value){delete keymap[keyname];continue}for(var keys=map(keyname.split(" "),normalizeKeyName),i=0;i<keys.length;i++){var val=void 0,name=void 0;i==keys.length-1?(name=keys.join(" "),val=value):(name=keys.slice(0,i+1).join(" "),val="...");var prev=copy[name];if(prev){if(prev!=val)throw new Error("Inconsistent bindings for "+name)}else copy[name]=val}delete keymap[keyname]}for(var prop in copy)keymap[prop]=copy[prop];return keymap}function lookupKey(key,map,handle,context){var found=(map=getKeyMap(map)).call?map.call(key,context):map[key];if(!1===found)return"nothing";if("..."===found)return"multi";if(null!=found&&handle(found))return"handled";if(map.fallthrough){if("[object Array]"!=Object.prototype.toString.call(map.fallthrough))return lookupKey(key,map.fallthrough,handle,context);for(var i=0;i<map.fallthrough.length;i++){var result=lookupKey(key,map.fallthrough[i],handle,context);if(result)return result}}}function isModifierKey(value){var name="string"==typeof value?value:keyNames[value.keyCode];return"Ctrl"==name||"Alt"==name||"Shift"==name||"Mod"==name}function addModifierNames(name,event,noShift){var base=name;return event.altKey&&"Alt"!=base&&(name="Alt-"+name),(flipCtrlCmd?event.metaKey:event.ctrlKey)&&"Ctrl"!=base&&(name="Ctrl-"+name),(flipCtrlCmd?event.ctrlKey:event.metaKey)&&"Mod"!=base&&(name="Cmd-"+name),!noShift&&event.shiftKey&&"Shift"!=base&&(name="Shift-"+name),name}function keyName(event,noShift){if(presto&&34==event.keyCode&&event.char)return!1;var name=keyNames[event.keyCode];return null!=name&&!event.altGraphKey&&(3==event.keyCode&&event.code&&(name=event.code),addModifierNames(name,event,noShift))}function getKeyMap(val){return"string"==typeof val?keyMap[val]:val}function deleteNearSelection(cm,compute){for(var ranges=cm.doc.sel.ranges,kill=[],i=0;i<ranges.length;i++){for(var toKill=compute(ranges[i]);kill.length&&cmp(toKill.from,lst(kill).to)<=0;){var replaced=kill.pop();if(cmp(replaced.from,toKill.from)<0){toKill.from=replaced.from;break}}kill.push(toKill)}runInOp(cm,function(){for(var i=kill.length-1;i>=0;i--)replaceRange(cm.doc,"",kill[i].from,kill[i].to,"+delete");ensureCursorVisible(cm)})}function moveCharLogically(line,ch,dir){var target=skipExtendingChars(line.text,ch+dir,dir);return target<0||target>line.text.length?null:target}function moveLogically(line,start,dir){var ch=moveCharLogically(line,start.ch,dir);return null==ch?null:new Pos(start.line,ch,dir<0?"after":"before")}function endOfLine(visually,cm,lineObj,lineNo,dir){if(visually){"rtl"==cm.doc.direction&&(dir=-dir);var order=getOrder(lineObj,cm.doc.direction);if(order){var ch,part=dir<0?lst(order):order[0],sticky=dir<0==(1==part.level)?"after":"before";if(part.level>0||"rtl"==cm.doc.direction){var prep=prepareMeasureForLine(cm,lineObj);ch=dir<0?lineObj.text.length-1:0;var targetTop=measureCharPrepared(cm,prep,ch).top;ch=findFirst(function(ch){return measureCharPrepared(cm,prep,ch).top==targetTop},dir<0==(1==part.level)?part.from:part.to-1,ch),"before"==sticky&&(ch=moveCharLogically(lineObj,ch,1))}else ch=dir<0?part.to:part.from;return new Pos(lineNo,ch,sticky)}}return new Pos(lineNo,dir<0?lineObj.text.length:0,dir<0?"before":"after")}keyMap.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},keyMap.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},keyMap.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},keyMap.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},keyMap.default=mac?keyMap.macDefault:keyMap.pcDefault;var commands={selectAll:selectAll,singleSelection:function(cm){return cm.setSelection(cm.getCursor("anchor"),cm.getCursor("head"),sel_dontScroll)},killLine:function(cm){return deleteNearSelection(cm,function(range){if(range.empty()){var len=getLine(cm.doc,range.head.line).text.length;return range.head.ch==len&&range.head.line<cm.lastLine()?{from:range.head,to:Pos(range.head.line+1,0)}:{from:range.head,to:Pos(range.head.line,len)}}return{from:range.from(),to:range.to()}})},deleteLine:function(cm){return deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:clipPos(cm.doc,Pos(range.to().line+1,0))}})},delLineLeft:function(cm){return deleteNearSelection(cm,function(range){return{from:Pos(range.from().line,0),to:range.from()}})},delWrappedLineLeft:function(cm){return deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5;return{from:cm.coordsChar({left:0,top:top},"div"),to:range.from()}})},delWrappedLineRight:function(cm){return deleteNearSelection(cm,function(range){var top=cm.charCoords(range.head,"div").top+5,rightPos=cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div");return{from:range.from(),to:rightPos}})},undo:function(cm){return cm.undo()},redo:function(cm){return cm.redo()},undoSelection:function(cm){return cm.undoSelection()},redoSelection:function(cm){return cm.redoSelection()},goDocStart:function(cm){return cm.extendSelection(Pos(cm.firstLine(),0))},goDocEnd:function(cm){return cm.extendSelection(Pos(cm.lastLine()))},goLineStart:function(cm){return cm.extendSelectionsBy(function(range){return lineStart(cm,range.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(cm){return cm.extendSelectionsBy(function(range){return lineStartSmart(cm,range.head)},{origin:"+move",bias:1})},goLineEnd:function(cm){return cm.extendSelectionsBy(function(range){return function(cm,lineN){var line=getLine(cm.doc,lineN),visual=function(line){for(var merged;merged=collapsedSpanAtEnd(line);)line=merged.find(1,!0).line;return line}(line);visual!=line&&(lineN=lineNo(visual));return endOfLine(!0,cm,line,lineN,-1)}(cm,range.head.line)},{origin:"+move",bias:-1})},goLineRight:function(cm){return cm.extendSelectionsBy(function(range){var top=cm.cursorCoords(range.head,"div").top+5;return cm.coordsChar({left:cm.display.lineDiv.offsetWidth+100,top:top},"div")},sel_move)},goLineLeft:function(cm){return cm.extendSelectionsBy(function(range){var top=cm.cursorCoords(range.head,"div").top+5;return cm.coordsChar({left:0,top:top},"div")},sel_move)},goLineLeftSmart:function(cm){return cm.extendSelectionsBy(function(range){var top=cm.cursorCoords(range.head,"div").top+5,pos=cm.coordsChar({left:0,top:top},"div");return pos.ch<cm.getLine(pos.line).search(/\S/)?lineStartSmart(cm,range.head):pos},sel_move)},goLineUp:function(cm){return cm.moveV(-1,"line")},goLineDown:function(cm){return cm.moveV(1,"line")},goPageUp:function(cm){return cm.moveV(-1,"page")},goPageDown:function(cm){return cm.moveV(1,"page")},goCharLeft:function(cm){return cm.moveH(-1,"char")},goCharRight:function(cm){return cm.moveH(1,"char")},goColumnLeft:function(cm){return cm.moveH(-1,"column")},goColumnRight:function(cm){return cm.moveH(1,"column")},goWordLeft:function(cm){return cm.moveH(-1,"word")},goGroupRight:function(cm){return cm.moveH(1,"group")},goGroupLeft:function(cm){return cm.moveH(-1,"group")},goWordRight:function(cm){return cm.moveH(1,"word")},delCharBefore:function(cm){return cm.deleteH(-1,"char")},delCharAfter:function(cm){return cm.deleteH(1,"char")},delWordBefore:function(cm){return cm.deleteH(-1,"word")},delWordAfter:function(cm){return cm.deleteH(1,"word")},delGroupBefore:function(cm){return cm.deleteH(-1,"group")},delGroupAfter:function(cm){return cm.deleteH(1,"group")},indentAuto:function(cm){return cm.indentSelection("smart")},indentMore:function(cm){return cm.indentSelection("add")},indentLess:function(cm){return cm.indentSelection("subtract")},insertTab:function(cm){return cm.replaceSelection("\t")},insertSoftTab:function(cm){for(var spaces=[],ranges=cm.listSelections(),tabSize=cm.options.tabSize,i=0;i<ranges.length;i++){var pos=ranges[i].from(),col=countColumn(cm.getLine(pos.line),pos.ch,tabSize);spaces.push(spaceStr(tabSize-col%tabSize))}cm.replaceSelections(spaces)},defaultTab:function(cm){cm.somethingSelected()?cm.indentSelection("add"):cm.execCommand("insertTab")},transposeChars:function(cm){return runInOp(cm,function(){for(var ranges=cm.listSelections(),newSel=[],i=0;i<ranges.length;i++)if(ranges[i].empty()){var cur=ranges[i].head,line=getLine(cm.doc,cur.line).text;if(line)if(cur.ch==line.length&&(cur=new Pos(cur.line,cur.ch-1)),cur.ch>0)cur=new Pos(cur.line,cur.ch+1),cm.replaceRange(line.charAt(cur.ch-1)+line.charAt(cur.ch-2),Pos(cur.line,cur.ch-2),cur,"+transpose");else if(cur.line>cm.doc.first){var prev=getLine(cm.doc,cur.line-1).text;prev&&(cur=new Pos(cur.line,1),cm.replaceRange(line.charAt(0)+cm.doc.lineSeparator()+prev.charAt(prev.length-1),Pos(cur.line-1,prev.length-1),cur,"+transpose"))}newSel.push(new Range(cur,cur))}cm.setSelections(newSel)})},newlineAndIndent:function(cm){return runInOp(cm,function(){for(var sels=cm.listSelections(),i=sels.length-1;i>=0;i--)cm.replaceRange(cm.doc.lineSeparator(),sels[i].anchor,sels[i].head,"+input");sels=cm.listSelections();for(var i$1=0;i$1<sels.length;i$1++)cm.indentLine(sels[i$1].from().line,null,!0);ensureCursorVisible(cm)})},openLine:function(cm){return cm.replaceSelection("\n","start")},toggleOverwrite:function(cm){return cm.toggleOverwrite()}};function lineStart(cm,lineN){var line=getLine(cm.doc,lineN),visual=visualLine(line);return visual!=line&&(lineN=lineNo(visual)),endOfLine(!0,cm,visual,lineN,1)}function lineStartSmart(cm,pos){var start=lineStart(cm,pos.line),line=getLine(cm.doc,start.line),order=getOrder(line,cm.doc.direction);if(!order||0==order[0].level){var firstNonWS=Math.max(start.ch,line.text.search(/\S/)),inWS=pos.line==start.line&&pos.ch<=firstNonWS&&pos.ch;return Pos(start.line,inWS?0:firstNonWS,start.sticky)}return start}function doHandleBinding(cm,bound,dropShift){if("string"==typeof bound&&!(bound=commands[bound]))return!1;cm.display.input.ensurePolled();var prevShift=cm.display.shift,done=!1;try{cm.isReadOnly()&&(cm.state.suppressEdits=!0),dropShift&&(cm.display.shift=!1),done=bound(cm)!=Pass}finally{cm.display.shift=prevShift,cm.state.suppressEdits=!1}return done}var stopSeq=new Delayed;function dispatchKey(cm,name,e,handle){var seq=cm.state.keySeq;if(seq){if(isModifierKey(name))return"handled";if(/\'$/.test(name)?cm.state.keySeq=null:stopSeq.set(50,function(){cm.state.keySeq==seq&&(cm.state.keySeq=null,cm.display.input.reset())}),dispatchKeyInner(cm,seq+" "+name,e,handle))return!0}return dispatchKeyInner(cm,name,e,handle)}function dispatchKeyInner(cm,name,e,handle){var result=function(cm,name,handle){for(var i=0;i<cm.state.keyMaps.length;i++){var result=lookupKey(name,cm.state.keyMaps[i],handle,cm);if(result)return result}return cm.options.extraKeys&&lookupKey(name,cm.options.extraKeys,handle,cm)||lookupKey(name,cm.options.keyMap,handle,cm)}(cm,name,handle);return"multi"==result&&(cm.state.keySeq=name),"handled"==result&&signalLater(cm,"keyHandled",cm,name,e),"handled"!=result&&"multi"!=result||(e_preventDefault(e),restartBlink(cm)),!!result}function handleKeyBinding(cm,e){var name=keyName(e,!0);return!!name&&(e.shiftKey&&!cm.state.keySeq?dispatchKey(cm,"Shift-"+name,e,function(b){return doHandleBinding(cm,b,!0)})||dispatchKey(cm,name,e,function(b){if("string"==typeof b?/^go[A-Z]/.test(b):b.motion)return doHandleBinding(cm,b)}):dispatchKey(cm,name,e,function(b){return doHandleBinding(cm,b)}))}var lastStoppedKey=null;function onKeyDown(e){var cm=this;if(!(e.target&&e.target!=cm.display.input.getField()||(cm.curOp.focus=activeElt(),signalDOMEvent(cm,e)))){ie&&ie_version<11&&27==e.keyCode&&(e.returnValue=!1);var code=e.keyCode;cm.display.shift=16==code||e.shiftKey;var handled=handleKeyBinding(cm,e);presto&&(lastStoppedKey=handled?code:null,!handled&&88==code&&!hasCopyEvent&&(mac?e.metaKey:e.ctrlKey)&&cm.replaceSelection("",null,"cut")),gecko&&!mac&&!handled&&46==code&&e.shiftKey&&!e.ctrlKey&&document.execCommand&&document.execCommand("cut"),18!=code||/\bCodeMirror-crosshair\b/.test(cm.display.lineDiv.className)||function(cm){var lineDiv=cm.display.lineDiv;function up(e){18!=e.keyCode&&e.altKey||(rmClass(lineDiv,"CodeMirror-crosshair"),off(document,"keyup",up),off(document,"mouseover",up))}addClass(lineDiv,"CodeMirror-crosshair"),on(document,"keyup",up),on(document,"mouseover",up)}(cm)}}function onKeyUp(e){16==e.keyCode&&(this.doc.sel.shift=!1),signalDOMEvent(this,e)}function onKeyPress(e){var cm=this;if(!(e.target&&e.target!=cm.display.input.getField()||eventInWidget(cm.display,e)||signalDOMEvent(cm,e)||e.ctrlKey&&!e.altKey||mac&&e.metaKey)){var keyCode=e.keyCode,charCode=e.charCode;if(presto&&keyCode==lastStoppedKey)return lastStoppedKey=null,void e_preventDefault(e);if(!presto||e.which&&!(e.which<10)||!handleKeyBinding(cm,e)){var ch=String.fromCharCode(null==charCode?keyCode:charCode);"\b"!=ch&&(function(cm,e,ch){return dispatchKey(cm,"'"+ch+"'",e,function(b){return doHandleBinding(cm,b,!0)})}(cm,e,ch)||cm.display.input.onKeyPress(e))}}}var lastClick,lastDoubleClick,PastClick=function(time,pos,button){this.time=time,this.pos=pos,this.button=button};function onMouseDown(e){var cm=this,display=cm.display;if(!(signalDOMEvent(cm,e)||display.activeTouch&&display.input.supportsTouch()))if(display.input.ensurePolled(),display.shift=e.shiftKey,eventInWidget(display,e))webkit||(display.scroller.draggable=!1,setTimeout(function(){return display.scroller.draggable=!0},100));else if(!clickInGutter(cm,e)){var pos=posFromMouse(cm,e),button=e_button(e),repeat=pos?function(pos,button){var now=+new Date;return lastDoubleClick&&lastDoubleClick.compare(now,pos,button)?(lastClick=lastDoubleClick=null,"triple"):lastClick&&lastClick.compare(now,pos,button)?(lastDoubleClick=new PastClick(now,pos,button),lastClick=null,"double"):(lastClick=new PastClick(now,pos,button),lastDoubleClick=null,"single")}(pos,button):"single";window.focus(),1==button&&cm.state.selectingText&&cm.state.selectingText(e),pos&&function(cm,button,pos,repeat,event){var name="Click";"double"==repeat?name="Double"+name:"triple"==repeat&&(name="Triple"+name);return dispatchKey(cm,addModifierNames(name=(1==button?"Left":2==button?"Middle":"Right")+name,event),event,function(bound){if("string"==typeof bound&&(bound=commands[bound]),!bound)return!1;var done=!1;try{cm.isReadOnly()&&(cm.state.suppressEdits=!0),done=bound(cm,pos)!=Pass}finally{cm.state.suppressEdits=!1}return done})}(cm,button,pos,repeat,e)||(1==button?pos?function(cm,pos,repeat,event){ie?setTimeout(bind(ensureFocus,cm),0):cm.curOp.focus=activeElt();var contained,behavior=function(cm,repeat,event){var option=cm.getOption("configureMouse"),value=option?option(cm,repeat,event):{};if(null==value.unit){var rect=chromeOS?event.shiftKey&&event.metaKey:event.altKey;value.unit=rect?"rectangle":"single"==repeat?"char":"double"==repeat?"word":"line"}(null==value.extend||cm.doc.extend)&&(value.extend=cm.doc.extend||event.shiftKey);null==value.addNew&&(value.addNew=mac?event.metaKey:event.ctrlKey);null==value.moveOnDrag&&(value.moveOnDrag=!(mac?event.altKey:event.ctrlKey));return value}(cm,repeat,event),sel=cm.doc.sel;cm.options.dragDrop&&dragAndDrop&&!cm.isReadOnly()&&"single"==repeat&&(contained=sel.contains(pos))>-1&&(cmp((contained=sel.ranges[contained]).from(),pos)<0||pos.xRel>0)&&(cmp(contained.to(),pos)>0||pos.xRel<0)?function(cm,event,pos,behavior){var display=cm.display,moved=!1,dragEnd=operation(cm,function(e){webkit&&(display.scroller.draggable=!1),cm.state.draggingText=!1,off(display.wrapper.ownerDocument,"mouseup",dragEnd),off(display.wrapper.ownerDocument,"mousemove",mouseMove),off(display.scroller,"dragstart",dragStart),off(display.scroller,"drop",dragEnd),moved||(e_preventDefault(e),behavior.addNew||extendSelection(cm.doc,pos,null,null,behavior.extend),webkit&&!safari||ie&&9==ie_version?setTimeout(function(){display.wrapper.ownerDocument.body.focus({preventScroll:!0}),display.input.focus()},20):display.input.focus())}),mouseMove=function(e2){moved=moved||Math.abs(event.clientX-e2.clientX)+Math.abs(event.clientY-e2.clientY)>=10},dragStart=function(){return moved=!0};webkit&&(display.scroller.draggable=!0);cm.state.draggingText=dragEnd,dragEnd.copy=!behavior.moveOnDrag,display.scroller.dragDrop&&display.scroller.dragDrop();on(display.wrapper.ownerDocument,"mouseup",dragEnd),on(display.wrapper.ownerDocument,"mousemove",mouseMove),on(display.scroller,"dragstart",dragStart),on(display.scroller,"drop",dragEnd),delayBlurEvent(cm),setTimeout(function(){return display.input.focus()},20)}(cm,event,pos,behavior):function(cm,event,start,behavior){var display=cm.display,doc=cm.doc;e_preventDefault(event);var ourRange,ourIndex,startSel=doc.sel,ranges=startSel.ranges;behavior.addNew&&!behavior.extend?(ourIndex=doc.sel.contains(start),ourRange=ourIndex>-1?ranges[ourIndex]:new Range(start,start)):(ourRange=doc.sel.primary(),ourIndex=doc.sel.primIndex);if("rectangle"==behavior.unit)behavior.addNew||(ourRange=new Range(start,start)),start=posFromMouse(cm,event,!0,!0),ourIndex=-1;else{var range=rangeForUnit(cm,start,behavior.unit);ourRange=behavior.extend?extendRange(ourRange,range.anchor,range.head,behavior.extend):range}behavior.addNew?-1==ourIndex?(ourIndex=ranges.length,setSelection(doc,normalizeSelection(cm,ranges.concat([ourRange]),ourIndex),{scroll:!1,origin:"*mouse"})):ranges.length>1&&ranges[ourIndex].empty()&&"char"==behavior.unit&&!behavior.extend?(setSelection(doc,normalizeSelection(cm,ranges.slice(0,ourIndex).concat(ranges.slice(ourIndex+1)),0),{scroll:!1,origin:"*mouse"}),startSel=doc.sel):replaceOneSelection(doc,ourIndex,ourRange,sel_mouse):(ourIndex=0,setSelection(doc,new Selection([ourRange],0),sel_mouse),startSel=doc.sel);var lastPos=start;function extendTo(pos){if(0!=cmp(lastPos,pos))if(lastPos=pos,"rectangle"==behavior.unit){for(var ranges=[],tabSize=cm.options.tabSize,startCol=countColumn(getLine(doc,start.line).text,start.ch,tabSize),posCol=countColumn(getLine(doc,pos.line).text,pos.ch,tabSize),left=Math.min(startCol,posCol),right=Math.max(startCol,posCol),line=Math.min(start.line,pos.line),end=Math.min(cm.lastLine(),Math.max(start.line,pos.line));line<=end;line++){var text=getLine(doc,line).text,leftPos=findColumn(text,left,tabSize);left==right?ranges.push(new Range(Pos(line,leftPos),Pos(line,leftPos))):text.length>leftPos&&ranges.push(new Range(Pos(line,leftPos),Pos(line,findColumn(text,right,tabSize))))}ranges.length||ranges.push(new Range(start,start)),setSelection(doc,normalizeSelection(cm,startSel.ranges.slice(0,ourIndex).concat(ranges),ourIndex),{origin:"*mouse",scroll:!1}),cm.scrollIntoView(pos)}else{var head,oldRange=ourRange,range=rangeForUnit(cm,pos,behavior.unit),anchor=oldRange.anchor;cmp(range.anchor,anchor)>0?(head=range.head,anchor=minPos(oldRange.from(),range.anchor)):(head=range.anchor,anchor=maxPos(oldRange.to(),range.head));var ranges$1=startSel.ranges.slice(0);ranges$1[ourIndex]=function(cm,range){var anchor=range.anchor,head=range.head,anchorLine=getLine(cm.doc,anchor.line);if(0==cmp(anchor,head)&&anchor.sticky==head.sticky)return range;var order=getOrder(anchorLine);if(!order)return range;var index=getBidiPartAt(order,anchor.ch,anchor.sticky),part=order[index];if(part.from!=anchor.ch&&part.to!=anchor.ch)return range;var leftSide,boundary=index+(part.from==anchor.ch==(1!=part.level)?0:1);if(0==boundary||boundary==order.length)return range;if(head.line!=anchor.line)leftSide=(head.line-anchor.line)*("ltr"==cm.doc.direction?1:-1)>0;else{var headIndex=getBidiPartAt(order,head.ch,head.sticky),dir=headIndex-index||(head.ch-anchor.ch)*(1==part.level?-1:1);leftSide=headIndex==boundary-1||headIndex==boundary?dir<0:dir>0}var usePart=order[boundary+(leftSide?-1:0)],from=leftSide==(1==usePart.level),ch=from?usePart.from:usePart.to,sticky=from?"after":"before";return anchor.ch==ch&&anchor.sticky==sticky?range:new Range(new Pos(anchor.line,ch,sticky),head)}(cm,new Range(clipPos(doc,anchor),head)),setSelection(doc,normalizeSelection(cm,ranges$1,ourIndex),sel_mouse)}}var editorSize=display.wrapper.getBoundingClientRect(),counter=0;function done(e){cm.state.selectingText=!1,counter=1/0,e&&(e_preventDefault(e),display.input.focus()),off(display.wrapper.ownerDocument,"mousemove",move),off(display.wrapper.ownerDocument,"mouseup",up),doc.history.lastSelOrigin=null}var move=operation(cm,function(e){0!==e.buttons&&e_button(e)?function extend(e){var curCount=++counter;var cur=posFromMouse(cm,e,!0,"rectangle"==behavior.unit);if(!cur)return;if(0!=cmp(cur,lastPos)){cm.curOp.focus=activeElt(),extendTo(cur);var visible=visibleLines(display,doc);(cur.line>=visible.to||cur.line<visible.from)&&setTimeout(operation(cm,function(){counter==curCount&&extend(e)}),150)}else{var outside=e.clientY<editorSize.top?-20:e.clientY>editorSize.bottom?20:0;outside&&setTimeout(operation(cm,function(){counter==curCount&&(display.scroller.scrollTop+=outside,extend(e))}),50)}}(e):done(e)}),up=operation(cm,done);cm.state.selectingText=up,on(display.wrapper.ownerDocument,"mousemove",move),on(display.wrapper.ownerDocument,"mouseup",up)}(cm,event,pos,behavior)}(cm,pos,repeat,e):e_target(e)==display.scroller&&e_preventDefault(e):2==button?(pos&&extendSelection(cm.doc,pos),setTimeout(function(){return display.input.focus()},20)):3==button&&(captureRightClick?cm.display.input.onContextMenu(e):delayBlurEvent(cm)))}}function rangeForUnit(cm,pos,unit){if("char"==unit)return new Range(pos,pos);if("word"==unit)return cm.findWordAt(pos);if("line"==unit)return new Range(Pos(pos.line,0),clipPos(cm.doc,Pos(pos.line+1,0)));var result=unit(cm,pos);return new Range(result.from,result.to)}function gutterEvent(cm,e,type,prevent){var mX,mY;if(e.touches)mX=e.touches[0].clientX,mY=e.touches[0].clientY;else try{mX=e.clientX,mY=e.clientY}catch(e$1){return!1}if(mX>=Math.floor(cm.display.gutters.getBoundingClientRect().right))return!1;prevent&&e_preventDefault(e);var display=cm.display,lineBox=display.lineDiv.getBoundingClientRect();if(mY>lineBox.bottom||!hasHandler(cm,type))return e_defaultPrevented(e);mY-=lineBox.top-display.viewOffset;for(var i=0;i<cm.display.gutterSpecs.length;++i){var g=display.gutters.childNodes[i];if(g&&g.getBoundingClientRect().right>=mX)return signal(cm,type,cm,lineAtHeight(cm.doc,mY),cm.display.gutterSpecs[i].className,e),e_defaultPrevented(e)}}function clickInGutter(cm,e){return gutterEvent(cm,e,"gutterClick",!0)}function onContextMenu(cm,e){eventInWidget(cm.display,e)||function(cm,e){if(!hasHandler(cm,"gutterContextMenu"))return!1;return gutterEvent(cm,e,"gutterContextMenu",!1)}(cm,e)||signalDOMEvent(cm,e,"contextmenu")||captureRightClick||cm.display.input.onContextMenu(e)}function themeChanged(cm){cm.display.wrapper.className=cm.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+cm.options.theme.replace(/(^|\s)\s*/g," cm-s-"),clearCaches(cm)}PastClick.prototype.compare=function(time,pos,button){return this.time+400>time&&0==cmp(pos,this.pos)&&button==this.button};var Init={toString:function(){return"CodeMirror.Init"}},defaults={},optionHandlers={};function dragDropChanged(cm,value,old){if(!value!=!(old&&old!=Init)){var funcs=cm.display.dragFunctions,toggle=value?on:off;toggle(cm.display.scroller,"dragstart",funcs.start),toggle(cm.display.scroller,"dragenter",funcs.enter),toggle(cm.display.scroller,"dragover",funcs.over),toggle(cm.display.scroller,"dragleave",funcs.leave),toggle(cm.display.scroller,"drop",funcs.drop)}}function wrappingChanged(cm){cm.options.lineWrapping?(addClass(cm.display.wrapper,"CodeMirror-wrap"),cm.display.sizer.style.minWidth="",cm.display.sizerWidth=null):(rmClass(cm.display.wrapper,"CodeMirror-wrap"),findMaxLine(cm)),estimateLineHeights(cm),regChange(cm),clearCaches(cm),setTimeout(function(){return updateScrollbars(cm)},100)}function CodeMirror(place,options){var this$1=this;if(!(this instanceof CodeMirror))return new CodeMirror(place,options);this.options=options=options?copyObj(options):{},copyObj(defaults,options,!1);var doc=options.value;"string"==typeof doc?doc=new Doc(doc,options.mode,null,options.lineSeparator,options.direction):options.mode&&(doc.modeOption=options.mode),this.doc=doc;var input=new CodeMirror.inputStyles[options.inputStyle](this),display=this.display=new function(place,doc,input,options){var d=this;this.input=input,d.scrollbarFiller=elt("div",null,"CodeMirror-scrollbar-filler"),d.scrollbarFiller.setAttribute("cm-not-content","true"),d.gutterFiller=elt("div",null,"CodeMirror-gutter-filler"),d.gutterFiller.setAttribute("cm-not-content","true"),d.lineDiv=eltP("div",null,"CodeMirror-code"),d.selectionDiv=elt("div",null,null,"position: relative; z-index: 1"),d.cursorDiv=elt("div",null,"CodeMirror-cursors"),d.measure=elt("div",null,"CodeMirror-measure"),d.lineMeasure=elt("div",null,"CodeMirror-measure"),d.lineSpace=eltP("div",[d.measure,d.lineMeasure,d.selectionDiv,d.cursorDiv,d.lineDiv],null,"position: relative; outline: none");var lines=eltP("div",[d.lineSpace],"CodeMirror-lines");d.mover=elt("div",[lines],null,"position: relative"),d.sizer=elt("div",[d.mover],"CodeMirror-sizer"),d.sizerWidth=null,d.heightForcer=elt("div",null,null,"position: absolute; height: "+scrollerGap+"px; width: 1px;"),d.gutters=elt("div",null,"CodeMirror-gutters"),d.lineGutter=null,d.scroller=elt("div",[d.sizer,d.heightForcer,d.gutters],"CodeMirror-scroll"),d.scroller.setAttribute("tabIndex","-1"),d.wrapper=elt("div",[d.scrollbarFiller,d.gutterFiller,d.scroller],"CodeMirror"),ie&&ie_version<8&&(d.gutters.style.zIndex=-1,d.scroller.style.paddingRight=0),webkit||gecko&&mobile||(d.scroller.draggable=!0),place&&(place.appendChild?place.appendChild(d.wrapper):place(d.wrapper)),d.viewFrom=d.viewTo=doc.first,d.reportedViewFrom=d.reportedViewTo=doc.first,d.view=[],d.renderedView=null,d.externalMeasured=null,d.viewOffset=0,d.lastWrapHeight=d.lastWrapWidth=0,d.updateLineNumbers=null,d.nativeBarWidth=d.barHeight=d.barWidth=0,d.scrollbarsClipped=!1,d.lineNumWidth=d.lineNumInnerWidth=d.lineNumChars=null,d.alignWidgets=!1,d.cachedCharWidth=d.cachedTextHeight=d.cachedPaddingH=null,d.maxLine=null,d.maxLineLength=0,d.maxLineChanged=!1,d.wheelDX=d.wheelDY=d.wheelStartX=d.wheelStartY=null,d.shift=!1,d.selForContextMenu=null,d.activeTouch=null,d.gutterSpecs=getGutters(options.gutters,options.lineNumbers),renderGutters(d),input.init(d)}(place,doc,input,options);for(var opt in display.wrapper.CodeMirror=this,themeChanged(this),options.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),initScrollbars(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new Delayed,keySeq:null,specialChars:null},options.autofocus&&!mobile&&display.input.focus(),ie&&ie_version<11&&setTimeout(function(){return this$1.display.input.reset(!0)},20),function(cm){var d=cm.display;on(d.scroller,"mousedown",operation(cm,onMouseDown)),on(d.scroller,"dblclick",ie&&ie_version<11?operation(cm,function(e){if(!signalDOMEvent(cm,e)){var pos=posFromMouse(cm,e);if(pos&&!clickInGutter(cm,e)&&!eventInWidget(cm.display,e)){e_preventDefault(e);var word=cm.findWordAt(pos);extendSelection(cm.doc,word.anchor,word.head)}}}):function(e){return signalDOMEvent(cm,e)||e_preventDefault(e)});on(d.scroller,"contextmenu",function(e){return onContextMenu(cm,e)}),on(d.input.getField(),"contextmenu",function(e){d.scroller.contains(e.target)||onContextMenu(cm,e)});var touchFinished,prevTouch={end:0};function finishTouch(){d.activeTouch&&(touchFinished=setTimeout(function(){return d.activeTouch=null},1e3),(prevTouch=d.activeTouch).end=+new Date)}function farAway(touch,other){if(null==other.left)return!0;var dx=other.left-touch.left,dy=other.top-touch.top;return dx*dx+dy*dy>400}on(d.scroller,"touchstart",function(e){if(!signalDOMEvent(cm,e)&&!function(e){if(1!=e.touches.length)return!1;var touch=e.touches[0];return touch.radiusX<=1&&touch.radiusY<=1}(e)&&!clickInGutter(cm,e)){d.input.ensurePolled(),clearTimeout(touchFinished);var now=+new Date;d.activeTouch={start:now,moved:!1,prev:now-prevTouch.end<=300?prevTouch:null},1==e.touches.length&&(d.activeTouch.left=e.touches[0].pageX,d.activeTouch.top=e.touches[0].pageY)}}),on(d.scroller,"touchmove",function(){d.activeTouch&&(d.activeTouch.moved=!0)}),on(d.scroller,"touchend",function(e){var touch=d.activeTouch;if(touch&&!eventInWidget(d,e)&&null!=touch.left&&!touch.moved&&new Date-touch.start<300){var range,pos=cm.coordsChar(d.activeTouch,"page");range=!touch.prev||farAway(touch,touch.prev)?new Range(pos,pos):!touch.prev.prev||farAway(touch,touch.prev.prev)?cm.findWordAt(pos):new Range(Pos(pos.line,0),clipPos(cm.doc,Pos(pos.line+1,0))),cm.setSelection(range.anchor,range.head),cm.focus(),e_preventDefault(e)}finishTouch()}),on(d.scroller,"touchcancel",finishTouch),on(d.scroller,"scroll",function(){d.scroller.clientHeight&&(updateScrollTop(cm,d.scroller.scrollTop),setScrollLeft(cm,d.scroller.scrollLeft,!0),signal(cm,"scroll",cm))}),on(d.scroller,"mousewheel",function(e){return onScrollWheel(cm,e)}),on(d.scroller,"DOMMouseScroll",function(e){return onScrollWheel(cm,e)}),on(d.wrapper,"scroll",function(){return d.wrapper.scrollTop=d.wrapper.scrollLeft=0}),d.dragFunctions={enter:function(e){signalDOMEvent(cm,e)||e_stop(e)},over:function(e){signalDOMEvent(cm,e)||(!function(cm,e){var pos=posFromMouse(cm,e);if(pos){var frag=document.createDocumentFragment();drawSelectionCursor(cm,pos,frag),cm.display.dragCursor||(cm.display.dragCursor=elt("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),cm.display.lineSpace.insertBefore(cm.display.dragCursor,cm.display.cursorDiv)),removeChildrenAndAdd(cm.display.dragCursor,frag)}}(cm,e),e_stop(e))},start:function(e){return function(cm,e){if(ie&&(!cm.state.draggingText||+new Date-lastDrop<100))e_stop(e);else if(!signalDOMEvent(cm,e)&&!eventInWidget(cm.display,e)&&(e.dataTransfer.setData("Text",cm.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!safari)){var img=elt("img",null,null,"position: fixed; left: 0; top: 0;");img.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",presto&&(img.width=img.height=1,cm.display.wrapper.appendChild(img),img._top=img.offsetTop),e.dataTransfer.setDragImage(img,0,0),presto&&img.parentNode.removeChild(img)}}(cm,e)},drop:operation(cm,onDrop),leave:function(e){signalDOMEvent(cm,e)||clearDragCursor(cm)}};var inp=d.input.getField();on(inp,"keyup",function(e){return onKeyUp.call(cm,e)}),on(inp,"keydown",operation(cm,onKeyDown)),on(inp,"keypress",operation(cm,onKeyPress)),on(inp,"focus",function(e){return onFocus(cm,e)}),on(inp,"blur",function(e){return onBlur(cm,e)})}(this),ensureGlobalHandlers(),startOperation(this),this.curOp.forceUpdate=!0,attachDoc(this,doc),options.autofocus&&!mobile||this.hasFocus()?setTimeout(bind(onFocus,this),20):onBlur(this),optionHandlers)optionHandlers.hasOwnProperty(opt)&&optionHandlers[opt](this,options[opt],Init);maybeUpdateLineNumberWidth(this),options.finishInit&&options.finishInit(this);for(var i=0;i<initHooks.length;++i)initHooks[i](this);endOperation(this),webkit&&options.lineWrapping&&"optimizelegibility"==getComputedStyle(display.lineDiv).textRendering&&(display.lineDiv.style.textRendering="auto")}CodeMirror.defaults=defaults,CodeMirror.optionHandlers=optionHandlers;var initHooks=[];function indentLine(cm,n,how,aggressive){var state,doc=cm.doc;null==how&&(how="add"),"smart"==how&&(doc.mode.indent?state=getContextBefore(cm,n).state:how="prev");var tabSize=cm.options.tabSize,line=getLine(doc,n),curSpace=countColumn(line.text,null,tabSize);line.stateAfter&&(line.stateAfter=null);var indentation,curSpaceString=line.text.match(/^\s*/)[0];if(aggressive||/\S/.test(line.text)){if("smart"==how&&((indentation=doc.mode.indent(state,line.text.slice(curSpaceString.length),line.text))==Pass||indentation>150)){if(!aggressive)return;how="prev"}}else indentation=0,how="not";"prev"==how?indentation=n>doc.first?countColumn(getLine(doc,n-1).text,null,tabSize):0:"add"==how?indentation=curSpace+cm.options.indentUnit:"subtract"==how?indentation=curSpace-cm.options.indentUnit:"number"==typeof how&&(indentation=curSpace+how),indentation=Math.max(0,indentation);var indentString="",pos=0;if(cm.options.indentWithTabs)for(var i=Math.floor(indentation/tabSize);i;--i)pos+=tabSize,indentString+="\t";if(pos<indentation&&(indentString+=spaceStr(indentation-pos)),indentString!=curSpaceString)return replaceRange(doc,indentString,Pos(n,0),Pos(n,curSpaceString.length),"+input"),line.stateAfter=null,!0;for(var i$1=0;i$1<doc.sel.ranges.length;i$1++){var range=doc.sel.ranges[i$1];if(range.head.line==n&&range.head.ch<curSpaceString.length){var pos$1=Pos(n,curSpaceString.length);replaceOneSelection(doc,i$1,new Range(pos$1,pos$1));break}}}CodeMirror.defineInitHook=function(f){return initHooks.push(f)};var lastCopied=null;function setLastCopied(newLastCopied){lastCopied=newLastCopied}function applyTextInput(cm,inserted,deleted,sel,origin){var doc=cm.doc;cm.display.shift=!1,sel||(sel=doc.sel);var recent=+new Date-200,paste="paste"==origin||cm.state.pasteIncoming>recent,textLines=splitLinesAuto(inserted),multiPaste=null;if(paste&&sel.ranges.length>1)if(lastCopied&&lastCopied.text.join("\n")==inserted){if(sel.ranges.length%lastCopied.text.length==0){multiPaste=[];for(var i=0;i<lastCopied.text.length;i++)multiPaste.push(doc.splitLines(lastCopied.text[i]))}}else textLines.length==sel.ranges.length&&cm.options.pasteLinesPerSelection&&(multiPaste=map(textLines,function(l){return[l]}));for(var updateInput=cm.curOp.updateInput,i$1=sel.ranges.length-1;i$1>=0;i$1--){var range=sel.ranges[i$1],from=range.from(),to=range.to();range.empty()&&(deleted&&deleted>0?from=Pos(from.line,from.ch-deleted):cm.state.overwrite&&!paste?to=Pos(to.line,Math.min(getLine(doc,to.line).text.length,to.ch+lst(textLines).length)):paste&&lastCopied&&lastCopied.lineWise&&lastCopied.text.join("\n")==textLines.join("\n")&&(from=to=Pos(from.line,0)));var changeEvent={from:from,to:to,text:multiPaste?multiPaste[i$1%multiPaste.length]:textLines,origin:origin||(paste?"paste":cm.state.cutIncoming>recent?"cut":"+input")};makeChange(cm.doc,changeEvent),signalLater(cm,"inputRead",cm,changeEvent)}inserted&&!paste&&triggerElectric(cm,inserted),ensureCursorVisible(cm),cm.curOp.updateInput<2&&(cm.curOp.updateInput=updateInput),cm.curOp.typing=!0,cm.state.pasteIncoming=cm.state.cutIncoming=-1}function handlePaste(e,cm){var pasted=e.clipboardData&&e.clipboardData.getData("Text");if(pasted)return e.preventDefault(),cm.isReadOnly()||cm.options.disableInput||runInOp(cm,function(){return applyTextInput(cm,pasted,0,null,"paste")}),!0}function triggerElectric(cm,inserted){if(cm.options.electricChars&&cm.options.smartIndent)for(var sel=cm.doc.sel,i=sel.ranges.length-1;i>=0;i--){var range=sel.ranges[i];if(!(range.head.ch>100||i&&sel.ranges[i-1].head.line==range.head.line)){var mode=cm.getModeAt(range.head),indented=!1;if(mode.electricChars){for(var j=0;j<mode.electricChars.length;j++)if(inserted.indexOf(mode.electricChars.charAt(j))>-1){indented=indentLine(cm,range.head.line,"smart");break}}else mode.electricInput&&mode.electricInput.test(getLine(cm.doc,range.head.line).text.slice(0,range.head.ch))&&(indented=indentLine(cm,range.head.line,"smart"));indented&&signalLater(cm,"electricInput",cm,range.head.line)}}}function copyableRanges(cm){for(var text=[],ranges=[],i=0;i<cm.doc.sel.ranges.length;i++){var line=cm.doc.sel.ranges[i].head.line,lineRange={anchor:Pos(line,0),head:Pos(line+1,0)};ranges.push(lineRange),text.push(cm.getRange(lineRange.anchor,lineRange.head))}return{text:text,ranges:ranges}}function disableBrowserMagic(field,spellcheck,autocorrect,autocapitalize){field.setAttribute("autocorrect",autocorrect?"":"off"),field.setAttribute("autocapitalize",autocapitalize?"":"off"),field.setAttribute("spellcheck",!!spellcheck)}function hiddenTextarea(){var te=elt("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),div=elt("div",[te],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return webkit?te.style.width="1000px":te.setAttribute("wrap","off"),ios&&(te.style.border="1px solid black"),disableBrowserMagic(te),div}function findPosH(doc,pos,dir,unit,visually){var oldPos=pos,origDir=dir,lineObj=getLine(doc,pos.line),lineDir=visually&&"rtl"==doc.direction?-dir:dir;function moveOnce(boundToLine){var next,l;if(null==(next=visually?function(cm,line,start,dir){var bidi=getOrder(line,cm.doc.direction);if(!bidi)return moveLogically(line,start,dir);start.ch>=line.text.length?(start.ch=line.text.length,start.sticky="before"):start.ch<=0&&(start.ch=0,start.sticky="after");var partPos=getBidiPartAt(bidi,start.ch,start.sticky),part=bidi[partPos];if("ltr"==cm.doc.direction&&part.level%2==0&&(dir>0?part.to>start.ch:part.from<start.ch))return moveLogically(line,start,dir);var prep,mv=function(pos,dir){return moveCharLogically(line,pos instanceof Pos?pos.ch:pos,dir)},getWrappedLineExtent=function(ch){return cm.options.lineWrapping?(prep=prep||prepareMeasureForLine(cm,line),wrappedLineExtentChar(cm,line,prep,ch)):{begin:0,end:line.text.length}},wrappedLineExtent=getWrappedLineExtent("before"==start.sticky?mv(start,-1):start.ch);if("rtl"==cm.doc.direction||1==part.level){var moveInStorageOrder=1==part.level==dir<0,ch=mv(start,moveInStorageOrder?1:-1);if(null!=ch&&(moveInStorageOrder?ch<=part.to&&ch<=wrappedLineExtent.end:ch>=part.from&&ch>=wrappedLineExtent.begin)){var sticky=moveInStorageOrder?"before":"after";return new Pos(start.line,ch,sticky)}}var searchInVisualLine=function(partPos,dir,wrappedLineExtent){for(var getRes=function(ch,moveInStorageOrder){return moveInStorageOrder?new Pos(start.line,mv(ch,1),"before"):new Pos(start.line,ch,"after")};partPos>=0&&partPos<bidi.length;partPos+=dir){var part=bidi[partPos],moveInStorageOrder=dir>0==(1!=part.level),ch=moveInStorageOrder?wrappedLineExtent.begin:mv(wrappedLineExtent.end,-1);if(part.from<=ch&&ch<part.to)return getRes(ch,moveInStorageOrder);if(ch=moveInStorageOrder?part.from:mv(part.to,-1),wrappedLineExtent.begin<=ch&&ch<wrappedLineExtent.end)return getRes(ch,moveInStorageOrder)}},res=searchInVisualLine(partPos+dir,dir,wrappedLineExtent);if(res)return res;var nextCh=dir>0?wrappedLineExtent.end:mv(wrappedLineExtent.begin,-1);return null==nextCh||dir>0&&nextCh==line.text.length||!(res=searchInVisualLine(dir>0?0:bidi.length-1,dir,getWrappedLineExtent(nextCh)))?null:res}(doc.cm,lineObj,pos,dir):moveLogically(lineObj,pos,dir))){if(boundToLine||(l=pos.line+lineDir)<doc.first||l>=doc.first+doc.size||(pos=new Pos(l,pos.ch,pos.sticky),!(lineObj=getLine(doc,l))))return!1;pos=endOfLine(visually,doc.cm,lineObj,pos.line,lineDir)}else pos=next;return!0}if("char"==unit)moveOnce();else if("column"==unit)moveOnce(!0);else if("word"==unit||"group"==unit)for(var sawType=null,group="group"==unit,helper=doc.cm&&doc.cm.getHelper(pos,"wordChars"),first=!0;!(dir<0)||moveOnce(!first);first=!1){var cur=lineObj.text.charAt(pos.ch)||"\n",type=isWordChar(cur,helper)?"w":group&&"\n"==cur?"n":!group||/\s/.test(cur)?null:"p";if(!group||first||type||(type="s"),sawType&&sawType!=type){dir<0&&(dir=1,moveOnce(),pos.sticky="after");break}if(type&&(sawType=type),dir>0&&!moveOnce(!first))break}var result=skipAtomic(doc,pos,oldPos,origDir,!0);return equalCursorPos(oldPos,result)&&(result.hitSide=!0),result}function findPosV(cm,pos,dir,unit){var y,target,doc=cm.doc,x=pos.left;if("page"==unit){var pageSize=Math.min(cm.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),moveAmount=Math.max(pageSize-.5*textHeight(cm.display),3);y=(dir>0?pos.bottom:pos.top)+dir*moveAmount}else"line"==unit&&(y=dir>0?pos.bottom+3:pos.top-3);for(;(target=coordsChar(cm,x,y)).outside;){if(dir<0?y<=0:y>=doc.height){target.hitSide=!0;break}y+=5*dir}return target}var ContentEditableInput=function(cm){this.cm=cm,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Delayed,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function posToDOM(cm,pos){var view=findViewForLine(cm,pos.line);if(!view||view.hidden)return null;var line=getLine(cm.doc,pos.line),info=mapFromLineView(view,line,pos.line),order=getOrder(line,cm.doc.direction),side="left";order&&(side=getBidiPartAt(order,pos.ch)%2?"right":"left");var result=nodeAndOffsetInLineMap(info.map,pos.ch,side);return result.offset="right"==result.collapse?result.end:result.start,result}function badPos(pos,bad){return bad&&(pos.bad=!0),pos}function domToPos(cm,node,offset){var lineNode;if(node==cm.display.lineDiv){if(!(lineNode=cm.display.lineDiv.childNodes[offset]))return badPos(cm.clipPos(Pos(cm.display.viewTo-1)),!0);node=null,offset=0}else for(lineNode=node;;lineNode=lineNode.parentNode){if(!lineNode||lineNode==cm.display.lineDiv)return null;if(lineNode.parentNode&&lineNode.parentNode==cm.display.lineDiv)break}for(var i=0;i<cm.display.view.length;i++){var lineView=cm.display.view[i];if(lineView.node==lineNode)return locateNodeInLineView(lineView,node,offset)}}function locateNodeInLineView(lineView,node,offset){var wrapper=lineView.text.firstChild,bad=!1;if(!node||!contains(wrapper,node))return badPos(Pos(lineNo(lineView.line),0),!0);if(node==wrapper&&(bad=!0,node=wrapper.childNodes[offset],offset=0,!node)){var line=lineView.rest?lst(lineView.rest):lineView.line;return badPos(Pos(lineNo(line),line.text.length),bad)}var textNode=3==node.nodeType?node:null,topNode=node;for(textNode||1!=node.childNodes.length||3!=node.firstChild.nodeType||(textNode=node.firstChild,offset&&(offset=textNode.nodeValue.length));topNode.parentNode!=wrapper;)topNode=topNode.parentNode;var measure=lineView.measure,maps=measure.maps;function find(textNode,topNode,offset){for(var i=-1;i<(maps?maps.length:0);i++)for(var map=i<0?measure.map:maps[i],j=0;j<map.length;j+=3){var curNode=map[j+2];if(curNode==textNode||curNode==topNode){var line=lineNo(i<0?lineView.line:lineView.rest[i]),ch=map[j]+offset;return(offset<0||curNode!=textNode)&&(ch=map[j+(offset?1:0)]),Pos(line,ch)}}}var found=find(textNode,topNode,offset);if(found)return badPos(found,bad);for(var after=topNode.nextSibling,dist=textNode?textNode.nodeValue.length-offset:0;after;after=after.nextSibling){if(found=find(after,after.firstChild,0))return badPos(Pos(found.line,found.ch-dist),bad);dist+=after.textContent.length}for(var before=topNode.previousSibling,dist$1=offset;before;before=before.previousSibling){if(found=find(before,before.firstChild,-1))return badPos(Pos(found.line,found.ch+dist$1),bad);dist$1+=before.textContent.length}}ContentEditableInput.prototype.init=function(display){var this$1=this,input=this,cm=input.cm,div=input.div=display.lineDiv;function belongsToInput(e){for(var t=e.target;t;t=t.parentNode){if(t==div)return!0;if(/\bCodeMirror-(?:line)?widget\b/.test(t.className))break}return!1}function onCopyCut(e){if(belongsToInput(e)&&!signalDOMEvent(cm,e)){if(cm.somethingSelected())setLastCopied({lineWise:!1,text:cm.getSelections()}),"cut"==e.type&&cm.replaceSelection("",null,"cut");else{if(!cm.options.lineWiseCopyCut)return;var ranges=copyableRanges(cm);setLastCopied({lineWise:!0,text:ranges.text}),"cut"==e.type&&cm.operation(function(){cm.setSelections(ranges.ranges,0,sel_dontScroll),cm.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var content=lastCopied.text.join("\n");if(e.clipboardData.setData("Text",content),e.clipboardData.getData("Text")==content)return void e.preventDefault()}var kludge=hiddenTextarea(),te=kludge.firstChild;cm.display.lineSpace.insertBefore(kludge,cm.display.lineSpace.firstChild),te.value=lastCopied.text.join("\n");var hadFocus=document.activeElement;selectInput(te),setTimeout(function(){cm.display.lineSpace.removeChild(kludge),hadFocus.focus(),hadFocus==div&&input.showPrimarySelection()},50)}}disableBrowserMagic(div,cm.options.spellcheck,cm.options.autocorrect,cm.options.autocapitalize),on(div,"paste",function(e){!belongsToInput(e)||signalDOMEvent(cm,e)||handlePaste(e,cm)||ie_version<=11&&setTimeout(operation(cm,function(){return this$1.updateFromDOM()}),20)}),on(div,"compositionstart",function(e){this$1.composing={data:e.data,done:!1}}),on(div,"compositionupdate",function(e){this$1.composing||(this$1.composing={data:e.data,done:!1})}),on(div,"compositionend",function(e){this$1.composing&&(e.data!=this$1.composing.data&&this$1.readFromDOMSoon(),this$1.composing.done=!0)}),on(div,"touchstart",function(){return input.forceCompositionEnd()}),on(div,"input",function(){this$1.composing||this$1.readFromDOMSoon()}),on(div,"copy",onCopyCut),on(div,"cut",onCopyCut)},ContentEditableInput.prototype.screenReaderLabelChanged=function(label){label?this.div.setAttribute("aria-label",label):this.div.removeAttribute("aria-label")},ContentEditableInput.prototype.prepareSelection=function(){var result=prepareSelection(this.cm,!1);return result.focus=document.activeElement==this.div,result},ContentEditableInput.prototype.showSelection=function(info,takeFocus){info&&this.cm.display.view.length&&((info.focus||takeFocus)&&this.showPrimarySelection(),this.showMultipleSelections(info))},ContentEditableInput.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},ContentEditableInput.prototype.showPrimarySelection=function(){var sel=this.getSelection(),cm=this.cm,prim=cm.doc.sel.primary(),from=prim.from(),to=prim.to();if(cm.display.viewTo==cm.display.viewFrom||from.line>=cm.display.viewTo||to.line<cm.display.viewFrom)sel.removeAllRanges();else{var curAnchor=domToPos(cm,sel.anchorNode,sel.anchorOffset),curFocus=domToPos(cm,sel.focusNode,sel.focusOffset);if(!curAnchor||curAnchor.bad||!curFocus||curFocus.bad||0!=cmp(minPos(curAnchor,curFocus),from)||0!=cmp(maxPos(curAnchor,curFocus),to)){var view=cm.display.view,start=from.line>=cm.display.viewFrom&&posToDOM(cm,from)||{node:view[0].measure.map[2],offset:0},end=to.line<cm.display.viewTo&&posToDOM(cm,to);if(!end){var measure=view[view.length-1].measure,map=measure.maps?measure.maps[measure.maps.length-1]:measure.map;end={node:map[map.length-1],offset:map[map.length-2]-map[map.length-3]}}if(start&&end){var rng,old=sel.rangeCount&&sel.getRangeAt(0);try{rng=range(start.node,start.offset,end.offset,end.node)}catch(e){}rng&&(!gecko&&cm.state.focused?(sel.collapse(start.node,start.offset),rng.collapsed||(sel.removeAllRanges(),sel.addRange(rng))):(sel.removeAllRanges(),sel.addRange(rng)),old&&null==sel.anchorNode?sel.addRange(old):gecko&&this.startGracePeriod()),this.rememberSelection()}else sel.removeAllRanges()}}},ContentEditableInput.prototype.startGracePeriod=function(){var this$1=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){this$1.gracePeriod=!1,this$1.selectionChanged()&&this$1.cm.operation(function(){return this$1.cm.curOp.selectionChanged=!0})},20)},ContentEditableInput.prototype.showMultipleSelections=function(info){removeChildrenAndAdd(this.cm.display.cursorDiv,info.cursors),removeChildrenAndAdd(this.cm.display.selectionDiv,info.selection)},ContentEditableInput.prototype.rememberSelection=function(){var sel=this.getSelection();this.lastAnchorNode=sel.anchorNode,this.lastAnchorOffset=sel.anchorOffset,this.lastFocusNode=sel.focusNode,this.lastFocusOffset=sel.focusOffset},ContentEditableInput.prototype.selectionInEditor=function(){var sel=this.getSelection();if(!sel.rangeCount)return!1;var node=sel.getRangeAt(0).commonAncestorContainer;return contains(this.div,node)},ContentEditableInput.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()&&document.activeElement==this.div||this.showSelection(this.prepareSelection(),!0),this.div.focus())},ContentEditableInput.prototype.blur=function(){this.div.blur()},ContentEditableInput.prototype.getField=function(){return this.div},ContentEditableInput.prototype.supportsTouch=function(){return!0},ContentEditableInput.prototype.receivedFocus=function(){var input=this;this.selectionInEditor()?this.pollSelection():runInOp(this.cm,function(){return input.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function poll(){input.cm.state.focused&&(input.pollSelection(),input.polling.set(input.cm.options.pollInterval,poll))})},ContentEditableInput.prototype.selectionChanged=function(){var sel=this.getSelection();return sel.anchorNode!=this.lastAnchorNode||sel.anchorOffset!=this.lastAnchorOffset||sel.focusNode!=this.lastFocusNode||sel.focusOffset!=this.lastFocusOffset},ContentEditableInput.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var sel=this.getSelection(),cm=this.cm;if(android&&chrome&&this.cm.display.gutterSpecs.length&&function(node){for(var scan=node;scan;scan=scan.parentNode)if(/CodeMirror-gutter-wrapper/.test(scan.className))return!0;return!1}(sel.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var anchor=domToPos(cm,sel.anchorNode,sel.anchorOffset),head=domToPos(cm,sel.focusNode,sel.focusOffset);anchor&&head&&runInOp(cm,function(){setSelection(cm.doc,simpleSelection(anchor,head),sel_dontScroll),(anchor.bad||head.bad)&&(cm.curOp.selectionChanged=!0)})}}},ContentEditableInput.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var fromIndex,fromLine,fromNode,cm=this.cm,display=cm.display,sel=cm.doc.sel.primary(),from=sel.from(),to=sel.to();if(0==from.ch&&from.line>cm.firstLine()&&(from=Pos(from.line-1,getLine(cm.doc,from.line-1).length)),to.ch==getLine(cm.doc,to.line).text.length&&to.line<cm.lastLine()&&(to=Pos(to.line+1,0)),from.line<display.viewFrom||to.line>display.viewTo-1)return!1;from.line==display.viewFrom||0==(fromIndex=findViewIndex(cm,from.line))?(fromLine=lineNo(display.view[0].line),fromNode=display.view[0].node):(fromLine=lineNo(display.view[fromIndex].line),fromNode=display.view[fromIndex-1].node.nextSibling);var toLine,toNode,toIndex=findViewIndex(cm,to.line);if(toIndex==display.view.length-1?(toLine=display.viewTo-1,toNode=display.lineDiv.lastChild):(toLine=lineNo(display.view[toIndex+1].line)-1,toNode=display.view[toIndex+1].node.previousSibling),!fromNode)return!1;for(var newText=cm.doc.splitLines(function(cm,from,to,fromLine,toLine){var text="",closing=!1,lineSep=cm.doc.lineSeparator(),extraLinebreak=!1;function close(){closing&&(text+=lineSep,extraLinebreak&&(text+=lineSep),closing=extraLinebreak=!1)}function addText(str){str&&(close(),text+=str)}function walk(node){if(1==node.nodeType){var cmText=node.getAttribute("cm-text");if(cmText)return void addText(cmText);var range,markerID=node.getAttribute("cm-marker");if(markerID){var found=cm.findMarks(Pos(fromLine,0),Pos(toLine+1,0),(id=+markerID,function(marker){return marker.id==id}));return void(found.length&&(range=found[0].find(0))&&addText(getBetween(cm.doc,range.from,range.to).join(lineSep)))}if("false"==node.getAttribute("contenteditable"))return;var isBlock=/^(pre|div|p|li|table|br)$/i.test(node.nodeName);if(!/^br$/i.test(node.nodeName)&&0==node.textContent.length)return;isBlock&&close();for(var i=0;i<node.childNodes.length;i++)walk(node.childNodes[i]);/^(pre|p)$/i.test(node.nodeName)&&(extraLinebreak=!0),isBlock&&(closing=!0)}else 3==node.nodeType&&addText(node.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var id}for(;walk(from),from!=to;)from=from.nextSibling,extraLinebreak=!1;return text}(cm,fromNode,toNode,fromLine,toLine)),oldText=getBetween(cm.doc,Pos(fromLine,0),Pos(toLine,getLine(cm.doc,toLine).text.length));newText.length>1&&oldText.length>1;)if(lst(newText)==lst(oldText))newText.pop(),oldText.pop(),toLine--;else{if(newText[0]!=oldText[0])break;newText.shift(),oldText.shift(),fromLine++}for(var cutFront=0,cutEnd=0,newTop=newText[0],oldTop=oldText[0],maxCutFront=Math.min(newTop.length,oldTop.length);cutFront<maxCutFront&&newTop.charCodeAt(cutFront)==oldTop.charCodeAt(cutFront);)++cutFront;for(var newBot=lst(newText),oldBot=lst(oldText),maxCutEnd=Math.min(newBot.length-(1==newText.length?cutFront:0),oldBot.length-(1==oldText.length?cutFront:0));cutEnd<maxCutEnd&&newBot.charCodeAt(newBot.length-cutEnd-1)==oldBot.charCodeAt(oldBot.length-cutEnd-1);)++cutEnd;if(1==newText.length&&1==oldText.length&&fromLine==from.line)for(;cutFront&&cutFront>from.ch&&newBot.charCodeAt(newBot.length-cutEnd-1)==oldBot.charCodeAt(oldBot.length-cutEnd-1);)cutFront--,cutEnd++;newText[newText.length-1]=newBot.slice(0,newBot.length-cutEnd).replace(/^\u200b+/,""),newText[0]=newText[0].slice(cutFront).replace(/\u200b+$/,"");var chFrom=Pos(fromLine,cutFront),chTo=Pos(toLine,oldText.length?lst(oldText).length-cutEnd:0);return newText.length>1||newText[0]||cmp(chFrom,chTo)?(replaceRange(cm.doc,newText,chFrom,chTo,"+input"),!0):void 0},ContentEditableInput.prototype.ensurePolled=function(){this.forceCompositionEnd()},ContentEditableInput.prototype.reset=function(){this.forceCompositionEnd()},ContentEditableInput.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},ContentEditableInput.prototype.readFromDOMSoon=function(){var this$1=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(this$1.readDOMTimeout=null,this$1.composing){if(!this$1.composing.done)return;this$1.composing=null}this$1.updateFromDOM()},80))},ContentEditableInput.prototype.updateFromDOM=function(){var this$1=this;!this.cm.isReadOnly()&&this.pollContent()||runInOp(this.cm,function(){return regChange(this$1.cm)})},ContentEditableInput.prototype.setUneditable=function(node){node.contentEditable="false"},ContentEditableInput.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly()||operation(this.cm,applyTextInput)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},ContentEditableInput.prototype.readOnlyChanged=function(val){this.div.contentEditable=String("nocursor"!=val)},ContentEditableInput.prototype.onContextMenu=function(){},ContentEditableInput.prototype.resetPosition=function(){},ContentEditableInput.prototype.needsContentAttribute=!0;var TextareaInput=function(cm){this.cm=cm,this.prevInput="",this.pollingFast=!1,this.polling=new Delayed,this.hasSelection=!1,this.composing=null};TextareaInput.prototype.init=function(display){var this$1=this,input=this,cm=this.cm;this.createField(display);var te=this.textarea;function prepareCopyCut(e){if(!signalDOMEvent(cm,e)){if(cm.somethingSelected())setLastCopied({lineWise:!1,text:cm.getSelections()});else{if(!cm.options.lineWiseCopyCut)return;var ranges=copyableRanges(cm);setLastCopied({lineWise:!0,text:ranges.text}),"cut"==e.type?cm.setSelections(ranges.ranges,null,sel_dontScroll):(input.prevInput="",te.value=ranges.text.join("\n"),selectInput(te))}"cut"==e.type&&(cm.state.cutIncoming=+new Date)}}display.wrapper.insertBefore(this.wrapper,display.wrapper.firstChild),ios&&(te.style.width="0px"),on(te,"input",function(){ie&&ie_version>=9&&this$1.hasSelection&&(this$1.hasSelection=null),input.poll()}),on(te,"paste",function(e){signalDOMEvent(cm,e)||handlePaste(e,cm)||(cm.state.pasteIncoming=+new Date,input.fastPoll())}),on(te,"cut",prepareCopyCut),on(te,"copy",prepareCopyCut),on(display.scroller,"paste",function(e){if(!eventInWidget(display,e)&&!signalDOMEvent(cm,e)){if(!te.dispatchEvent)return cm.state.pasteIncoming=+new Date,void input.focus();var event=new Event("paste");event.clipboardData=e.clipboardData,te.dispatchEvent(event)}}),on(display.lineSpace,"selectstart",function(e){eventInWidget(display,e)||e_preventDefault(e)}),on(te,"compositionstart",function(){var start=cm.getCursor("from");input.composing&&input.composing.range.clear(),input.composing={start:start,range:cm.markText(start,cm.getCursor("to"),{className:"CodeMirror-composing"})}}),on(te,"compositionend",function(){input.composing&&(input.poll(),input.composing.range.clear(),input.composing=null)})},TextareaInput.prototype.createField=function(_display){this.wrapper=hiddenTextarea(),this.textarea=this.wrapper.firstChild},TextareaInput.prototype.screenReaderLabelChanged=function(label){label?this.textarea.setAttribute("aria-label",label):this.textarea.removeAttribute("aria-label")},TextareaInput.prototype.prepareSelection=function(){var cm=this.cm,display=cm.display,doc=cm.doc,result=prepareSelection(cm);if(cm.options.moveInputWithCursor){var headPos=cursorCoords(cm,doc.sel.primary().head,"div"),wrapOff=display.wrapper.getBoundingClientRect(),lineOff=display.lineDiv.getBoundingClientRect();result.teTop=Math.max(0,Math.min(display.wrapper.clientHeight-10,headPos.top+lineOff.top-wrapOff.top)),result.teLeft=Math.max(0,Math.min(display.wrapper.clientWidth-10,headPos.left+lineOff.left-wrapOff.left))}return result},TextareaInput.prototype.showSelection=function(drawn){var display=this.cm.display;removeChildrenAndAdd(display.cursorDiv,drawn.cursors),removeChildrenAndAdd(display.selectionDiv,drawn.selection),null!=drawn.teTop&&(this.wrapper.style.top=drawn.teTop+"px",this.wrapper.style.left=drawn.teLeft+"px")},TextareaInput.prototype.reset=function(typing){if(!this.contextMenuPending&&!this.composing){var cm=this.cm;if(cm.somethingSelected()){this.prevInput="";var content=cm.getSelection();this.textarea.value=content,cm.state.focused&&selectInput(this.textarea),ie&&ie_version>=9&&(this.hasSelection=content)}else typing||(this.prevInput=this.textarea.value="",ie&&ie_version>=9&&(this.hasSelection=null))}},TextareaInput.prototype.getField=function(){return this.textarea},TextareaInput.prototype.supportsTouch=function(){return!1},TextareaInput.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!mobile||activeElt()!=this.textarea))try{this.textarea.focus()}catch(e){}},TextareaInput.prototype.blur=function(){this.textarea.blur()},TextareaInput.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},TextareaInput.prototype.receivedFocus=function(){this.slowPoll()},TextareaInput.prototype.slowPoll=function(){var this$1=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){this$1.poll(),this$1.cm.state.focused&&this$1.slowPoll()})},TextareaInput.prototype.fastPoll=function(){var missed=!1,input=this;input.pollingFast=!0,input.polling.set(20,function p(){input.poll()||missed?(input.pollingFast=!1,input.slowPoll()):(missed=!0,input.polling.set(60,p))})},TextareaInput.prototype.poll=function(){var this$1=this,cm=this.cm,input=this.textarea,prevInput=this.prevInput;if(this.contextMenuPending||!cm.state.focused||hasSelection(input)&&!prevInput&&!this.composing||cm.isReadOnly()||cm.options.disableInput||cm.state.keySeq)return!1;var text=input.value;if(text==prevInput&&!cm.somethingSelected())return!1;if(ie&&ie_version>=9&&this.hasSelection===text||mac&&/[\uf700-\uf7ff]/.test(text))return cm.display.input.reset(),!1;if(cm.doc.sel==cm.display.selForContextMenu){var first=text.charCodeAt(0);if(8203!=first||prevInput||(prevInput="​"),8666==first)return this.reset(),this.cm.execCommand("undo")}for(var same=0,l=Math.min(prevInput.length,text.length);same<l&&prevInput.charCodeAt(same)==text.charCodeAt(same);)++same;return runInOp(cm,function(){applyTextInput(cm,text.slice(same),prevInput.length-same,null,this$1.composing?"*compose":null),text.length>1e3||text.indexOf("\n")>-1?input.value=this$1.prevInput="":this$1.prevInput=text,this$1.composing&&(this$1.composing.range.clear(),this$1.composing.range=cm.markText(this$1.composing.start,cm.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},TextareaInput.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},TextareaInput.prototype.onKeyPress=function(){ie&&ie_version>=9&&(this.hasSelection=null),this.fastPoll()},TextareaInput.prototype.onContextMenu=function(e){var input=this,cm=input.cm,display=cm.display,te=input.textarea;input.contextMenuPending&&input.contextMenuPending();var pos=posFromMouse(cm,e),scrollPos=display.scroller.scrollTop;if(pos&&!presto){cm.options.resetSelectionOnContextMenu&&-1==cm.doc.sel.contains(pos)&&operation(cm,setSelection)(cm.doc,simpleSelection(pos),sel_dontScroll);var oldScrollY,oldCSS=te.style.cssText,oldWrapperCSS=input.wrapper.style.cssText,wrapperBox=input.wrapper.offsetParent.getBoundingClientRect();if(input.wrapper.style.cssText="position: static",te.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-wrapperBox.top-5)+"px; left: "+(e.clientX-wrapperBox.left-5)+"px;\n      z-index: 1000; background: "+(ie?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",webkit&&(oldScrollY=window.scrollY),display.input.focus(),webkit&&window.scrollTo(null,oldScrollY),display.input.reset(),cm.somethingSelected()||(te.value=input.prevInput=" "),input.contextMenuPending=rehide,display.selForContextMenu=cm.doc.sel,clearTimeout(display.detectingSelectAll),ie&&ie_version>=9&&prepareSelectAllHack(),captureRightClick){e_stop(e);var mouseup=function(){off(window,"mouseup",mouseup),setTimeout(rehide,20)};on(window,"mouseup",mouseup)}else setTimeout(rehide,50)}function prepareSelectAllHack(){if(null!=te.selectionStart){var selected=cm.somethingSelected(),extval="​"+(selected?te.value:"");te.value="⇚",te.value=extval,input.prevInput=selected?"":"​",te.selectionStart=1,te.selectionEnd=extval.length,display.selForContextMenu=cm.doc.sel}}function rehide(){if(input.contextMenuPending==rehide&&(input.contextMenuPending=!1,input.wrapper.style.cssText=oldWrapperCSS,te.style.cssText=oldCSS,ie&&ie_version<9&&display.scrollbars.setScrollTop(display.scroller.scrollTop=scrollPos),null!=te.selectionStart)){(!ie||ie&&ie_version<9)&&prepareSelectAllHack();var i=0,poll=function(){display.selForContextMenu==cm.doc.sel&&0==te.selectionStart&&te.selectionEnd>0&&"​"==input.prevInput?operation(cm,selectAll)(cm):i++<10?display.detectingSelectAll=setTimeout(poll,500):(display.selForContextMenu=null,display.input.reset())};display.detectingSelectAll=setTimeout(poll,200)}}},TextareaInput.prototype.readOnlyChanged=function(val){val||this.reset(),this.textarea.disabled="nocursor"==val},TextareaInput.prototype.setUneditable=function(){},TextareaInput.prototype.needsContentAttribute=!1,function(CodeMirror){var optionHandlers=CodeMirror.optionHandlers;function option(name,deflt,handle,notOnInit){CodeMirror.defaults[name]=deflt,handle&&(optionHandlers[name]=notOnInit?function(cm,val,old){old!=Init&&handle(cm,val,old)}:handle)}CodeMirror.defineOption=option,CodeMirror.Init=Init,option("value","",function(cm,val){return cm.setValue(val)},!0),option("mode",null,function(cm,val){cm.doc.modeOption=val,loadMode(cm)},!0),option("indentUnit",2,loadMode,!0),option("indentWithTabs",!1),option("smartIndent",!0),option("tabSize",4,function(cm){resetModeState(cm),clearCaches(cm),regChange(cm)},!0),option("lineSeparator",null,function(cm,val){if(cm.doc.lineSep=val,val){var newBreaks=[],lineNo=cm.doc.first;cm.doc.iter(function(line){for(var pos=0;;){var found=line.text.indexOf(val,pos);if(-1==found)break;pos=found+val.length,newBreaks.push(Pos(lineNo,found))}lineNo++});for(var i=newBreaks.length-1;i>=0;i--)replaceRange(cm.doc,val,newBreaks[i],Pos(newBreaks[i].line,newBreaks[i].ch+val.length))}}),option("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200c\u200e\u200f\u2028\u2029\ufeff\ufff9-\ufffc]/g,function(cm,val,old){cm.state.specialChars=new RegExp(val.source+(val.test("\t")?"":"|\t"),"g"),old!=Init&&cm.refresh()}),option("specialCharPlaceholder",defaultSpecialCharPlaceholder,function(cm){return cm.refresh()},!0),option("electricChars",!0),option("inputStyle",mobile?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),option("spellcheck",!1,function(cm,val){return cm.getInputField().spellcheck=val},!0),option("autocorrect",!1,function(cm,val){return cm.getInputField().autocorrect=val},!0),option("autocapitalize",!1,function(cm,val){return cm.getInputField().autocapitalize=val},!0),option("rtlMoveVisually",!windows),option("wholeLineUpdateBefore",!0),option("theme","default",function(cm){themeChanged(cm),updateGutters(cm)},!0),option("keyMap","default",function(cm,val,old){var next=getKeyMap(val),prev=old!=Init&&getKeyMap(old);prev&&prev.detach&&prev.detach(cm,next),next.attach&&next.attach(cm,prev||null)}),option("extraKeys",null),option("configureMouse",null),option("lineWrapping",!1,wrappingChanged,!0),option("gutters",[],function(cm,val){cm.display.gutterSpecs=getGutters(val,cm.options.lineNumbers),updateGutters(cm)},!0),option("fixedGutter",!0,function(cm,val){cm.display.gutters.style.left=val?compensateForHScroll(cm.display)+"px":"0",cm.refresh()},!0),option("coverGutterNextToScrollbar",!1,function(cm){return updateScrollbars(cm)},!0),option("scrollbarStyle","native",function(cm){initScrollbars(cm),updateScrollbars(cm),cm.display.scrollbars.setScrollTop(cm.doc.scrollTop),cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft)},!0),option("lineNumbers",!1,function(cm,val){cm.display.gutterSpecs=getGutters(cm.options.gutters,val),updateGutters(cm)},!0),option("firstLineNumber",1,updateGutters,!0),option("lineNumberFormatter",function(integer){return integer},updateGutters,!0),option("showCursorWhenSelecting",!1,updateSelection,!0),option("resetSelectionOnContextMenu",!0),option("lineWiseCopyCut",!0),option("pasteLinesPerSelection",!0),option("selectionsMayTouch",!1),option("readOnly",!1,function(cm,val){"nocursor"==val&&(onBlur(cm),cm.display.input.blur()),cm.display.input.readOnlyChanged(val)}),option("screenReaderLabel",null,function(cm,val){val=""===val?null:val,cm.display.input.screenReaderLabelChanged(val)}),option("disableInput",!1,function(cm,val){val||cm.display.input.reset()},!0),option("dragDrop",!0,dragDropChanged),option("allowDropFileTypes",null),option("cursorBlinkRate",530),option("cursorScrollMargin",0),option("cursorHeight",1,updateSelection,!0),option("singleCursorHeightPerLine",!0,updateSelection,!0),option("workTime",100),option("workDelay",100),option("flattenSpans",!0,resetModeState,!0),option("addModeClass",!1,resetModeState,!0),option("pollInterval",100),option("undoDepth",200,function(cm,val){return cm.doc.history.undoDepth=val}),option("historyEventDelay",1250),option("viewportMargin",10,function(cm){return cm.refresh()},!0),option("maxHighlightLength",1e4,resetModeState,!0),option("moveInputWithCursor",!0,function(cm,val){val||cm.display.input.resetPosition()}),option("tabindex",null,function(cm,val){return cm.display.input.getField().tabIndex=val||""}),option("autofocus",null),option("direction","ltr",function(cm,val){return cm.doc.setDirection(val)},!0),option("phrases",null)}(CodeMirror),function(CodeMirror){var optionHandlers=CodeMirror.optionHandlers,helpers=CodeMirror.helpers={};CodeMirror.prototype={constructor:CodeMirror,focus:function(){window.focus(),this.display.input.focus()},setOption:function(option,value){var options=this.options,old=options[option];options[option]==value&&"mode"!=option||(options[option]=value,optionHandlers.hasOwnProperty(option)&&operation(this,optionHandlers[option])(this,value,old),signal(this,"optionChange",this,option))},getOption:function(option){return this.options[option]},getDoc:function(){return this.doc},addKeyMap:function(map,bottom){this.state.keyMaps[bottom?"push":"unshift"](getKeyMap(map))},removeKeyMap:function(map){for(var maps=this.state.keyMaps,i=0;i<maps.length;++i)if(maps[i]==map||maps[i].name==map)return maps.splice(i,1),!0},addOverlay:methodOp(function(spec,options){var mode=spec.token?spec:CodeMirror.getMode(this.options,spec);if(mode.startState)throw new Error("Overlays may not be stateful.");!function(array,value,score){for(var pos=0,priority=score(value);pos<array.length&&score(array[pos])<=priority;)pos++;array.splice(pos,0,value)}(this.state.overlays,{mode:mode,modeSpec:spec,opaque:options&&options.opaque,priority:options&&options.priority||0},function(overlay){return overlay.priority}),this.state.modeGen++,regChange(this)}),removeOverlay:methodOp(function(spec){for(var overlays=this.state.overlays,i=0;i<overlays.length;++i){var cur=overlays[i].modeSpec;if(cur==spec||"string"==typeof spec&&cur.name==spec)return overlays.splice(i,1),this.state.modeGen++,void regChange(this)}}),indentLine:methodOp(function(n,dir,aggressive){"string"!=typeof dir&&"number"!=typeof dir&&(dir=null==dir?this.options.smartIndent?"smart":"prev":dir?"add":"subtract"),isLine(this.doc,n)&&indentLine(this,n,dir,aggressive)}),indentSelection:methodOp(function(how){for(var ranges=this.doc.sel.ranges,end=-1,i=0;i<ranges.length;i++){var range=ranges[i];if(range.empty())range.head.line>end&&(indentLine(this,range.head.line,how,!0),end=range.head.line,i==this.doc.sel.primIndex&&ensureCursorVisible(this));else{var from=range.from(),to=range.to(),start=Math.max(end,from.line);end=Math.min(this.lastLine(),to.line-(to.ch?0:1))+1;for(var j=start;j<end;++j)indentLine(this,j,how);var newRanges=this.doc.sel.ranges;0==from.ch&&ranges.length==newRanges.length&&newRanges[i].from().ch>0&&replaceOneSelection(this.doc,i,new Range(from,newRanges[i].to()),sel_dontScroll)}}}),getTokenAt:function(pos,precise){return takeToken(this,pos,precise)},getLineTokens:function(line,precise){return takeToken(this,Pos(line),precise,!0)},getTokenTypeAt:function(pos){pos=clipPos(this.doc,pos);var type,styles=getLineStyles(this,getLine(this.doc,pos.line)),before=0,after=(styles.length-1)/2,ch=pos.ch;if(0==ch)type=styles[2];else for(;;){var mid=before+after>>1;if((mid?styles[2*mid-1]:0)>=ch)after=mid;else{if(!(styles[2*mid+1]<ch)){type=styles[2*mid+2];break}before=mid+1}}var cut=type?type.indexOf("overlay "):-1;return cut<0?type:0==cut?null:type.slice(0,cut-1)},getModeAt:function(pos){var mode=this.doc.mode;return mode.innerMode?CodeMirror.innerMode(mode,this.getTokenAt(pos).state).mode:mode},getHelper:function(pos,type){return this.getHelpers(pos,type)[0]},getHelpers:function(pos,type){var found=[];if(!helpers.hasOwnProperty(type))return found;var help=helpers[type],mode=this.getModeAt(pos);if("string"==typeof mode[type])help[mode[type]]&&found.push(help[mode[type]]);else if(mode[type])for(var i=0;i<mode[type].length;i++){var val=help[mode[type][i]];val&&found.push(val)}else mode.helperType&&help[mode.helperType]?found.push(help[mode.helperType]):help[mode.name]&&found.push(help[mode.name]);for(var i$1=0;i$1<help._global.length;i$1++){var cur=help._global[i$1];cur.pred(mode,this)&&-1==indexOf(found,cur.val)&&found.push(cur.val)}return found},getStateAfter:function(line,precise){var doc=this.doc;return getContextBefore(this,(line=clipLine(doc,null==line?doc.first+doc.size-1:line))+1,precise).state},cursorCoords:function(start,mode){var range=this.doc.sel.primary();return cursorCoords(this,null==start?range.head:"object"==typeof start?clipPos(this.doc,start):start?range.from():range.to(),mode||"page")},charCoords:function(pos,mode){return charCoords(this,clipPos(this.doc,pos),mode||"page")},coordsChar:function(coords,mode){return coordsChar(this,(coords=fromCoordSystem(this,coords,mode||"page")).left,coords.top)},lineAtHeight:function(height,mode){return height=fromCoordSystem(this,{top:height,left:0},mode||"page").top,lineAtHeight(this.doc,height+this.display.viewOffset)},heightAtLine:function(line,mode,includeWidgets){var lineObj,end=!1;if("number"==typeof line){var last=this.doc.first+this.doc.size-1;line<this.doc.first?line=this.doc.first:line>last&&(line=last,end=!0),lineObj=getLine(this.doc,line)}else lineObj=line;return intoCoordSystem(this,lineObj,{top:0,left:0},mode||"page",includeWidgets||end).top+(end?this.doc.height-heightAtLine(lineObj):0)},defaultTextHeight:function(){return textHeight(this.display)},defaultCharWidth:function(){return charWidth(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(pos,node,scroll,vert,horiz){var cm,rect,scrollPos,display=this.display,top=(pos=cursorCoords(this,clipPos(this.doc,pos))).bottom,left=pos.left;if(node.style.position="absolute",node.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(node),display.sizer.appendChild(node),"over"==vert)top=pos.top;else if("above"==vert||"near"==vert){var vspace=Math.max(display.wrapper.clientHeight,this.doc.height),hspace=Math.max(display.sizer.clientWidth,display.lineSpace.clientWidth);("above"==vert||pos.bottom+node.offsetHeight>vspace)&&pos.top>node.offsetHeight?top=pos.top-node.offsetHeight:pos.bottom+node.offsetHeight<=vspace&&(top=pos.bottom),left+node.offsetWidth>hspace&&(left=hspace-node.offsetWidth)}node.style.top=top+"px",node.style.left=node.style.right="","right"==horiz?(left=display.sizer.clientWidth-node.offsetWidth,node.style.right="0px"):("left"==horiz?left=0:"middle"==horiz&&(left=(display.sizer.clientWidth-node.offsetWidth)/2),node.style.left=left+"px"),scroll&&(cm=this,rect={left:left,top:top,right:left+node.offsetWidth,bottom:top+node.offsetHeight},null!=(scrollPos=calculateScrollPos(cm,rect)).scrollTop&&updateScrollTop(cm,scrollPos.scrollTop),null!=scrollPos.scrollLeft&&setScrollLeft(cm,scrollPos.scrollLeft))},triggerOnKeyDown:methodOp(onKeyDown),triggerOnKeyPress:methodOp(onKeyPress),triggerOnKeyUp:onKeyUp,triggerOnMouseDown:methodOp(onMouseDown),execCommand:function(cmd){if(commands.hasOwnProperty(cmd))return commands[cmd].call(null,this)},triggerElectric:methodOp(function(text){triggerElectric(this,text)}),findPosH:function(from,amount,unit,visually){var dir=1;amount<0&&(dir=-1,amount=-amount);for(var cur=clipPos(this.doc,from),i=0;i<amount&&!(cur=findPosH(this.doc,cur,dir,unit,visually)).hitSide;++i);return cur},moveH:methodOp(function(dir,unit){var this$1=this;this.extendSelectionsBy(function(range){return this$1.display.shift||this$1.doc.extend||range.empty()?findPosH(this$1.doc,range.head,dir,unit,this$1.options.rtlMoveVisually):dir<0?range.from():range.to()},sel_move)}),deleteH:methodOp(function(dir,unit){var sel=this.doc.sel,doc=this.doc;sel.somethingSelected()?doc.replaceSelection("",null,"+delete"):deleteNearSelection(this,function(range){var other=findPosH(doc,range.head,dir,unit,!1);return dir<0?{from:other,to:range.head}:{from:range.head,to:other}})}),findPosV:function(from,amount,unit,goalColumn){var dir=1,x=goalColumn;amount<0&&(dir=-1,amount=-amount);for(var cur=clipPos(this.doc,from),i=0;i<amount;++i){var coords=cursorCoords(this,cur,"div");if(null==x?x=coords.left:coords.left=x,(cur=findPosV(this,coords,dir,unit)).hitSide)break}return cur},moveV:methodOp(function(dir,unit){var this$1=this,doc=this.doc,goals=[],collapse=!this.display.shift&&!doc.extend&&doc.sel.somethingSelected();if(doc.extendSelectionsBy(function(range){if(collapse)return dir<0?range.from():range.to();var headPos=cursorCoords(this$1,range.head,"div");null!=range.goalColumn&&(headPos.left=range.goalColumn),goals.push(headPos.left);var pos=findPosV(this$1,headPos,dir,unit);return"page"==unit&&range==doc.sel.primary()&&addToScrollTop(this$1,charCoords(this$1,pos,"div").top-headPos.top),pos},sel_move),goals.length)for(var i=0;i<doc.sel.ranges.length;i++)doc.sel.ranges[i].goalColumn=goals[i]}),findWordAt:function(pos){var line=getLine(this.doc,pos.line).text,start=pos.ch,end=pos.ch;if(line){var helper=this.getHelper(pos,"wordChars");"before"!=pos.sticky&&end!=line.length||!start?++end:--start;for(var startChar=line.charAt(start),check=isWordChar(startChar,helper)?function(ch){return isWordChar(ch,helper)}:/\s/.test(startChar)?function(ch){return/\s/.test(ch)}:function(ch){return!/\s/.test(ch)&&!isWordChar(ch)};start>0&&check(line.charAt(start-1));)--start;for(;end<line.length&&check(line.charAt(end));)++end}return new Range(Pos(pos.line,start),Pos(pos.line,end))},toggleOverwrite:function(value){null!=value&&value==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?addClass(this.display.cursorDiv,"CodeMirror-overwrite"):rmClass(this.display.cursorDiv,"CodeMirror-overwrite"),signal(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==activeElt()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:methodOp(function(x,y){scrollToCoords(this,x,y)}),getScrollInfo:function(){var scroller=this.display.scroller;return{left:scroller.scrollLeft,top:scroller.scrollTop,height:scroller.scrollHeight-scrollGap(this)-this.display.barHeight,width:scroller.scrollWidth-scrollGap(this)-this.display.barWidth,clientHeight:displayHeight(this),clientWidth:displayWidth(this)}},scrollIntoView:methodOp(function(range,margin){null==range?(range={from:this.doc.sel.primary().head,to:null},null==margin&&(margin=this.options.cursorScrollMargin)):"number"==typeof range?range={from:Pos(range,0),to:null}:null==range.from&&(range={from:range,to:null}),range.to||(range.to=range.from),range.margin=margin||0,null!=range.from.line?function(cm,range){resolveScrollToPos(cm),cm.curOp.scrollToPos=range}(this,range):scrollToCoordsRange(this,range.from,range.to,range.margin)}),setSize:methodOp(function(width,height){var this$1=this,interpret=function(val){return"number"==typeof val||/^\d+$/.test(String(val))?val+"px":val};null!=width&&(this.display.wrapper.style.width=interpret(width)),null!=height&&(this.display.wrapper.style.height=interpret(height)),this.options.lineWrapping&&clearLineMeasurementCache(this);var lineNo=this.display.viewFrom;this.doc.iter(lineNo,this.display.viewTo,function(line){if(line.widgets)for(var i=0;i<line.widgets.length;i++)if(line.widgets[i].noHScroll){regLineChange(this$1,lineNo,"widget");break}++lineNo}),this.curOp.forceUpdate=!0,signal(this,"refresh",this)}),operation:function(f){return runInOp(this,f)},startOperation:function(){return startOperation(this)},endOperation:function(){return endOperation(this)},refresh:methodOp(function(){var oldHeight=this.display.cachedTextHeight;regChange(this),this.curOp.forceUpdate=!0,clearCaches(this),scrollToCoords(this,this.doc.scrollLeft,this.doc.scrollTop),updateGutterSpace(this.display),(null==oldHeight||Math.abs(oldHeight-textHeight(this.display))>.5||this.options.lineWrapping)&&estimateLineHeights(this),signal(this,"refresh",this)}),swapDoc:methodOp(function(doc){var old=this.doc;return old.cm=null,this.state.selectingText&&this.state.selectingText(),attachDoc(this,doc),clearCaches(this),this.display.input.reset(),scrollToCoords(this,doc.scrollLeft,doc.scrollTop),this.curOp.forceScroll=!0,signalLater(this,"swapDoc",this,old),old}),phrase:function(phraseText){var phrases=this.options.phrases;return phrases&&Object.prototype.hasOwnProperty.call(phrases,phraseText)?phrases[phraseText]:phraseText},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},eventMixin(CodeMirror),CodeMirror.registerHelper=function(type,name,value){helpers.hasOwnProperty(type)||(helpers[type]=CodeMirror[type]={_global:[]}),helpers[type][name]=value},CodeMirror.registerGlobalHelper=function(type,name,predicate,value){CodeMirror.registerHelper(type,name,value),helpers[type]._global.push({pred:predicate,val:value})}}(CodeMirror);var dontDelegate="iter insert remove copy getEditor constructor".split(" ");for(var prop in Doc.prototype)Doc.prototype.hasOwnProperty(prop)&&indexOf(dontDelegate,prop)<0&&(CodeMirror.prototype[prop]=function(method){return function(){return method.apply(this.doc,arguments)}}(Doc.prototype[prop]));return eventMixin(Doc),CodeMirror.inputStyles={textarea:TextareaInput,contenteditable:ContentEditableInput},CodeMirror.defineMode=function(name){CodeMirror.defaults.mode||"null"==name||(CodeMirror.defaults.mode=name),function(name,mode){arguments.length>2&&(mode.dependencies=Array.prototype.slice.call(arguments,2)),modes[name]=mode}.apply(this,arguments)},CodeMirror.defineMIME=function(mime,spec){mimeModes[mime]=spec},CodeMirror.defineMode("null",function(){return{token:function(stream){return stream.skipToEnd()}}}),CodeMirror.defineMIME("text/plain","null"),CodeMirror.defineExtension=function(name,func){CodeMirror.prototype[name]=func},CodeMirror.defineDocExtension=function(name,func){Doc.prototype[name]=func},CodeMirror.fromTextArea=function(textarea,options){if((options=options?copyObj(options):{}).value=textarea.value,!options.tabindex&&textarea.tabIndex&&(options.tabindex=textarea.tabIndex),!options.placeholder&&textarea.placeholder&&(options.placeholder=textarea.placeholder),null==options.autofocus){var hasFocus=activeElt();options.autofocus=hasFocus==textarea||null!=textarea.getAttribute("autofocus")&&hasFocus==document.body}function save(){textarea.value=cm.getValue()}var realSubmit;if(textarea.form&&(on(textarea.form,"submit",save),!options.leaveSubmitMethodAlone)){var form=textarea.form;realSubmit=form.submit;try{var wrappedSubmit=form.submit=function(){save(),form.submit=realSubmit,form.submit(),form.submit=wrappedSubmit}}catch(e){}}options.finishInit=function(cm){cm.save=save,cm.getTextArea=function(){return textarea},cm.toTextArea=function(){cm.toTextArea=isNaN,save(),textarea.parentNode.removeChild(cm.getWrapperElement()),textarea.style.display="",textarea.form&&(off(textarea.form,"submit",save),options.leaveSubmitMethodAlone||"function"!=typeof textarea.form.submit||(textarea.form.submit=realSubmit))}},textarea.style.display="none";var cm=CodeMirror(function(node){return textarea.parentNode.insertBefore(node,textarea.nextSibling)},options);return cm},function(CodeMirror){CodeMirror.off=off,CodeMirror.on=on,CodeMirror.wheelEventPixels=wheelEventPixels,CodeMirror.Doc=Doc,CodeMirror.splitLines=splitLinesAuto,CodeMirror.countColumn=countColumn,CodeMirror.findColumn=findColumn,CodeMirror.isWordChar=isWordCharBasic,CodeMirror.Pass=Pass,CodeMirror.signal=signal,CodeMirror.Line=Line,CodeMirror.changeEnd=changeEnd,CodeMirror.scrollbarModel=scrollbarModel,CodeMirror.Pos=Pos,CodeMirror.cmpPos=cmp,CodeMirror.modes=modes,CodeMirror.mimeModes=mimeModes,CodeMirror.resolveMode=resolveMode,CodeMirror.getMode=getMode,CodeMirror.modeExtensions=modeExtensions,CodeMirror.extendMode=extendMode,CodeMirror.copyState=copyState,CodeMirror.startState=startState,CodeMirror.innerMode=innerMode,CodeMirror.commands=commands,CodeMirror.keyMap=keyMap,CodeMirror.keyName=keyName,CodeMirror.isModifierKey=isModifierKey,CodeMirror.lookupKey=lookupKey,CodeMirror.normalizeKeyMap=normalizeKeyMap,CodeMirror.StringStream=StringStream,CodeMirror.SharedTextMarker=SharedTextMarker,CodeMirror.TextMarker=TextMarker,CodeMirror.LineWidget=LineWidget,CodeMirror.e_preventDefault=e_preventDefault,CodeMirror.e_stopPropagation=e_stopPropagation,CodeMirror.e_stop=e_stop,CodeMirror.addClass=addClass,CodeMirror.contains=contains,CodeMirror.rmClass=rmClass,CodeMirror.keyNames=keyNames}(CodeMirror),CodeMirror.version="5.57.0",CodeMirror}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){var ie_lt8=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),Pos=CodeMirror.Pos,matching={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function bracketRegex(config){return config&&config.bracketRegex||/[(){}[\]]/}function findMatchingBracket(cm,where,config){var line=cm.getLineHandle(where.line),pos=where.ch-1,afterCursor=config&&config.afterCursor;null==afterCursor&&(afterCursor=/(^| )cm-fat-cursor($| )/.test(cm.getWrapperElement().className));var re=bracketRegex(config),match=!afterCursor&&pos>=0&&re.test(line.text.charAt(pos))&&matching[line.text.charAt(pos)]||re.test(line.text.charAt(pos+1))&&matching[line.text.charAt(++pos)];if(!match)return null;var dir=">"==match.charAt(1)?1:-1;if(config&&config.strict&&dir>0!=(pos==where.ch))return null;var style=cm.getTokenTypeAt(Pos(where.line,pos+1)),found=scanForBracket(cm,Pos(where.line,pos+(dir>0?1:0)),dir,style||null,config);return null==found?null:{from:Pos(where.line,pos),to:found&&found.pos,match:found&&found.ch==match.charAt(0),forward:dir>0}}function scanForBracket(cm,where,dir,style,config){for(var maxScanLen=config&&config.maxScanLineLength||1e4,maxScanLines=config&&config.maxScanLines||1e3,stack=[],re=bracketRegex(config),lineEnd=dir>0?Math.min(where.line+maxScanLines,cm.lastLine()+1):Math.max(cm.firstLine()-1,where.line-maxScanLines),lineNo=where.line;lineNo!=lineEnd;lineNo+=dir){var line=cm.getLine(lineNo);if(line){var pos=dir>0?0:line.length-1,end=dir>0?line.length:-1;if(!(line.length>maxScanLen))for(lineNo==where.line&&(pos=where.ch-(dir<0?1:0));pos!=end;pos+=dir){var ch=line.charAt(pos);if(re.test(ch)&&(void 0===style||cm.getTokenTypeAt(Pos(lineNo,pos+1))==style)){var match=matching[ch];if(match&&">"==match.charAt(1)==dir>0)stack.push(ch);else{if(!stack.length)return{pos:Pos(lineNo,pos),ch:ch};stack.pop()}}}}}return lineNo-dir!=(dir>0?cm.lastLine():cm.firstLine())&&null}function matchBrackets(cm,autoclear,config){for(var maxHighlightLen=cm.state.matchBrackets.maxHighlightLineLength||1e3,marks=[],ranges=cm.listSelections(),i=0;i<ranges.length;i++){var match=ranges[i].empty()&&findMatchingBracket(cm,ranges[i].head,config);if(match&&cm.getLine(match.from.line).length<=maxHighlightLen){var style=match.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";marks.push(cm.markText(match.from,Pos(match.from.line,match.from.ch+1),{className:style})),match.to&&cm.getLine(match.to.line).length<=maxHighlightLen&&marks.push(cm.markText(match.to,Pos(match.to.line,match.to.ch+1),{className:style}))}}if(marks.length){ie_lt8&&cm.state.focused&&cm.focus();var clear=function(){cm.operation(function(){for(var i=0;i<marks.length;i++)marks[i].clear()})};if(!autoclear)return clear;setTimeout(clear,800)}}function doMatchBrackets(cm){cm.operation(function(){cm.state.matchBrackets.currentlyHighlighted&&(cm.state.matchBrackets.currentlyHighlighted(),cm.state.matchBrackets.currentlyHighlighted=null),cm.state.matchBrackets.currentlyHighlighted=matchBrackets(cm,!1,cm.state.matchBrackets)})}CodeMirror.defineOption("matchBrackets",!1,function(cm,val,old){function clear(cm){cm.state.matchBrackets&&cm.state.matchBrackets.currentlyHighlighted&&(cm.state.matchBrackets.currentlyHighlighted(),cm.state.matchBrackets.currentlyHighlighted=null)}old&&old!=CodeMirror.Init&&(cm.off("cursorActivity",doMatchBrackets),cm.off("focus",doMatchBrackets),cm.off("blur",clear),clear(cm)),val&&(cm.state.matchBrackets="object"==typeof val?val:{},cm.on("cursorActivity",doMatchBrackets),cm.on("focus",doMatchBrackets),cm.on("blur",clear))}),CodeMirror.defineExtension("matchBrackets",function(){matchBrackets(this,!0)}),CodeMirror.defineExtension("findMatchingBracket",function(pos,config,oldConfig){return(oldConfig||"boolean"==typeof config)&&(oldConfig?(oldConfig.strict=config,config=oldConfig):config=config?{strict:!0}:null),findMatchingBracket(this,pos,config)}),CodeMirror.defineExtension("scanForBracket",function(pos,dir,style,config){return scanForBracket(this,pos,dir,style,config)})}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){var defaults={pairs:"()[]{}''\"\"",closeBefore:")]}'\":;>",triples:"",explode:"[]{}"},Pos=CodeMirror.Pos;function getOption(conf,name){return"pairs"==name&&"string"==typeof conf?conf:"object"==typeof conf&&null!=conf[name]?conf[name]:defaults[name]}CodeMirror.defineOption("autoCloseBrackets",!1,function(cm,val,old){old&&old!=CodeMirror.Init&&(cm.removeKeyMap(keyMap),cm.state.closeBrackets=null),val&&(ensureBound(getOption(val,"pairs")),cm.state.closeBrackets=val,cm.addKeyMap(keyMap))});var keyMap={Backspace:function(cm){var conf=getConfig(cm);if(!conf||cm.getOption("disableInput"))return CodeMirror.Pass;for(var pairs=getOption(conf,"pairs"),ranges=cm.listSelections(),i=0;i<ranges.length;i++){if(!ranges[i].empty())return CodeMirror.Pass;var around=charsAround(cm,ranges[i].head);if(!around||pairs.indexOf(around)%2!=0)return CodeMirror.Pass}for(var i=ranges.length-1;i>=0;i--){var cur=ranges[i].head;cm.replaceRange("",Pos(cur.line,cur.ch-1),Pos(cur.line,cur.ch+1),"+delete")}},Enter:function(cm){var conf=getConfig(cm),explode=conf&&getOption(conf,"explode");if(!explode||cm.getOption("disableInput"))return CodeMirror.Pass;for(var ranges=cm.listSelections(),i=0;i<ranges.length;i++){if(!ranges[i].empty())return CodeMirror.Pass;var around=charsAround(cm,ranges[i].head);if(!around||explode.indexOf(around)%2!=0)return CodeMirror.Pass}cm.operation(function(){var linesep=cm.lineSeparator()||"\n";cm.replaceSelection(linesep+linesep,null),cm.execCommand("goCharLeft"),ranges=cm.listSelections();for(var i=0;i<ranges.length;i++){var line=ranges[i].head.line;cm.indentLine(line,null,!0),cm.indentLine(line+1,null,!0)}})}};function ensureBound(chars){for(var i=0;i<chars.length;i++){var ch=chars.charAt(i),key="'"+ch+"'";keyMap[key]||(keyMap[key]=handler(ch))}}function handler(ch){return function(cm){return function(cm,ch){var conf=getConfig(cm);if(!conf||cm.getOption("disableInput"))return CodeMirror.Pass;var pairs=getOption(conf,"pairs"),pos=pairs.indexOf(ch);if(-1==pos)return CodeMirror.Pass;for(var type,closeBefore=getOption(conf,"closeBefore"),triples=getOption(conf,"triples"),identical=pairs.charAt(pos+1)==ch,ranges=cm.listSelections(),opening=pos%2==0,i=0;i<ranges.length;i++){var curType,range=ranges[i],cur=range.head,next=cm.getRange(cur,Pos(cur.line,cur.ch+1));if(opening&&!range.empty())curType="surround";else if(!identical&&opening||next!=ch)if(identical&&cur.ch>1&&triples.indexOf(ch)>=0&&cm.getRange(Pos(cur.line,cur.ch-2),cur)==ch+ch){if(cur.ch>2&&/\bstring/.test(cm.getTokenTypeAt(Pos(cur.line,cur.ch-2))))return CodeMirror.Pass;curType="addFour"}else if(identical){var prev=0==cur.ch?" ":cm.getRange(Pos(cur.line,cur.ch-1),cur);if(CodeMirror.isWordChar(next)||prev==ch||CodeMirror.isWordChar(prev))return CodeMirror.Pass;curType="both"}else{if(!opening||!(0===next.length||/\s/.test(next)||closeBefore.indexOf(next)>-1))return CodeMirror.Pass;curType="both"}else curType=identical&&stringStartsAfter(cm,cur)?"both":triples.indexOf(ch)>=0&&cm.getRange(cur,Pos(cur.line,cur.ch+3))==ch+ch+ch?"skipThree":"skip";if(type){if(type!=curType)return CodeMirror.Pass}else type=curType}var left=pos%2?pairs.charAt(pos-1):ch,right=pos%2?ch:pairs.charAt(pos+1);cm.operation(function(){if("skip"==type)cm.execCommand("goCharRight");else if("skipThree"==type)for(var i=0;i<3;i++)cm.execCommand("goCharRight");else if("surround"==type){for(var sels=cm.getSelections(),i=0;i<sels.length;i++)sels[i]=left+sels[i]+right;cm.replaceSelections(sels,"around"),sels=cm.listSelections().slice();for(var i=0;i<sels.length;i++)sels[i]=(sel=sels[i],void 0,inverted=CodeMirror.cmpPos(sel.anchor,sel.head)>0,{anchor:new Pos(sel.anchor.line,sel.anchor.ch+(inverted?-1:1)),head:new Pos(sel.head.line,sel.head.ch+(inverted?1:-1))});cm.setSelections(sels)}else"both"==type?(cm.replaceSelection(left+right,null),cm.triggerElectric(left+right),cm.execCommand("goCharLeft")):"addFour"==type&&(cm.replaceSelection(left+left+left+left,"before"),cm.execCommand("goCharRight"));var sel,inverted})}(cm,ch)}}function getConfig(cm){var deflt=cm.state.closeBrackets;return!deflt||deflt.override?deflt:cm.getModeAt(cm.getCursor()).closeBrackets||deflt}function charsAround(cm,pos){var str=cm.getRange(Pos(pos.line,pos.ch-1),Pos(pos.line,pos.ch+1));return 2==str.length?str:null}function stringStartsAfter(cm,pos){var token=cm.getTokenAt(Pos(pos.line,pos.ch+1));return/\bstring/.test(token.type)&&token.start==pos.ch&&(0==pos.ch||!/\bstring/.test(cm.getTokenTypeAt(pos)))}ensureBound(defaults.pairs+"`")}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function doFold(cm,pos,options,force){if(options&&options.call){var finder=options;options=null}else finder=getOption(cm,options,"rangeFinder");"number"==typeof pos&&(pos=CodeMirror.Pos(pos,0));var minSize=getOption(cm,options,"minFoldSize");function getRange(allowFolded){var range=finder(cm,pos);if(!range||range.to.line-range.from.line<minSize)return null;for(var marks=cm.findMarksAt(range.from),i=0;i<marks.length;++i)if(marks[i].__isFold&&"fold"!==force){if(!allowFolded)return null;range.cleared=!0,marks[i].clear()}return range}var range=getRange(!0);if(getOption(cm,options,"scanUp"))for(;!range&&pos.line>cm.firstLine();)pos=CodeMirror.Pos(pos.line-1,0),range=getRange(!1);if(range&&!range.cleared&&"unfold"!==force){var myWidget=function(cm,options,range){var widget=getOption(cm,options,"widget");"function"==typeof widget&&(widget=widget(range.from,range.to));if("string"==typeof widget){var text=document.createTextNode(widget);(widget=document.createElement("span")).appendChild(text),widget.className="CodeMirror-foldmarker"}else widget&&(widget=widget.cloneNode(!0));return widget}(cm,options,range);CodeMirror.on(myWidget,"mousedown",function(e){myRange.clear(),CodeMirror.e_preventDefault(e)});var myRange=cm.markText(range.from,range.to,{replacedWith:myWidget,clearOnEnter:getOption(cm,options,"clearOnEnter"),__isFold:!0});myRange.on("clear",function(from,to){CodeMirror.signal(cm,"unfold",cm,from,to)}),CodeMirror.signal(cm,"fold",cm,range.from,range.to)}}CodeMirror.newFoldFunction=function(rangeFinder,widget){return function(cm,pos){doFold(cm,pos,{rangeFinder:rangeFinder,widget:widget})}},CodeMirror.defineExtension("foldCode",function(pos,options,force){doFold(this,pos,options,force)}),CodeMirror.defineExtension("isFolded",function(pos){for(var marks=this.findMarksAt(pos),i=0;i<marks.length;++i)if(marks[i].__isFold)return!0}),CodeMirror.commands.toggleFold=function(cm){cm.foldCode(cm.getCursor())},CodeMirror.commands.fold=function(cm){cm.foldCode(cm.getCursor(),null,"fold")},CodeMirror.commands.unfold=function(cm){cm.foldCode(cm.getCursor(),null,"unfold")},CodeMirror.commands.foldAll=function(cm){cm.operation(function(){for(var i=cm.firstLine(),e=cm.lastLine();i<=e;i++)cm.foldCode(CodeMirror.Pos(i,0),null,"fold")})},CodeMirror.commands.unfoldAll=function(cm){cm.operation(function(){for(var i=cm.firstLine(),e=cm.lastLine();i<=e;i++)cm.foldCode(CodeMirror.Pos(i,0),null,"unfold")})},CodeMirror.registerHelper("fold","combine",function(){var funcs=Array.prototype.slice.call(arguments,0);return function(cm,start){for(var i=0;i<funcs.length;++i){var found=funcs[i](cm,start);if(found)return found}}}),CodeMirror.registerHelper("fold","auto",function(cm,start){for(var helpers=cm.getHelpers(start,"fold"),i=0;i<helpers.length;i++){var cur=helpers[i](cm,start);if(cur)return cur}});var defaultOptions={rangeFinder:CodeMirror.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1,clearOnEnter:!0};function getOption(cm,options,name){if(options&&void 0!==options[name])return options[name];var editorOptions=cm.options.foldOptions;return editorOptions&&void 0!==editorOptions[name]?editorOptions[name]:defaultOptions[name]}CodeMirror.defineOption("foldOptions",null),CodeMirror.defineExtension("foldOption",function(options,name){return getOption(this,options,name)})}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.defineOption("foldGutter",!1,function(cm,val,old){old&&old!=CodeMirror.Init&&(cm.clearGutter(cm.state.foldGutter.options.gutter),cm.state.foldGutter=null,cm.off("gutterClick",onGutterClick),cm.off("changes",onChange),cm.off("viewportChange",onViewportChange),cm.off("fold",onFold),cm.off("unfold",onFold),cm.off("swapDoc",onChange)),val&&(cm.state.foldGutter=new function(options){this.options=options,this.from=this.to=0}(function(opts){!0===opts&&(opts={});null==opts.gutter&&(opts.gutter="CodeMirror-foldgutter");null==opts.indicatorOpen&&(opts.indicatorOpen="CodeMirror-foldgutter-open");null==opts.indicatorFolded&&(opts.indicatorFolded="CodeMirror-foldgutter-folded");return opts}(val)),updateInViewport(cm),cm.on("gutterClick",onGutterClick),cm.on("changes",onChange),cm.on("viewportChange",onViewportChange),cm.on("fold",onFold),cm.on("unfold",onFold),cm.on("swapDoc",onChange))});var Pos=CodeMirror.Pos;function isFolded(cm,line){for(var marks=cm.findMarks(Pos(line,0),Pos(line+1,0)),i=0;i<marks.length;++i)if(marks[i].__isFold){var fromPos=marks[i].find(-1);if(fromPos&&fromPos.line===line)return marks[i]}}function marker(spec){if("string"==typeof spec){var elt=document.createElement("div");return elt.className=spec+" CodeMirror-guttermarker-subtle",elt}return spec.cloneNode(!0)}function updateFoldInfo(cm,from,to){var opts=cm.state.foldGutter.options,cur=from-1,minSize=cm.foldOption(opts,"minFoldSize"),func=cm.foldOption(opts,"rangeFinder"),clsFolded="string"==typeof opts.indicatorFolded&&classTest(opts.indicatorFolded),clsOpen="string"==typeof opts.indicatorOpen&&classTest(opts.indicatorOpen);cm.eachLine(from,to,function(line){++cur;var mark=null,old=line.gutterMarkers;if(old&&(old=old[opts.gutter]),isFolded(cm,cur)){if(clsFolded&&old&&clsFolded.test(old.className))return;mark=marker(opts.indicatorFolded)}else{var pos=Pos(cur,0),range=func&&func(cm,pos);if(range&&range.to.line-range.from.line>=minSize){if(clsOpen&&old&&clsOpen.test(old.className))return;mark=marker(opts.indicatorOpen)}}(mark||old)&&cm.setGutterMarker(line,opts.gutter,mark)})}function classTest(cls){return new RegExp("(^|\\s)"+cls+"(?:$|\\s)\\s*")}function updateInViewport(cm){var vp=cm.getViewport(),state=cm.state.foldGutter;state&&(cm.operation(function(){updateFoldInfo(cm,vp.from,vp.to)}),state.from=vp.from,state.to=vp.to)}function onGutterClick(cm,line,gutter){var state=cm.state.foldGutter;if(state){var opts=state.options;if(gutter==opts.gutter){var folded=isFolded(cm,line);folded?folded.clear():cm.foldCode(Pos(line,0),opts)}}}function onChange(cm){var state=cm.state.foldGutter;if(state){var opts=state.options;state.from=state.to=0,clearTimeout(state.changeUpdate),state.changeUpdate=setTimeout(function(){updateInViewport(cm)},opts.foldOnChangeTimeSpan||600)}}function onViewportChange(cm){var state=cm.state.foldGutter;if(state){var opts=state.options;clearTimeout(state.changeUpdate),state.changeUpdate=setTimeout(function(){var vp=cm.getViewport();state.from==state.to||vp.from-state.to>20||state.from-vp.to>20?updateInViewport(cm):cm.operation(function(){vp.from<state.from&&(updateFoldInfo(cm,vp.from,state.from),state.from=vp.from),vp.to>state.to&&(updateFoldInfo(cm,state.to,vp.to),state.to=vp.to)})},opts.updateViewportTimeSpan||400)}}function onFold(cm,from){var state=cm.state.foldGutter;if(state){var line=from.line;line>=state.from&&line<state.to&&updateFoldInfo(cm,line,line+1)}}}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.registerHelper("fold","brace",function(cm,start){var tokenType,line=start.line,lineText=cm.getLine(line);function findOpening(openCh){for(var at=start.ch,pass=0;;){var found=at<=0?-1:lineText.lastIndexOf(openCh,at-1);if(-1!=found){if(1==pass&&found<start.ch)break;if(tokenType=cm.getTokenTypeAt(CodeMirror.Pos(line,found+1)),!/^(comment|string)/.test(tokenType))return found+1;at=found-1}else{if(1==pass)break;pass=1,at=lineText.length}}}var startToken="{",endToken="}",startCh=findOpening("{");if(null==startCh&&(startToken="[",endToken="]",startCh=findOpening("[")),null!=startCh){var end,endCh,count=1,lastLine=cm.lastLine();outer:for(var i=line;i<=lastLine;++i)for(var text=cm.getLine(i),pos=i==line?startCh:0;;){var nextOpen=text.indexOf(startToken,pos),nextClose=text.indexOf(endToken,pos);if(nextOpen<0&&(nextOpen=text.length),nextClose<0&&(nextClose=text.length),(pos=Math.min(nextOpen,nextClose))==text.length)break;if(cm.getTokenTypeAt(CodeMirror.Pos(i,pos+1))==tokenType)if(pos==nextOpen)++count;else if(!--count){end=i,endCh=pos;break outer}++pos}if(null!=end&&line!=end)return{from:CodeMirror.Pos(line,startCh),to:CodeMirror.Pos(end,endCh)}}}),CodeMirror.registerHelper("fold","import",function(cm,start){function hasImport(line){if(line<cm.firstLine()||line>cm.lastLine())return null;var start=cm.getTokenAt(CodeMirror.Pos(line,1));if(/\S/.test(start.string)||(start=cm.getTokenAt(CodeMirror.Pos(line,start.end+1))),"keyword"!=start.type||"import"!=start.string)return null;for(var i=line,e=Math.min(cm.lastLine(),line+10);i<=e;++i){var semi=cm.getLine(i).indexOf(";");if(-1!=semi)return{startCh:start.end,end:CodeMirror.Pos(i,semi)}}}var prev,startLine=start.line,has=hasImport(startLine);if(!has||hasImport(startLine-1)||(prev=hasImport(startLine-2))&&prev.end.line==startLine-1)return null;for(var end=has.end;;){var next=hasImport(end.line+1);if(null==next)break;end=next.end}return{from:cm.clipPos(CodeMirror.Pos(startLine,has.startCh+1)),to:end}}),CodeMirror.registerHelper("fold","include",function(cm,start){function hasInclude(line){if(line<cm.firstLine()||line>cm.lastLine())return null;var start=cm.getTokenAt(CodeMirror.Pos(line,1));return/\S/.test(start.string)||(start=cm.getTokenAt(CodeMirror.Pos(line,start.end+1))),"meta"==start.type&&"#include"==start.string.slice(0,8)?start.start+8:void 0}var startLine=start.line,has=hasInclude(startLine);if(null==has||null!=hasInclude(startLine-1))return null;for(var end=startLine;;){if(null==hasInclude(end+1))break;++end}return{from:CodeMirror.Pos(startLine,has+1),to:cm.clipPos(CodeMirror.Pos(end))}})}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function lineIndent(cm,lineNo){var text=cm.getLine(lineNo),spaceTo=text.search(/\S/);return-1==spaceTo||/\bcomment\b/.test(cm.getTokenTypeAt(CodeMirror.Pos(lineNo,spaceTo+1)))?-1:CodeMirror.countColumn(text,null,cm.getOption("tabSize"))}CodeMirror.registerHelper("fold","indent",function(cm,start){var myIndent=lineIndent(cm,start.line);if(!(myIndent<0)){for(var lastLineInFold=null,i=start.line+1,end=cm.lastLine();i<=end;++i){var indent=lineIndent(cm,i);if(-1==indent);else{if(!(indent>myIndent))break;lastLineInFold=i}}return lastLineInFold?{from:CodeMirror.Pos(start.line,cm.getLine(start.line).length),to:CodeMirror.Pos(lastLineInFold,cm.getLine(lastLineInFold).length)}:void 0}})}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";var Pos=CodeMirror.Pos;function cmp(a,b){return a.line-b.line||a.ch-b.ch}var nameStartChar="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",xmlTagStart=new RegExp("<(/?)(["+nameStartChar+"][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*)","g");function Iter(cm,line,ch,range){this.line=line,this.ch=ch,this.cm=cm,this.text=cm.getLine(line),this.min=range?Math.max(range.from,cm.firstLine()):cm.firstLine(),this.max=range?Math.min(range.to-1,cm.lastLine()):cm.lastLine()}function tagAt(iter,ch){var type=iter.cm.getTokenTypeAt(Pos(iter.line,ch));return type&&/\btag\b/.test(type)}function nextLine(iter){if(!(iter.line>=iter.max))return iter.ch=0,iter.text=iter.cm.getLine(++iter.line),!0}function prevLine(iter){if(!(iter.line<=iter.min))return iter.text=iter.cm.getLine(--iter.line),iter.ch=iter.text.length,!0}function toTagEnd(iter){for(;;){var gt=iter.text.indexOf(">",iter.ch);if(-1==gt){if(nextLine(iter))continue;return}if(tagAt(iter,gt+1)){var lastSlash=iter.text.lastIndexOf("/",gt),selfClose=lastSlash>-1&&!/\S/.test(iter.text.slice(lastSlash+1,gt));return iter.ch=gt+1,selfClose?"selfClose":"regular"}iter.ch=gt+1}}function toTagStart(iter){for(;;){var lt=iter.ch?iter.text.lastIndexOf("<",iter.ch-1):-1;if(-1==lt){if(prevLine(iter))continue;return}if(tagAt(iter,lt+1)){xmlTagStart.lastIndex=lt,iter.ch=lt;var match=xmlTagStart.exec(iter.text);if(match&&match.index==lt)return match}else iter.ch=lt}}function toNextTag(iter){for(;;){xmlTagStart.lastIndex=iter.ch;var found=xmlTagStart.exec(iter.text);if(!found){if(nextLine(iter))continue;return}if(tagAt(iter,found.index+1))return iter.ch=found.index+found[0].length,found;iter.ch=found.index+1}}function toPrevTag(iter){for(;;){var gt=iter.ch?iter.text.lastIndexOf(">",iter.ch-1):-1;if(-1==gt){if(prevLine(iter))continue;return}if(tagAt(iter,gt+1)){var lastSlash=iter.text.lastIndexOf("/",gt),selfClose=lastSlash>-1&&!/\S/.test(iter.text.slice(lastSlash+1,gt));return iter.ch=gt+1,selfClose?"selfClose":"regular"}iter.ch=gt}}function findMatchingClose(iter,tag){for(var stack=[];;){var end,next=toNextTag(iter),startLine=iter.line,startCh=iter.ch-(next?next[0].length:0);if(!next||!(end=toTagEnd(iter)))return;if("selfClose"!=end)if(next[1]){for(var i=stack.length-1;i>=0;--i)if(stack[i]==next[2]){stack.length=i;break}if(i<0&&(!tag||tag==next[2]))return{tag:next[2],from:Pos(startLine,startCh),to:Pos(iter.line,iter.ch)}}else stack.push(next[2])}}function findMatchingOpen(iter,tag){for(var stack=[];;){var prev=toPrevTag(iter);if(!prev)return;if("selfClose"!=prev){var endLine=iter.line,endCh=iter.ch,start=toTagStart(iter);if(!start)return;if(start[1])stack.push(start[2]);else{for(var i=stack.length-1;i>=0;--i)if(stack[i]==start[2]){stack.length=i;break}if(i<0&&(!tag||tag==start[2]))return{tag:start[2],from:Pos(iter.line,iter.ch),to:Pos(endLine,endCh)}}}else toTagStart(iter)}}CodeMirror.registerHelper("fold","xml",function(cm,start){for(var iter=new Iter(cm,start.line,0);;){var openTag=toNextTag(iter);if(!openTag||iter.line!=start.line)return;var end=toTagEnd(iter);if(!end)return;if(!openTag[1]&&"selfClose"!=end){var startPos=Pos(iter.line,iter.ch),endPos=findMatchingClose(iter,openTag[2]);return endPos&&cmp(endPos.from,startPos)>0?{from:startPos,to:endPos.from}:null}}}),CodeMirror.findMatchingTag=function(cm,pos,range){var iter=new Iter(cm,pos.line,pos.ch,range);if(-1!=iter.text.indexOf(">")||-1!=iter.text.indexOf("<")){var end=toTagEnd(iter),to=end&&Pos(iter.line,iter.ch),start=end&&toTagStart(iter);if(end&&start&&!(cmp(iter,pos)>0)){var here={from:Pos(iter.line,iter.ch),to:to,tag:start[2]};return"selfClose"==end?{open:here,close:null,at:"open"}:start[1]?{open:findMatchingOpen(iter,start[2]),close:here,at:"close"}:{open:here,close:findMatchingClose(iter=new Iter(cm,to.line,to.ch,range),start[2]),at:"open"}}}},CodeMirror.findEnclosingTag=function(cm,pos,range,tag){for(var iter=new Iter(cm,pos.line,pos.ch,range);;){var open=findMatchingOpen(iter,tag);if(!open)break;var close=findMatchingClose(new Iter(cm,pos.line,pos.ch,range),open.tag);if(close)return{open:open,close:close}}},CodeMirror.scanForClosingTag=function(cm,pos,name,end){return findMatchingClose(new Iter(cm,pos.line,pos.ch,end?{from:0,to:end}:null),name)}}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";CodeMirror.defineMode("javascript",function(config,parserConfig){var type,content,indentUnit=config.indentUnit,statementIndent=parserConfig.statementIndent,jsonldMode=parserConfig.jsonld,jsonMode=parserConfig.json||jsonldMode,isTS=parserConfig.typescript,wordRE=parserConfig.wordCharacters||/[\w$\xa1-\uffff]/,keywords=function(){function kw(type){return{type:type,style:"keyword"}}var A=kw("keyword a"),B=kw("keyword b"),C=kw("keyword c"),D=kw("keyword d"),operator=kw("operator"),atom={type:"atom",style:"atom"};return{if:kw("if"),while:A,with:A,else:B,do:B,try:B,finally:B,return:D,break:D,continue:D,new:kw("new"),delete:C,void:C,throw:C,debugger:kw("debugger"),var:kw("var"),const:kw("var"),let:kw("var"),function:kw("function"),catch:kw("catch"),for:kw("for"),switch:kw("switch"),case:kw("case"),default:kw("default"),in:operator,typeof:operator,instanceof:operator,true:atom,false:atom,null:atom,undefined:atom,NaN:atom,Infinity:atom,this:kw("this"),class:kw("class"),super:kw("atom"),yield:C,export:kw("export"),import:kw("import"),extends:C,await:C}}(),isOperatorChar=/[+\-*&%=<>!?|~^@]/,isJsonldKeyword=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function ret(tp,style,cont){return type=tp,content=cont,style}function tokenBase(stream,state){var quote,ch=stream.next();if('"'==ch||"'"==ch)return state.tokenize=(quote=ch,function(stream,state){var next,escaped=!1;if(jsonldMode&&"@"==stream.peek()&&stream.match(isJsonldKeyword))return state.tokenize=tokenBase,ret("jsonld-keyword","meta");for(;null!=(next=stream.next())&&(next!=quote||escaped);)escaped=!escaped&&"\\"==next;return escaped||(state.tokenize=tokenBase),ret("string","string")}),state.tokenize(stream,state);if("."==ch&&stream.match(/^\d[\d_]*(?:[eE][+\-]?[\d_]+)?/))return ret("number","number");if("."==ch&&stream.match(".."))return ret("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(ch))return ret(ch);if("="==ch&&stream.eat(">"))return ret("=>","operator");if("0"==ch&&stream.match(/^(?:x[\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return ret("number","number");if(/\d/.test(ch))return stream.match(/^[\d_]*(?:n|(?:\.[\d_]*)?(?:[eE][+\-]?[\d_]+)?)?/),ret("number","number");if("/"==ch)return stream.eat("*")?(state.tokenize=tokenComment,tokenComment(stream,state)):stream.eat("/")?(stream.skipToEnd(),ret("comment","comment")):expressionAllowed(stream,state,1)?(function(stream){for(var next,escaped=!1,inSet=!1;null!=(next=stream.next());){if(!escaped){if("/"==next&&!inSet)return;"["==next?inSet=!0:inSet&&"]"==next&&(inSet=!1)}escaped=!escaped&&"\\"==next}}(stream),stream.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),ret("regexp","string-2")):(stream.eat("="),ret("operator","operator",stream.current()));if("`"==ch)return state.tokenize=tokenQuasi,tokenQuasi(stream,state);if("#"==ch&&"!"==stream.peek())return stream.skipToEnd(),ret("meta","meta");if("#"==ch&&stream.eatWhile(wordRE))return ret("variable","property");if("<"==ch&&stream.match("!--")||"-"==ch&&stream.match("->")&&!/\S/.test(stream.string.slice(0,stream.start)))return stream.skipToEnd(),ret("comment","comment");if(isOperatorChar.test(ch))return">"==ch&&state.lexical&&">"==state.lexical.type||(stream.eat("=")?"!"!=ch&&"="!=ch||stream.eat("="):/[<>*+\-]/.test(ch)&&(stream.eat(ch),">"==ch&&stream.eat(ch))),"?"==ch&&stream.eat(".")?ret("."):ret("operator","operator",stream.current());if(wordRE.test(ch)){stream.eatWhile(wordRE);var word=stream.current();if("."!=state.lastType){if(keywords.propertyIsEnumerable(word)){var kw=keywords[word];return ret(kw.type,kw.style,word)}if("async"==word&&stream.match(/^(\s|\/\*.*?\*\/)*[\[\(\w]/,!1))return ret("async","keyword",word)}return ret("variable","variable",word)}}function tokenComment(stream,state){for(var ch,maybeEnd=!1;ch=stream.next();){if("/"==ch&&maybeEnd){state.tokenize=tokenBase;break}maybeEnd="*"==ch}return ret("comment","comment")}function tokenQuasi(stream,state){for(var next,escaped=!1;null!=(next=stream.next());){if(!escaped&&("`"==next||"$"==next&&stream.eat("{"))){state.tokenize=tokenBase;break}escaped=!escaped&&"\\"==next}return ret("quasi","string-2",stream.current())}var brackets="([{}])";function findFatArrow(stream,state){state.fatArrowAt&&(state.fatArrowAt=null);var arrow=stream.string.indexOf("=>",stream.start);if(!(arrow<0)){if(isTS){var m=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(stream.string.slice(stream.start,arrow));m&&(arrow=m.index)}for(var depth=0,sawSomething=!1,pos=arrow-1;pos>=0;--pos){var ch=stream.string.charAt(pos),bracket=brackets.indexOf(ch);if(bracket>=0&&bracket<3){if(!depth){++pos;break}if(0==--depth){"("==ch&&(sawSomething=!0);break}}else if(bracket>=3&&bracket<6)++depth;else if(wordRE.test(ch))sawSomething=!0;else if(/["'\/`]/.test(ch))for(;;--pos){if(0==pos)return;if(stream.string.charAt(pos-1)==ch&&"\\"!=stream.string.charAt(pos-2)){pos--;break}}else if(sawSomething&&!depth){++pos;break}}sawSomething&&!depth&&(state.fatArrowAt=pos)}}var atomicTypes={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0};function JSLexical(indented,column,type,align,prev,info){this.indented=indented,this.column=column,this.type=type,this.prev=prev,this.info=info,null!=align&&(this.align=align)}function inScope(state,varname){for(var v=state.localVars;v;v=v.next)if(v.name==varname)return!0;for(var cx=state.context;cx;cx=cx.prev)for(v=cx.vars;v;v=v.next)if(v.name==varname)return!0}var cx={state:null,column:null,marked:null,cc:null};function pass(){for(var i=arguments.length-1;i>=0;i--)cx.cc.push(arguments[i])}function cont(){return pass.apply(null,arguments),!0}function inList(name,list){for(var v=list;v;v=v.next)if(v.name==name)return!0;return!1}function register(varname){var state=cx.state;if(cx.marked="def",state.context)if("var"==state.lexical.info&&state.context&&state.context.block){var newContext=function registerVarScoped(varname,context){if(context){if(context.block){var inner=registerVarScoped(varname,context.prev);return inner?inner==context.prev?context:new Context(inner,context.vars,!0):null}return inList(varname,context.vars)?context:new Context(context.prev,new Var(varname,context.vars),!1)}return null}(varname,state.context);if(null!=newContext)return void(state.context=newContext)}else if(!inList(varname,state.localVars))return void(state.localVars=new Var(varname,state.localVars));parserConfig.globalVars&&!inList(varname,state.globalVars)&&(state.globalVars=new Var(varname,state.globalVars))}function isModifier(name){return"public"==name||"private"==name||"protected"==name||"abstract"==name||"readonly"==name}function Context(prev,vars,block){this.prev=prev,this.vars=vars,this.block=block}function Var(name,next){this.name=name,this.next=next}var defaultVars=new Var("this",new Var("arguments",null));function pushcontext(){cx.state.context=new Context(cx.state.context,cx.state.localVars,!1),cx.state.localVars=defaultVars}function pushblockcontext(){cx.state.context=new Context(cx.state.context,cx.state.localVars,!0),cx.state.localVars=null}function popcontext(){cx.state.localVars=cx.state.context.vars,cx.state.context=cx.state.context.prev}function pushlex(type,info){var result=function(){var state=cx.state,indent=state.indented;if("stat"==state.lexical.type)indent=state.lexical.indented;else for(var outer=state.lexical;outer&&")"==outer.type&&outer.align;outer=outer.prev)indent=outer.indented;state.lexical=new JSLexical(indent,cx.stream.column(),type,null,state.lexical,info)};return result.lex=!0,result}function poplex(){var state=cx.state;state.lexical.prev&&(")"==state.lexical.type&&(state.indented=state.lexical.indented),state.lexical=state.lexical.prev)}function expect(wanted){return function exp(type){return type==wanted?cont():";"==wanted||"}"==type||")"==type||"]"==type?pass():cont(exp)}}function statement(type,value){return"var"==type?cont(pushlex("vardef",value),vardef,expect(";"),poplex):"keyword a"==type?cont(pushlex("form"),parenExpr,statement,poplex):"keyword b"==type?cont(pushlex("form"),statement,poplex):"keyword d"==type?cx.stream.match(/^\s*$/,!1)?cont():cont(pushlex("stat"),maybeexpression,expect(";"),poplex):"debugger"==type?cont(expect(";")):"{"==type?cont(pushlex("}"),pushblockcontext,block,poplex,popcontext):";"==type?cont():"if"==type?("else"==cx.state.lexical.info&&cx.state.cc[cx.state.cc.length-1]==poplex&&cx.state.cc.pop()(),cont(pushlex("form"),parenExpr,statement,poplex,maybeelse)):"function"==type?cont(functiondef):"for"==type?cont(pushlex("form"),forspec,statement,poplex):"class"==type||isTS&&"interface"==value?(cx.marked="keyword",cont(pushlex("form","class"==type?type:value),className,poplex)):"variable"==type?isTS&&"declare"==value?(cx.marked="keyword",cont(statement)):isTS&&("module"==value||"enum"==value||"type"==value)&&cx.stream.match(/^\s*\w/,!1)?(cx.marked="keyword","enum"==value?cont(enumdef):"type"==value?cont(typename,expect("operator"),typeexpr,expect(";")):cont(pushlex("form"),pattern,expect("{"),pushlex("}"),block,poplex,poplex)):isTS&&"namespace"==value?(cx.marked="keyword",cont(pushlex("form"),expression,statement,poplex)):isTS&&"abstract"==value?(cx.marked="keyword",cont(statement)):cont(pushlex("stat"),maybelabel):"switch"==type?cont(pushlex("form"),parenExpr,expect("{"),pushlex("}","switch"),pushblockcontext,block,poplex,poplex,popcontext):"case"==type?cont(expression,expect(":")):"default"==type?cont(expect(":")):"catch"==type?cont(pushlex("form"),pushcontext,maybeCatchBinding,statement,poplex,popcontext):"export"==type?cont(pushlex("stat"),afterExport,poplex):"import"==type?cont(pushlex("stat"),afterImport,poplex):"async"==type?cont(statement):"@"==value?cont(expression,statement):pass(pushlex("stat"),expression,expect(";"),poplex)}function maybeCatchBinding(type){if("("==type)return cont(funarg,expect(")"))}function expression(type,value){return expressionInner(type,value,!1)}function expressionNoComma(type,value){return expressionInner(type,value,!0)}function parenExpr(type){return"("!=type?pass():cont(pushlex(")"),maybeexpression,expect(")"),poplex)}function expressionInner(type,value,noComma){if(cx.state.fatArrowAt==cx.stream.start){var body=noComma?arrowBodyNoComma:arrowBody;if("("==type)return cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,expect("=>"),body,popcontext);if("variable"==type)return pass(pushcontext,pattern,expect("=>"),body,popcontext)}var maybeop=noComma?maybeoperatorNoComma:maybeoperatorComma;return atomicTypes.hasOwnProperty(type)?cont(maybeop):"function"==type?cont(functiondef,maybeop):"class"==type||isTS&&"interface"==value?(cx.marked="keyword",cont(pushlex("form"),classExpression,poplex)):"keyword c"==type||"async"==type?cont(noComma?expressionNoComma:expression):"("==type?cont(pushlex(")"),maybeexpression,expect(")"),poplex,maybeop):"operator"==type||"spread"==type?cont(noComma?expressionNoComma:expression):"["==type?cont(pushlex("]"),arrayLiteral,poplex,maybeop):"{"==type?contCommasep(objprop,"}",null,maybeop):"quasi"==type?pass(quasi,maybeop):"new"==type?cont(function(noComma){return function(type){return"."==type?cont(noComma?targetNoComma:target):"variable"==type&&isTS?cont(maybeTypeArgs,noComma?maybeoperatorNoComma:maybeoperatorComma):pass(noComma?expressionNoComma:expression)}}(noComma)):"import"==type?cont(expression):cont()}function maybeexpression(type){return type.match(/[;\}\)\],]/)?pass():pass(expression)}function maybeoperatorComma(type,value){return","==type?cont(maybeexpression):maybeoperatorNoComma(type,value,!1)}function maybeoperatorNoComma(type,value,noComma){var me=0==noComma?maybeoperatorComma:maybeoperatorNoComma,expr=0==noComma?expression:expressionNoComma;return"=>"==type?cont(pushcontext,noComma?arrowBodyNoComma:arrowBody,popcontext):"operator"==type?/\+\+|--/.test(value)||isTS&&"!"==value?cont(me):isTS&&"<"==value&&cx.stream.match(/^([^<>]|<[^<>]*>)*>\s*\(/,!1)?cont(pushlex(">"),commasep(typeexpr,">"),poplex,me):"?"==value?cont(expression,expect(":"),expr):cont(expr):"quasi"==type?pass(quasi,me):";"!=type?"("==type?contCommasep(expressionNoComma,")","call",me):"."==type?cont(property,me):"["==type?cont(pushlex("]"),maybeexpression,expect("]"),poplex,me):isTS&&"as"==value?(cx.marked="keyword",cont(typeexpr,me)):"regexp"==type?(cx.state.lastType=cx.marked="operator",cx.stream.backUp(cx.stream.pos-cx.stream.start-1),cont(expr)):void 0:void 0}function quasi(type,value){return"quasi"!=type?pass():"${"!=value.slice(value.length-2)?cont(quasi):cont(expression,continueQuasi)}function continueQuasi(type){if("}"==type)return cx.marked="string-2",cx.state.tokenize=tokenQuasi,cont(quasi)}function arrowBody(type){return findFatArrow(cx.stream,cx.state),pass("{"==type?statement:expression)}function arrowBodyNoComma(type){return findFatArrow(cx.stream,cx.state),pass("{"==type?statement:expressionNoComma)}function target(_,value){if("target"==value)return cx.marked="keyword",cont(maybeoperatorComma)}function targetNoComma(_,value){if("target"==value)return cx.marked="keyword",cont(maybeoperatorNoComma)}function maybelabel(type){return":"==type?cont(poplex,statement):pass(maybeoperatorComma,expect(";"),poplex)}function property(type){if("variable"==type)return cx.marked="property",cont()}function objprop(type,value){if("async"==type)return cx.marked="property",cont(objprop);if("variable"==type||"keyword"==cx.style){return cx.marked="property","get"==value||"set"==value?cont(getterSetter):(isTS&&cx.state.fatArrowAt==cx.stream.start&&(m=cx.stream.match(/^\s*:\s*/,!1))&&(cx.state.fatArrowAt=cx.stream.pos+m[0].length),cont(afterprop));var m}else{if("number"==type||"string"==type)return cx.marked=jsonldMode?"property":cx.style+" property",cont(afterprop);if("jsonld-keyword"==type)return cont(afterprop);if(isTS&&isModifier(value))return cx.marked="keyword",cont(objprop);if("["==type)return cont(expression,maybetype,expect("]"),afterprop);if("spread"==type)return cont(expressionNoComma,afterprop);if("*"==value)return cx.marked="keyword",cont(objprop);if(":"==type)return pass(afterprop)}}function getterSetter(type){return"variable"!=type?pass(afterprop):(cx.marked="property",cont(functiondef))}function afterprop(type){return":"==type?cont(expressionNoComma):"("==type?pass(functiondef):void 0}function commasep(what,end,sep){function proceed(type,value){if(sep?sep.indexOf(type)>-1:","==type){var lex=cx.state.lexical;return"call"==lex.info&&(lex.pos=(lex.pos||0)+1),cont(function(type,value){return type==end||value==end?pass():pass(what)},proceed)}return type==end||value==end?cont():sep&&sep.indexOf(";")>-1?pass(what):cont(expect(end))}return function(type,value){return type==end||value==end?cont():pass(what,proceed)}}function contCommasep(what,end,info){for(var i=3;i<arguments.length;i++)cx.cc.push(arguments[i]);return cont(pushlex(end,info),commasep(what,end),poplex)}function block(type){return"}"==type?cont():pass(statement,block)}function maybetype(type,value){if(isTS){if(":"==type)return cont(typeexpr);if("?"==value)return cont(maybetype)}}function maybetypeOrIn(type,value){if(isTS&&(":"==type||"in"==value))return cont(typeexpr)}function mayberettype(type){if(isTS&&":"==type)return cx.stream.match(/^\s*\w+\s+is\b/,!1)?cont(expression,isKW,typeexpr):cont(typeexpr)}function isKW(_,value){if("is"==value)return cx.marked="keyword",cont()}function typeexpr(type,value){return"keyof"==value||"typeof"==value||"infer"==value?(cx.marked="keyword",cont("typeof"==value?expressionNoComma:typeexpr)):"variable"==type||"void"==value?(cx.marked="type",cont(afterType)):"|"==value||"&"==value?cont(typeexpr):"string"==type||"number"==type||"atom"==type?cont(afterType):"["==type?cont(pushlex("]"),commasep(typeexpr,"]",","),poplex,afterType):"{"==type?cont(pushlex("}"),commasep(typeprop,"}",",;"),poplex,afterType):"("==type?cont(commasep(typearg,")"),maybeReturnType,afterType):"<"==type?cont(commasep(typeexpr,">"),typeexpr):void 0}function maybeReturnType(type){if("=>"==type)return cont(typeexpr)}function typeprop(type,value){return"variable"==type||"keyword"==cx.style?(cx.marked="property",cont(typeprop)):"?"==value||"number"==type||"string"==type?cont(typeprop):":"==type?cont(typeexpr):"["==type?cont(expect("variable"),maybetypeOrIn,expect("]"),typeprop):"("==type?pass(functiondecl,typeprop):void 0}function typearg(type,value){return"variable"==type&&cx.stream.match(/^\s*[?:]/,!1)||"?"==value?cont(typearg):":"==type?cont(typeexpr):"spread"==type?cont(typearg):pass(typeexpr)}function afterType(type,value){return"<"==value?cont(pushlex(">"),commasep(typeexpr,">"),poplex,afterType):"|"==value||"."==type||"&"==value?cont(typeexpr):"["==type?cont(typeexpr,expect("]"),afterType):"extends"==value||"implements"==value?(cx.marked="keyword",cont(typeexpr)):"?"==value?cont(typeexpr,expect(":"),typeexpr):void 0}function maybeTypeArgs(_,value){if("<"==value)return cont(pushlex(">"),commasep(typeexpr,">"),poplex,afterType)}function typeparam(){return pass(typeexpr,maybeTypeDefault)}function maybeTypeDefault(_,value){if("="==value)return cont(typeexpr)}function vardef(_,value){return"enum"==value?(cx.marked="keyword",cont(enumdef)):pass(pattern,maybetype,maybeAssign,vardefCont)}function pattern(type,value){return isTS&&isModifier(value)?(cx.marked="keyword",cont(pattern)):"variable"==type?(register(value),cont()):"spread"==type?cont(pattern):"["==type?contCommasep(eltpattern,"]"):"{"==type?contCommasep(proppattern,"}"):void 0}function proppattern(type,value){return"variable"!=type||cx.stream.match(/^\s*:/,!1)?("variable"==type&&(cx.marked="property"),"spread"==type?cont(pattern):"}"==type?pass():"["==type?cont(expression,expect("]"),expect(":"),proppattern):cont(expect(":"),pattern,maybeAssign)):(register(value),cont(maybeAssign))}function eltpattern(){return pass(pattern,maybeAssign)}function maybeAssign(_type,value){if("="==value)return cont(expressionNoComma)}function vardefCont(type){if(","==type)return cont(vardef)}function maybeelse(type,value){if("keyword b"==type&&"else"==value)return cont(pushlex("form","else"),statement,poplex)}function forspec(type,value){return"await"==value?cont(forspec):"("==type?cont(pushlex(")"),forspec1,poplex):void 0}function forspec1(type){return"var"==type?cont(vardef,forspec2):"variable"==type?cont(forspec2):pass(forspec2)}function forspec2(type,value){return")"==type?cont():";"==type?cont(forspec2):"in"==value||"of"==value?(cx.marked="keyword",cont(expression,forspec2)):pass(expression,forspec2)}function functiondef(type,value){return"*"==value?(cx.marked="keyword",cont(functiondef)):"variable"==type?(register(value),cont(functiondef)):"("==type?cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,mayberettype,statement,popcontext):isTS&&"<"==value?cont(pushlex(">"),commasep(typeparam,">"),poplex,functiondef):void 0}function functiondecl(type,value){return"*"==value?(cx.marked="keyword",cont(functiondecl)):"variable"==type?(register(value),cont(functiondecl)):"("==type?cont(pushcontext,pushlex(")"),commasep(funarg,")"),poplex,mayberettype,popcontext):isTS&&"<"==value?cont(pushlex(">"),commasep(typeparam,">"),poplex,functiondecl):void 0}function typename(type,value){return"keyword"==type||"variable"==type?(cx.marked="type",cont(typename)):"<"==value?cont(pushlex(">"),commasep(typeparam,">"),poplex):void 0}function funarg(type,value){return"@"==value&&cont(expression,funarg),"spread"==type?cont(funarg):isTS&&isModifier(value)?(cx.marked="keyword",cont(funarg)):isTS&&"this"==type?cont(maybetype,maybeAssign):pass(pattern,maybetype,maybeAssign)}function classExpression(type,value){return"variable"==type?className(type,value):classNameAfter(type,value)}function className(type,value){if("variable"==type)return register(value),cont(classNameAfter)}function classNameAfter(type,value){return"<"==value?cont(pushlex(">"),commasep(typeparam,">"),poplex,classNameAfter):"extends"==value||"implements"==value||isTS&&","==type?("implements"==value&&(cx.marked="keyword"),cont(isTS?typeexpr:expression,classNameAfter)):"{"==type?cont(pushlex("}"),classBody,poplex):void 0}function classBody(type,value){return"async"==type||"variable"==type&&("static"==value||"get"==value||"set"==value||isTS&&isModifier(value))&&cx.stream.match(/^\s+[\w$\xa1-\uffff]/,!1)?(cx.marked="keyword",cont(classBody)):"variable"==type||"keyword"==cx.style?(cx.marked="property",cont(classfield,classBody)):"number"==type||"string"==type?cont(classfield,classBody):"["==type?cont(expression,maybetype,expect("]"),classfield,classBody):"*"==value?(cx.marked="keyword",cont(classBody)):isTS&&"("==type?pass(functiondecl,classBody):";"==type||","==type?cont(classBody):"}"==type?cont():"@"==value?cont(expression,classBody):void 0}function classfield(type,value){if("?"==value)return cont(classfield);if(":"==type)return cont(typeexpr,maybeAssign);if("="==value)return cont(expressionNoComma);var context=cx.state.lexical.prev;return pass(context&&"interface"==context.info?functiondecl:functiondef)}function afterExport(type,value){return"*"==value?(cx.marked="keyword",cont(maybeFrom,expect(";"))):"default"==value?(cx.marked="keyword",cont(expression,expect(";"))):"{"==type?cont(commasep(exportField,"}"),maybeFrom,expect(";")):pass(statement)}function exportField(type,value){return"as"==value?(cx.marked="keyword",cont(expect("variable"))):"variable"==type?pass(expressionNoComma,exportField):void 0}function afterImport(type){return"string"==type?cont():"("==type?pass(expression):pass(importSpec,maybeMoreImports,maybeFrom)}function importSpec(type,value){return"{"==type?contCommasep(importSpec,"}"):("variable"==type&&register(value),"*"==value&&(cx.marked="keyword"),cont(maybeAs))}function maybeMoreImports(type){if(","==type)return cont(importSpec,maybeMoreImports)}function maybeAs(_type,value){if("as"==value)return cx.marked="keyword",cont(importSpec)}function maybeFrom(_type,value){if("from"==value)return cx.marked="keyword",cont(expression)}function arrayLiteral(type){return"]"==type?cont():pass(commasep(expressionNoComma,"]"))}function enumdef(){return pass(pushlex("form"),pattern,expect("{"),pushlex("}"),commasep(enummember,"}"),poplex,poplex)}function enummember(){return pass(pattern,maybeAssign)}function expressionAllowed(stream,state,backUp){return state.tokenize==tokenBase&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(state.lastType)||"quasi"==state.lastType&&/\{\s*$/.test(stream.string.slice(0,stream.pos-(backUp||0)))}return popcontext.lex=!0,poplex.lex=!0,{startState:function(basecolumn){var state={tokenize:tokenBase,lastType:"sof",cc:[],lexical:new JSLexical((basecolumn||0)-indentUnit,0,"block",!1),localVars:parserConfig.localVars,context:parserConfig.localVars&&new Context(null,null,!1),indented:basecolumn||0};return parserConfig.globalVars&&"object"==typeof parserConfig.globalVars&&(state.globalVars=parserConfig.globalVars),state},token:function(stream,state){if(stream.sol()&&(state.lexical.hasOwnProperty("align")||(state.lexical.align=!1),state.indented=stream.indentation(),findFatArrow(stream,state)),state.tokenize!=tokenComment&&stream.eatSpace())return null;var style=state.tokenize(stream,state);return"comment"==type?style:(state.lastType="operator"!=type||"++"!=content&&"--"!=content?type:"incdec",function(state,style,type,content,stream){var cc=state.cc;for(cx.state=state,cx.stream=stream,cx.marked=null,cx.cc=cc,cx.style=style,state.lexical.hasOwnProperty("align")||(state.lexical.align=!0);;)if((cc.length?cc.pop():jsonMode?expression:statement)(type,content)){for(;cc.length&&cc[cc.length-1].lex;)cc.pop()();return cx.marked?cx.marked:"variable"==type&&inScope(state,content)?"variable-2":style}}(state,style,type,content,stream))},indent:function(state,textAfter){if(state.tokenize==tokenComment)return CodeMirror.Pass;if(state.tokenize!=tokenBase)return 0;var top,firstChar=textAfter&&textAfter.charAt(0),lexical=state.lexical;if(!/^\s*else\b/.test(textAfter))for(var i=state.cc.length-1;i>=0;--i){var c=state.cc[i];if(c==poplex)lexical=lexical.prev;else if(c!=maybeelse)break}for(;("stat"==lexical.type||"form"==lexical.type)&&("}"==firstChar||(top=state.cc[state.cc.length-1])&&(top==maybeoperatorComma||top==maybeoperatorNoComma)&&!/^[,\.=+\-*:?[\(]/.test(textAfter));)lexical=lexical.prev;statementIndent&&")"==lexical.type&&"stat"==lexical.prev.type&&(lexical=lexical.prev);var type=lexical.type,closing=firstChar==type;return"vardef"==type?lexical.indented+("operator"==state.lastType||","==state.lastType?lexical.info.length+1:0):"form"==type&&"{"==firstChar?lexical.indented:"form"==type?lexical.indented+indentUnit:"stat"==type?lexical.indented+(function(state,textAfter){return"operator"==state.lastType||","==state.lastType||isOperatorChar.test(textAfter.charAt(0))||/[,.]/.test(textAfter.charAt(0))}(state,textAfter)?statementIndent||indentUnit:0):"switch"!=lexical.info||closing||0==parserConfig.doubleIndentSwitch?lexical.align?lexical.column+(closing?0:1):lexical.indented+(closing?0:indentUnit):lexical.indented+(/^(?:case|default)\b/.test(textAfter)?indentUnit:2*indentUnit)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:jsonMode?null:"/*",blockCommentEnd:jsonMode?null:"*/",blockCommentContinue:jsonMode?null:" * ",lineComment:jsonMode?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:jsonMode?"json":"javascript",jsonldMode:jsonldMode,jsonMode:jsonMode,expressionAllowed:expressionAllowed,skipExpression:function(state){var top=state.cc[state.cc.length-1];top!=expression&&top!=expressionNoComma||state.cc.pop()}}}),CodeMirror.registerHelper("wordChars","javascript",/[\w$]/),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("text/ecmascript","javascript"),CodeMirror.defineMIME("application/javascript","javascript"),CodeMirror.defineMIME("application/x-javascript","javascript"),CodeMirror.defineMIME("application/ecmascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),CodeMirror.defineMIME("application/x-json",{name:"javascript",json:!0}),CodeMirror.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0})}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";var htmlConfig={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},xmlConfig={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};CodeMirror.defineMode("xml",function(editorConf,config_){var type,setStyle,indentUnit=editorConf.indentUnit,config={},defaults=config_.htmlMode?htmlConfig:xmlConfig;for(var prop in defaults)config[prop]=defaults[prop];for(var prop in config_)config[prop]=config_[prop];function inText(stream,state){function chain(parser){return state.tokenize=parser,parser(stream,state)}var ch=stream.next();return"<"==ch?stream.eat("!")?stream.eat("[")?stream.match("CDATA[")?chain(inBlock("atom","]]>")):null:stream.match("--")?chain(inBlock("comment","--\x3e")):stream.match("DOCTYPE",!0,!0)?(stream.eatWhile(/[\w\._\-]/),chain(function doctype(depth){return function(stream,state){for(var ch;null!=(ch=stream.next());){if("<"==ch)return state.tokenize=doctype(depth+1),state.tokenize(stream,state);if(">"==ch){if(1==depth){state.tokenize=inText;break}return state.tokenize=doctype(depth-1),state.tokenize(stream,state)}}return"meta"}}(1))):null:stream.eat("?")?(stream.eatWhile(/[\w\._\-]/),state.tokenize=inBlock("meta","?>"),"meta"):(type=stream.eat("/")?"closeTag":"openTag",state.tokenize=inTag,"tag bracket"):"&"==ch?(stream.eat("#")?stream.eat("x")?stream.eatWhile(/[a-fA-F\d]/)&&stream.eat(";"):stream.eatWhile(/[\d]/)&&stream.eat(";"):stream.eatWhile(/[\w\.\-:]/)&&stream.eat(";"))?"atom":"error":(stream.eatWhile(/[^&<]/),null)}function inTag(stream,state){var quote,closure,ch=stream.next();if(">"==ch||"/"==ch&&stream.eat(">"))return state.tokenize=inText,type=">"==ch?"endTag":"selfcloseTag","tag bracket";if("="==ch)return type="equals",null;if("<"==ch){state.tokenize=inText,state.state=baseState,state.tagName=state.tagStart=null;var next=state.tokenize(stream,state);return next?next+" tag error":"tag error"}return/[\'\"]/.test(ch)?(state.tokenize=(quote=ch,(closure=function(stream,state){for(;!stream.eol();)if(stream.next()==quote){state.tokenize=inTag;break}return"string"}).isInAttribute=!0,closure),state.stringStartCol=stream.column(),state.tokenize(stream,state)):(stream.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function inBlock(style,terminator){return function(stream,state){for(;!stream.eol();){if(stream.match(terminator)){state.tokenize=inText;break}stream.next()}return style}}function popContext(state){state.context&&(state.context=state.context.prev)}function maybePopContext(state,nextTagName){for(var parentTagName;;){if(!state.context)return;if(parentTagName=state.context.tagName,!config.contextGrabbers.hasOwnProperty(parentTagName)||!config.contextGrabbers[parentTagName].hasOwnProperty(nextTagName))return;popContext(state)}}function baseState(type,stream,state){return"openTag"==type?(state.tagStart=stream.column(),tagNameState):"closeTag"==type?closeTagNameState:baseState}function tagNameState(type,stream,state){return"word"==type?(state.tagName=stream.current(),setStyle="tag",attrState):config.allowMissingTagName&&"endTag"==type?(setStyle="tag bracket",attrState(type,stream,state)):(setStyle="error",tagNameState)}function closeTagNameState(type,stream,state){if("word"==type){var tagName=stream.current();return state.context&&state.context.tagName!=tagName&&config.implicitlyClosed.hasOwnProperty(state.context.tagName)&&popContext(state),state.context&&state.context.tagName==tagName||!1===config.matchClosing?(setStyle="tag",closeState):(setStyle="tag error",closeStateErr)}return config.allowMissingTagName&&"endTag"==type?(setStyle="tag bracket",closeState(type,stream,state)):(setStyle="error",closeStateErr)}function closeState(type,_stream,state){return"endTag"!=type?(setStyle="error",closeState):(popContext(state),baseState)}function closeStateErr(type,stream,state){return setStyle="error",closeState(type,0,state)}function attrState(type,_stream,state){if("word"==type)return setStyle="attribute",attrEqState;if("endTag"==type||"selfcloseTag"==type){var tagName=state.tagName,tagStart=state.tagStart;return state.tagName=state.tagStart=null,"selfcloseTag"==type||config.autoSelfClosers.hasOwnProperty(tagName)?maybePopContext(state,tagName):(maybePopContext(state,tagName),state.context=new function(state,tagName,startOfLine){this.prev=state.context,this.tagName=tagName,this.indent=state.indented,this.startOfLine=startOfLine,(config.doNotIndent.hasOwnProperty(tagName)||state.context&&state.context.noIndent)&&(this.noIndent=!0)}(state,tagName,tagStart==state.indented)),baseState}return setStyle="error",attrState}function attrEqState(type,stream,state){return"equals"==type?attrValueState:(config.allowMissing||(setStyle="error"),attrState(type,0,state))}function attrValueState(type,stream,state){return"string"==type?attrContinuedState:"word"==type&&config.allowUnquoted?(setStyle="string",attrState):(setStyle="error",attrState(type,0,state))}function attrContinuedState(type,stream,state){return"string"==type?attrContinuedState:attrState(type,0,state)}return inText.isInText=!0,{startState:function(baseIndent){var state={tokenize:inText,state:baseState,indented:baseIndent||0,tagName:null,tagStart:null,context:null};return null!=baseIndent&&(state.baseIndent=baseIndent),state},token:function(stream,state){if(!state.tagName&&stream.sol()&&(state.indented=stream.indentation()),stream.eatSpace())return null;type=null;var style=state.tokenize(stream,state);return(style||type)&&"comment"!=style&&(setStyle=null,state.state=state.state(type||style,stream,state),setStyle&&(style="error"==setStyle?style+" error":setStyle)),style},indent:function(state,textAfter,fullLine){var context=state.context;if(state.tokenize.isInAttribute)return state.tagStart==state.indented?state.stringStartCol+1:state.indented+indentUnit;if(context&&context.noIndent)return CodeMirror.Pass;if(state.tokenize!=inTag&&state.tokenize!=inText)return fullLine?fullLine.match(/^(\s*)/)[0].length:0;if(state.tagName)return!1!==config.multilineTagIndentPastTag?state.tagStart+state.tagName.length+2:state.tagStart+indentUnit*(config.multilineTagIndentFactor||1);if(config.alignCDATA&&/<!\[CDATA\[/.test(textAfter))return 0;var tagAfter=textAfter&&/^<(\/)?([\w_:\.-]*)/.exec(textAfter);if(tagAfter&&tagAfter[1])for(;context;){if(context.tagName==tagAfter[2]){context=context.prev;break}if(!config.implicitlyClosed.hasOwnProperty(context.tagName))break;context=context.prev}else if(tagAfter)for(;context;){var grabbers=config.contextGrabbers[context.tagName];if(!grabbers||!grabbers.hasOwnProperty(tagAfter[2]))break;context=context.prev}for(;context&&context.prev&&!context.startOfLine;)context=context.prev;return context?context.indent+indentUnit:state.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:config.htmlMode?"html":"xml",helperType:config.htmlMode?"html":"xml",skipAttribute:function(state){state.state==attrValueState&&(state.state=attrState)},xmlCurrentTag:function(state){return state.tagName?{name:state.tagName,close:"closeTag"==state.type}:null},xmlCurrentContext:function(state){for(var context=[],cx=state.context;cx;cx=cx.prev)cx.tagName&&context.push(cx.tagName);return context.reverse()}}}),CodeMirror.defineMIME("text/xml","xml"),CodeMirror.defineMIME("application/xml","xml"),CodeMirror.mimeModes.hasOwnProperty("text/html")||CodeMirror.defineMIME("text/html",{name:"xml",htmlMode:!0})}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";function keySet(array){for(var keys={},i=0;i<array.length;++i)keys[array[i].toLowerCase()]=!0;return keys}CodeMirror.defineMode("css",function(config,parserConfig){var inline=parserConfig.inline;parserConfig.propertyKeywords||(parserConfig=CodeMirror.resolveMode("text/css"));var type,override,indentUnit=config.indentUnit,tokenHooks=parserConfig.tokenHooks,documentTypes=parserConfig.documentTypes||{},mediaTypes=parserConfig.mediaTypes||{},mediaFeatures=parserConfig.mediaFeatures||{},mediaValueKeywords=parserConfig.mediaValueKeywords||{},propertyKeywords=parserConfig.propertyKeywords||{},nonStandardPropertyKeywords=parserConfig.nonStandardPropertyKeywords||{},fontProperties=parserConfig.fontProperties||{},counterDescriptors=parserConfig.counterDescriptors||{},colorKeywords=parserConfig.colorKeywords||{},valueKeywords=parserConfig.valueKeywords||{},allowNested=parserConfig.allowNested,lineComment=parserConfig.lineComment,supportsAtComponent=!0===parserConfig.supportsAtComponent;function ret(style,tp){return type=tp,style}function tokenString(quote){return function(stream,state){for(var ch,escaped=!1;null!=(ch=stream.next());){if(ch==quote&&!escaped){")"==quote&&stream.backUp(1);break}escaped=!escaped&&"\\"==ch}return(ch==quote||!escaped&&")"!=quote)&&(state.tokenize=null),ret("string","string")}}function tokenParenthesized(stream,state){return stream.next(),stream.match(/\s*[\"\')]/,!1)?state.tokenize=null:state.tokenize=tokenString(")"),ret(null,"(")}function Context(type,indent,prev){this.type=type,this.indent=indent,this.prev=prev}function pushContext(state,stream,type,indent){return state.context=new Context(type,stream.indentation()+(!1===indent?0:indentUnit),state.context),type}function popContext(state){return state.context.prev&&(state.context=state.context.prev),state.context.type}function pass(type,stream,state){return states[state.context.type](type,stream,state)}function popAndPass(type,stream,state,n){for(var i=n||1;i>0;i--)state.context=state.context.prev;return pass(type,stream,state)}function wordAsValue(stream){var word=stream.current().toLowerCase();override=valueKeywords.hasOwnProperty(word)?"atom":colorKeywords.hasOwnProperty(word)?"keyword":"variable"}var states={top:function(type,stream,state){if("{"==type)return pushContext(state,stream,"block");if("}"==type&&state.context.prev)return popContext(state);if(supportsAtComponent&&/@component/i.test(type))return pushContext(state,stream,"atComponentBlock");if(/^@(-moz-)?document$/i.test(type))return pushContext(state,stream,"documentTypes");if(/^@(media|supports|(-moz-)?document|import)$/i.test(type))return pushContext(state,stream,"atBlock");if(/^@(font-face|counter-style)/i.test(type))return state.stateArg=type,"restricted_atBlock_before";if(/^@(-(moz|ms|o|webkit)-)?keyframes$/i.test(type))return"keyframes";if(type&&"@"==type.charAt(0))return pushContext(state,stream,"at");if("hash"==type)override="builtin";else if("word"==type)override="tag";else{if("variable-definition"==type)return"maybeprop";if("interpolation"==type)return pushContext(state,stream,"interpolation");if(":"==type)return"pseudo";if(allowNested&&"("==type)return pushContext(state,stream,"parens")}return state.context.type},block:function(type,stream,state){if("word"==type){var word=stream.current().toLowerCase();return propertyKeywords.hasOwnProperty(word)?(override="property","maybeprop"):nonStandardPropertyKeywords.hasOwnProperty(word)?(override="string-2","maybeprop"):allowNested?(override=stream.match(/^\s*:(?:\s|$)/,!1)?"property":"tag","block"):(override+=" error","maybeprop")}return"meta"==type?"block":allowNested||"hash"!=type&&"qualifier"!=type?states.top(type,stream,state):(override="error","block")},maybeprop:function(type,stream,state){return":"==type?pushContext(state,stream,"prop"):pass(type,stream,state)},prop:function(type,stream,state){if(";"==type)return popContext(state);if("{"==type&&allowNested)return pushContext(state,stream,"propBlock");if("}"==type||"{"==type)return popAndPass(type,stream,state);if("("==type)return pushContext(state,stream,"parens");if("hash"!=type||/^#([0-9a-fA-f]{3,4}|[0-9a-fA-f]{6}|[0-9a-fA-f]{8})$/.test(stream.current())){if("word"==type)wordAsValue(stream);else if("interpolation"==type)return pushContext(state,stream,"interpolation")}else override+=" error";return"prop"},propBlock:function(type,_stream,state){return"}"==type?popContext(state):"word"==type?(override="property","maybeprop"):state.context.type},parens:function(type,stream,state){return"{"==type||"}"==type?popAndPass(type,stream,state):")"==type?popContext(state):"("==type?pushContext(state,stream,"parens"):"interpolation"==type?pushContext(state,stream,"interpolation"):("word"==type&&wordAsValue(stream),"parens")},pseudo:function(type,stream,state){return"meta"==type?"pseudo":"word"==type?(override="variable-3",state.context.type):pass(type,stream,state)},documentTypes:function(type,stream,state){return"word"==type&&documentTypes.hasOwnProperty(stream.current())?(override="tag",state.context.type):states.atBlock(type,stream,state)},atBlock:function(type,stream,state){if("("==type)return pushContext(state,stream,"atBlock_parens");if("}"==type||";"==type)return popAndPass(type,stream,state);if("{"==type)return popContext(state)&&pushContext(state,stream,allowNested?"block":"top");if("interpolation"==type)return pushContext(state,stream,"interpolation");if("word"==type){var word=stream.current().toLowerCase();override="only"==word||"not"==word||"and"==word||"or"==word?"keyword":mediaTypes.hasOwnProperty(word)?"attribute":mediaFeatures.hasOwnProperty(word)?"property":mediaValueKeywords.hasOwnProperty(word)?"keyword":propertyKeywords.hasOwnProperty(word)?"property":nonStandardPropertyKeywords.hasOwnProperty(word)?"string-2":valueKeywords.hasOwnProperty(word)?"atom":colorKeywords.hasOwnProperty(word)?"keyword":"error"}return state.context.type},atComponentBlock:function(type,stream,state){return"}"==type?popAndPass(type,stream,state):"{"==type?popContext(state)&&pushContext(state,stream,allowNested?"block":"top",!1):("word"==type&&(override="error"),state.context.type)},atBlock_parens:function(type,stream,state){return")"==type?popContext(state):"{"==type||"}"==type?popAndPass(type,stream,state,2):states.atBlock(type,stream,state)},restricted_atBlock_before:function(type,stream,state){return"{"==type?pushContext(state,stream,"restricted_atBlock"):"word"==type&&"@counter-style"==state.stateArg?(override="variable","restricted_atBlock_before"):pass(type,stream,state)},restricted_atBlock:function(type,stream,state){return"}"==type?(state.stateArg=null,popContext(state)):"word"==type?(override="@font-face"==state.stateArg&&!fontProperties.hasOwnProperty(stream.current().toLowerCase())||"@counter-style"==state.stateArg&&!counterDescriptors.hasOwnProperty(stream.current().toLowerCase())?"error":"property","maybeprop"):"restricted_atBlock"},keyframes:function(type,stream,state){return"word"==type?(override="variable","keyframes"):"{"==type?pushContext(state,stream,"top"):pass(type,stream,state)},at:function(type,stream,state){return";"==type?popContext(state):"{"==type||"}"==type?popAndPass(type,stream,state):("word"==type?override="tag":"hash"==type&&(override="builtin"),"at")},interpolation:function(type,stream,state){return"}"==type?popContext(state):"{"==type||";"==type?popAndPass(type,stream,state):("word"==type?override="variable":"variable"!=type&&"("!=type&&")"!=type&&(override="error"),"interpolation")}};return{startState:function(base){return{tokenize:null,state:inline?"block":"top",stateArg:null,context:new Context(inline?"block":"top",base||0,null)}},token:function(stream,state){if(!state.tokenize&&stream.eatSpace())return null;var style=(state.tokenize||function(stream,state){var ch=stream.next();if(tokenHooks[ch]){var result=tokenHooks[ch](stream,state);if(!1!==result)return result}return"@"==ch?(stream.eatWhile(/[\w\\\-]/),ret("def",stream.current())):"="==ch||("~"==ch||"|"==ch)&&stream.eat("=")?ret(null,"compare"):'"'==ch||"'"==ch?(state.tokenize=tokenString(ch),state.tokenize(stream,state)):"#"==ch?(stream.eatWhile(/[\w\\\-]/),ret("atom","hash")):"!"==ch?(stream.match(/^\s*\w*/),ret("keyword","important")):/\d/.test(ch)||"."==ch&&stream.eat(/\d/)?(stream.eatWhile(/[\w.%]/),ret("number","unit")):"-"!==ch?/[,+>*\/]/.test(ch)?ret(null,"select-op"):"."==ch&&stream.match(/^-?[_a-z][_a-z0-9-]*/i)?ret("qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(ch)?ret(null,ch):stream.match(/[\w-.]+(?=\()/)?(/^(url(-prefix)?|domain|regexp)$/.test(stream.current().toLowerCase())&&(state.tokenize=tokenParenthesized),ret("variable callee","variable")):/[\w\\\-]/.test(ch)?(stream.eatWhile(/[\w\\\-]/),ret("property","word")):ret(null,null):/[\d.]/.test(stream.peek())?(stream.eatWhile(/[\w.%]/),ret("number","unit")):stream.match(/^-[\w\\\-]*/)?(stream.eatWhile(/[\w\\\-]/),stream.match(/^\s*:/,!1)?ret("variable-2","variable-definition"):ret("variable-2","variable")):stream.match(/^\w+-/)?ret("meta","meta"):void 0})(stream,state);return style&&"object"==typeof style&&(type=style[1],style=style[0]),override=style,"comment"!=type&&(state.state=states[state.state](type,stream,state)),override},indent:function(state,textAfter){var cx=state.context,ch=textAfter&&textAfter.charAt(0),indent=cx.indent;return"prop"!=cx.type||"}"!=ch&&")"!=ch||(cx=cx.prev),cx.prev&&("}"!=ch||"block"!=cx.type&&"top"!=cx.type&&"interpolation"!=cx.type&&"restricted_atBlock"!=cx.type?(")"!=ch||"parens"!=cx.type&&"atBlock_parens"!=cx.type)&&("{"!=ch||"at"!=cx.type&&"atBlock"!=cx.type)||(indent=Math.max(0,cx.indent-indentUnit)):indent=(cx=cx.prev).indent),indent},electricChars:"}",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",lineComment:lineComment,fold:"brace"}});var documentTypes_=["domain","regexp","url","url-prefix"],documentTypes=keySet(documentTypes_),mediaTypes_=["all","aural","braille","handheld","print","projection","screen","tty","tv","embossed"],mediaTypes=keySet(mediaTypes_),mediaFeatures_=["width","min-width","max-width","height","min-height","max-height","device-width","min-device-width","max-device-width","device-height","min-device-height","max-device-height","aspect-ratio","min-aspect-ratio","max-aspect-ratio","device-aspect-ratio","min-device-aspect-ratio","max-device-aspect-ratio","color","min-color","max-color","color-index","min-color-index","max-color-index","monochrome","min-monochrome","max-monochrome","resolution","min-resolution","max-resolution","scan","grid","orientation","device-pixel-ratio","min-device-pixel-ratio","max-device-pixel-ratio","pointer","any-pointer","hover","any-hover","prefers-color-scheme"],mediaFeatures=keySet(mediaFeatures_),mediaValueKeywords_=["landscape","portrait","none","coarse","fine","on-demand","hover","interlace","progressive","dark","light"],mediaValueKeywords=keySet(mediaValueKeywords_),propertyKeywords_=["align-content","align-items","align-self","alignment-adjust","alignment-baseline","all","anchor-point","animation","animation-delay","animation-direction","animation-duration","animation-fill-mode","animation-iteration-count","animation-name","animation-play-state","animation-timing-function","appearance","azimuth","backdrop-filter","backface-visibility","background","background-attachment","background-blend-mode","background-clip","background-color","background-image","background-origin","background-position","background-position-x","background-position-y","background-repeat","background-size","baseline-shift","binding","bleed","block-size","bookmark-label","bookmark-level","bookmark-state","bookmark-target","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-image","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-left","border-left-color","border-left-style","border-left-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-decoration-break","box-shadow","box-sizing","break-after","break-before","break-inside","caption-side","caret-color","clear","clip","color","color-profile","column-count","column-fill","column-gap","column-rule","column-rule-color","column-rule-style","column-rule-width","column-span","column-width","columns","contain","content","counter-increment","counter-reset","crop","cue","cue-after","cue-before","cursor","direction","display","dominant-baseline","drop-initial-after-adjust","drop-initial-after-align","drop-initial-before-adjust","drop-initial-before-align","drop-initial-size","drop-initial-value","elevation","empty-cells","fit","fit-position","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","float-offset","flow-from","flow-into","font","font-family","font-feature-settings","font-kerning","font-language-override","font-optical-sizing","font-size","font-size-adjust","font-stretch","font-style","font-synthesis","font-variant","font-variant-alternates","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","font-variant-position","font-variation-settings","font-weight","gap","grid","grid-area","grid-auto-columns","grid-auto-flow","grid-auto-rows","grid-column","grid-column-end","grid-column-gap","grid-column-start","grid-gap","grid-row","grid-row-end","grid-row-gap","grid-row-start","grid-template","grid-template-areas","grid-template-columns","grid-template-rows","hanging-punctuation","height","hyphens","icon","image-orientation","image-rendering","image-resolution","inline-box-align","inset","inset-block","inset-block-end","inset-block-start","inset-inline","inset-inline-end","inset-inline-start","isolation","justify-content","justify-items","justify-self","left","letter-spacing","line-break","line-height","line-height-step","line-stacking","line-stacking-ruby","line-stacking-shift","line-stacking-strategy","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","marks","marquee-direction","marquee-loop","marquee-play-count","marquee-speed","marquee-style","mask-clip","mask-composite","mask-image","mask-mode","mask-origin","mask-position","mask-repeat","mask-size","mask-type","max-block-size","max-height","max-inline-size","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","move-to","nav-down","nav-index","nav-left","nav-right","nav-up","object-fit","object-position","offset","offset-anchor","offset-distance","offset-path","offset-position","offset-rotate","opacity","order","orphans","outline","outline-color","outline-offset","outline-style","outline-width","overflow","overflow-style","overflow-wrap","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","page","page-break-after","page-break-before","page-break-inside","page-policy","pause","pause-after","pause-before","perspective","perspective-origin","pitch","pitch-range","place-content","place-items","place-self","play-during","position","presentation-level","punctuation-trim","quotes","region-break-after","region-break-before","region-break-inside","region-fragment","rendering-intent","resize","rest","rest-after","rest-before","richness","right","rotate","rotation","rotation-point","row-gap","ruby-align","ruby-overhang","ruby-position","ruby-span","scale","scroll-behavior","scroll-margin","scroll-margin-block","scroll-margin-block-end","scroll-margin-block-start","scroll-margin-bottom","scroll-margin-inline","scroll-margin-inline-end","scroll-margin-inline-start","scroll-margin-left","scroll-margin-right","scroll-margin-top","scroll-padding","scroll-padding-block","scroll-padding-block-end","scroll-padding-block-start","scroll-padding-bottom","scroll-padding-inline","scroll-padding-inline-end","scroll-padding-inline-start","scroll-padding-left","scroll-padding-right","scroll-padding-top","scroll-snap-align","scroll-snap-type","shape-image-threshold","shape-inside","shape-margin","shape-outside","size","speak","speak-as","speak-header","speak-numeral","speak-punctuation","speech-rate","stress","string-set","tab-size","table-layout","target","target-name","target-new","target-position","text-align","text-align-last","text-combine-upright","text-decoration","text-decoration-color","text-decoration-line","text-decoration-skip","text-decoration-skip-ink","text-decoration-style","text-emphasis","text-emphasis-color","text-emphasis-position","text-emphasis-style","text-height","text-indent","text-justify","text-orientation","text-outline","text-overflow","text-rendering","text-shadow","text-size-adjust","text-space-collapse","text-transform","text-underline-position","text-wrap","top","touch-action","transform","transform-origin","transform-style","transition","transition-delay","transition-duration","transition-property","transition-timing-function","translate","unicode-bidi","user-select","vertical-align","visibility","voice-balance","voice-duration","voice-family","voice-pitch","voice-range","voice-rate","voice-stress","voice-volume","volume","white-space","widows","width","will-change","word-break","word-spacing","word-wrap","writing-mode","z-index","clip-path","clip-rule","mask","enable-background","filter","flood-color","flood-opacity","lighting-color","stop-color","stop-opacity","pointer-events","color-interpolation","color-interpolation-filters","color-rendering","fill","fill-opacity","fill-rule","image-rendering","marker","marker-end","marker-mid","marker-start","paint-order","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-rendering","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","text-anchor","writing-mode"],propertyKeywords=keySet(propertyKeywords_),nonStandardPropertyKeywords_=["border-block","border-block-color","border-block-end","border-block-end-color","border-block-end-style","border-block-end-width","border-block-start","border-block-start-color","border-block-start-style","border-block-start-width","border-block-style","border-block-width","border-inline","border-inline-color","border-inline-end","border-inline-end-color","border-inline-end-style","border-inline-end-width","border-inline-start","border-inline-start-color","border-inline-start-style","border-inline-start-width","border-inline-style","border-inline-width","margin-block","margin-block-end","margin-block-start","margin-inline","margin-inline-end","margin-inline-start","padding-block","padding-block-end","padding-block-start","padding-inline","padding-inline-end","padding-inline-start","scroll-snap-stop","scrollbar-3d-light-color","scrollbar-arrow-color","scrollbar-base-color","scrollbar-dark-shadow-color","scrollbar-face-color","scrollbar-highlight-color","scrollbar-shadow-color","scrollbar-track-color","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","shape-inside","zoom"],nonStandardPropertyKeywords=keySet(nonStandardPropertyKeywords_),fontProperties=keySet(["font-display","font-family","src","unicode-range","font-variant","font-feature-settings","font-stretch","font-weight","font-style"]),counterDescriptors=keySet(["additive-symbols","fallback","negative","pad","prefix","range","speak-as","suffix","symbols","system"]),colorKeywords_=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","grey","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],colorKeywords=keySet(colorKeywords_),valueKeywords_=["above","absolute","activeborder","additive","activecaption","afar","after-white-space","ahead","alias","all","all-scroll","alphabetic","alternate","always","amharic","amharic-abegede","antialiased","appworkspace","arabic-indic","armenian","asterisks","attr","auto","auto-flow","avoid","avoid-column","avoid-page","avoid-region","axis-pan","background","backwards","baseline","below","bidi-override","binary","bengali","blink","block","block-axis","bold","bolder","border","border-box","both","bottom","break","break-all","break-word","bullets","button","button-bevel","buttonface","buttonhighlight","buttonshadow","buttontext","calc","cambodian","capitalize","caps-lock-indicator","caption","captiontext","caret","cell","center","checkbox","circle","cjk-decimal","cjk-earthly-branch","cjk-heavenly-stem","cjk-ideographic","clear","clip","close-quote","col-resize","collapse","color","color-burn","color-dodge","column","column-reverse","compact","condensed","contain","content","contents","content-box","context-menu","continuous","copy","counter","counters","cover","crop","cross","crosshair","currentcolor","cursive","cyclic","darken","dashed","decimal","decimal-leading-zero","default","default-button","dense","destination-atop","destination-in","destination-out","destination-over","devanagari","difference","disc","discard","disclosure-closed","disclosure-open","document","dot-dash","dot-dot-dash","dotted","double","down","e-resize","ease","ease-in","ease-in-out","ease-out","element","ellipse","ellipsis","embed","end","ethiopic","ethiopic-abegede","ethiopic-abegede-am-et","ethiopic-abegede-gez","ethiopic-abegede-ti-er","ethiopic-abegede-ti-et","ethiopic-halehame-aa-er","ethiopic-halehame-aa-et","ethiopic-halehame-am-et","ethiopic-halehame-gez","ethiopic-halehame-om-et","ethiopic-halehame-sid-et","ethiopic-halehame-so-et","ethiopic-halehame-ti-er","ethiopic-halehame-ti-et","ethiopic-halehame-tig","ethiopic-numeric","ew-resize","exclusion","expanded","extends","extra-condensed","extra-expanded","fantasy","fast","fill","fill-box","fixed","flat","flex","flex-end","flex-start","footnotes","forwards","from","geometricPrecision","georgian","graytext","grid","groove","gujarati","gurmukhi","hand","hangul","hangul-consonant","hard-light","hebrew","help","hidden","hide","higher","highlight","highlighttext","hiragana","hiragana-iroha","horizontal","hsl","hsla","hue","icon","ignore","inactiveborder","inactivecaption","inactivecaptiontext","infinite","infobackground","infotext","inherit","initial","inline","inline-axis","inline-block","inline-flex","inline-grid","inline-table","inset","inside","intrinsic","invert","italic","japanese-formal","japanese-informal","justify","kannada","katakana","katakana-iroha","keep-all","khmer","korean-hangul-formal","korean-hanja-formal","korean-hanja-informal","landscape","lao","large","larger","left","level","lighter","lighten","line-through","linear","linear-gradient","lines","list-item","listbox","listitem","local","logical","loud","lower","lower-alpha","lower-armenian","lower-greek","lower-hexadecimal","lower-latin","lower-norwegian","lower-roman","lowercase","ltr","luminosity","malayalam","manipulation","match","matrix","matrix3d","media-controls-background","media-current-time-display","media-fullscreen-button","media-mute-button","media-play-button","media-return-to-realtime-button","media-rewind-button","media-seek-back-button","media-seek-forward-button","media-slider","media-sliderthumb","media-time-remaining-display","media-volume-slider","media-volume-slider-container","media-volume-sliderthumb","medium","menu","menulist","menulist-button","menulist-text","menulist-textfield","menutext","message-box","middle","min-intrinsic","mix","mongolian","monospace","move","multiple","multiple_mask_images","multiply","myanmar","n-resize","narrower","ne-resize","nesw-resize","no-close-quote","no-drop","no-open-quote","no-repeat","none","normal","not-allowed","nowrap","ns-resize","numbers","numeric","nw-resize","nwse-resize","oblique","octal","opacity","open-quote","optimizeLegibility","optimizeSpeed","oriya","oromo","outset","outside","outside-shape","overlay","overline","padding","padding-box","painted","page","paused","persian","perspective","pinch-zoom","plus-darker","plus-lighter","pointer","polygon","portrait","pre","pre-line","pre-wrap","preserve-3d","progress","push-button","radial-gradient","radio","read-only","read-write","read-write-plaintext-only","rectangle","region","relative","repeat","repeating-linear-gradient","repeating-radial-gradient","repeat-x","repeat-y","reset","reverse","rgb","rgba","ridge","right","rotate","rotate3d","rotateX","rotateY","rotateZ","round","row","row-resize","row-reverse","rtl","run-in","running","s-resize","sans-serif","saturation","scale","scale3d","scaleX","scaleY","scaleZ","screen","scroll","scrollbar","scroll-position","se-resize","searchfield","searchfield-cancel-button","searchfield-decoration","searchfield-results-button","searchfield-results-decoration","self-start","self-end","semi-condensed","semi-expanded","separate","serif","show","sidama","simp-chinese-formal","simp-chinese-informal","single","skew","skewX","skewY","skip-white-space","slide","slider-horizontal","slider-vertical","sliderthumb-horizontal","sliderthumb-vertical","slow","small","small-caps","small-caption","smaller","soft-light","solid","somali","source-atop","source-in","source-out","source-over","space","space-around","space-between","space-evenly","spell-out","square","square-button","start","static","status-bar","stretch","stroke","stroke-box","sub","subpixel-antialiased","svg_masks","super","sw-resize","symbolic","symbols","system-ui","table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group","tamil","telugu","text","text-bottom","text-top","textarea","textfield","thai","thick","thin","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","tibetan","tigre","tigrinya-er","tigrinya-er-abegede","tigrinya-et","tigrinya-et-abegede","to","top","trad-chinese-formal","trad-chinese-informal","transform","translate","translate3d","translateX","translateY","translateZ","transparent","ultra-condensed","ultra-expanded","underline","unidirectional-pan","unset","up","upper-alpha","upper-armenian","upper-greek","upper-hexadecimal","upper-latin","upper-norwegian","upper-roman","uppercase","urdu","url","var","vertical","vertical-text","view-box","visible","visibleFill","visiblePainted","visibleStroke","visual","w-resize","wait","wave","wider","window","windowframe","windowtext","words","wrap","wrap-reverse","x-large","x-small","xor","xx-large","xx-small"],valueKeywords=keySet(valueKeywords_),allWords=documentTypes_.concat(mediaTypes_).concat(mediaFeatures_).concat(mediaValueKeywords_).concat(propertyKeywords_).concat(nonStandardPropertyKeywords_).concat(colorKeywords_).concat(valueKeywords_);function tokenCComment(stream,state){for(var ch,maybeEnd=!1;null!=(ch=stream.next());){if(maybeEnd&&"/"==ch){state.tokenize=null;break}maybeEnd="*"==ch}return["comment","comment"]}CodeMirror.registerHelper("hintWords","css",allWords),CodeMirror.defineMIME("text/css",{documentTypes:documentTypes,mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,mediaValueKeywords:mediaValueKeywords,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,fontProperties:fontProperties,counterDescriptors:counterDescriptors,colorKeywords:colorKeywords,valueKeywords:valueKeywords,tokenHooks:{"/":function(stream,state){return!!stream.eat("*")&&(state.tokenize=tokenCComment,tokenCComment(stream,state))}},name:"css"}),CodeMirror.defineMIME("text/x-scss",{mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,mediaValueKeywords:mediaValueKeywords,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,fontProperties:fontProperties,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(stream,state){return stream.eat("/")?(stream.skipToEnd(),["comment","comment"]):stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):["operator","operator"]},":":function(stream){return!!stream.match(/\s*\{/,!1)&&[null,null]},$:function(stream){return stream.match(/^[\w-]+/),stream.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"]},"#":function(stream){return!!stream.eat("{")&&[null,"interpolation"]}},name:"css",helperType:"scss"}),CodeMirror.defineMIME("text/x-less",{mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,mediaValueKeywords:mediaValueKeywords,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,colorKeywords:colorKeywords,valueKeywords:valueKeywords,fontProperties:fontProperties,allowNested:!0,lineComment:"//",tokenHooks:{"/":function(stream,state){return stream.eat("/")?(stream.skipToEnd(),["comment","comment"]):stream.eat("*")?(state.tokenize=tokenCComment,tokenCComment(stream,state)):["operator","operator"]},"@":function(stream){return stream.eat("{")?[null,"interpolation"]:!stream.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/i,!1)&&(stream.eatWhile(/[\w\\\-]/),stream.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"}),CodeMirror.defineMIME("text/x-gss",{documentTypes:documentTypes,mediaTypes:mediaTypes,mediaFeatures:mediaFeatures,propertyKeywords:propertyKeywords,nonStandardPropertyKeywords:nonStandardPropertyKeywords,fontProperties:fontProperties,counterDescriptors:counterDescriptors,colorKeywords:colorKeywords,valueKeywords:valueKeywords,supportsAtComponent:!0,tokenHooks:{"/":function(stream,state){return!!stream.eat("*")&&(state.tokenize=tokenCComment,tokenCComment(stream,state))}},name:"css",helperType:"gss"})}),function(mod){"object"==typeof exports&&"object"==typeof module?mod(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],mod):mod(CodeMirror)}(function(CodeMirror){"use strict";var defaultTags={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]};var attrRegexpCache={};function getAttrValue(text,attr){var match=text.match(function(attr){var regexp=attrRegexpCache[attr];return regexp||(attrRegexpCache[attr]=new RegExp("\\s+"+attr+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*"))}(attr));return match?/^\s*(.*?)\s*$/.exec(match[2])[1]:""}function getTagRegexp(tagName,anchored){return new RegExp((anchored?"^":"")+"</s*"+tagName+"s*>","i")}function addTags(from,to){for(var tag in from)for(var dest=to[tag]||(to[tag]=[]),source=from[tag],i=source.length-1;i>=0;i--)dest.unshift(source[i])}CodeMirror.defineMode("htmlmixed",function(config,parserConfig){var htmlMode=CodeMirror.getMode(config,{name:"xml",htmlMode:!0,multilineTagIndentFactor:parserConfig.multilineTagIndentFactor,multilineTagIndentPastTag:parserConfig.multilineTagIndentPastTag}),tags={},configTags=parserConfig&&parserConfig.tags,configScript=parserConfig&&parserConfig.scriptTypes;if(addTags(defaultTags,tags),configTags&&addTags(configTags,tags),configScript)for(var i=configScript.length-1;i>=0;i--)tags.script.unshift(["type",configScript[i].matches,configScript[i].mode]);function html(stream,state){var tagName,style=htmlMode.token(stream,state.htmlState),tag=/\btag\b/.test(style);if(tag&&!/[<>\s\/]/.test(stream.current())&&(tagName=state.htmlState.tagName&&state.htmlState.tagName.toLowerCase())&&tags.hasOwnProperty(tagName))state.inTag=tagName+" ";else if(state.inTag&&tag&&/>$/.test(stream.current())){var inTag=/^([\S]+) (.*)/.exec(state.inTag);state.inTag=null;var modeSpec=">"==stream.current()&&function(tagInfo,tagText){for(var i=0;i<tagInfo.length;i++){var spec=tagInfo[i];if(!spec[0]||spec[1].test(getAttrValue(tagText,spec[0])))return spec[2]}}(tags[inTag[1]],inTag[2]),mode=CodeMirror.getMode(config,modeSpec),endTagA=getTagRegexp(inTag[1],!0),endTag=getTagRegexp(inTag[1],!1);state.token=function(stream,state){return stream.match(endTagA,!1)?(state.token=html,state.localState=state.localMode=null,null):function(stream,pat,style){var cur=stream.current(),close=cur.search(pat);return close>-1?stream.backUp(cur.length-close):cur.match(/<\/?$/)&&(stream.backUp(cur.length),stream.match(pat,!1)||stream.match(cur)),style}(stream,endTag,state.localMode.token(stream,state.localState))},state.localMode=mode,state.localState=CodeMirror.startState(mode,htmlMode.indent(state.htmlState,"",""))}else state.inTag&&(state.inTag+=stream.current(),stream.eol()&&(state.inTag+=" "));return style}return{startState:function(){return{token:html,inTag:null,localMode:null,localState:null,htmlState:CodeMirror.startState(htmlMode)}},copyState:function(state){var local;return state.localState&&(local=CodeMirror.copyState(state.localMode,state.localState)),{token:state.token,inTag:state.inTag,localMode:state.localMode,localState:local,htmlState:CodeMirror.copyState(htmlMode,state.htmlState)}},token:function(stream,state){return state.token(stream,state)},indent:function(state,textAfter,line){return!state.localMode||/^\s*<\//.test(textAfter)?htmlMode.indent(state.htmlState,textAfter,line):state.localMode.indent?state.localMode.indent(state.localState,textAfter,line):CodeMirror.Pass},innerMode:function(state){return{state:state.localState||state.htmlState,mode:state.localMode||htmlMode}}}},"xml","javascript","css"),CodeMirror.defineMIME("text/html","htmlmixed")}),function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.io=factory():root.io=factory()}((()=>"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:Function("return this")())(),function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s="./build/index.js")}({"./build/index.js":function(module,exports,__webpack_require__){"use strict";function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Socket=exports.io=exports.Manager=exports.protocol=void 0;var url_1=__webpack_require__("./build/url.js"),manager_1=__webpack_require__("./build/manager.js"),socket_1=__webpack_require__("./build/socket.js");Object.defineProperty(exports,"Socket",{enumerable:!0,get:function(){return socket_1.Socket}});var debug=__webpack_require__("./node_modules/debug/src/browser.js")("socket.io-client");module.exports=exports=lookup;var cache=exports.managers={};function lookup(uri,opts){"object"===_typeof(uri)&&(opts=uri,uri=void 0),opts=opts||{};var io,parsed=url_1.url(uri),source=parsed.source,id=parsed.id,path=parsed.path,sameNamespace=cache[id]&&path in cache[id].nsps;return opts.forceNew||opts["force new connection"]||!1===opts.multiplex||sameNamespace?(debug("ignoring socket cache for %s",source),io=new manager_1.Manager(source,opts)):(cache[id]||(debug("new io instance for %s",source),cache[id]=new manager_1.Manager(source,opts)),io=cache[id]),parsed.query&&!opts.query&&(opts.query=parsed.query),io.socket(parsed.path,opts)}exports.io=lookup;var socket_io_parser_1=__webpack_require__("./node_modules/socket.io-parser/dist/index.js");Object.defineProperty(exports,"protocol",{enumerable:!0,get:function(){return socket_io_parser_1.protocol}}),exports.connect=lookup;var manager_2=__webpack_require__("./build/manager.js");Object.defineProperty(exports,"Manager",{enumerable:!0,get:function(){return manager_2.Manager}})},"./build/manager.js":function(module,exports,__webpack_require__){"use strict";function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Manager=void 0;var eio=__webpack_require__("./node_modules/engine.io-client/lib/index.js"),socket_1=__webpack_require__("./build/socket.js"),Emitter=__webpack_require__("./node_modules/component-emitter/index.js"),parser=__webpack_require__("./node_modules/socket.io-parser/dist/index.js"),on_1=__webpack_require__("./build/on.js"),bind=__webpack_require__("./node_modules/component-bind/index.js"),Backoff=__webpack_require__("./node_modules/backo2/index.js"),debug=__webpack_require__("./node_modules/debug/src/browser.js")("socket.io-client:manager"),Manager=function(_Emitter){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Manager,Emitter);var Constructor,protoProps,staticProps,_super=_createSuper(Manager);function Manager(uri,opts){var _this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Manager),(_this=_super.call(this)).nsps={},_this.subs=[],uri&&"object"===_typeof(uri)&&(opts=uri,uri=void 0),(opts=opts||{}).path=opts.path||"/socket.io",_this.opts=opts,_this.reconnection(!1!==opts.reconnection),_this.reconnectionAttempts(opts.reconnectionAttempts||1/0),_this.reconnectionDelay(opts.reconnectionDelay||1e3),_this.reconnectionDelayMax(opts.reconnectionDelayMax||5e3),_this.randomizationFactor(opts.randomizationFactor||.5),_this.backoff=new Backoff({min:_this.reconnectionDelay(),max:_this.reconnectionDelayMax(),jitter:_this.randomizationFactor()}),_this.timeout(null==opts.timeout?2e4:opts.timeout),_this._readyState="closed",_this.uri=uri;var _parser=opts.parser||parser;return _this.encoder=new _parser.Encoder,_this.decoder=new _parser.Decoder,_this._autoConnect=!1!==opts.autoConnect,_this._autoConnect&&_this.open(),_this}return Constructor=Manager,(protoProps=[{key:"reconnection",value:function(v){return arguments.length?(this._reconnection=!!v,this):this._reconnection}},{key:"reconnectionAttempts",value:function(v){return void 0===v?this._reconnectionAttempts:(this._reconnectionAttempts=v,this)}},{key:"reconnectionDelay",value:function(v){var _a;return void 0===v?this._reconnectionDelay:(this._reconnectionDelay=v,null===(_a=this.backoff)||void 0===_a||_a.setMin(v),this)}},{key:"randomizationFactor",value:function(v){var _a;return void 0===v?this._randomizationFactor:(this._randomizationFactor=v,null===(_a=this.backoff)||void 0===_a||_a.setJitter(v),this)}},{key:"reconnectionDelayMax",value:function(v){var _a;return void 0===v?this._reconnectionDelayMax:(this._reconnectionDelayMax=v,null===(_a=this.backoff)||void 0===_a||_a.setMax(v),this)}},{key:"timeout",value:function(v){return arguments.length?(this._timeout=v,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(fn){var _this2=this;if(debug("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;debug("opening %s",this.uri),this.engine=eio(this.uri,this.opts);var socket=this.engine,self=this;this._readyState="opening",this.skipReconnect=!1;var openSub=on_1.on(socket,"open",function(){self.onopen(),fn&&fn()}),errorSub=on_1.on(socket,"error",function(err){debug("error"),self.cleanup(),self._readyState="closed",_get(_getPrototypeOf(Manager.prototype),"emit",_this2).call(_this2,"error",err),fn?fn(err):self.maybeReconnectOnOpen()});if(!1!==this._timeout){var timeout=this._timeout;debug("connect attempt will timeout after %d",timeout),0===timeout&&openSub.destroy();var timer=setTimeout(function(){debug("connect attempt timed out after %d",timeout),openSub.destroy(),socket.close(),socket.emit("error",new Error("timeout"))},timeout);this.subs.push({destroy:function(){clearTimeout(timer)}})}return this.subs.push(openSub),this.subs.push(errorSub),this}},{key:"connect",value:function(fn){return this.open(fn)}},{key:"onopen",value:function(){debug("open"),this.cleanup(),this._readyState="open",_get(_getPrototypeOf(Manager.prototype),"emit",this).call(this,"open");var socket=this.engine;this.subs.push(on_1.on(socket,"data",bind(this,"ondata")),on_1.on(socket,"ping",bind(this,"onping")),on_1.on(socket,"error",bind(this,"onerror")),on_1.on(socket,"close",bind(this,"onclose")),on_1.on(this.decoder,"decoded",bind(this,"ondecoded")))}},{key:"onping",value:function(){_get(_getPrototypeOf(Manager.prototype),"emit",this).call(this,"ping")}},{key:"ondata",value:function(data){this.decoder.add(data)}},{key:"ondecoded",value:function(packet){_get(_getPrototypeOf(Manager.prototype),"emit",this).call(this,"packet",packet)}},{key:"onerror",value:function(err){debug("error",err),_get(_getPrototypeOf(Manager.prototype),"emit",this).call(this,"error",err)}},{key:"socket",value:function(nsp,opts){var socket=this.nsps[nsp];return socket||(socket=new socket_1.Socket(this,nsp,opts),this.nsps[nsp]=socket),socket}},{key:"_destroy",value:function(socket){for(var _i=0,_nsps=Object.keys(this.nsps);_i<_nsps.length;_i++){var nsp=_nsps[_i];if(this.nsps[nsp].active)return void debug("socket %s is still active, skipping close",nsp)}this._close()}},{key:"_packet",value:function(packet){debug("writing packet %j",packet),packet.query&&0===packet.type&&(packet.nsp+="?"+packet.query);for(var encodedPackets=this.encoder.encode(packet),i=0;i<encodedPackets.length;i++)this.engine.write(encodedPackets[i],packet.options)}},{key:"cleanup",value:function(){debug("cleanup");for(var subsLength=this.subs.length,i=0;i<subsLength;i++){this.subs.shift().destroy()}this.decoder.destroy()}},{key:"_close",value:function(){debug("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(reason){debug("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",_get(_getPrototypeOf(Manager.prototype),"emit",this).call(this,"close",reason),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var _this3=this;if(this._reconnecting||this.skipReconnect)return this;var self=this;if(this.backoff.attempts>=this._reconnectionAttempts)debug("reconnect failed"),this.backoff.reset(),_get(_getPrototypeOf(Manager.prototype),"emit",this).call(this,"reconnect_failed"),this._reconnecting=!1;else{var delay=this.backoff.duration();debug("will wait %dms before reconnect attempt",delay),this._reconnecting=!0;var timer=setTimeout(function(){self.skipReconnect||(debug("attempting reconnect"),_get(_getPrototypeOf(Manager.prototype),"emit",_this3).call(_this3,"reconnect_attempt",self.backoff.attempts),self.skipReconnect||self.open(function(err){err?(debug("reconnect attempt error"),self._reconnecting=!1,self.reconnect(),_get(_getPrototypeOf(Manager.prototype),"emit",_this3).call(_this3,"reconnect_error",err)):(debug("reconnect success"),self.onreconnect())}))},delay);this.subs.push({destroy:function(){clearTimeout(timer)}})}}},{key:"onreconnect",value:function(){var attempt=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),_get(_getPrototypeOf(Manager.prototype),"emit",this).call(this,"reconnect",attempt)}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Manager}();exports.Manager=Manager},"./build/on.js":function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.on=void 0,exports.on=function(obj,ev,fn){return obj.on(ev,fn),{destroy:function(){obj.off(ev,fn)}}}},"./build/socket.js":function(module,exports,__webpack_require__){"use strict";function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _createForOfIteratorHelper(o,allowArrayLike){var it;if("undefined"==typeof Symbol||null==o[Symbol.iterator]){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=o[Symbol.iterator]()},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Socket=void 0;var socket_io_parser_1=__webpack_require__("./node_modules/socket.io-parser/dist/index.js"),Emitter=__webpack_require__("./node_modules/component-emitter/index.js"),on_1=__webpack_require__("./build/on.js"),bind=__webpack_require__("./node_modules/component-bind/index.js"),debug=__webpack_require__("./node_modules/debug/src/browser.js")("socket.io-client:socket"),RESERVED_EVENTS=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Socket=function(_Emitter){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Socket,Emitter);var Constructor,protoProps,staticProps,_super=_createSuper(Socket);function Socket(io,nsp,opts){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Socket),(_this=_super.call(this)).ids=0,_this.acks={},_this.receiveBuffer=[],_this.sendBuffer=[],_this.flags={},_this.io=io,_this.nsp=nsp,_this.ids=0,_this.acks={},_this.receiveBuffer=[],_this.sendBuffer=[],_this.connected=!1,_this.disconnected=!0,_this.flags={},opts&&opts.auth&&(_this.auth=opts.auth),_this.io._autoConnect&&_this.open(),_this}return Constructor=Socket,(protoProps=[{key:"subEvents",value:function(){if(!this.subs){var io=this.io;this.subs=[on_1.on(io,"open",bind(this,"onopen")),on_1.on(io,"packet",bind(this,"onpacket")),on_1.on(io,"close",bind(this,"onclose"))]}}},{key:"connect",value:function(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen(),this)}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return args.unshift("message"),this.emit.apply(this,args),this}},{key:"emit",value:function(ev){if(RESERVED_EVENTS.hasOwnProperty(ev))throw new Error('"'+ev+'" is a reserved event name');for(var _len2=arguments.length,args=new Array(_len2>1?_len2-1:0),_key2=1;_key2<_len2;_key2++)args[_key2-1]=arguments[_key2];args.unshift(ev);var packet={type:socket_io_parser_1.PacketType.EVENT,data:args,options:{}};packet.options.compress=!1!==this.flags.compress,"function"==typeof args[args.length-1]&&(debug("emitting packet with ack id %d",this.ids),this.acks[this.ids]=args.pop(),packet.id=this.ids++);var isTransportWritable=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!isTransportWritable||!this.connected)?debug("discard packet as the transport is not currently writable"):this.connected?this.packet(packet):this.sendBuffer.push(packet),this.flags={},this}},{key:"packet",value:function(_packet){_packet.nsp=this.nsp,this.io._packet(_packet)}},{key:"onopen",value:function(){var _this2=this;debug("transport is open - connecting"),"function"==typeof this.auth?this.auth(function(data){_this2.packet({type:socket_io_parser_1.PacketType.CONNECT,data:data})}):this.packet({type:socket_io_parser_1.PacketType.CONNECT,data:this.auth})}},{key:"onclose",value:function(reason){debug("close (%s)",reason),this.connected=!1,this.disconnected=!0,delete this.id,_get(_getPrototypeOf(Socket.prototype),"emit",this).call(this,"disconnect",reason)}},{key:"onpacket",value:function(packet){if(packet.nsp===this.nsp)switch(packet.type){case socket_io_parser_1.PacketType.CONNECT:if(packet.data&&packet.data.sid){var id=packet.data.sid;this.onconnect(id)}else _get(_getPrototypeOf(Socket.prototype),"emit",this).call(this,"connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case socket_io_parser_1.PacketType.EVENT:case socket_io_parser_1.PacketType.BINARY_EVENT:this.onevent(packet);break;case socket_io_parser_1.PacketType.ACK:case socket_io_parser_1.PacketType.BINARY_ACK:this.onack(packet);break;case socket_io_parser_1.PacketType.DISCONNECT:this.ondisconnect();break;case socket_io_parser_1.PacketType.CONNECT_ERROR:var err=new Error(packet.data.message);err.data=packet.data.data,_get(_getPrototypeOf(Socket.prototype),"emit",this).call(this,"connect_error",err)}}},{key:"onevent",value:function(packet){var args=packet.data||[];debug("emitting event %j",args),null!=packet.id&&(debug("attaching ack callback to event"),args.push(this.ack(packet.id))),this.connected?this.emitEvent(args):this.receiveBuffer.push(Object.freeze(args))}},{key:"emitEvent",value:function(args){if(this._anyListeners&&this._anyListeners.length){var _step,_iterator=_createForOfIteratorHelper(this._anyListeners.slice());try{for(_iterator.s();!(_step=_iterator.n()).done;){_step.value.apply(this,args)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}_get(_getPrototypeOf(Socket.prototype),"emit",this).apply(this,args)}},{key:"ack",value:function(id){var self=this,sent=!1;return function(){if(!sent){sent=!0;for(var _len3=arguments.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=arguments[_key3];debug("sending ack %j",args),self.packet({type:socket_io_parser_1.PacketType.ACK,id:id,data:args})}}}},{key:"onack",value:function(packet){var ack=this.acks[packet.id];"function"==typeof ack?(debug("calling ack %s with %j",packet.id,packet.data),ack.apply(this,packet.data),delete this.acks[packet.id]):debug("bad ack %s",packet.id)}},{key:"onconnect",value:function(id){debug("socket connected with id %s",id),this.id=id,this.connected=!0,this.disconnected=!1,_get(_getPrototypeOf(Socket.prototype),"emit",this).call(this,"connect"),this.emitBuffered()}},{key:"emitBuffered",value:function(){var _this3=this;this.receiveBuffer.forEach(function(args){return _this3.emitEvent(args)}),this.receiveBuffer=[],this.sendBuffer.forEach(function(packet){return _this3.packet(packet)}),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){debug("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){if(this.subs){for(var i=0;i<this.subs.length;i++)this.subs[i].destroy();this.subs=null}this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&(debug("performing disconnect (%s)",this.nsp),this.packet({type:socket_io_parser_1.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(_compress){return this.flags.compress=_compress,this}},{key:"onAny",value:function(listener){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(listener),this}},{key:"prependAny",value:function(listener){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(listener),this}},{key:"offAny",value:function(listener){if(!this._anyListeners)return this;if(listener){for(var listeners=this._anyListeners,i=0;i<listeners.length;i++)if(listener===listeners[i])return listeners.splice(i,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"active",get:function(){return!!this.subs}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Socket}();exports.Socket=Socket},"./build/url.js":function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.url=void 0;var parseuri=__webpack_require__("./node_modules/parseuri/index.js"),debug=__webpack_require__("./node_modules/debug/src/browser.js")("socket.io-client:url");exports.url=function(uri,loc){var obj=uri;loc=loc||"undefined"!=typeof location&&location,null==uri&&(uri=loc.protocol+"//"+loc.host),"string"==typeof uri&&("/"===uri.charAt(0)&&(uri="/"===uri.charAt(1)?loc.protocol+uri:loc.host+uri),/^(https?|wss?):\/\//.test(uri)||(debug("protocol-less url %s",uri),uri=void 0!==loc?loc.protocol+"//"+uri:"https://"+uri),debug("parse %s",uri),obj=parseuri(uri)),obj.port||(/^(http|ws)$/.test(obj.protocol)?obj.port="80":/^(http|ws)s$/.test(obj.protocol)&&(obj.port="443")),obj.path=obj.path||"/";var host=-1!==obj.host.indexOf(":")?"["+obj.host+"]":obj.host;return obj.id=obj.protocol+"://"+host+":"+obj.port,obj.href=obj.protocol+"://"+host+(loc&&loc.port===obj.port?"":":"+obj.port),obj}},"./node_modules/backo2/index.js":function(module,exports){function Backoff(opts){opts=opts||{},this.ms=opts.min||100,this.max=opts.max||1e4,this.factor=opts.factor||2,this.jitter=opts.jitter>0&&opts.jitter<=1?opts.jitter:0,this.attempts=0}module.exports=Backoff,Backoff.prototype.duration=function(){var ms=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var rand=Math.random(),deviation=Math.floor(rand*this.jitter*ms);ms=0==(1&Math.floor(10*rand))?ms-deviation:ms+deviation}return 0|Math.min(ms,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(min){this.ms=min},Backoff.prototype.setMax=function(max){this.max=max},Backoff.prototype.setJitter=function(jitter){this.jitter=jitter}},"./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js":function(module,exports){!function(){"use strict";for(var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",lookup=new Uint8Array(256),i=0;i<chars.length;i++)lookup[chars.charCodeAt(i)]=i;exports.encode=function(arraybuffer){var i,bytes=new Uint8Array(arraybuffer),len=bytes.length,base64="";for(i=0;i<len;i+=3)base64+=chars[bytes[i]>>2],base64+=chars[(3&bytes[i])<<4|bytes[i+1]>>4],base64+=chars[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64+=chars[63&bytes[i+2]];return len%3==2?base64=base64.substring(0,base64.length-1)+"=":len%3==1&&(base64=base64.substring(0,base64.length-2)+"=="),base64},exports.decode=function(base64){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*base64.length,len=base64.length,p=0;"="===base64[base64.length-1]&&(bufferLength--,"="===base64[base64.length-2]&&bufferLength--);var arraybuffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(arraybuffer);for(i=0;i<len;i+=4)encoded1=lookup[base64.charCodeAt(i)],encoded2=lookup[base64.charCodeAt(i+1)],encoded3=lookup[base64.charCodeAt(i+2)],encoded4=lookup[base64.charCodeAt(i+3)],bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return arraybuffer}}()},"./node_modules/component-bind/index.js":function(module,exports){var slice=[].slice;module.exports=function(obj,fn){if("string"==typeof fn&&(fn=obj[fn]),"function"!=typeof fn)throw new Error("bind() requires a function");var args=slice.call(arguments,2);return function(){return fn.apply(obj,args.concat(slice.call(arguments)))}}},"./node_modules/component-emitter/index.js":function(module,exports,__webpack_require__){function Emitter(obj){if(obj)return function(obj){for(var key in Emitter.prototype)obj[key]=Emitter.prototype[key];return obj}(obj)}module.exports=Emitter,Emitter.prototype.on=Emitter.prototype.addEventListener=function(event,fn){return this._callbacks=this._callbacks||{},(this._callbacks["$"+event]=this._callbacks["$"+event]||[]).push(fn),this},Emitter.prototype.once=function(event,fn){function on(){this.off(event,on),fn.apply(this,arguments)}return on.fn=fn,this.on(event,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(event,fn){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var cb,callbacks=this._callbacks["$"+event];if(!callbacks)return this;if(1==arguments.length)return delete this._callbacks["$"+event],this;for(var i=0;i<callbacks.length;i++)if((cb=callbacks[i])===fn||cb.fn===fn){callbacks.splice(i,1);break}return 0===callbacks.length&&delete this._callbacks["$"+event],this},Emitter.prototype.emit=function(event){this._callbacks=this._callbacks||{};for(var args=new Array(arguments.length-1),callbacks=this._callbacks["$"+event],i=1;i<arguments.length;i++)args[i-1]=arguments[i];if(callbacks){i=0;for(var len=(callbacks=callbacks.slice(0)).length;i<len;++i)callbacks[i].apply(this,args)}return this},Emitter.prototype.listeners=function(event){return this._callbacks=this._callbacks||{},this._callbacks["$"+event]||[]},Emitter.prototype.hasListeners=function(event){return!!this.listeners(event).length}},"./node_modules/debug/src/browser.js":function(module,exports,__webpack_require__){(function(process){function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}exports.log=function(){var _console;return"object"===("undefined"==typeof console?"undefined":_typeof(console))&&console.log&&(_console=console).log.apply(_console,arguments)},exports.formatArgs=function(args){if(args[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+args[0]+(this.useColors?"%c ":" ")+"+"+module.exports.humanize(this.diff),!this.useColors)return;var c="color: "+this.color;args.splice(1,0,c,"color: inherit");var index=0,lastC=0;args[0].replace(/%[a-zA-Z%]/g,function(match){"%%"!==match&&"%c"===match&&(lastC=++index)}),args.splice(lastC,0,c)},exports.save=function(namespaces){try{namespaces?exports.storage.setItem("debug",namespaces):exports.storage.removeItem("debug")}catch(error){}},exports.load=function(){var r;try{r=exports.storage.getItem("debug")}catch(error){}!r&&void 0!==process&&"env"in process&&(r=process.env.DEBUG);return r},exports.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},exports.storage=function(){try{return localStorage}catch(error){}}(),exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],module.exports=__webpack_require__("./node_modules/debug/src/common.js")(exports),module.exports.formatters.j=function(v){try{return JSON.stringify(v)}catch(error){return"[UnexpectedJSONParseError]: "+error.message}}}).call(this,__webpack_require__("./node_modules/process/browser.js"))},"./node_modules/debug/src/common.js":function(module,exports,__webpack_require__){function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(iter))return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}module.exports=function(env){function selectColor(namespace){for(var hash=0,i=0;i<namespace.length;i++)hash=(hash<<5)-hash+namespace.charCodeAt(i),hash|=0;return createDebug.colors[Math.abs(hash)%createDebug.colors.length]}function createDebug(namespace){var prevTime;function debug(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];if(debug.enabled){var self=debug,curr=Number(new Date),ms=curr-(prevTime||curr);self.diff=ms,self.prev=prevTime,self.curr=curr,prevTime=curr,args[0]=createDebug.coerce(args[0]),"string"!=typeof args[0]&&args.unshift("%O");var index=0;args[0]=args[0].replace(/%([a-zA-Z%])/g,function(match,format){if("%%"===match)return match;index++;var formatter=createDebug.formatters[format];if("function"==typeof formatter){var val=args[index];match=formatter.call(self,val),args.splice(index,1),index--}return match}),createDebug.formatArgs.call(self,args),(self.log||createDebug.log).apply(self,args)}}return debug.namespace=namespace,debug.enabled=createDebug.enabled(namespace),debug.useColors=createDebug.useColors(),debug.color=selectColor(namespace),debug.destroy=destroy,debug.extend=extend,"function"==typeof createDebug.init&&createDebug.init(debug),createDebug.instances.push(debug),debug}function destroy(){var index=createDebug.instances.indexOf(this);return-1!==index&&(createDebug.instances.splice(index,1),!0)}function extend(namespace,delimiter){var newDebug=createDebug(this.namespace+(void 0===delimiter?":":delimiter)+namespace);return newDebug.log=this.log,newDebug}function toNamespace(regexp){return regexp.toString().substring(2,regexp.toString().length-2).replace(/\.\*\?$/,"*")}return createDebug.debug=createDebug,createDebug.default=createDebug,createDebug.coerce=function(val){return val instanceof Error?val.stack||val.message:val},createDebug.disable=function(){var namespaces=[].concat(_toConsumableArray(createDebug.names.map(toNamespace)),_toConsumableArray(createDebug.skips.map(toNamespace).map(function(namespace){return"-"+namespace}))).join(",");return createDebug.enable(""),namespaces},createDebug.enable=function(namespaces){var i;createDebug.save(namespaces),createDebug.names=[],createDebug.skips=[];var split=("string"==typeof namespaces?namespaces:"").split(/[\s,]+/),len=split.length;for(i=0;i<len;i++)split[i]&&("-"===(namespaces=split[i].replace(/\*/g,".*?"))[0]?createDebug.skips.push(new RegExp("^"+namespaces.substr(1)+"$")):createDebug.names.push(new RegExp("^"+namespaces+"$")));for(i=0;i<createDebug.instances.length;i++){var instance=createDebug.instances[i];instance.enabled=createDebug.enabled(instance.namespace)}},createDebug.enabled=function(name){if("*"===name[name.length-1])return!0;var i,len;for(i=0,len=createDebug.skips.length;i<len;i++)if(createDebug.skips[i].test(name))return!1;for(i=0,len=createDebug.names.length;i<len;i++)if(createDebug.names[i].test(name))return!0;return!1},createDebug.humanize=__webpack_require__("./node_modules/ms/index.js"),Object.keys(env).forEach(function(key){createDebug[key]=env[key]}),createDebug.instances=[],createDebug.names=[],createDebug.skips=[],createDebug.formatters={},createDebug.selectColor=selectColor,createDebug.enable(createDebug.load()),createDebug}},"./node_modules/engine.io-client/lib/globalThis.browser.js":function(module,exports){module.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},"./node_modules/engine.io-client/lib/index.js":function(module,exports,__webpack_require__){var Socket=__webpack_require__("./node_modules/engine.io-client/lib/socket.js");module.exports=function(uri,opts){return new Socket(uri,opts)},module.exports.Socket=Socket,module.exports.protocol=Socket.protocol,module.exports.Transport=__webpack_require__("./node_modules/engine.io-client/lib/transport.js"),module.exports.transports=__webpack_require__("./node_modules/engine.io-client/lib/transports/index.js"),module.exports.parser=__webpack_require__("./node_modules/engine.io-parser/lib/index.js")},"./node_modules/engine.io-client/lib/socket.js":function(module,exports,__webpack_require__){function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var transports=__webpack_require__("./node_modules/engine.io-client/lib/transports/index.js"),Emitter=__webpack_require__("./node_modules/component-emitter/index.js"),debug=__webpack_require__("./node_modules/debug/src/browser.js")("engine.io-client:socket"),parser=__webpack_require__("./node_modules/engine.io-parser/lib/index.js"),parseuri=__webpack_require__("./node_modules/parseuri/index.js"),parseqs=__webpack_require__("./node_modules/parseqs/index.js"),Socket=function(_Emitter){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Socket,Emitter);var Constructor,protoProps,staticProps,_super=_createSuper(Socket);function Socket(uri){var _this,opts=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Socket),_this=_super.call(this),uri&&"object"===_typeof(uri)&&(opts=uri,uri=null),uri?(uri=parseuri(uri),opts.hostname=uri.host,opts.secure="https"===uri.protocol||"wss"===uri.protocol,opts.port=uri.port,uri.query&&(opts.query=uri.query)):opts.host&&(opts.hostname=parseuri(opts.host).host),_this.secure=null!=opts.secure?opts.secure:"undefined"!=typeof location&&"https:"===location.protocol,opts.hostname&&!opts.port&&(opts.port=_this.secure?"443":"80"),_this.hostname=opts.hostname||("undefined"!=typeof location?location.hostname:"localhost"),_this.port=opts.port||("undefined"!=typeof location&&location.port?location.port:_this.secure?443:80),_this.transports=opts.transports||["polling","websocket"],_this.readyState="",_this.writeBuffer=[],_this.prevBufferLen=0,_this.opts=_extends({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{}},opts),_this.opts.path=_this.opts.path.replace(/\/$/,"")+"/","string"==typeof _this.opts.query&&(_this.opts.query=parseqs.decode(_this.opts.query)),_this.id=null,_this.upgrades=null,_this.pingInterval=null,_this.pingTimeout=null,_this.pingTimeoutTimer=null,_this.open(),_this}return Constructor=Socket,(protoProps=[{key:"createTransport",value:function(name){debug('creating transport "%s"',name);var query=function(obj){var o={};for(var i in obj)obj.hasOwnProperty(i)&&(o[i]=obj[i]);return o}(this.opts.query);query.EIO=parser.protocol,query.transport=name,this.id&&(query.sid=this.id);var opts=_extends({},this.opts.transportOptions[name],this.opts,{query:query,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return debug("options: %j",opts),new transports[name](opts)}},{key:"open",value:function(){var transport;if(this.opts.rememberUpgrade&&Socket.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))transport="websocket";else{if(0===this.transports.length){var self=this;return void setTimeout(function(){self.emit("error","No transports available")},0)}transport=this.transports[0]}this.readyState="opening";try{transport=this.createTransport(transport)}catch(e){return debug("error while creating transport: %s",e),this.transports.shift(),void this.open()}transport.open(),this.setTransport(transport)}},{key:"setTransport",value:function(transport){debug("setting transport %s",transport.name);var self=this;this.transport&&(debug("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=transport,transport.on("drain",function(){self.onDrain()}).on("packet",function(packet){self.onPacket(packet)}).on("error",function(e){self.onError(e)}).on("close",function(){self.onClose("transport close")})}},{key:"probe",value:function(name){debug('probing transport "%s"',name);var transport=this.createTransport(name,{probe:1}),failed=!1,self=this;function onTransportOpen(){if(self.onlyBinaryUpgrades){var upgradeLosesBinary=!this.supportsBinary&&self.transport.supportsBinary;failed=failed||upgradeLosesBinary}failed||(debug('probe transport "%s" opened',name),transport.send([{type:"ping",data:"probe"}]),transport.once("packet",function(msg){if(!failed)if("pong"===msg.type&&"probe"===msg.data){if(debug('probe transport "%s" pong',name),self.upgrading=!0,self.emit("upgrading",transport),!transport)return;Socket.priorWebsocketSuccess="websocket"===transport.name,debug('pausing current transport "%s"',self.transport.name),self.transport.pause(function(){failed||"closed"!==self.readyState&&(debug("changing transport and sending upgrade packet"),cleanup(),self.setTransport(transport),transport.send([{type:"upgrade"}]),self.emit("upgrade",transport),transport=null,self.upgrading=!1,self.flush())})}else{debug('probe transport "%s" failed',name);var err=new Error("probe error");err.transport=transport.name,self.emit("upgradeError",err)}}))}function freezeTransport(){failed||(failed=!0,cleanup(),transport.close(),transport=null)}function onerror(err){var error=new Error("probe error: "+err);error.transport=transport.name,freezeTransport(),debug('probe transport "%s" failed because of error: %s',name,err),self.emit("upgradeError",error)}function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(to){transport&&to.name!==transport.name&&(debug('"%s" works - aborting "%s"',to.name,transport.name),freezeTransport())}function cleanup(){transport.removeListener("open",onTransportOpen),transport.removeListener("error",onerror),transport.removeListener("close",onTransportClose),self.removeListener("close",onclose),self.removeListener("upgrading",onupgrade)}Socket.priorWebsocketSuccess=!1,transport.once("open",onTransportOpen),transport.once("error",onerror),transport.once("close",onTransportClose),this.once("close",onclose),this.once("upgrading",onupgrade),transport.open()}},{key:"onOpen",value:function(){if(debug("socket open"),this.readyState="open",Socket.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){debug("starting upgrade probes");for(var i=0,l=this.upgrades.length;i<l;i++)this.probe(this.upgrades[i])}}},{key:"onPacket",value:function(packet){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(debug('socket receive: type "%s", data "%s"',packet.type,packet.data),this.emit("packet",packet),this.emit("heartbeat"),packet.type){case"open":this.onHandshake(JSON.parse(packet.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("pong");break;case"error":var err=new Error("server error");err.code=packet.data,this.onError(err);break;case"message":this.emit("data",packet.data),this.emit("message",packet.data)}else debug('packet received with socket readyState "%s"',this.readyState)}},{key:"onHandshake",value:function(data){this.emit("handshake",data),this.id=data.sid,this.transport.query.sid=data.sid,this.upgrades=this.filterUpgrades(data.upgrades),this.pingInterval=data.pingInterval,this.pingTimeout=data.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var _this2=this;clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(function(){_this2.onClose("ping timeout")},this.pingInterval+this.pingTimeout)}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()}},{key:"flush",value:function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(debug("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}},{key:"write",value:function(msg,options,fn){return this.sendPacket("message",msg,options,fn),this}},{key:"send",value:function(msg,options,fn){return this.sendPacket("message",msg,options,fn),this}},{key:"sendPacket",value:function(type,data,options,fn){if("function"==typeof data&&(fn=data,data=void 0),"function"==typeof options&&(fn=options,options=null),"closing"!==this.readyState&&"closed"!==this.readyState){(options=options||{}).compress=!1!==options.compress;var packet={type:type,data:data,options:options};this.emit("packetCreate",packet),this.writeBuffer.push(packet),fn&&this.once("flush",fn),this.flush()}}},{key:"close",value:function(){var self=this;function close(){self.onClose("forced close"),debug("socket closing - telling transport to close"),self.transport.close()}function cleanupAndClose(){self.removeListener("upgrade",cleanupAndClose),self.removeListener("upgradeError",cleanupAndClose),close()}function waitForUpgrade(){self.once("upgrade",cleanupAndClose),self.once("upgradeError",cleanupAndClose)}return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",function(){this.upgrading?waitForUpgrade():close()}):this.upgrading?waitForUpgrade():close()),this}},{key:"onError",value:function(err){debug("socket error %j",err),Socket.priorWebsocketSuccess=!1,this.emit("error",err),this.onClose("transport error",err)}},{key:"onClose",value:function(reason,desc){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){debug('socket close with reason: "%s"',reason);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",reason,desc),this.writeBuffer=[],this.prevBufferLen=0}}},{key:"filterUpgrades",value:function(upgrades){for(var filteredUpgrades=[],i=0,j=upgrades.length;i<j;i++)~this.transports.indexOf(upgrades[i])&&filteredUpgrades.push(upgrades[i]);return filteredUpgrades}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Socket}();Socket.priorWebsocketSuccess=!1,Socket.protocol=parser.protocol,module.exports=Socket},"./node_modules/engine.io-client/lib/transport.js":function(module,exports,__webpack_require__){function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var parser=__webpack_require__("./node_modules/engine.io-parser/lib/index.js"),Emitter=__webpack_require__("./node_modules/component-emitter/index.js"),Transport=function(_Emitter){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Transport,Emitter);var Constructor,protoProps,staticProps,_super=_createSuper(Transport);function Transport(opts){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Transport),(_this=_super.call(this)).opts=opts,_this.query=opts.query,_this.readyState="",_this.socket=opts.socket,_this}return Constructor=Transport,(protoProps=[{key:"onError",value:function(msg,desc){var err=new Error(msg);return err.type="TransportError",err.description=desc,this.emit("error",err),this}},{key:"open",value:function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(packets){if("open"!==this.readyState)throw new Error("Transport not open");this.write(packets)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,this.emit("open")}},{key:"onData",value:function(data){var packet=parser.decodePacket(data,this.socket.binaryType);this.onPacket(packet)}},{key:"onPacket",value:function(packet){this.emit("packet",packet)}},{key:"onClose",value:function(){this.readyState="closed",this.emit("close")}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Transport}();module.exports=Transport},"./node_modules/engine.io-client/lib/transports/index.js":function(module,exports,__webpack_require__){var XMLHttpRequest=__webpack_require__("./node_modules/engine.io-client/lib/xmlhttprequest.js"),XHR=__webpack_require__("./node_modules/engine.io-client/lib/transports/polling-xhr.js"),JSONP=__webpack_require__("./node_modules/engine.io-client/lib/transports/polling-jsonp.js"),websocket=__webpack_require__("./node_modules/engine.io-client/lib/transports/websocket.js");exports.polling=function(opts){var xd=!1,xs=!1,jsonp=!1!==opts.jsonp;if("undefined"!=typeof location){var isSSL="https:"===location.protocol,port=location.port;port||(port=isSSL?443:80),xd=opts.hostname!==location.hostname||port!==opts.port,xs=opts.secure!==isSSL}if(opts.xdomain=xd,opts.xscheme=xs,"open"in new XMLHttpRequest(opts)&&!opts.forceJSONP)return new XHR(opts);if(!jsonp)throw new Error("JSONP disabled");return new JSONP(opts)},exports.websocket=websocket},"./node_modules/engine.io-client/lib/transports/polling-jsonp.js":function(module,exports,__webpack_require__){function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return _assertThisInitialized(self)}(this,result)}}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var callbacks,Polling=__webpack_require__("./node_modules/engine.io-client/lib/transports/polling.js"),globalThis=__webpack_require__("./node_modules/engine.io-client/lib/globalThis.browser.js"),rNewline=/\n/g,rEscapedNewline=/\\n/g;function empty(){}var JSONPPolling=function(_Polling){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(JSONPPolling,Polling);var Constructor,protoProps,staticProps,_super=_createSuper(JSONPPolling);function JSONPPolling(opts){var _this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,JSONPPolling),(_this=_super.call(this,opts)).query=_this.query||{},callbacks||(callbacks=globalThis.___eio=globalThis.___eio||[]),_this.index=callbacks.length;var self=_assertThisInitialized(_this);return callbacks.push(function(msg){self.onData(msg)}),_this.query.j=_this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){self.script&&(self.script.onerror=empty)},!1),_this}return Constructor=JSONPPolling,(protoProps=[{key:"doClose",value:function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),_get(_getPrototypeOf(JSONPPolling.prototype),"doClose",this).call(this)}},{key:"doPoll",value:function(){var self=this,script=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),script.async=!0,script.src=this.uri(),script.onerror=function(e){self.onError("jsonp poll error",e)};var insertAt=document.getElementsByTagName("script")[0];insertAt?insertAt.parentNode.insertBefore(script,insertAt):(document.head||document.body).appendChild(script),this.script=script,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var iframe=document.createElement("iframe");document.body.appendChild(iframe),document.body.removeChild(iframe)},100)}},{key:"doWrite",value:function(data,fn){var iframe,self=this;if(!this.form){var form=document.createElement("form"),area=document.createElement("textarea"),id=this.iframeId="eio_iframe_"+this.index;form.className="socketio",form.style.position="absolute",form.style.top="-1000px",form.style.left="-1000px",form.target=id,form.method="POST",form.setAttribute("accept-charset","utf-8"),area.name="d",form.appendChild(area),document.body.appendChild(form),this.form=form,this.area=area}function complete(){initIframe(),fn()}function initIframe(){if(self.iframe)try{self.form.removeChild(self.iframe)}catch(e){self.onError("jsonp polling iframe removal error",e)}try{var html='<iframe src="javascript:0" name="'+self.iframeId+'">';iframe=document.createElement(html)}catch(e){(iframe=document.createElement("iframe")).name=self.iframeId,iframe.src="javascript:0"}iframe.id=self.iframeId,self.form.appendChild(iframe),self.iframe=iframe}this.form.action=this.uri(),initIframe(),data=data.replace(rEscapedNewline,"\\\n"),this.area.value=data.replace(rNewline,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===self.iframe.readyState&&complete()}:this.iframe.onload=complete}},{key:"supportsBinary",get:function(){return!1}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),JSONPPolling}();module.exports=JSONPPolling},"./node_modules/engine.io-client/lib/transports/polling-xhr.js":function(module,exports,__webpack_require__){function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var XMLHttpRequest=__webpack_require__("./node_modules/engine.io-client/lib/xmlhttprequest.js"),Polling=__webpack_require__("./node_modules/engine.io-client/lib/transports/polling.js"),Emitter=__webpack_require__("./node_modules/component-emitter/index.js"),pick=__webpack_require__("./node_modules/engine.io-client/lib/util.js").pick,globalThis=__webpack_require__("./node_modules/engine.io-client/lib/globalThis.browser.js"),debug=__webpack_require__("./node_modules/debug/src/browser.js")("engine.io-client:polling-xhr");function empty(){}var hasXHR2=null!=new XMLHttpRequest({xdomain:!1}).responseType,XHR=function(_Polling){_inherits(XHR,Polling);var _super=_createSuper(XHR);function XHR(opts){var _this;if(_classCallCheck(this,XHR),_this=_super.call(this,opts),"undefined"!=typeof location){var isSSL="https:"===location.protocol,port=location.port;port||(port=isSSL?443:80),_this.xd="undefined"!=typeof location&&opts.hostname!==location.hostname||port!==opts.port,_this.xs=opts.secure!==isSSL}var forceBase64=opts&&opts.forceBase64;return _this.supportsBinary=hasXHR2&&!forceBase64,_this}return _createClass(XHR,[{key:"request",value:function(){var opts=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _extends(opts,{xd:this.xd,xs:this.xs},this.opts),new Request(this.uri(),opts)}},{key:"doWrite",value:function(data,fn){var req=this.request({method:"POST",data:data}),self=this;req.on("success",fn),req.on("error",function(err){self.onError("xhr post error",err)})}},{key:"doPoll",value:function(){debug("xhr poll");var req=this.request(),self=this;req.on("data",function(data){self.onData(data)}),req.on("error",function(err){self.onError("xhr poll error",err)}),this.pollXhr=req}}]),XHR}(),Request=function(_Emitter){_inherits(Request,Emitter);var _super2=_createSuper(Request);function Request(uri,opts){var _this2;return _classCallCheck(this,Request),(_this2=_super2.call(this)).opts=opts,_this2.method=opts.method||"GET",_this2.uri=uri,_this2.async=!1!==opts.async,_this2.data=void 0!==opts.data?opts.data:null,_this2.create(),_this2}return _createClass(Request,[{key:"create",value:function(){var opts=pick(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized");opts.xdomain=!!this.opts.xd,opts.xscheme=!!this.opts.xs;var xhr=this.xhr=new XMLHttpRequest(opts),self=this;try{debug("xhr open %s: %s",this.method,this.uri),xhr.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var i in xhr.setDisableHeaderCheck&&xhr.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(i)&&xhr.setRequestHeader(i,this.opts.extraHeaders[i])}catch(e){}if("POST"===this.method)try{xhr.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{xhr.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in xhr&&(xhr.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(xhr.timeout=this.opts.requestTimeout),this.hasXDR()?(xhr.onload=function(){self.onLoad()},xhr.onerror=function(){self.onError(xhr.responseText)}):xhr.onreadystatechange=function(){4===xhr.readyState&&(200===xhr.status||1223===xhr.status?self.onLoad():setTimeout(function(){self.onError("number"==typeof xhr.status?xhr.status:0)},0))},debug("xhr data %s",this.data),xhr.send(this.data)}catch(e){return void setTimeout(function(){self.onError(e)},0)}"undefined"!=typeof document&&(this.index=Request.requestsCount++,Request.requests[this.index]=this)}},{key:"onSuccess",value:function(){this.emit("success"),this.cleanup()}},{key:"onData",value:function(data){this.emit("data",data),this.onSuccess()}},{key:"onError",value:function(err){this.emit("error",err),this.cleanup(!0)}},{key:"cleanup",value:function(fromError){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=empty:this.xhr.onreadystatechange=empty,fromError)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete Request.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var data=this.xhr.responseText;null!==data&&this.onData(data)}},{key:"hasXDR",value:function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}},{key:"abort",value:function(){this.cleanup()}}]),Request}();if(Request.requestsCount=0,Request.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",unloadHandler);else if("function"==typeof addEventListener){addEventListener("onpagehide"in globalThis?"pagehide":"unload",unloadHandler,!1)}function unloadHandler(){for(var i in Request.requests)Request.requests.hasOwnProperty(i)&&Request.requests[i].abort()}module.exports=XHR,module.exports.Request=Request},"./node_modules/engine.io-client/lib/transports/polling.js":function(module,exports,__webpack_require__){function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Transport=__webpack_require__("./node_modules/engine.io-client/lib/transport.js"),parseqs=__webpack_require__("./node_modules/parseqs/index.js"),parser=__webpack_require__("./node_modules/engine.io-parser/lib/index.js"),yeast=__webpack_require__("./node_modules/yeast/index.js"),debug=__webpack_require__("./node_modules/debug/src/browser.js")("engine.io-client:polling"),Polling=function(_Transport){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Polling,Transport);var Constructor,protoProps,staticProps,_super=_createSuper(Polling);function Polling(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Polling),_super.apply(this,arguments)}return Constructor=Polling,(protoProps=[{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(onPause){var self=this;function pause(){debug("paused"),self.readyState="paused",onPause()}if(this.readyState="pausing",this.polling||!this.writable){var total=0;this.polling&&(debug("we are currently polling - waiting to pause"),total++,this.once("pollComplete",function(){debug("pre-pause polling complete"),--total||pause()})),this.writable||(debug("we are currently writing - waiting to pause"),total++,this.once("drain",function(){debug("pre-pause writing complete"),--total||pause()}))}else pause()}},{key:"poll",value:function(){debug("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}},{key:"onData",value:function(data){var self=this;debug("polling got data %s",data);parser.decodePayload(data,this.socket.binaryType).forEach(function(packet,index,total){if("opening"===self.readyState&&"open"===packet.type&&self.onOpen(),"close"===packet.type)return self.onClose(),!1;self.onPacket(packet)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():debug('ignoring poll - transport state "%s"',this.readyState))}},{key:"doClose",value:function(){var self=this;function close(){debug("writing close packet"),self.write([{type:"close"}])}"open"===this.readyState?(debug("transport open - closing"),close()):(debug("transport not open - deferring close"),this.once("open",close))}},{key:"write",value:function(packets){var _this=this;this.writable=!1,parser.encodePayload(packets,function(data){_this.doWrite(data,function(){_this.writable=!0,_this.emit("drain")})})}},{key:"uri",value:function(){var query=this.query||{},schema=this.opts.secure?"https":"http",port="";return!1!==this.opts.timestampRequests&&(query[this.opts.timestampParam]=yeast()),this.supportsBinary||query.sid||(query.b64=1),query=parseqs.encode(query),this.opts.port&&("https"===schema&&443!==Number(this.opts.port)||"http"===schema&&80!==Number(this.opts.port))&&(port=":"+this.opts.port),query.length&&(query="?"+query),schema+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+port+this.opts.path+query}},{key:"name",get:function(){return"polling"}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Polling}();module.exports=Polling},"./node_modules/engine.io-client/lib/transports/websocket-constructor.browser.js":function(module,exports,__webpack_require__){var globalThis=__webpack_require__("./node_modules/engine.io-client/lib/globalThis.browser.js");module.exports={WebSocket:globalThis.WebSocket||globalThis.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer"}},"./node_modules/engine.io-client/lib/transports/websocket.js":function(module,exports,__webpack_require__){function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var Transport=__webpack_require__("./node_modules/engine.io-client/lib/transport.js"),parser=__webpack_require__("./node_modules/engine.io-parser/lib/index.js"),parseqs=__webpack_require__("./node_modules/parseqs/index.js"),yeast=__webpack_require__("./node_modules/yeast/index.js"),pick=__webpack_require__("./node_modules/engine.io-client/lib/util.js").pick,_require2=__webpack_require__("./node_modules/engine.io-client/lib/transports/websocket-constructor.browser.js"),WebSocket=_require2.WebSocket,usingBrowserWebSocket=_require2.usingBrowserWebSocket,defaultBinaryType=_require2.defaultBinaryType,debug=__webpack_require__("./node_modules/debug/src/browser.js")("engine.io-client:websocket"),isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),WS=function(_Transport){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(WS,Transport);var Constructor,protoProps,staticProps,_super=_createSuper(WS);function WS(opts){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,WS),(_this=_super.call(this,opts)).supportsBinary=!opts.forceBase64,_this}return Constructor=WS,(protoProps=[{key:"doOpen",value:function(){if(this.check()){var uri=this.uri(),protocols=this.opts.protocols,opts=isReactNative?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress");this.opts.extraHeaders&&(opts.headers=this.opts.extraHeaders);try{this.ws=usingBrowserWebSocket&&!isReactNative?protocols?new WebSocket(uri,protocols):new WebSocket(uri):new WebSocket(uri,protocols,opts)}catch(err){return this.emit("error",err)}this.ws.binaryType=this.socket.binaryType||defaultBinaryType,this.addEventListeners()}}},{key:"addEventListeners",value:function(){var self=this;this.ws.onopen=function(){self.onOpen()},this.ws.onclose=function(){self.onClose()},this.ws.onmessage=function(ev){self.onData(ev.data)},this.ws.onerror=function(e){self.onError("websocket error",e)}}},{key:"write",value:function(packets){var self=this;this.writable=!1;for(var total=packets.length,i=0,l=total;i<l;i++)!function(packet){parser.encodePacket(packet,self.supportsBinary,function(data){var opts={};usingBrowserWebSocket||(packet.options&&(opts.compress=packet.options.compress),self.opts.perMessageDeflate&&("string"==typeof data?Buffer.byteLength(data):data.length)<self.opts.perMessageDeflate.threshold&&(opts.compress=!1));try{usingBrowserWebSocket?self.ws.send(data):self.ws.send(data,opts)}catch(e){debug("websocket closed before onclose event")}--total||done()})}(packets[i]);function done(){self.emit("flush"),setTimeout(function(){self.writable=!0,self.emit("drain")},0)}}},{key:"onClose",value:function(){Transport.prototype.onClose.call(this)}},{key:"doClose",value:function(){void 0!==this.ws&&this.ws.close()}},{key:"uri",value:function(){var query=this.query||{},schema=this.opts.secure?"wss":"ws",port="";return this.opts.port&&("wss"===schema&&443!==Number(this.opts.port)||"ws"===schema&&80!==Number(this.opts.port))&&(port=":"+this.opts.port),this.opts.timestampRequests&&(query[this.opts.timestampParam]=yeast()),this.supportsBinary||(query.b64=1),(query=parseqs.encode(query)).length&&(query="?"+query),schema+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+port+this.opts.path+query}},{key:"check",value:function(){return!(!WebSocket||"__initialize"in WebSocket&&this.name===WS.prototype.name)}},{key:"name",get:function(){return"websocket"}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),WS}();module.exports=WS},"./node_modules/engine.io-client/lib/util.js":function(module,exports){module.exports.pick=function(obj){for(var _len=arguments.length,attr=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)attr[_key-1]=arguments[_key];return attr.reduce(function(acc,k){return acc[k]=obj[k],acc},{})}},"./node_modules/engine.io-client/lib/xmlhttprequest.js":function(module,exports,__webpack_require__){var hasCORS=__webpack_require__("./node_modules/has-cors/index.js"),globalThis=__webpack_require__("./node_modules/engine.io-client/lib/globalThis.browser.js");module.exports=function(opts){var xdomain=opts.xdomain,xscheme=opts.xscheme,enablesXDR=opts.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!xdomain||hasCORS))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!xscheme&&enablesXDR)return new XDomainRequest}catch(e){}if(!xdomain)try{return new(globalThis[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},"./node_modules/engine.io-parser/lib/commons.js":function(module,exports){var PACKET_TYPES=Object.create(null);PACKET_TYPES.open="0",PACKET_TYPES.close="1",PACKET_TYPES.ping="2",PACKET_TYPES.pong="3",PACKET_TYPES.message="4",PACKET_TYPES.upgrade="5",PACKET_TYPES.noop="6";var PACKET_TYPES_REVERSE=Object.create(null);Object.keys(PACKET_TYPES).forEach(function(key){PACKET_TYPES_REVERSE[PACKET_TYPES[key]]=key});module.exports={PACKET_TYPES:PACKET_TYPES,PACKET_TYPES_REVERSE:PACKET_TYPES_REVERSE,ERROR_PACKET:{type:"error",data:"parser error"}}},"./node_modules/engine.io-parser/lib/decodePacket.browser.js":function(module,exports,__webpack_require__){var base64decoder,_require=__webpack_require__("./node_modules/engine.io-parser/lib/commons.js"),PACKET_TYPES_REVERSE=_require.PACKET_TYPES_REVERSE,ERROR_PACKET=_require.ERROR_PACKET;"function"==typeof ArrayBuffer&&(base64decoder=__webpack_require__("./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js"));var decodeBase64Packet=function(data,binaryType){if(base64decoder){var decoded=base64decoder.decode(data);return mapBinary(decoded,binaryType)}return{base64:!0,data:data}},mapBinary=function(data,binaryType){switch(binaryType){case"blob":return data instanceof ArrayBuffer?new Blob([data]):data;case"arraybuffer":default:return data}};module.exports=function(encodedPacket,binaryType){if("string"!=typeof encodedPacket)return{type:"message",data:mapBinary(encodedPacket,binaryType)};var type=encodedPacket.charAt(0);return"b"===type?{type:"message",data:decodeBase64Packet(encodedPacket.substring(1),binaryType)}:PACKET_TYPES_REVERSE[type]?encodedPacket.length>1?{type:PACKET_TYPES_REVERSE[type],data:encodedPacket.substring(1)}:{type:PACKET_TYPES_REVERSE[type]}:ERROR_PACKET}},"./node_modules/engine.io-parser/lib/encodePacket.browser.js":function(module,exports,__webpack_require__){var PACKET_TYPES=__webpack_require__("./node_modules/engine.io-parser/lib/commons.js").PACKET_TYPES,withNativeBlob="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),withNativeArrayBuffer="function"==typeof ArrayBuffer,encodeBlobAsBase64=function(data,callback){var fileReader=new FileReader;return fileReader.onload=function(){var content=fileReader.result.split(",")[1];callback("b"+content)},fileReader.readAsDataURL(data)};module.exports=function(_ref,supportsBinary,callback){var obj,type=_ref.type,data=_ref.data;return withNativeBlob&&data instanceof Blob?supportsBinary?callback(data):encodeBlobAsBase64(data,callback):withNativeArrayBuffer&&(data instanceof ArrayBuffer||(obj=data,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(obj):obj&&obj.buffer instanceof ArrayBuffer))?supportsBinary?callback(data instanceof ArrayBuffer?data:data.buffer):encodeBlobAsBase64(new Blob([data]),callback):callback(PACKET_TYPES[type]+(data||""))}},"./node_modules/engine.io-parser/lib/index.js":function(module,exports,__webpack_require__){var encodePacket=__webpack_require__("./node_modules/engine.io-parser/lib/encodePacket.browser.js"),decodePacket=__webpack_require__("./node_modules/engine.io-parser/lib/decodePacket.browser.js"),SEPARATOR=String.fromCharCode(30);module.exports={protocol:4,encodePacket:encodePacket,encodePayload:function(packets,callback){var length=packets.length,encodedPackets=new Array(length),count=0;packets.forEach(function(packet,i){encodePacket(packet,!1,function(encodedPacket){encodedPackets[i]=encodedPacket,++count===length&&callback(encodedPackets.join(SEPARATOR))})})},decodePacket:decodePacket,decodePayload:function(encodedPayload,binaryType){for(var encodedPackets=encodedPayload.split(SEPARATOR),packets=[],i=0;i<encodedPackets.length;i++){var decodedPacket=decodePacket(encodedPackets[i],binaryType);if(packets.push(decodedPacket),"error"===decodedPacket.type)break}return packets}}},"./node_modules/has-cors/index.js":function(module,exports){try{module.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(err){module.exports=!1}},"./node_modules/ms/index.js":function(module,exports){function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d;function plural(ms,msAbs,n,name){var isPlural=msAbs>=1.5*n;return Math.round(ms/n)+" "+name+(isPlural?"s":"")}module.exports=function(val,options){options=options||{};var type=_typeof(val);if("string"===type&&val.length>0)return function(str){if((str=String(str)).length>100)return;var match=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(str);if(!match)return;var n=parseFloat(match[1]);switch((match[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*y;case"weeks":case"week":case"w":return n*w;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"hrs":case"hr":case"h":return n*h;case"minutes":case"minute":case"mins":case"min":case"m":return n*m;case"seconds":case"second":case"secs":case"sec":case"s":return n*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(val);if("number"===type&&isFinite(val))return options.long?function(ms){var msAbs=Math.abs(ms);if(msAbs>=d)return plural(ms,msAbs,d,"day");if(msAbs>=h)return plural(ms,msAbs,h,"hour");if(msAbs>=m)return plural(ms,msAbs,m,"minute");if(msAbs>=s)return plural(ms,msAbs,s,"second");return ms+" ms"}(val):function(ms){var msAbs=Math.abs(ms);if(msAbs>=d)return Math.round(ms/d)+"d";if(msAbs>=h)return Math.round(ms/h)+"h";if(msAbs>=m)return Math.round(ms/m)+"m";if(msAbs>=s)return Math.round(ms/s)+"s";return ms+"ms"}(val);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(val))}},"./node_modules/parseqs/index.js":function(module,exports){exports.encode=function(obj){var str="";for(var i in obj)obj.hasOwnProperty(i)&&(str.length&&(str+="&"),str+=encodeURIComponent(i)+"="+encodeURIComponent(obj[i]));return str},exports.decode=function(qs){for(var qry={},pairs=qs.split("&"),i=0,l=pairs.length;i<l;i++){var pair=pairs[i].split("=");qry[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1])}return qry}},"./node_modules/parseuri/index.js":function(module,exports){var re=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];module.exports=function(str){var src=str,b=str.indexOf("["),e=str.indexOf("]");-1!=b&&-1!=e&&(str=str.substring(0,b)+str.substring(b,e).replace(/:/g,";")+str.substring(e,str.length));for(var query,data,m=re.exec(str||""),uri={},i=14;i--;)uri[parts[i]]=m[i]||"";return-1!=b&&-1!=e&&(uri.source=src,uri.host=uri.host.substring(1,uri.host.length-1).replace(/;/g,":"),uri.authority=uri.authority.replace("[","").replace("]","").replace(/;/g,":"),uri.ipv6uri=!0),uri.pathNames=function(obj,path){var names=path.replace(/\/{2,9}/g,"/").split("/");"/"!=path.substr(0,1)&&0!==path.length||names.splice(0,1);"/"==path.substr(path.length-1,1)&&names.splice(names.length-1,1);return names}(0,uri.path),uri.queryKey=(query=uri.query,data={},query.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function($0,$1,$2){$1&&(data[$1]=$2)}),data),uri}},"./node_modules/process/browser.js":function(module,exports){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},"./node_modules/socket.io-parser/dist/binary.js":function(module,exports,__webpack_require__){"use strict";function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.reconstructPacket=exports.deconstructPacket=void 0;var is_binary_1=__webpack_require__("./node_modules/socket.io-parser/dist/is-binary.js");exports.deconstructPacket=function(packet){var buffers=[],packetData=packet.data,pack=packet;return pack.data=function _deconstructPacket(data,buffers){if(!data)return data;if(is_binary_1.isBinary(data)){var placeholder={_placeholder:!0,num:buffers.length};return buffers.push(data),placeholder}if(Array.isArray(data)){for(var newData=new Array(data.length),i=0;i<data.length;i++)newData[i]=_deconstructPacket(data[i],buffers);return newData}if("object"===_typeof(data)&&!(data instanceof Date)){var _newData={};for(var key in data)data.hasOwnProperty(key)&&(_newData[key]=_deconstructPacket(data[key],buffers));return _newData}return data}(packetData,buffers),pack.attachments=buffers.length,{packet:pack,buffers:buffers}},exports.reconstructPacket=function(packet,buffers){return packet.data=function _reconstructPacket(data,buffers){if(!data)return data;if(data&&data._placeholder)return buffers[data.num];if(Array.isArray(data))for(var i=0;i<data.length;i++)data[i]=_reconstructPacket(data[i],buffers);else if("object"===_typeof(data))for(var key in data)data.hasOwnProperty(key)&&(data[key]=_reconstructPacket(data[key],buffers));return data}(packet.data,buffers),packet.attachments=void 0,packet}},"./node_modules/socket.io-parser/dist/index.js":function(module,exports,__webpack_require__){"use strict";function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _createSuper(Derived){var hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return function(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(this,result)}}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}Object.defineProperty(exports,"__esModule",{value:!0}),exports.Decoder=exports.Encoder=exports.PacketType=exports.protocol=void 0;var PacketType,Emitter=__webpack_require__("./node_modules/component-emitter/index.js"),binary_1=__webpack_require__("./node_modules/socket.io-parser/dist/binary.js"),is_binary_1=__webpack_require__("./node_modules/socket.io-parser/dist/is-binary.js"),debug=__webpack_require__("./node_modules/debug/src/browser.js")("socket.io-parser");exports.protocol=5,function(PacketType){PacketType[PacketType.CONNECT=0]="CONNECT",PacketType[PacketType.DISCONNECT=1]="DISCONNECT",PacketType[PacketType.EVENT=2]="EVENT",PacketType[PacketType.ACK=3]="ACK",PacketType[PacketType.CONNECT_ERROR=4]="CONNECT_ERROR",PacketType[PacketType.BINARY_EVENT=5]="BINARY_EVENT",PacketType[PacketType.BINARY_ACK=6]="BINARY_ACK"}(PacketType=exports.PacketType||(exports.PacketType={}));var Encoder=function(){function Encoder(){_classCallCheck(this,Encoder)}return _createClass(Encoder,[{key:"encode",value:function(obj){return debug("encoding packet %j",obj),obj.type!==PacketType.EVENT&&obj.type!==PacketType.ACK||!is_binary_1.hasBinary(obj)?[this.encodeAsString(obj)]:(obj.type=obj.type===PacketType.EVENT?PacketType.BINARY_EVENT:PacketType.BINARY_ACK,this.encodeAsBinary(obj))}},{key:"encodeAsString",value:function(obj){var str=""+obj.type;return obj.type!==PacketType.BINARY_EVENT&&obj.type!==PacketType.BINARY_ACK||(str+=obj.attachments+"-"),obj.nsp&&"/"!==obj.nsp&&(str+=obj.nsp+","),null!=obj.id&&(str+=obj.id),null!=obj.data&&(str+=JSON.stringify(obj.data)),debug("encoded %j as %s",obj,str),str}},{key:"encodeAsBinary",value:function(obj){var deconstruction=binary_1.deconstructPacket(obj),pack=this.encodeAsString(deconstruction.packet),buffers=deconstruction.buffers;return buffers.unshift(pack),buffers}}]),Encoder}();exports.Encoder=Encoder;var Decoder=function(_Emitter){!function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(Decoder,Emitter);var _super=_createSuper(Decoder);function Decoder(){return _classCallCheck(this,Decoder),_super.call(this)}return _createClass(Decoder,[{key:"add",value:function(obj){var packet;if("string"==typeof obj)(packet=this.decodeString(obj)).type===PacketType.BINARY_EVENT||packet.type===PacketType.BINARY_ACK?(this.reconstructor=new BinaryReconstructor(packet),0===packet.attachments&&_get(_getPrototypeOf(Decoder.prototype),"emit",this).call(this,"decoded",packet)):_get(_getPrototypeOf(Decoder.prototype),"emit",this).call(this,"decoded",packet);else{if(!is_binary_1.isBinary(obj)&&!obj.base64)throw new Error("Unknown type: "+obj);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(packet=this.reconstructor.takeBinaryData(obj))&&(this.reconstructor=null,_get(_getPrototypeOf(Decoder.prototype),"emit",this).call(this,"decoded",packet))}}},{key:"decodeString",value:function(str){var i=0,p={type:Number(str.charAt(0))};if(void 0===PacketType[p.type])throw new Error("unknown packet type "+p.type);if(p.type===PacketType.BINARY_EVENT||p.type===PacketType.BINARY_ACK){for(var start=i+1;"-"!==str.charAt(++i)&&i!=str.length;);var buf=str.substring(start,i);if(buf!=Number(buf)||"-"!==str.charAt(i))throw new Error("Illegal attachments");p.attachments=Number(buf)}if("/"===str.charAt(i+1)){for(var _start=i+1;++i;){if(","===str.charAt(i))break;if(i===str.length)break}p.nsp=str.substring(_start,i)}else p.nsp="/";var next=str.charAt(i+1);if(""!==next&&Number(next)==next){for(var _start2=i+1;++i;){var _c=str.charAt(i);if(null==_c||Number(_c)!=_c){--i;break}if(i===str.length)break}p.id=Number(str.substring(_start2,i+1))}if(str.charAt(++i)){var payload=function(str){try{return JSON.parse(str)}catch(e){return!1}}(str.substr(i));if(!Decoder.isPayloadValid(p.type,payload))throw new Error("invalid payload");p.data=payload}return debug("decoded %s as %j",str,p),p}},{key:"destroy",value:function(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}],[{key:"isPayloadValid",value:function(type,payload){switch(type){case PacketType.CONNECT:return"object"===_typeof(payload);case PacketType.DISCONNECT:return void 0===payload;case PacketType.CONNECT_ERROR:return"string"==typeof payload||"object"===_typeof(payload);case PacketType.EVENT:case PacketType.BINARY_EVENT:return Array.isArray(payload)&&"string"==typeof payload[0];case PacketType.ACK:case PacketType.BINARY_ACK:return Array.isArray(payload)}}}]),Decoder}();exports.Decoder=Decoder;var BinaryReconstructor=function(){function BinaryReconstructor(packet){_classCallCheck(this,BinaryReconstructor),this.packet=packet,this.buffers=[],this.reconPack=packet}return _createClass(BinaryReconstructor,[{key:"takeBinaryData",value:function(binData){if(this.buffers.push(binData),this.buffers.length===this.reconPack.attachments){var packet=binary_1.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),packet}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),BinaryReconstructor}()},"./node_modules/socket.io-parser/dist/is-binary.js":function(module,exports,__webpack_require__){"use strict";function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.hasBinary=exports.isBinary=void 0;var withNativeArrayBuffer="function"==typeof ArrayBuffer,isView=function(obj){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(obj):obj.buffer instanceof ArrayBuffer},toString=Object.prototype.toString,withNativeBlob="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===toString.call(Blob),withNativeFile="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===toString.call(File);function isBinary(obj){return withNativeArrayBuffer&&(obj instanceof ArrayBuffer||isView(obj))||withNativeBlob&&obj instanceof Blob||withNativeFile&&obj instanceof File}exports.isBinary=isBinary,exports.hasBinary=function hasBinary(obj,toJSON){if(!obj||"object"!==_typeof(obj))return!1;if(Array.isArray(obj)){for(var i=0,l=obj.length;i<l;i++)if(hasBinary(obj[i]))return!0;return!1}if(isBinary(obj))return!0;if(obj.toJSON&&"function"==typeof obj.toJSON&&1===arguments.length)return hasBinary(obj.toJSON(),!0);for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&hasBinary(obj[key]))return!0;return!1}},"./node_modules/yeast/index.js":function(module,exports,__webpack_require__){"use strict";var prev,alphabet="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),length=64,map={},seed=0,i=0;function encode(num){var encoded="";do{encoded=alphabet[num%length]+encoded,num=Math.floor(num/length)}while(num>0);return encoded}function yeast(){var now=encode(+new Date);return now!==prev?(seed=0,prev=now):now+"."+encode(seed++)}for(;i<length;i++)map[alphabet[i]]=i;yeast.encode=encode,yeast.decode=function(str){var decoded=0;for(i=0;i<str.length;i++)decoded=decoded*length+map[str.charAt(i)];return decoded},module.exports=yeast}})}),function(){var style_html=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=18)}([,,function(module,exports,__webpack_require__){"use strict";function OutputLine(parent){this.__parent=parent,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function IndentStringCache(options,baseIndentString){this.__cache=[""],this.__indent_size=options.indent_size,this.__indent_string=options.indent_char,options.indent_with_tabs||(this.__indent_string=new Array(options.indent_size+1).join(options.indent_char)),baseIndentString=baseIndentString||"",options.indent_level>0&&(baseIndentString=new Array(options.indent_level+1).join(this.__indent_string)),this.__base_string=baseIndentString,this.__base_string_length=baseIndentString.length}function Output(options,baseIndentString){this.__indent_cache=new IndentStringCache(options,baseIndentString),this.raw=!1,this._end_with_newline=options.end_with_newline,this.indent_size=options.indent_size,this.wrap_line_length=options.wrap_line_length,this.indent_empty_lines=options.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new OutputLine(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}OutputLine.prototype.clone_empty=function(){var line=new OutputLine(this.__parent);return line.set_indent(this.__indent_count,this.__alignment_count),line},OutputLine.prototype.item=function(index){return index<0?this.__items[this.__items.length+index]:this.__items[index]},OutputLine.prototype.has_match=function(pattern){for(var lastCheckedOutput=this.__items.length-1;lastCheckedOutput>=0;lastCheckedOutput--)if(this.__items[lastCheckedOutput].match(pattern))return!0;return!1},OutputLine.prototype.set_indent=function(indent,alignment){this.is_empty()&&(this.__indent_count=indent||0,this.__alignment_count=alignment||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},OutputLine.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},OutputLine.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},OutputLine.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var next=this.__parent.current_line;return next.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),next.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),next.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===next.__items[0]&&(next.__items.splice(0,1),next.__character_count-=1),!0}return!1},OutputLine.prototype.is_empty=function(){return 0===this.__items.length},OutputLine.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},OutputLine.prototype.push=function(item){this.__items.push(item);var last_newline_index=item.lastIndexOf("\n");-1!==last_newline_index?this.__character_count=item.length-last_newline_index:this.__character_count+=item.length},OutputLine.prototype.pop=function(){var item=null;return this.is_empty()||(item=this.__items.pop(),this.__character_count-=item.length),item},OutputLine.prototype._remove_indent=function(){this.__indent_count>0&&(this.__indent_count-=1,this.__character_count-=this.__parent.indent_size)},OutputLine.prototype._remove_wrap_indent=function(){this.__wrap_point_indent_count>0&&(this.__wrap_point_indent_count-=1)},OutputLine.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),this.__character_count-=1},OutputLine.prototype.toString=function(){var result="";return this.is_empty()?this.__parent.indent_empty_lines&&(result=this.__parent.get_indent_string(this.__indent_count)):(result=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),result+=this.__items.join("")),result},IndentStringCache.prototype.get_indent_size=function(indent,column){var result=this.__base_string_length;return column=column||0,indent<0&&(result=0),result+=indent*this.__indent_size,result+=column},IndentStringCache.prototype.get_indent_string=function(indent_level,column){var result=this.__base_string;return column=column||0,indent_level<0&&(indent_level=0,result=""),column+=indent_level*this.__indent_size,this.__ensure_cache(column),result+=this.__cache[column]},IndentStringCache.prototype.__ensure_cache=function(column){for(;column>=this.__cache.length;)this.__add_column()},IndentStringCache.prototype.__add_column=function(){var column=this.__cache.length,indent=0,result="";this.__indent_size&&column>=this.__indent_size&&(column-=(indent=Math.floor(column/this.__indent_size))*this.__indent_size,result=new Array(indent+1).join(this.__indent_string)),column&&(result+=new Array(column+1).join(" ")),this.__cache.push(result)},Output.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},Output.prototype.get_line_number=function(){return this.__lines.length},Output.prototype.get_indent_string=function(indent,column){return this.__indent_cache.get_indent_string(indent,column)},Output.prototype.get_indent_size=function(indent,column){return this.__indent_cache.get_indent_size(indent,column)},Output.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},Output.prototype.add_new_line=function(force_newline){return!(this.is_empty()||!force_newline&&this.just_added_newline())&&(this.raw||this.__add_outputline(),!0)},Output.prototype.get_code=function(eol){this.trim(!0);var last_item=this.current_line.pop();last_item&&("\n"===last_item[last_item.length-1]&&(last_item=last_item.replace(/\n+$/g,"")),this.current_line.push(last_item)),this._end_with_newline&&this.__add_outputline();var sweet_code=this.__lines.join("\n");return"\n"!==eol&&(sweet_code=sweet_code.replace(/[\n]/g,eol)),sweet_code},Output.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},Output.prototype.set_indent=function(indent,alignment){return indent=indent||0,alignment=alignment||0,this.next_line.set_indent(indent,alignment),this.__lines.length>1?(this.current_line.set_indent(indent,alignment),!0):(this.current_line.set_indent(),!1)},Output.prototype.add_raw_token=function(token){for(var x=0;x<token.newlines;x++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(token.whitespace_before),this.current_line.push(token.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},Output.prototype.add_token=function(printable_token){this.__add_space_before_token(),this.current_line.push(printable_token),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},Output.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},Output.prototype.remove_indent=function(index){for(var output_length=this.__lines.length;index<output_length;)this.__lines[index]._remove_indent(),index++;this.current_line._remove_wrap_indent()},Output.prototype.trim=function(eat_newlines){for(eat_newlines=void 0!==eat_newlines&&eat_newlines,this.current_line.trim();eat_newlines&&this.__lines.length>1&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null},Output.prototype.just_added_newline=function(){return this.current_line.is_empty()},Output.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},Output.prototype.ensure_empty_line_above=function(starts_with,ends_with){for(var index=this.__lines.length-2;index>=0;){var potentialEmptyLine=this.__lines[index];if(potentialEmptyLine.is_empty())break;if(0!==potentialEmptyLine.item(0).indexOf(starts_with)&&potentialEmptyLine.item(-1)!==ends_with){this.__lines.splice(index+1,0,new OutputLine(this)),this.previous_line=this.__lines[this.__lines.length-2];break}index--}},module.exports.Output=Output},function(module,exports,__webpack_require__){"use strict";module.exports.Token=function(type,text,newlines,whitespace_before){this.type=type,this.text=text,this.comments_before=null,this.newlines=newlines||0,this.whitespace_before=whitespace_before||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}},,,function(module,exports,__webpack_require__){"use strict";function Options(options,merge_child_field){this.raw_options=_mergeOpts(options,merge_child_field),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4)),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php"],["auto"])}function _mergeOpts(allOptions,childFieldName){var name,finalOpts={};for(name in allOptions=_normalizeOpts(allOptions))name!==childFieldName&&(finalOpts[name]=allOptions[name]);if(childFieldName&&allOptions[childFieldName])for(name in allOptions[childFieldName])finalOpts[name]=allOptions[childFieldName][name];return finalOpts}function _normalizeOpts(options){var key,convertedOpts={};for(key in options){convertedOpts[key.replace(/-/g,"_")]=options[key]}return convertedOpts}Options.prototype._get_array=function(name,default_value){var option_value=this.raw_options[name],result=default_value||[];return"object"==typeof option_value?null!==option_value&&"function"==typeof option_value.concat&&(result=option_value.concat()):"string"==typeof option_value&&(result=option_value.split(/[^a-zA-Z0-9_\/\-]+/)),result},Options.prototype._get_boolean=function(name,default_value){var option_value=this.raw_options[name];return void 0===option_value?!!default_value:!!option_value},Options.prototype._get_characters=function(name,default_value){var option_value=this.raw_options[name],result=default_value||"";return"string"==typeof option_value&&(result=option_value.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),result},Options.prototype._get_number=function(name,default_value){var option_value=this.raw_options[name];default_value=parseInt(default_value,10),isNaN(default_value)&&(default_value=0);var result=parseInt(option_value,10);return isNaN(result)&&(result=default_value),result},Options.prototype._get_selection=function(name,selection_list,default_value){var result=this._get_selection_list(name,selection_list,default_value);if(1!==result.length)throw new Error("Invalid Option Value: The option '"+name+"' can only be one of the following values:\n"+selection_list+"\nYou passed in: '"+this.raw_options[name]+"'");return result[0]},Options.prototype._get_selection_list=function(name,selection_list,default_value){if(!selection_list||0===selection_list.length)throw new Error("Selection list cannot be empty.");if(default_value=default_value||[selection_list[0]],!this._is_valid_selection(default_value,selection_list))throw new Error("Invalid Default Value!");var result=this._get_array(name,default_value);if(!this._is_valid_selection(result,selection_list))throw new Error("Invalid Option Value: The option '"+name+"' can contain only the following values:\n"+selection_list+"\nYou passed in: '"+this.raw_options[name]+"'");return result},Options.prototype._is_valid_selection=function(result,selection_list){return result.length&&selection_list.length&&!result.some(function(item){return-1===selection_list.indexOf(item)})},module.exports.Options=Options,module.exports.normalizeOpts=_normalizeOpts,module.exports.mergeOpts=_mergeOpts},,function(module,exports,__webpack_require__){"use strict";var regexp_has_sticky=RegExp.prototype.hasOwnProperty("sticky");function InputScanner(input_string){this.__input=input_string||"",this.__input_length=this.__input.length,this.__position=0}InputScanner.prototype.restart=function(){this.__position=0},InputScanner.prototype.back=function(){this.__position>0&&(this.__position-=1)},InputScanner.prototype.hasNext=function(){return this.__position<this.__input_length},InputScanner.prototype.next=function(){var val=null;return this.hasNext()&&(val=this.__input.charAt(this.__position),this.__position+=1),val},InputScanner.prototype.peek=function(index){var val=null;return index=index||0,(index+=this.__position)>=0&&index<this.__input_length&&(val=this.__input.charAt(index)),val},InputScanner.prototype.__match=function(pattern,index){pattern.lastIndex=index;var pattern_match=pattern.exec(this.__input);return!pattern_match||regexp_has_sticky&&pattern.sticky||pattern_match.index!==index&&(pattern_match=null),pattern_match},InputScanner.prototype.test=function(pattern,index){return index=index||0,(index+=this.__position)>=0&&index<this.__input_length&&!!this.__match(pattern,index)},InputScanner.prototype.testChar=function(pattern,index){var val=this.peek(index);return pattern.lastIndex=0,null!==val&&pattern.test(val)},InputScanner.prototype.match=function(pattern){var pattern_match=this.__match(pattern,this.__position);return pattern_match?this.__position+=pattern_match[0].length:pattern_match=null,pattern_match},InputScanner.prototype.read=function(starting_pattern,until_pattern,until_after){var match,val="";return starting_pattern&&(match=this.match(starting_pattern))&&(val+=match[0]),!until_pattern||!match&&starting_pattern||(val+=this.readUntil(until_pattern,until_after)),val},InputScanner.prototype.readUntil=function(pattern,until_after){var val,match_index=this.__position;pattern.lastIndex=this.__position;var pattern_match=pattern.exec(this.__input);return pattern_match?(match_index=pattern_match.index,until_after&&(match_index+=pattern_match[0].length)):match_index=this.__input_length,val=this.__input.substring(this.__position,match_index),this.__position=match_index,val},InputScanner.prototype.readUntilAfter=function(pattern){return this.readUntil(pattern,!0)},InputScanner.prototype.get_regexp=function(pattern,match_from){var result=null,flags="g";return match_from&&regexp_has_sticky&&(flags="y"),"string"==typeof pattern&&""!==pattern?result=new RegExp(pattern,flags):pattern&&(result=new RegExp(pattern.source,flags)),result},InputScanner.prototype.get_literal_regexp=function(literal_string){return RegExp(literal_string.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},InputScanner.prototype.peekUntilAfter=function(pattern){var start=this.__position,val=this.readUntilAfter(pattern);return this.__position=start,val},InputScanner.prototype.lookBack=function(testVal){var start=this.__position-1;return start>=testVal.length&&this.__input.substring(start-testVal.length,start).toLowerCase()===testVal},module.exports.InputScanner=InputScanner},function(module,exports,__webpack_require__){"use strict";var InputScanner=__webpack_require__(8).InputScanner,Token=__webpack_require__(3).Token,TokenStream=__webpack_require__(10).TokenStream,WhitespacePattern=__webpack_require__(11).WhitespacePattern,TOKEN={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"},Tokenizer=function(input_string,options){this._input=new InputScanner(input_string),this._options=options||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new WhitespacePattern(this._input)};Tokenizer.prototype.tokenize=function(){var current;this._input.restart(),this.__tokens=new TokenStream,this._reset();for(var previous=new Token(TOKEN.START,""),open_token=null,open_stack=[],comments=new TokenStream;previous.type!==TOKEN.EOF;){for(current=this._get_next_token(previous,open_token);this._is_comment(current);)comments.add(current),current=this._get_next_token(previous,open_token);comments.isEmpty()||(current.comments_before=comments,comments=new TokenStream),current.parent=open_token,this._is_opening(current)?(open_stack.push(open_token),open_token=current):open_token&&this._is_closing(current,open_token)&&(current.opened=open_token,open_token.closed=current,open_token=open_stack.pop(),current.parent=open_token),current.previous=previous,previous.next=current,this.__tokens.add(current),previous=current}return this.__tokens},Tokenizer.prototype._is_first_token=function(){return this.__tokens.isEmpty()},Tokenizer.prototype._reset=function(){},Tokenizer.prototype._get_next_token=function(previous_token,open_token){this._readWhitespace();var resulting_string=this._input.read(/.+/g);return resulting_string?this._create_token(TOKEN.RAW,resulting_string):this._create_token(TOKEN.EOF,"")},Tokenizer.prototype._is_comment=function(current_token){return!1},Tokenizer.prototype._is_opening=function(current_token){return!1},Tokenizer.prototype._is_closing=function(current_token,open_token){return!1},Tokenizer.prototype._create_token=function(type,text){return new Token(type,text,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)},Tokenizer.prototype._readWhitespace=function(){return this._patterns.whitespace.read()},module.exports.Tokenizer=Tokenizer,module.exports.TOKEN=TOKEN},function(module,exports,__webpack_require__){"use strict";function TokenStream(parent_token){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=parent_token}TokenStream.prototype.restart=function(){this.__position=0},TokenStream.prototype.isEmpty=function(){return 0===this.__tokens_length},TokenStream.prototype.hasNext=function(){return this.__position<this.__tokens_length},TokenStream.prototype.next=function(){var val=null;return this.hasNext()&&(val=this.__tokens[this.__position],this.__position+=1),val},TokenStream.prototype.peek=function(index){var val=null;return index=index||0,(index+=this.__position)>=0&&index<this.__tokens_length&&(val=this.__tokens[index]),val},TokenStream.prototype.add=function(token){this.__parent_token&&(token.parent=this.__parent_token),this.__tokens.push(token),this.__tokens_length+=1},module.exports.TokenStream=TokenStream},function(module,exports,__webpack_require__){"use strict";var Pattern=__webpack_require__(12).Pattern;function WhitespacePattern(input_scanner,parent){Pattern.call(this,input_scanner,parent),parent?this._line_regexp=this._input.get_regexp(parent._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}WhitespacePattern.prototype=new Pattern,WhitespacePattern.prototype.__set_whitespace_patterns=function(whitespace_chars,newline_chars){whitespace_chars+="\\t ",newline_chars+="\\n\\r",this._match_pattern=this._input.get_regexp("["+whitespace_chars+newline_chars+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+newline_chars+"]")},WhitespacePattern.prototype.read=function(){this.newline_count=0,this.whitespace_before_token="";var resulting_string=this._input.read(this._match_pattern);if(" "===resulting_string)this.whitespace_before_token=" ";else if(resulting_string){var matches=this.__split(this._newline_regexp,resulting_string);this.newline_count=matches.length-1,this.whitespace_before_token=matches[this.newline_count]}return resulting_string},WhitespacePattern.prototype.matching=function(whitespace_chars,newline_chars){var result=this._create();return result.__set_whitespace_patterns(whitespace_chars,newline_chars),result._update(),result},WhitespacePattern.prototype._create=function(){return new WhitespacePattern(this._input,this)},WhitespacePattern.prototype.__split=function(regexp,input_string){regexp.lastIndex=0;for(var start_index=0,result=[],next_match=regexp.exec(input_string);next_match;)result.push(input_string.substring(start_index,next_match.index)),start_index=next_match.index+next_match[0].length,next_match=regexp.exec(input_string);return start_index<input_string.length?result.push(input_string.substring(start_index,input_string.length)):result.push(""),result},module.exports.WhitespacePattern=WhitespacePattern},function(module,exports,__webpack_require__){"use strict";function Pattern(input_scanner,parent){this._input=input_scanner,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,parent&&(this._starting_pattern=this._input.get_regexp(parent._starting_pattern,!0),this._match_pattern=this._input.get_regexp(parent._match_pattern,!0),this._until_pattern=this._input.get_regexp(parent._until_pattern),this._until_after=parent._until_after)}Pattern.prototype.read=function(){var result=this._input.read(this._starting_pattern);return this._starting_pattern&&!result||(result+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),result},Pattern.prototype.read_match=function(){return this._input.match(this._match_pattern)},Pattern.prototype.until_after=function(pattern){var result=this._create();return result._until_after=!0,result._until_pattern=this._input.get_regexp(pattern),result._update(),result},Pattern.prototype.until=function(pattern){var result=this._create();return result._until_after=!1,result._until_pattern=this._input.get_regexp(pattern),result._update(),result},Pattern.prototype.starting_with=function(pattern){var result=this._create();return result._starting_pattern=this._input.get_regexp(pattern,!0),result._update(),result},Pattern.prototype.matching=function(pattern){var result=this._create();return result._match_pattern=this._input.get_regexp(pattern,!0),result._update(),result},Pattern.prototype._create=function(){return new Pattern(this._input,this)},Pattern.prototype._update=function(){},module.exports.Pattern=Pattern},function(module,exports,__webpack_require__){"use strict";function Directives(start_block_pattern,end_block_pattern){start_block_pattern="string"==typeof start_block_pattern?start_block_pattern:start_block_pattern.source,end_block_pattern="string"==typeof end_block_pattern?end_block_pattern:end_block_pattern.source,this.__directives_block_pattern=new RegExp(start_block_pattern+/ beautify( \w+[:]\w+)+ /.source+end_block_pattern,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(start_block_pattern+/\sbeautify\signore:end\s/.source+end_block_pattern,"g")}Directives.prototype.get_directives=function(text){if(!text.match(this.__directives_block_pattern))return null;var directives={};this.__directive_pattern.lastIndex=0;for(var directive_match=this.__directive_pattern.exec(text);directive_match;)directives[directive_match[1]]=directive_match[2],directive_match=this.__directive_pattern.exec(text);return directives},Directives.prototype.readIgnored=function(input){return input.readUntilAfter(this.__directives_end_ignore_pattern)},module.exports.Directives=Directives},function(module,exports,__webpack_require__){"use strict";var Pattern=__webpack_require__(12).Pattern,template_names={django:!1,erb:!1,handlebars:!1,php:!1};function TemplatablePattern(input_scanner,parent){Pattern.call(this,input_scanner,parent),this.__template_pattern=null,this._disabled=Object.assign({},template_names),this._excluded=Object.assign({},template_names),parent&&(this.__template_pattern=this._input.get_regexp(parent.__template_pattern),this._excluded=Object.assign(this._excluded,parent._excluded),this._disabled=Object.assign(this._disabled,parent._disabled));var pattern=new Pattern(input_scanner);this.__patterns={handlebars_comment:pattern.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:pattern.starting_with(/{{{/).until_after(/}}}/),handlebars:pattern.starting_with(/{{/).until_after(/}}/),php:pattern.starting_with(/<\?(?:[=]|php)/).until_after(/\?>/),erb:pattern.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:pattern.starting_with(/{%/).until_after(/%}/),django_value:pattern.starting_with(/{{/).until_after(/}}/),django_comment:pattern.starting_with(/{#/).until_after(/#}/)}}TemplatablePattern.prototype=new Pattern,TemplatablePattern.prototype._create=function(){return new TemplatablePattern(this._input,this)},TemplatablePattern.prototype._update=function(){this.__set_templated_pattern()},TemplatablePattern.prototype.disable=function(language){var result=this._create();return result._disabled[language]=!0,result._update(),result},TemplatablePattern.prototype.read_options=function(options){var result=this._create();for(var language in template_names)result._disabled[language]=-1===options.templating.indexOf(language);return result._update(),result},TemplatablePattern.prototype.exclude=function(language){var result=this._create();return result._excluded[language]=!0,result._update(),result},TemplatablePattern.prototype.read=function(){var result="";result=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern);for(var next=this._read_template();next;)this._match_pattern?next+=this._input.read(this._match_pattern):next+=this._input.readUntil(this.__template_pattern),result+=next,next=this._read_template();return this._until_after&&(result+=this._input.readUntilAfter(this._until_pattern)),result},TemplatablePattern.prototype.__set_templated_pattern=function(){var items=[];this._disabled.php||items.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||items.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||items.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(items.push(this.__patterns.django._starting_pattern.source),items.push(this.__patterns.django_value._starting_pattern.source),items.push(this.__patterns.django_comment._starting_pattern.source)),this._until_pattern&&items.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+items.join("|")+")")},TemplatablePattern.prototype._read_template=function(){var resulting_string="",c=this._input.peek();if("<"===c){var peek1=this._input.peek(1);this._disabled.php||this._excluded.php||"?"!==peek1||(resulting_string=resulting_string||this.__patterns.php.read()),this._disabled.erb||this._excluded.erb||"%"!==peek1||(resulting_string=resulting_string||this.__patterns.erb.read())}else"{"===c&&(this._disabled.handlebars||this._excluded.handlebars||(resulting_string=(resulting_string=(resulting_string=resulting_string||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(this._excluded.django||this._excluded.handlebars||(resulting_string=resulting_string||this.__patterns.django_value.read()),this._excluded.django||(resulting_string=(resulting_string=resulting_string||this.__patterns.django_comment.read())||this.__patterns.django.read())));return resulting_string},module.exports.TemplatablePattern=TemplatablePattern},,,,function(module,exports,__webpack_require__){"use strict";var Beautifier=__webpack_require__(19).Beautifier,Options=__webpack_require__(20).Options;module.exports=function(html_source,options,js_beautify,css_beautify){return new Beautifier(html_source,options,js_beautify,css_beautify).beautify()},module.exports.defaultOptions=function(){return new Options}},function(module,exports,__webpack_require__){"use strict";var Options=__webpack_require__(20).Options,Output=__webpack_require__(2).Output,Tokenizer=__webpack_require__(21).Tokenizer,TOKEN=__webpack_require__(21).TOKEN,lineBreak=/\r\n|[\r\n]/,allLineBreaks=/\r\n|[\r\n]/g,Printer=function(options,base_indent_string){this.indent_level=0,this.alignment_size=0,this.max_preserve_newlines=options.max_preserve_newlines,this.preserve_newlines=options.preserve_newlines,this._output=new Output(options,base_indent_string)};Printer.prototype.current_line_has_match=function(pattern){return this._output.current_line.has_match(pattern)},Printer.prototype.set_space_before_token=function(value,non_breaking){this._output.space_before_token=value,this._output.non_breaking_space=non_breaking},Printer.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size),this._output.set_wrap_point()},Printer.prototype.add_raw_token=function(token){this._output.add_raw_token(token)},Printer.prototype.print_preserved_newlines=function(raw_token){var newlines=0;raw_token.type!==TOKEN.TEXT&&raw_token.previous.type!==TOKEN.TEXT&&(newlines=raw_token.newlines?1:0),this.preserve_newlines&&(newlines=raw_token.newlines<this.max_preserve_newlines+1?raw_token.newlines:this.max_preserve_newlines+1);for(var n=0;n<newlines;n++)this.print_newline(n>0);return 0!==newlines},Printer.prototype.traverse_whitespace=function(raw_token){return!(!raw_token.whitespace_before&&!raw_token.newlines)&&(this.print_preserved_newlines(raw_token)||(this._output.space_before_token=!0),!0)},Printer.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped},Printer.prototype.print_newline=function(force){this._output.add_new_line(force)},Printer.prototype.print_token=function(token){token.text&&(this._output.set_indent(this.indent_level,this.alignment_size),this._output.add_token(token.text))},Printer.prototype.indent=function(){this.indent_level++},Printer.prototype.get_full_indent=function(level){return(level=this.indent_level+(level||0))<1?"":this._output.get_indent_string(level)};var get_custom_beautifier_name=function(tag_check,raw_token){var typeAttribute=null,result=null;return raw_token.closed?("script"===tag_check?typeAttribute="text/javascript":"style"===tag_check&&(typeAttribute="text/css"),(typeAttribute=function(start_token){for(var result=null,raw_token=start_token.next;raw_token.type!==TOKEN.EOF&&start_token.closed!==raw_token;){if(raw_token.type===TOKEN.ATTRIBUTE&&"type"===raw_token.text){raw_token.next&&raw_token.next.type===TOKEN.EQUALS&&raw_token.next.next&&raw_token.next.next.type===TOKEN.VALUE&&(result=raw_token.next.next.text);break}raw_token=raw_token.next}return result}(raw_token)||typeAttribute).search("text/css")>-1?result="css":typeAttribute.search(/module|((text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect))/)>-1?result="javascript":typeAttribute.search(/(text|application|dojo)\/(x-)?(html)/)>-1?result="html":typeAttribute.search(/test\/null/)>-1&&(result="null"),result):null};function in_array(what,arr){return-1!==arr.indexOf(what)}function TagStack(printer){this._printer=printer,this._current_frame=null}function Beautifier(source_text,options,js_beautify,css_beautify){this._source_text=source_text||"",options=options||{},this._js_beautify=js_beautify,this._css_beautify=css_beautify,this._tag_stack=null;var optionHtml=new Options(options,"html");this._options=optionHtml,this._is_wrap_attributes_force="force"===this._options.wrap_attributes.substr(0,"force".length),this._is_wrap_attributes_force_expand_multiline="force-expand-multiline"===this._options.wrap_attributes,this._is_wrap_attributes_force_aligned="force-aligned"===this._options.wrap_attributes,this._is_wrap_attributes_aligned_multiple="aligned-multiple"===this._options.wrap_attributes,this._is_wrap_attributes_preserve="preserve"===this._options.wrap_attributes.substr(0,"preserve".length),this._is_wrap_attributes_preserve_aligned="preserve-aligned"===this._options.wrap_attributes}TagStack.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null},TagStack.prototype.record_tag=function(parser_token){var new_frame=new function(parent,parser_token,indent_level){this.parent=parent||null,this.tag=parser_token?parser_token.tag_name:"",this.indent_level=indent_level||0,this.parser_token=parser_token||null}(this._current_frame,parser_token,this._printer.indent_level);this._current_frame=new_frame},TagStack.prototype._try_pop_frame=function(frame){var parser_token=null;return frame&&(parser_token=frame.parser_token,this._printer.indent_level=frame.indent_level,this._current_frame=frame.parent),parser_token},TagStack.prototype._get_frame=function(tag_list,stop_list){for(var frame=this._current_frame;frame&&-1===tag_list.indexOf(frame.tag);){if(stop_list&&-1!==stop_list.indexOf(frame.tag)){frame=null;break}frame=frame.parent}return frame},TagStack.prototype.try_pop=function(tag,stop_list){var frame=this._get_frame([tag],stop_list);return this._try_pop_frame(frame)},TagStack.prototype.indent_to_tag=function(tag_list){var frame=this._get_frame(tag_list);frame&&(this._printer.indent_level=frame.indent_level)},Beautifier.prototype.beautify=function(){if(this._options.disabled)return this._source_text;var source_text=this._source_text,eol=this._options.eol;"auto"===this._options.eol&&(eol="\n",source_text&&lineBreak.test(source_text)&&(eol=source_text.match(lineBreak)[0]));var baseIndentString=(source_text=source_text.replace(allLineBreaks,"\n")).match(/^[\t ]*/)[0],last_token={text:"",type:""},last_tag_token=new TagOpenParserToken,printer=new Printer(this._options,baseIndentString),tokens=new Tokenizer(source_text,this._options).tokenize();this._tag_stack=new TagStack(printer);for(var parser_token=null,raw_token=tokens.next();raw_token.type!==TOKEN.EOF;)raw_token.type===TOKEN.TAG_OPEN||raw_token.type===TOKEN.COMMENT?last_tag_token=parser_token=this._handle_tag_open(printer,raw_token,last_tag_token,last_token):raw_token.type===TOKEN.ATTRIBUTE||raw_token.type===TOKEN.EQUALS||raw_token.type===TOKEN.VALUE||raw_token.type===TOKEN.TEXT&&!last_tag_token.tag_complete?parser_token=this._handle_inside_tag(printer,raw_token,last_tag_token,tokens):raw_token.type===TOKEN.TAG_CLOSE?parser_token=this._handle_tag_close(printer,raw_token,last_tag_token):raw_token.type===TOKEN.TEXT?parser_token=this._handle_text(printer,raw_token,last_tag_token):printer.add_raw_token(raw_token),last_token=parser_token,raw_token=tokens.next();return printer._output.get_code(eol)},Beautifier.prototype._handle_tag_close=function(printer,raw_token,last_tag_token){var parser_token={text:raw_token.text,type:raw_token.type};return printer.alignment_size=0,last_tag_token.tag_complete=!0,printer.set_space_before_token(raw_token.newlines||""!==raw_token.whitespace_before,!0),last_tag_token.is_unformatted?printer.add_raw_token(raw_token):("<"===last_tag_token.tag_start_char&&(printer.set_space_before_token("/"===raw_token.text[0],!0),this._is_wrap_attributes_force_expand_multiline&&last_tag_token.has_wrapped_attrs&&printer.print_newline(!1)),printer.print_token(raw_token)),!last_tag_token.indent_content||last_tag_token.is_unformatted||last_tag_token.is_content_unformatted||(printer.indent(),last_tag_token.indent_content=!1),last_tag_token.is_inline_element||last_tag_token.is_unformatted||last_tag_token.is_content_unformatted||printer.set_wrap_point(),parser_token},Beautifier.prototype._handle_inside_tag=function(printer,raw_token,last_tag_token,tokens){var wrapped=last_tag_token.has_wrapped_attrs,parser_token={text:raw_token.text,type:raw_token.type};if(printer.set_space_before_token(raw_token.newlines||""!==raw_token.whitespace_before,!0),last_tag_token.is_unformatted)printer.add_raw_token(raw_token);else if("{"===last_tag_token.tag_start_char&&raw_token.type===TOKEN.TEXT)printer.print_preserved_newlines(raw_token)?(raw_token.newlines=0,printer.add_raw_token(raw_token)):printer.print_token(raw_token);else{if(raw_token.type===TOKEN.ATTRIBUTE?(printer.set_space_before_token(!0),last_tag_token.attr_count+=1):raw_token.type===TOKEN.EQUALS?printer.set_space_before_token(!1):raw_token.type===TOKEN.VALUE&&raw_token.previous.type===TOKEN.EQUALS&&printer.set_space_before_token(!1),raw_token.type===TOKEN.ATTRIBUTE&&"<"===last_tag_token.tag_start_char&&((this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned)&&(printer.traverse_whitespace(raw_token),wrapped=wrapped||0!==raw_token.newlines),this._is_wrap_attributes_force)){var force_attr_wrap=last_tag_token.attr_count>1;if(this._is_wrap_attributes_force_expand_multiline&&1===last_tag_token.attr_count){var peek_token,is_only_attribute=!0,peek_index=0;do{if((peek_token=tokens.peek(peek_index)).type===TOKEN.ATTRIBUTE){is_only_attribute=!1;break}peek_index+=1}while(peek_index<4&&peek_token.type!==TOKEN.EOF&&peek_token.type!==TOKEN.TAG_CLOSE);force_attr_wrap=!is_only_attribute}force_attr_wrap&&(printer.print_newline(!1),wrapped=!0)}printer.print_token(raw_token),wrapped=wrapped||printer.previous_token_wrapped(),last_tag_token.has_wrapped_attrs=wrapped}return parser_token},Beautifier.prototype._handle_text=function(printer,raw_token,last_tag_token){var parser_token={text:raw_token.text,type:"TK_CONTENT"};return last_tag_token.custom_beautifier_name?this._print_custom_beatifier_text(printer,raw_token,last_tag_token):last_tag_token.is_unformatted||last_tag_token.is_content_unformatted?printer.add_raw_token(raw_token):(printer.traverse_whitespace(raw_token),printer.print_token(raw_token)),parser_token},Beautifier.prototype._print_custom_beatifier_text=function(printer,raw_token,last_tag_token){var local=this;if(""!==raw_token.text){var _beautifier,text=raw_token.text,script_indent_level=1,pre="",post="";"javascript"===last_tag_token.custom_beautifier_name&&"function"==typeof this._js_beautify?_beautifier=this._js_beautify:"css"===last_tag_token.custom_beautifier_name&&"function"==typeof this._css_beautify?_beautifier=this._css_beautify:"html"===last_tag_token.custom_beautifier_name&&(_beautifier=function(html_source,options){return new Beautifier(html_source,options,local._js_beautify,local._css_beautify).beautify()}),"keep"===this._options.indent_scripts?script_indent_level=0:"separate"===this._options.indent_scripts&&(script_indent_level=-printer.indent_level);var indentation=printer.get_full_indent(script_indent_level);if(text=text.replace(/\n[ \t]*$/,""),"html"!==last_tag_token.custom_beautifier_name&&"<"===text[0]&&text.match(/^(<!--|<!\[CDATA\[)/)){var matched=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(text);if(!matched)return void printer.add_raw_token(raw_token);pre=indentation+matched[1]+"\n",text=matched[4],matched[5]&&(post=indentation+matched[5]),text=text.replace(/\n[ \t]*$/,""),(matched[2]||-1!==matched[3].indexOf("\n"))&&(matched=matched[3].match(/[ \t]+$/))&&(raw_token.whitespace_before=matched[0])}if(text)if(_beautifier){var Child_options=function(){this.eol="\n"};Child_options.prototype=this._options.raw_options,text=_beautifier(indentation+text,new Child_options)}else{var white=raw_token.whitespace_before;white&&(text=text.replace(new RegExp("\n("+white+")?","g"),"\n")),text=indentation+text.replace(/\n/g,"\n"+indentation)}pre&&(text=text?pre+text+"\n"+post:pre+post),printer.print_newline(!1),text&&(raw_token.text=text,raw_token.whitespace_before="",raw_token.newlines=0,printer.add_raw_token(raw_token),printer.print_newline(!0))}},Beautifier.prototype._handle_tag_open=function(printer,raw_token,last_tag_token,last_token){var parser_token=this._get_tag_open_token(raw_token);return!last_tag_token.is_unformatted&&!last_tag_token.is_content_unformatted||last_tag_token.is_empty_element||raw_token.type!==TOKEN.TAG_OPEN||0!==raw_token.text.indexOf("</")?(printer.traverse_whitespace(raw_token),this._set_tag_position(printer,raw_token,parser_token,last_tag_token,last_token),parser_token.is_inline_element||printer.set_wrap_point(),printer.print_token(raw_token)):(printer.add_raw_token(raw_token),parser_token.start_tag_token=this._tag_stack.try_pop(parser_token.tag_name)),(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned)&&(parser_token.alignment_size=raw_token.text.length+1),parser_token.tag_complete||parser_token.is_unformatted||(printer.alignment_size=parser_token.alignment_size),parser_token};var TagOpenParserToken=function(parent,raw_token){var tag_check_match;(this.parent=parent||null,this.text="",this.type="TK_TAG_OPEN",this.tag_name="",this.is_inline_element=!1,this.is_unformatted=!1,this.is_content_unformatted=!1,this.is_empty_element=!1,this.is_start_tag=!1,this.is_end_tag=!1,this.indent_content=!1,this.multiline_content=!1,this.custom_beautifier_name=null,this.start_tag_token=null,this.attr_count=0,this.has_wrapped_attrs=!1,this.alignment_size=0,this.tag_complete=!1,this.tag_start_char="",this.tag_check="",raw_token)?(this.tag_start_char=raw_token.text[0],this.text=raw_token.text,"<"===this.tag_start_char?(tag_check_match=raw_token.text.match(/^<([^\s>]*)/),this.tag_check=tag_check_match?tag_check_match[1]:""):(tag_check_match=raw_token.text.match(/^{{(?:[\^]|#\*?)?([^\s}]+)/),this.tag_check=tag_check_match?tag_check_match[1]:"","{{#>"===raw_token.text&&">"===this.tag_check&&null!==raw_token.next&&(this.tag_check=raw_token.next.text)),this.tag_check=this.tag_check.toLowerCase(),raw_token.type===TOKEN.COMMENT&&(this.tag_complete=!0),this.is_start_tag="/"!==this.tag_check.charAt(0),this.tag_name=this.is_start_tag?this.tag_check:this.tag_check.substr(1),this.is_end_tag=!this.is_start_tag||raw_token.closed&&"/>"===raw_token.closed.text,this.is_end_tag=this.is_end_tag||"{"===this.tag_start_char&&(this.text.length<3||/[^#\^]/.test(this.text.charAt(2)))):this.tag_complete=!0};Beautifier.prototype._get_tag_open_token=function(raw_token){var parser_token=new TagOpenParserToken(this._tag_stack.get_parser_token(),raw_token);return parser_token.alignment_size=this._options.wrap_attributes_indent_size,parser_token.is_end_tag=parser_token.is_end_tag||in_array(parser_token.tag_check,this._options.void_elements),parser_token.is_empty_element=parser_token.tag_complete||parser_token.is_start_tag&&parser_token.is_end_tag,parser_token.is_unformatted=!parser_token.tag_complete&&in_array(parser_token.tag_check,this._options.unformatted),parser_token.is_content_unformatted=!parser_token.is_empty_element&&in_array(parser_token.tag_check,this._options.content_unformatted),parser_token.is_inline_element=in_array(parser_token.tag_name,this._options.inline)||"{"===parser_token.tag_start_char,parser_token},Beautifier.prototype._set_tag_position=function(printer,raw_token,parser_token,last_tag_token,last_token){if(parser_token.is_empty_element||(parser_token.is_end_tag?parser_token.start_tag_token=this._tag_stack.try_pop(parser_token.tag_name):(this._do_optional_end_element(parser_token)&&(parser_token.is_inline_element||printer.print_newline(!1)),this._tag_stack.record_tag(parser_token),"script"!==parser_token.tag_name&&"style"!==parser_token.tag_name||parser_token.is_unformatted||parser_token.is_content_unformatted||(parser_token.custom_beautifier_name=get_custom_beautifier_name(parser_token.tag_check,raw_token)))),in_array(parser_token.tag_check,this._options.extra_liners)&&(printer.print_newline(!1),printer._output.just_added_blankline()||printer.print_newline(!0)),parser_token.is_empty_element){if("{"===parser_token.tag_start_char&&"else"===parser_token.tag_check)this._tag_stack.indent_to_tag(["if","unless","each"]),parser_token.indent_content=!0,printer.current_line_has_match(/{{#if/)||printer.print_newline(!1);"!--"===parser_token.tag_name&&last_token.type===TOKEN.TAG_CLOSE&&last_tag_token.is_end_tag&&-1===parser_token.text.indexOf("\n")||(parser_token.is_inline_element||parser_token.is_unformatted||printer.print_newline(!1),this._calcluate_parent_multiline(printer,parser_token))}else if(parser_token.is_end_tag){var do_end_expand=!1;do_end_expand=(do_end_expand=parser_token.start_tag_token&&parser_token.start_tag_token.multiline_content)||!parser_token.is_inline_element&&!(last_tag_token.is_inline_element||last_tag_token.is_unformatted)&&!(last_token.type===TOKEN.TAG_CLOSE&&parser_token.start_tag_token===last_tag_token)&&"TK_CONTENT"!==last_token.type,(parser_token.is_content_unformatted||parser_token.is_unformatted)&&(do_end_expand=!1),do_end_expand&&printer.print_newline(!1)}else parser_token.indent_content=!parser_token.custom_beautifier_name,"<"===parser_token.tag_start_char&&("html"===parser_token.tag_name?parser_token.indent_content=this._options.indent_inner_html:"head"===parser_token.tag_name?parser_token.indent_content=this._options.indent_head_inner_html:"body"===parser_token.tag_name&&(parser_token.indent_content=this._options.indent_body_inner_html)),parser_token.is_inline_element||parser_token.is_unformatted||"TK_CONTENT"===last_token.type&&!parser_token.is_content_unformatted||printer.print_newline(!1),this._calcluate_parent_multiline(printer,parser_token)},Beautifier.prototype._calcluate_parent_multiline=function(printer,parser_token){!parser_token.parent||!printer._output.just_added_newline()||(parser_token.is_inline_element||parser_token.is_unformatted)&&parser_token.parent.is_inline_element||(parser_token.parent.multiline_content=!0)};var p_closers=["address","article","aside","blockquote","details","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","main","nav","ol","p","pre","section","table","ul"],p_parent_excludes=["a","audio","del","ins","map","noscript","video"];Beautifier.prototype._do_optional_end_element=function(parser_token){var result=null;if(!parser_token.is_empty_element&&parser_token.is_start_tag&&parser_token.parent){if("body"===parser_token.tag_name)result=result||this._tag_stack.try_pop("head");else if("li"===parser_token.tag_name)result=result||this._tag_stack.try_pop("li",["ol","ul"]);else if("dd"===parser_token.tag_name||"dt"===parser_token.tag_name)result=(result=result||this._tag_stack.try_pop("dt",["dl"]))||this._tag_stack.try_pop("dd",["dl"]);else if("p"===parser_token.parent.tag_name&&-1!==p_closers.indexOf(parser_token.tag_name)){var p_parent=parser_token.parent.parent;p_parent&&-1!==p_parent_excludes.indexOf(p_parent.tag_name)||(result=result||this._tag_stack.try_pop("p"))}else"rp"===parser_token.tag_name||"rt"===parser_token.tag_name?result=(result=result||this._tag_stack.try_pop("rt",["ruby","rtc"]))||this._tag_stack.try_pop("rp",["ruby","rtc"]):"optgroup"===parser_token.tag_name?result=result||this._tag_stack.try_pop("optgroup",["select"]):"option"===parser_token.tag_name?result=result||this._tag_stack.try_pop("option",["select","datalist","optgroup"]):"colgroup"===parser_token.tag_name?result=result||this._tag_stack.try_pop("caption",["table"]):"thead"===parser_token.tag_name?result=(result=result||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]):"tbody"===parser_token.tag_name||"tfoot"===parser_token.tag_name?result=(result=(result=(result=result||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("thead",["table"]))||this._tag_stack.try_pop("tbody",["table"]):"tr"===parser_token.tag_name?result=(result=(result=result||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"]):"th"!==parser_token.tag_name&&"td"!==parser_token.tag_name||(result=(result=result||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]))||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"]));return parser_token.parent=this._tag_stack.get_parser_token(),result}},module.exports.Beautifier=Beautifier},function(module,exports,__webpack_require__){"use strict";var BaseOptions=__webpack_require__(6).Options;function Options(options){BaseOptions.call(this,options,"html"),1===this.templating.length&&"auto"===this.templating[0]&&(this.templating=["django","erb","handlebars","php"]),this.indent_inner_html=this._get_boolean("indent_inner_html"),this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",!0),this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",!0),this.indent_handlebars=this._get_boolean("indent_handlebars",!0),this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]),this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size),this.extra_liners=this._get_array("extra_liners",["head","body","/html"]),this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]),this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]),this.unformatted=this._get_array("unformatted",[]),this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]),this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter"),this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}Options.prototype=new BaseOptions,module.exports.Options=Options},function(module,exports,__webpack_require__){"use strict";var BaseTokenizer=__webpack_require__(9).Tokenizer,BASETOKEN=__webpack_require__(9).TOKEN,Directives=__webpack_require__(13).Directives,TemplatablePattern=__webpack_require__(14).TemplatablePattern,Pattern=__webpack_require__(12).Pattern,TOKEN={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:BASETOKEN.START,RAW:BASETOKEN.RAW,EOF:BASETOKEN.EOF},directives_core=new Directives(/<\!--/,/-->/),Tokenizer=function(input_string,options){BaseTokenizer.call(this,input_string,options),this._current_tag_name="";var templatable_reader=new TemplatablePattern(this._input).read_options(this._options),pattern_reader=new Pattern(this._input);if(this.__patterns={word:templatable_reader.until(/[\n\r\t <]/),single_quote:templatable_reader.until_after(/'/),double_quote:templatable_reader.until_after(/"/),attribute:templatable_reader.until(/[\n\r\t =>]|\/>/),element_name:templatable_reader.until(/[\n\r\t >\/]/),handlebars_comment:pattern_reader.starting_with(/{{!--/).until_after(/--}}/),handlebars:pattern_reader.starting_with(/{{/).until_after(/}}/),handlebars_open:pattern_reader.until(/[\n\r\t }]/),handlebars_raw_close:pattern_reader.until(/}}/),comment:pattern_reader.starting_with(/<!--/).until_after(/-->/),cdata:pattern_reader.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:pattern_reader.starting_with(/<!\[/).until_after(/]>/),processing:pattern_reader.starting_with(/<\?/).until_after(/\?>/)},this._options.indent_handlebars&&(this.__patterns.word=this.__patterns.word.exclude("handlebars")),this._unformatted_content_delimiter=null,this._options.unformatted_content_delimiter){var literal_regexp=this._input.get_literal_regexp(this._options.unformatted_content_delimiter);this.__patterns.unformatted_content_delimiter=pattern_reader.matching(literal_regexp).until_after(literal_regexp)}};(Tokenizer.prototype=new BaseTokenizer)._is_comment=function(current_token){return!1},Tokenizer.prototype._is_opening=function(current_token){return current_token.type===TOKEN.TAG_OPEN},Tokenizer.prototype._is_closing=function(current_token,open_token){return current_token.type===TOKEN.TAG_CLOSE&&open_token&&((">"===current_token.text||"/>"===current_token.text)&&"<"===open_token.text[0]||"}}"===current_token.text&&"{"===open_token.text[0]&&"{"===open_token.text[1])},Tokenizer.prototype._reset=function(){this._current_tag_name=""},Tokenizer.prototype._get_next_token=function(previous_token,open_token){var token=null;this._readWhitespace();var c=this._input.peek();return null===c?this._create_token(TOKEN.EOF,""):token=(token=(token=(token=(token=(token=(token=(token=(token=token||this._read_open_handlebars(c,open_token))||this._read_attribute(c,previous_token,open_token))||this._read_close(c,open_token))||this._read_raw_content(c,previous_token,open_token))||this._read_content_word(c))||this._read_comment_or_cdata(c))||this._read_processing(c))||this._read_open(c,open_token))||this._create_token(TOKEN.UNKNOWN,this._input.next())},Tokenizer.prototype._read_comment_or_cdata=function(c){var token=null,resulting_string=null,directives=null;"<"===c&&("!"===this._input.peek(1)&&((resulting_string=this.__patterns.comment.read())?(directives=directives_core.get_directives(resulting_string))&&"start"===directives.ignore&&(resulting_string+=directives_core.readIgnored(this._input)):resulting_string=this.__patterns.cdata.read()),resulting_string&&((token=this._create_token(TOKEN.COMMENT,resulting_string)).directives=directives));return token},Tokenizer.prototype._read_processing=function(c){var token=null,resulting_string=null;if("<"===c){var peek1=this._input.peek(1);"!"!==peek1&&"?"!==peek1||(resulting_string=(resulting_string=this.__patterns.conditional_comment.read())||this.__patterns.processing.read()),resulting_string&&((token=this._create_token(TOKEN.COMMENT,resulting_string)).directives=null)}return token},Tokenizer.prototype._read_open=function(c,open_token){var resulting_string=null,token=null;return open_token||"<"===c&&(resulting_string=this._input.next(),"/"===this._input.peek()&&(resulting_string+=this._input.next()),resulting_string+=this.__patterns.element_name.read(),token=this._create_token(TOKEN.TAG_OPEN,resulting_string)),token},Tokenizer.prototype._read_open_handlebars=function(c,open_token){var resulting_string=null,token=null;return open_token||this._options.indent_handlebars&&"{"===c&&"{"===this._input.peek(1)&&("!"===this._input.peek(2)?(resulting_string=(resulting_string=this.__patterns.handlebars_comment.read())||this.__patterns.handlebars.read(),token=this._create_token(TOKEN.COMMENT,resulting_string)):(resulting_string=this.__patterns.handlebars_open.read(),token=this._create_token(TOKEN.TAG_OPEN,resulting_string))),token},Tokenizer.prototype._read_close=function(c,open_token){var resulting_string=null,token=null;return open_token&&("<"===open_token.text[0]&&(">"===c||"/"===c&&">"===this._input.peek(1))?(resulting_string=this._input.next(),"/"===c&&(resulting_string+=this._input.next()),token=this._create_token(TOKEN.TAG_CLOSE,resulting_string)):"{"===open_token.text[0]&&"}"===c&&"}"===this._input.peek(1)&&(this._input.next(),this._input.next(),token=this._create_token(TOKEN.TAG_CLOSE,"}}"))),token},Tokenizer.prototype._read_attribute=function(c,previous_token,open_token){var token=null,resulting_string="";if(open_token&&"<"===open_token.text[0])if("="===c)token=this._create_token(TOKEN.EQUALS,this._input.next());else if('"'===c||"'"===c){var content=this._input.next();content+='"'===c?this.__patterns.double_quote.read():this.__patterns.single_quote.read(),token=this._create_token(TOKEN.VALUE,content)}else(resulting_string=this.__patterns.attribute.read())&&(token=previous_token.type===TOKEN.EQUALS?this._create_token(TOKEN.VALUE,resulting_string):this._create_token(TOKEN.ATTRIBUTE,resulting_string));return token},Tokenizer.prototype._is_content_unformatted=function(tag_name){return-1===this._options.void_elements.indexOf(tag_name)&&(-1!==this._options.content_unformatted.indexOf(tag_name)||-1!==this._options.unformatted.indexOf(tag_name))},Tokenizer.prototype._read_raw_content=function(c,previous_token,open_token){var resulting_string="";if(open_token&&"{"===open_token.text[0])resulting_string=this.__patterns.handlebars_raw_close.read();else if(previous_token.type===TOKEN.TAG_CLOSE&&"<"===previous_token.opened.text[0]&&"/"!==previous_token.text[0]){var tag_name=previous_token.opened.text.substr(1).toLowerCase();if("script"===tag_name||"style"===tag_name){var token=this._read_comment_or_cdata(c);if(token)return token.type=TOKEN.TEXT,token;resulting_string=this._input.readUntil(new RegExp("</"+tag_name+"[\\n\\r\\t ]*?>","ig"))}else this._is_content_unformatted(tag_name)&&(resulting_string=this._input.readUntil(new RegExp("</"+tag_name+"[\\n\\r\\t ]*?>","ig")))}return resulting_string?this._create_token(TOKEN.TEXT,resulting_string):null},Tokenizer.prototype._read_content_word=function(c){var resulting_string="";if(this._options.unformatted_content_delimiter&&c===this._options.unformatted_content_delimiter[0]&&(resulting_string=this.__patterns.unformatted_content_delimiter.read()),resulting_string||(resulting_string=this.__patterns.word.read()),resulting_string)return this._create_token(TOKEN.TEXT,resulting_string)},module.exports.Tokenizer=Tokenizer,module.exports.TOKEN=TOKEN}]);if("function"==typeof define&&define.amd)define(["require","./beautify","./beautify-css"],function(requireamd){var js_beautify=requireamd("./beautify"),css_beautify=requireamd("./beautify-css");return{html_beautify:function(html_source,options){return style_html(html_source,options,js_beautify.js_beautify,css_beautify.css_beautify)}}});else if("undefined"!=typeof exports){var js_beautify=require("./beautify.js"),css_beautify=require("./beautify-css.js");exports.html_beautify=function(html_source,options){return style_html(html_source,options,js_beautify.js_beautify,css_beautify.css_beautify)}}else"undefined"!=typeof window?window.html_beautify=function(html_source,options){return style_html(html_source,options,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(html_source,options){return style_html(html_source,options,global.js_beautify,global.css_beautify)})}();var parser=function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s="./src/parser.js")}({"./src/json2xml.js":function(module,exports,__webpack_require__){"use strict";var buildOptions=__webpack_require__("./src/util.js").buildOptions,defaultOptions={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(a){return a},attrValueProcessor:function(a){return a}},props=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor"];function Parser(options){this.options=buildOptions(options,defaultOptions,props),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=isAttribute),this.options.cdataTagName?this.isCDATA=isCDATA:this.isCDATA=function(){return!1},this.replaceCDATAstr=replaceCDATAstr,this.replaceCDATAarr=replaceCDATAarr,this.options.format?(this.indentate=indentate,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=buildEmptyTextNode,this.buildObjNode=buildEmptyObjNode):(this.buildTextNode=buildTextValNode,this.buildObjNode=buildObjectNode),this.buildTextValNode=buildTextValNode,this.buildObjectNode=buildObjectNode}function replaceCDATAstr(str,cdata){return str=this.options.tagValueProcessor(""+str),""===this.options.cdataPositionChar||""===str?str+"<![CDATA["+cdata+"]]"+this.tagEndChar:str.replace(this.options.cdataPositionChar,"<![CDATA["+cdata+"]]"+this.tagEndChar)}function replaceCDATAarr(str,cdata){if(str=this.options.tagValueProcessor(""+str),""===this.options.cdataPositionChar||""===str)return str+"<![CDATA["+cdata.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(var v in cdata)str=str.replace(this.options.cdataPositionChar,"<![CDATA["+cdata[v]+"]]>");return str+this.newLine}function buildObjectNode(val,key,attrStr,level){return attrStr&&!val.includes("<")?this.indentate(level)+"<"+key+attrStr+">"+val+"</"+key+this.tagEndChar:this.indentate(level)+"<"+key+attrStr+this.tagEndChar+val+this.indentate(level)+"</"+key+this.tagEndChar}function buildEmptyObjNode(val,key,attrStr,level){return""!==val?this.buildObjectNode(val,key,attrStr,level):this.indentate(level)+"<"+key+attrStr+"/"+this.tagEndChar}function buildTextValNode(val,key,attrStr,level){return this.indentate(level)+"<"+key+attrStr+">"+this.options.tagValueProcessor(val)+"</"+key+this.tagEndChar}function buildEmptyTextNode(val,key,attrStr,level){return""!==val?this.buildTextValNode(val,key,attrStr,level):this.indentate(level)+"<"+key+attrStr+"/"+this.tagEndChar}function indentate(level){return this.options.indentBy.repeat(level)}function isAttribute(name){return!!name.startsWith(this.options.attributeNamePrefix)&&name.substr(this.attrPrefixLen)}function isCDATA(name){return name===this.options.cdataTagName}Parser.prototype.parse=function(jObj){return this.j2x(jObj,0).val},Parser.prototype.j2x=function(jObj,level){for(var attrStr="",val="",keys=Object.keys(jObj),len=keys.length,i=0;i<len;i++){var key=keys[i];if(void 0===jObj[key]);else if(null===jObj[key])val+=this.indentate(level)+"<"+key+"/"+this.tagEndChar;else if(jObj[key]instanceof Date)val+=this.buildTextNode(jObj[key],key,"",level);else if("object"!=typeof jObj[key]){var attr=this.isAttribute(key);attr?attrStr+=" "+attr+'="'+this.options.attrValueProcessor(""+jObj[key])+'"':this.isCDATA(key)?jObj[this.options.textNodeName]?val+=this.replaceCDATAstr(jObj[this.options.textNodeName],jObj[key]):val+=this.replaceCDATAstr("",jObj[key]):key===this.options.textNodeName?jObj[this.options.cdataTagName]||(val+=this.options.tagValueProcessor(""+jObj[key])):val+=this.buildTextNode(jObj[key],key,"",level)}else if(Array.isArray(jObj[key]))if(this.isCDATA(key))val+=this.indentate(level),jObj[this.options.textNodeName]?val+=this.replaceCDATAarr(jObj[this.options.textNodeName],jObj[key]):val+=this.replaceCDATAarr("",jObj[key]);else for(var arrLen=jObj[key].length,j=0;j<arrLen;j++){var item=jObj[key][j];if(void 0===item);else if(null===item)val+=this.indentate(level)+"<"+key+"/"+this.tagEndChar;else if("object"==typeof item){var result=this.j2x(item,level+1);val+=this.buildObjNode(result.val,key,result.attrStr,level)}else val+=this.buildTextNode(item,key,"",level)}else if(this.options.attrNodeName&&key===this.options.attrNodeName)for(var Ks=Object.keys(jObj[key]),L=Ks.length,_j=0;_j<L;_j++)attrStr+=" "+Ks[_j]+'="'+this.options.attrValueProcessor(""+jObj[key][Ks[_j]])+'"';else{var _result=this.j2x(jObj[key],level+1);val+=this.buildObjNode(_result.val,key,_result.attrStr,level)}}return{attrStr:attrStr,val:val}},module.exports=Parser},"./src/nimndata.js":function(module,exports,__webpack_require__){"use strict";var _char=function(a){return String.fromCharCode(a)},chars={nilChar:_char(176),missingChar:_char(201),nilPremitive:_char(175),missingPremitive:_char(200),emptyChar:_char(178),emptyValue:_char(177),boundryChar:_char(179),objStart:_char(198),arrStart:_char(204),arrayEnd:_char(185)},charsArr=[chars.nilChar,chars.nilPremitive,chars.missingChar,chars.missingPremitive,chars.boundryChar,chars.emptyChar,chars.emptyValue,chars.arrayEnd,chars.objStart,chars.arrStart],_e=function _e(node,e_schema,options){if("string"==typeof e_schema)return node&&node[0]&&void 0!==node[0].val?getValue(node[0].val,e_schema):getValue(node,e_schema);var jObj,hasValidData=void 0===(jObj=node)?chars.missingChar:null===jObj?chars.nilChar:!(jObj.child&&0===Object.keys(jObj.child).length&&(!jObj.attrsMap||0===Object.keys(jObj.attrsMap).length))||chars.emptyChar;if(!0===hasValidData){var str="";if(Array.isArray(e_schema)){str+=chars.arrStart;var itemSchema=e_schema[0],arr_len=node.length;if("string"==typeof itemSchema)for(var arr_i=0;arr_i<arr_len;arr_i++){var r=getValue(node[arr_i].val,itemSchema);str=processValue(str,r)}else for(var _arr_i=0;_arr_i<arr_len;_arr_i++){var _r=_e(node[_arr_i],itemSchema,options);str=processValue(str,_r)}str+=chars.arrayEnd}else{str+=chars.objStart;var keys=Object.keys(e_schema);for(var i in Array.isArray(node)&&(node=node[0]),keys){var key=keys[i],_r2=void 0;_r2=!options.ignoreAttributes&&node.attrsMap&&node.attrsMap[key]?_e(node.attrsMap[key],e_schema[key],options):key===options.textNodeName?_e(node.val,e_schema[key],options):_e(node.child[key],e_schema[key],options),str=processValue(str,_r2)}}return str}return hasValidData},getValue=function(a){switch(a){case void 0:return chars.missingPremitive;case null:return chars.nilPremitive;case"":return chars.emptyValue;default:return a}},processValue=function(str,r){return isAppChar(r[0])||isAppChar(str[str.length-1])||(str+=chars.boundryChar),str+r},isAppChar=function(ch){return-1!==charsArr.indexOf(ch)};var x2j=__webpack_require__("./src/xmlstr2xmlnode.js"),buildOptions=__webpack_require__("./src/util.js").buildOptions;exports.convert2nimn=function(node,e_schema,options){return options=buildOptions(options,x2j.defaultOptions,x2j.props),_e(node,e_schema,options)}},"./src/node2json.js":function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__("./src/util.js");exports.convertToJson=function convertToJson(node,options){var jObj={};if(!(node.child&&!util.isEmptyObject(node.child)||node.attrsMap&&!util.isEmptyObject(node.attrsMap)))return util.isExist(node.val)?node.val:"";util.isExist(node.val)&&("string"!=typeof node.val||""!==node.val&&node.val!==options.cdataPositionChar)&&("strict"===options.arrayMode?jObj[options.textNodeName]=[node.val]:jObj[options.textNodeName]=node.val),util.merge(jObj,node.attrsMap,options.arrayMode);for(var keys=Object.keys(node.child),index=0;index<keys.length;index++){var tagname=keys[index];if(node.child[tagname]&&node.child[tagname].length>1)for(var tag in jObj[tagname]=[],node.child[tagname])jObj[tagname].push(convertToJson(node.child[tagname][tag],options));else if(!0===options.arrayMode){var result=convertToJson(node.child[tagname][0],options);jObj[tagname]="object"==typeof result?[result]:result}else"strict"===options.arrayMode?jObj[tagname]=[convertToJson(node.child[tagname][0],options)]:jObj[tagname]=convertToJson(node.child[tagname][0],options)}return jObj}},"./src/node2json_str.js":function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__("./src/util.js"),buildOptions=__webpack_require__("./src/util.js").buildOptions,x2j=__webpack_require__("./src/xmlstr2xmlnode.js"),_cToJsonStr=function _cToJsonStr(node,options,level){for(var v,jObj="{",keys=Object.keys(node.child),index=0;index<keys.length;index++){var tagname=keys[index];if(node.child[tagname]&&node.child[tagname].length>1){for(var tag in jObj+='"'+tagname+'" : [ ',node.child[tagname])jObj+=_cToJsonStr(node.child[tagname][tag],options)+" , ";jObj=jObj.substr(0,jObj.length-1)+" ] "}else jObj+='"'+tagname+'" : '+_cToJsonStr(node.child[tagname][0],options)+" ,"}return util.merge(jObj,node.attrsMap),util.isEmptyObject(jObj)?util.isExist(node.val)?node.val:"":(util.isExist(node.val)&&("string"!=typeof node.val||""!==node.val&&node.val!==options.cdataPositionChar)&&(jObj+='"'+options.textNodeName+'" : '+(!0!==(v=node.val)&&!1!==v&&isNaN(v)?'"'+v+'"':v)),","===jObj[jObj.length-1]&&(jObj=jObj.substr(0,jObj.length-2)),jObj+"}")};exports.convertToJsonString=function(node,options){return(options=buildOptions(options,x2j.defaultOptions,x2j.props)).indentBy=options.indentBy||"",_cToJsonStr(node,options,0)}},"./src/parser.js":function(module,exports,__webpack_require__){"use strict";var nodeToJson=__webpack_require__("./src/node2json.js"),xmlToNodeobj=__webpack_require__("./src/xmlstr2xmlnode.js"),x2xmlnode=__webpack_require__("./src/xmlstr2xmlnode.js"),buildOptions=__webpack_require__("./src/util.js").buildOptions,validator=__webpack_require__("./src/validator.js");exports.parse=function(xmlData,options,validationOption){if(validationOption){!0===validationOption&&(validationOption={});var result=validator.validate(xmlData,validationOption);if(!0!==result)throw Error(result.err.msg)}options=buildOptions(options,x2xmlnode.defaultOptions,x2xmlnode.props);var traversableObj=xmlToNodeobj.getTraversalObj(xmlData,options);return nodeToJson.convertToJson(traversableObj,options)},exports.convertTonimn=__webpack_require__("./src/nimndata.js").convert2nimn,exports.getTraversalObj=xmlToNodeobj.getTraversalObj,exports.convertToJson=nodeToJson.convertToJson,exports.convertToJsonString=__webpack_require__("./src/node2json_str.js").convertToJsonString,exports.validate=validator.validate,exports.j2xParser=__webpack_require__("./src/json2xml.js"),exports.parseToNimn=function(xmlData,schema,options){return exports.convertTonimn(exports.getTraversalObj(xmlData,options),schema,options)}},"./src/util.js":function(module,exports,__webpack_require__){"use strict";var nameStartChar=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",nameRegexp="["+nameStartChar+"][:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",regexName=new RegExp("^"+nameRegexp+"$");exports.isExist=function(v){return void 0!==v},exports.isEmptyObject=function(obj){return 0===Object.keys(obj).length},exports.merge=function(target,a,arrayMode){if(a)for(var keys=Object.keys(a),len=keys.length,i=0;i<len;i++)target[keys[i]]="strict"===arrayMode?[a[keys[i]]]:a[keys[i]]},exports.getValue=function(v){return exports.isExist(v)?v:""},exports.buildOptions=function(options,defaultOptions,props){var newOptions={};if(!options)return defaultOptions;for(var i=0;i<props.length;i++)void 0!==options[props[i]]?newOptions[props[i]]=options[props[i]]:newOptions[props[i]]=defaultOptions[props[i]];return newOptions},exports.isName=function(string){var match=regexName.exec(string);return!(null===match||void 0===match)},exports.getAllMatches=function(string,regex){for(var matches=[],match=regex.exec(string);match;){for(var allmatches=[],len=match.length,index=0;index<len;index++)allmatches.push(match[index]);matches.push(allmatches),match=regex.exec(string)}return matches},exports.nameRegexp=nameRegexp},"./src/validator.js":function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__("./src/util.js"),defaultOptions={allowBooleanAttributes:!1},props=["allowBooleanAttributes"];function readPI(xmlData,i){for(var start=i;i<xmlData.length;i++)if("?"!=xmlData[i]&&" "!=xmlData[i]);else{var tagname=xmlData.substr(start,i-start);if(i>5&&"xml"===tagname)return getErrorObject("InvalidXml","XML declaration allowed only at the start of the document.",getLineNumberForPosition(xmlData,i));if("?"==xmlData[i]&&">"==xmlData[i+1]){i++;break}}return i}function readCommentAndCDATA(xmlData,i){if(xmlData.length>i+5&&"-"===xmlData[i+1]&&"-"===xmlData[i+2]){for(i+=3;i<xmlData.length;i++)if("-"===xmlData[i]&&"-"===xmlData[i+1]&&">"===xmlData[i+2]){i+=2;break}}else if(xmlData.length>i+8&&"D"===xmlData[i+1]&&"O"===xmlData[i+2]&&"C"===xmlData[i+3]&&"T"===xmlData[i+4]&&"Y"===xmlData[i+5]&&"P"===xmlData[i+6]&&"E"===xmlData[i+7]){var angleBracketsCount=1;for(i+=8;i<xmlData.length;i++)if("<"===xmlData[i])angleBracketsCount++;else if(">"===xmlData[i]&&0===--angleBracketsCount)break}else if(xmlData.length>i+9&&"["===xmlData[i+1]&&"C"===xmlData[i+2]&&"D"===xmlData[i+3]&&"A"===xmlData[i+4]&&"T"===xmlData[i+5]&&"A"===xmlData[i+6]&&"["===xmlData[i+7])for(i+=8;i<xmlData.length;i++)if("]"===xmlData[i]&&"]"===xmlData[i+1]&&">"===xmlData[i+2]){i+=2;break}return i}exports.validate=function(xmlData,options){options=util.buildOptions(options,defaultOptions,props);var tagname,tags=[],tagFound=!1,reachedRoot=!1;"\ufeff"===xmlData[0]&&(xmlData=xmlData.substr(1));for(var i=0;i<xmlData.length;i++){if("<"!==xmlData[i]){if(" "===xmlData[i]||"\t"===xmlData[i]||"\n"===xmlData[i]||"\r"===xmlData[i])continue;return getErrorObject("InvalidChar","char '"+xmlData[i]+"' is not expected.",getLineNumberForPosition(xmlData,i))}if("?"===xmlData[++i]){if((i=readPI(xmlData,++i)).err)return i}else{if("!"===xmlData[i]){i=readCommentAndCDATA(xmlData,i);continue}var closingTag=!1;"/"===xmlData[i]&&(closingTag=!0,i++);for(var tagName="";i<xmlData.length&&">"!==xmlData[i]&&" "!==xmlData[i]&&"\t"!==xmlData[i]&&"\n"!==xmlData[i]&&"\r"!==xmlData[i];i++)tagName+=xmlData[i];if("/"===(tagName=tagName.trim())[tagName.length-1]&&(tagName=tagName.substring(0,tagName.length-1),i--),tagname=tagName,!util.isName(tagname)){return getErrorObject("InvalidTag",0===tagName.trim().length?"There is an unnecessary space between tag name and backward slash '</ ..'.":"Tag '"+tagName+"' is an invalid name.",getLineNumberForPosition(xmlData,i))}var result=readAttributeStr(xmlData,i);if(!1===result)return getErrorObject("InvalidAttr","Attributes for '"+tagName+"' have open quote.",getLineNumberForPosition(xmlData,i));var attrStr=result.value;if(i=result.index,"/"===attrStr[attrStr.length-1]){var isValid=validateAttributeString(attrStr=attrStr.substring(0,attrStr.length-1),options);if(!0!==isValid)return getErrorObject(isValid.err.code,isValid.err.msg,getLineNumberForPosition(xmlData,i-attrStr.length+isValid.err.line));tagFound=!0}else if(closingTag){if(!result.tagClosed)return getErrorObject("InvalidTag","Closing tag '"+tagName+"' doesn't have proper closing.",getLineNumberForPosition(xmlData,i));if(attrStr.trim().length>0)return getErrorObject("InvalidTag","Closing tag '"+tagName+"' can't have attributes or invalid starting.",getLineNumberForPosition(xmlData,i));var otg=tags.pop();if(tagName!==otg)return getErrorObject("InvalidTag","Closing tag '"+otg+"' is expected inplace of '"+tagName+"'.",getLineNumberForPosition(xmlData,i));0==tags.length&&(reachedRoot=!0)}else{var _isValid=validateAttributeString(attrStr,options);if(!0!==_isValid)return getErrorObject(_isValid.err.code,_isValid.err.msg,getLineNumberForPosition(xmlData,i-attrStr.length+_isValid.err.line));if(!0===reachedRoot)return getErrorObject("InvalidXml","Multiple possible root nodes found.",getLineNumberForPosition(xmlData,i));tags.push(tagName),tagFound=!0}for(i++;i<xmlData.length;i++){if("<"===xmlData[i]){if("!"===xmlData[i+1]){i=readCommentAndCDATA(xmlData,++i);continue}break}if("&"===xmlData[i]){var afterAmp=validateAmpersand(xmlData,i);if(-1==afterAmp)return getErrorObject("InvalidChar","char '&' is not expected.",getLineNumberForPosition(xmlData,i));i=afterAmp}}"<"===xmlData[i]&&i--}}return tagFound?!(tags.length>0)||getErrorObject("InvalidXml","Invalid '"+JSON.stringify(tags,null,4).replace(/\r?\n/g,"")+"' found.",1):getErrorObject("InvalidXml","Start tag expected.",1)};var doubleQuote='"',singleQuote="'";function readAttributeStr(xmlData,i){for(var attrStr="",startChar="",tagClosed=!1;i<xmlData.length;i++){if(xmlData[i]===doubleQuote||xmlData[i]===singleQuote)if(""===startChar)startChar=xmlData[i];else{if(startChar!==xmlData[i])continue;startChar=""}else if(">"===xmlData[i]&&""===startChar){tagClosed=!0;break}attrStr+=xmlData[i]}return""===startChar&&{value:attrStr,index:i,tagClosed:tagClosed}}var validAttrStrRegxp=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function validateAttributeString(attrStr,options){for(var matches=util.getAllMatches(attrStr,validAttrStrRegxp),attrNames={},i=0;i<matches.length;i++){if(0===matches[i][1].length)return getErrorObject("InvalidAttr","Attribute '"+matches[i][2]+"' has no space in starting.",getPositionFromMatch(attrStr,matches[i][0]));if(void 0===matches[i][3]&&!options.allowBooleanAttributes)return getErrorObject("InvalidAttr","boolean attribute '"+matches[i][2]+"' is not allowed.",getPositionFromMatch(attrStr,matches[i][0]));var attrName=matches[i][2];if(!validateAttrName(attrName))return getErrorObject("InvalidAttr","Attribute '"+attrName+"' is an invalid name.",getPositionFromMatch(attrStr,matches[i][0]));if(attrNames.hasOwnProperty(attrName))return getErrorObject("InvalidAttr","Attribute '"+attrName+"' is repeated.",getPositionFromMatch(attrStr,matches[i][0]));attrNames[attrName]=1}return!0}function validateAmpersand(xmlData,i){if(";"===xmlData[++i])return-1;if("#"===xmlData[i])return function(xmlData,i){var re=/\d/;for("x"===xmlData[i]&&(i++,re=/[\da-fA-F]/);i<xmlData.length;i++){if(";"===xmlData[i])return i;if(!xmlData[i].match(re))break}return-1}(xmlData,++i);for(var count=0;i<xmlData.length;i++,count++)if(!(xmlData[i].match(/\w/)&&count<20)){if(";"===xmlData[i])break;return-1}return i}function getErrorObject(code,message,lineNumber){return{err:{code:code,msg:message,line:lineNumber}}}function validateAttrName(attrName){return util.isName(attrName)}function getLineNumberForPosition(xmlData,index){return xmlData.substring(0,index).split(/\r?\n/).length}function getPositionFromMatch(attrStr,match){return attrStr.indexOf(match)+match.length}},"./src/xmlNode.js":function(module,exports,__webpack_require__){"use strict";module.exports=function(tagname,parent,val){this.tagname=tagname,this.parent=parent,this.child={},this.attrsMap={},this.val=val,this.addChild=function(child){Array.isArray(this.child[child.tagname])?this.child[child.tagname].push(child):this.child[child.tagname]=[child]}}},"./src/xmlstr2xmlnode.js":function(module,exports,__webpack_require__){"use strict";var util=__webpack_require__("./src/util.js"),buildOptions=__webpack_require__("./src/util.js").buildOptions,xmlNode=__webpack_require__("./src/xmlNode.js");"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,util.nameRegexp);!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);var defaultOptions={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",tagValueProcessor:function(a,tagName){return a},attrValueProcessor:function(a,attrName){return a},stopNodes:[]};exports.defaultOptions=defaultOptions;var props=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","stopNodes"];function processTagValue(tagName,val,options){return val&&(options.trimValues&&(val=val.trim()),val=parseValue(val=options.tagValueProcessor(val,tagName),options.parseNodeValue,options.parseTrueNumberOnly)),val}function resolveNameSpace(tagname,options){if(options.ignoreNameSpace){var tags=tagname.split(":"),prefix="/"===tagname.charAt(0)?"/":"";if("xmlns"===tags[0])return"";2===tags.length&&(tagname=prefix+tags[1])}return tagname}function parseValue(val,shouldParse,parseTrueNumberOnly){var parsed;return shouldParse&&"string"==typeof val?(""===val.trim()||isNaN(val)?parsed="true"===val||"false"!==val&&val:(-1!==val.indexOf("0x")?parsed=Number.parseInt(val,16):-1!==val.indexOf(".")?(parsed=Number.parseFloat(val),val=val.replace(/\.?0+$/,"")):parsed=Number.parseInt(val,10),parseTrueNumberOnly&&(parsed=String(parsed)===val?parsed:val)),parsed):util.isExist(val)?val:""}exports.props=props;var attrsRegx=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function buildAttributesMap(attrStr,options){if(!options.ignoreAttributes&&"string"==typeof attrStr){attrStr=attrStr.replace(/\r?\n/g," ");for(var matches=util.getAllMatches(attrStr,attrsRegx),len=matches.length,attrs={},i=0;i<len;i++){var attrName=resolveNameSpace(matches[i][1],options);attrName.length&&(void 0!==matches[i][4]?(options.trimValues&&(matches[i][4]=matches[i][4].trim()),matches[i][4]=options.attrValueProcessor(matches[i][4],attrName),attrs[options.attributeNamePrefix+attrName]=parseValue(matches[i][4],options.parseAttributeValue,options.parseTrueNumberOnly)):options.allowBooleanAttributes&&(attrs[options.attributeNamePrefix+attrName]=!0))}if(!Object.keys(attrs).length)return;if(options.attrNodeName){var attrCollection={};return attrCollection[options.attrNodeName]=attrs,attrCollection}return attrs}}function closingIndexForOpeningTag(data,i){for(var attrBoundary,index=i;index<data.length;index++){var ch=data[index];if(attrBoundary)ch===attrBoundary&&(attrBoundary="");else if('"'===ch||"'"===ch)attrBoundary=ch;else if(">"===ch)return index}}exports.getTraversalObj=function(xmlData,options){options=buildOptions(options,defaultOptions,props);for(var xmlObj=new xmlNode("!xml"),currentNode=xmlObj,textData="",i=0;i<xmlData.length;i++)if("<"===xmlData[i])if("/"===xmlData[i+1]){var closeIndex=xmlData.indexOf(">",i),tagName=xmlData.substring(i+2,closeIndex).trim();if(options.ignoreNameSpace){var colonIndex=tagName.indexOf(":");-1!==colonIndex&&(tagName=tagName.substr(colonIndex+1))}currentNode&&(currentNode.val?currentNode.val=util.getValue(currentNode.val)+""+processTagValue(tagName,textData,options):currentNode.val=processTagValue(tagName,textData,options)),options.stopNodes.length&&options.stopNodes.includes(currentNode.tagname)&&(currentNode.child=[],void 0==currentNode.attrsMap&&(currentNode.attrsMap={}),currentNode.val=xmlData.substr(currentNode.startIndex+1,i-currentNode.startIndex-1)),currentNode=currentNode.parent,textData="",i=closeIndex}else if("?"===xmlData[i+1])i=xmlData.indexOf("?>",i)+1;else if("-"===xmlData[i+2])i=xmlData.indexOf("--\x3e",i)+2;else if("D"===xmlData[i+2]){var _closeIndex=xmlData.indexOf(">",i);i=xmlData.substr(i,_closeIndex).indexOf("[")?xmlData.indexOf("]>",i)+1:_closeIndex}else if("["===xmlData[i+2]){var _closeIndex2=xmlData.indexOf("]]>",i),_tagExp=xmlData.substring(i+9,_closeIndex2);if(textData&&(currentNode.val=util.getValue(currentNode.val)+""+processTagValue(currentNode.tagname,textData,options),textData=""),options.cdataTagName){var childNode=new xmlNode(options.cdataTagName,currentNode,_tagExp);currentNode.addChild(childNode),currentNode.val=util.getValue(currentNode.val)+options.cdataPositionChar,_tagExp&&(childNode.val=_tagExp)}else currentNode.val=(currentNode.val||"")+(_tagExp||"");i=_closeIndex2+2}else{var _closeIndex3=closingIndexForOpeningTag(xmlData,i),_tagExp2=xmlData.substring(i+1,_closeIndex3),separatorIndex=_tagExp2.indexOf(" "),_tagName=_tagExp2;if(-1!==separatorIndex&&(_tagName=_tagExp2.substr(0,separatorIndex),_tagExp2=_tagExp2.substr(separatorIndex+1)),options.ignoreNameSpace){var _colonIndex=_tagName.indexOf(":");-1!==_colonIndex&&(_tagName=_tagName.substr(_colonIndex+1))}if(currentNode&&textData&&"!xml"!==currentNode.tagname&&(currentNode.val=util.getValue(currentNode.val)+""+processTagValue(currentNode.tagname,textData,options)),_tagExp2.lastIndexOf("/")===_tagExp2.length-1){_tagExp2="/"===_tagName[_tagName.length-1]?_tagName=_tagName.substr(0,_tagName.length-1):_tagExp2.substr(0,_tagExp2.length-1);var _childNode=new xmlNode(_tagName,currentNode,"");_tagName!==_tagExp2&&(_childNode.attrsMap=buildAttributesMap(_tagExp2,options)),currentNode.addChild(_childNode)}else{var _childNode2=new xmlNode(_tagName,currentNode);options.stopNodes.length&&options.stopNodes.includes(_childNode2.tagname)&&(_childNode2.startIndex=_closeIndex3),_tagName!==_tagExp2&&(_childNode2.attrsMap=buildAttributesMap(_tagExp2,options)),currentNode.addChild(_childNode2),currentNode=_childNode2}textData="",i=_closeIndex3}else textData+=xmlData[i];return xmlObj}}});!function(sax){sax.parser=function(strict,opt){return new SAXParser(strict,opt)},sax.SAXParser=SAXParser,sax.SAXStream=SAXStream,sax.createStream=function(strict,opt){return new SAXStream(strict,opt)},sax.MAX_BUFFER_LENGTH=65536;var Stream,buffers=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function SAXParser(strict,opt){if(!(this instanceof SAXParser))return new SAXParser(strict,opt);!function(parser){for(var i=0,l=buffers.length;i<l;i++)parser[buffers[i]]=""}(this),this.q=this.c="",this.bufferCheckPosition=sax.MAX_BUFFER_LENGTH,this.opt=opt||{},this.opt.lowercase=this.opt.lowercase||this.opt.lowercasetags,this.looseCase=this.opt.lowercase?"toLowerCase":"toUpperCase",this.tags=[],this.closed=this.closedRoot=this.sawRoot=!1,this.tag=this.error=null,this.strict=!!strict,this.noscript=!(!strict&&!this.opt.noscript),this.state=S.BEGIN,this.strictEntities=this.opt.strictEntities,this.ENTITIES=this.strictEntities?Object.create(sax.XML_ENTITIES):Object.create(sax.ENTITIES),this.attribList=[],this.opt.xmlns&&(this.ns=Object.create(rootNS)),this.trackPosition=!1!==this.opt.position,this.trackPosition&&(this.position=this.line=this.column=0),emit(this,"onready")}sax.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(o){function F(){}return F.prototype=o,new F}),Object.keys||(Object.keys=function(o){var a=[];for(var i in o)o.hasOwnProperty(i)&&a.push(i);return a}),SAXParser.prototype={end:function(){end(this)},write:function(chunk){if(this.error)throw this.error;if(this.closed)return error(this,"Cannot write after close. Assign an onready handler.");if(null===chunk)return end(this);"object"==typeof chunk&&(chunk=chunk.toString());var i=0,c="";for(;c=charAt(chunk,i++),this.c=c,c;)switch(this.trackPosition&&(this.position++,"\n"===c?(this.line++,this.column=0):this.column++),this.state){case S.BEGIN:if(this.state=S.BEGIN_WHITESPACE,"\ufeff"===c)continue;beginWhiteSpace(this,c);continue;case S.BEGIN_WHITESPACE:beginWhiteSpace(this,c);continue;case S.TEXT:if(this.sawRoot&&!this.closedRoot){for(var starti=i-1;c&&"<"!==c&&"&"!==c;)(c=charAt(chunk,i++))&&this.trackPosition&&(this.position++,"\n"===c?(this.line++,this.column=0):this.column++);this.textNode+=chunk.substring(starti,i-1)}"<"!==c||this.sawRoot&&this.closedRoot&&!this.strict?(isWhitespace(c)||this.sawRoot&&!this.closedRoot||strictFail(this,"Text data outside of root node."),"&"===c?this.state=S.TEXT_ENTITY:this.textNode+=c):(this.state=S.OPEN_WAKA,this.startTagPosition=this.position);continue;case S.SCRIPT:"<"===c?this.state=S.SCRIPT_ENDING:this.script+=c;continue;case S.SCRIPT_ENDING:"/"===c?this.state=S.CLOSE_TAG:(this.script+="<"+c,this.state=S.SCRIPT);continue;case S.OPEN_WAKA:if("!"===c)this.state=S.SGML_DECL,this.sgmlDecl="";else if(isWhitespace(c));else if(isMatch(nameStart,c))this.state=S.OPEN_TAG,this.tagName=c;else if("/"===c)this.state=S.CLOSE_TAG,this.tagName="";else if("?"===c)this.state=S.PROC_INST,this.procInstName=this.procInstBody="";else{if(strictFail(this,"Unencoded <"),this.startTagPosition+1<this.position){var pad=this.position-this.startTagPosition;c=new Array(pad).join(" ")+c}this.textNode+="<"+c,this.state=S.TEXT}continue;case S.SGML_DECL:(this.sgmlDecl+c).toUpperCase()===CDATA?(emitNode(this,"onopencdata"),this.state=S.CDATA,this.sgmlDecl="",this.cdata=""):this.sgmlDecl+c==="--"?(this.state=S.COMMENT,this.comment="",this.sgmlDecl=""):(this.sgmlDecl+c).toUpperCase()===DOCTYPE?(this.state=S.DOCTYPE,(this.doctype||this.sawRoot)&&strictFail(this,"Inappropriately located doctype declaration"),this.doctype="",this.sgmlDecl=""):">"===c?(emitNode(this,"onsgmldeclaration",this.sgmlDecl),this.sgmlDecl="",this.state=S.TEXT):isQuote(c)?(this.state=S.SGML_DECL_QUOTED,this.sgmlDecl+=c):this.sgmlDecl+=c;continue;case S.SGML_DECL_QUOTED:c===this.q&&(this.state=S.SGML_DECL,this.q=""),this.sgmlDecl+=c;continue;case S.DOCTYPE:">"===c?(this.state=S.TEXT,emitNode(this,"ondoctype",this.doctype),this.doctype=!0):(this.doctype+=c,"["===c?this.state=S.DOCTYPE_DTD:isQuote(c)&&(this.state=S.DOCTYPE_QUOTED,this.q=c));continue;case S.DOCTYPE_QUOTED:this.doctype+=c,c===this.q&&(this.q="",this.state=S.DOCTYPE);continue;case S.DOCTYPE_DTD:this.doctype+=c,"]"===c?this.state=S.DOCTYPE:isQuote(c)&&(this.state=S.DOCTYPE_DTD_QUOTED,this.q=c);continue;case S.DOCTYPE_DTD_QUOTED:this.doctype+=c,c===this.q&&(this.state=S.DOCTYPE_DTD,this.q="");continue;case S.COMMENT:"-"===c?this.state=S.COMMENT_ENDING:this.comment+=c;continue;case S.COMMENT_ENDING:"-"===c?(this.state=S.COMMENT_ENDED,this.comment=textopts(this.opt,this.comment),this.comment&&emitNode(this,"oncomment",this.comment),this.comment=""):(this.comment+="-"+c,this.state=S.COMMENT);continue;case S.COMMENT_ENDED:">"!==c?(strictFail(this,"Malformed comment"),this.comment+="--"+c,this.state=S.COMMENT):this.state=S.TEXT;continue;case S.CDATA:"]"===c?this.state=S.CDATA_ENDING:this.cdata+=c;continue;case S.CDATA_ENDING:"]"===c?this.state=S.CDATA_ENDING_2:(this.cdata+="]"+c,this.state=S.CDATA);continue;case S.CDATA_ENDING_2:">"===c?(this.cdata&&emitNode(this,"oncdata",this.cdata),emitNode(this,"onclosecdata"),this.cdata="",this.state=S.TEXT):"]"===c?this.cdata+="]":(this.cdata+="]]"+c,this.state=S.CDATA);continue;case S.PROC_INST:"?"===c?this.state=S.PROC_INST_ENDING:isWhitespace(c)?this.state=S.PROC_INST_BODY:this.procInstName+=c;continue;case S.PROC_INST_BODY:if(!this.procInstBody&&isWhitespace(c))continue;"?"===c?this.state=S.PROC_INST_ENDING:this.procInstBody+=c;continue;case S.PROC_INST_ENDING:">"===c?(emitNode(this,"onprocessinginstruction",{name:this.procInstName,body:this.procInstBody}),this.procInstName=this.procInstBody="",this.state=S.TEXT):(this.procInstBody+="?"+c,this.state=S.PROC_INST_BODY);continue;case S.OPEN_TAG:isMatch(nameBody,c)?this.tagName+=c:(newTag(this),">"===c?openTag(this):"/"===c?this.state=S.OPEN_TAG_SLASH:(isWhitespace(c)||strictFail(this,"Invalid character in tag name"),this.state=S.ATTRIB));continue;case S.OPEN_TAG_SLASH:">"===c?(openTag(this,!0),closeTag(this)):(strictFail(this,"Forward-slash in opening tag not followed by >"),this.state=S.ATTRIB);continue;case S.ATTRIB:if(isWhitespace(c))continue;">"===c?openTag(this):"/"===c?this.state=S.OPEN_TAG_SLASH:isMatch(nameStart,c)?(this.attribName=c,this.attribValue="",this.state=S.ATTRIB_NAME):strictFail(this,"Invalid attribute name");continue;case S.ATTRIB_NAME:"="===c?this.state=S.ATTRIB_VALUE:">"===c?(strictFail(this,"Attribute without value"),this.attribValue=this.attribName,attrib(this),openTag(this)):isWhitespace(c)?this.state=S.ATTRIB_NAME_SAW_WHITE:isMatch(nameBody,c)?this.attribName+=c:strictFail(this,"Invalid attribute name");continue;case S.ATTRIB_NAME_SAW_WHITE:if("="===c)this.state=S.ATTRIB_VALUE;else{if(isWhitespace(c))continue;strictFail(this,"Attribute without value"),this.tag.attributes[this.attribName]="",this.attribValue="",emitNode(this,"onattribute",{name:this.attribName,value:""}),this.attribName="",">"===c?openTag(this):isMatch(nameStart,c)?(this.attribName=c,this.state=S.ATTRIB_NAME):(strictFail(this,"Invalid attribute name"),this.state=S.ATTRIB)}continue;case S.ATTRIB_VALUE:if(isWhitespace(c))continue;isQuote(c)?(this.q=c,this.state=S.ATTRIB_VALUE_QUOTED):(strictFail(this,"Unquoted attribute value"),this.state=S.ATTRIB_VALUE_UNQUOTED,this.attribValue=c);continue;case S.ATTRIB_VALUE_QUOTED:if(c!==this.q){"&"===c?this.state=S.ATTRIB_VALUE_ENTITY_Q:this.attribValue+=c;continue}attrib(this),this.q="",this.state=S.ATTRIB_VALUE_CLOSED;continue;case S.ATTRIB_VALUE_CLOSED:isWhitespace(c)?this.state=S.ATTRIB:">"===c?openTag(this):"/"===c?this.state=S.OPEN_TAG_SLASH:isMatch(nameStart,c)?(strictFail(this,"No whitespace between attributes"),this.attribName=c,this.attribValue="",this.state=S.ATTRIB_NAME):strictFail(this,"Invalid attribute name");continue;case S.ATTRIB_VALUE_UNQUOTED:if(!isAttribEnd(c)){"&"===c?this.state=S.ATTRIB_VALUE_ENTITY_U:this.attribValue+=c;continue}attrib(this),">"===c?openTag(this):this.state=S.ATTRIB;continue;case S.CLOSE_TAG:if(this.tagName)">"===c?closeTag(this):isMatch(nameBody,c)?this.tagName+=c:this.script?(this.script+="</"+this.tagName,this.tagName="",this.state=S.SCRIPT):(isWhitespace(c)||strictFail(this,"Invalid tagname in closing tag"),this.state=S.CLOSE_TAG_SAW_WHITE);else{if(isWhitespace(c))continue;notMatch(nameStart,c)?this.script?(this.script+="</"+c,this.state=S.SCRIPT):strictFail(this,"Invalid tagname in closing tag."):this.tagName=c}continue;case S.CLOSE_TAG_SAW_WHITE:if(isWhitespace(c))continue;">"===c?closeTag(this):strictFail(this,"Invalid characters in closing tag");continue;case S.TEXT_ENTITY:case S.ATTRIB_VALUE_ENTITY_Q:case S.ATTRIB_VALUE_ENTITY_U:var returnState,buffer;switch(this.state){case S.TEXT_ENTITY:returnState=S.TEXT,buffer="textNode";break;case S.ATTRIB_VALUE_ENTITY_Q:returnState=S.ATTRIB_VALUE_QUOTED,buffer="attribValue";break;case S.ATTRIB_VALUE_ENTITY_U:returnState=S.ATTRIB_VALUE_UNQUOTED,buffer="attribValue"}";"===c?(this[buffer]+=parseEntity(this),this.entity="",this.state=returnState):isMatch(this.entity.length?entityBody:entityStart,c)?this.entity+=c:(strictFail(this,"Invalid character in entity name"),this[buffer]+="&"+this.entity+c,this.entity="",this.state=returnState);continue;default:throw new Error(this,"Unknown state: "+this.state)}this.position>=this.bufferCheckPosition&&function(parser){for(var maxAllowed=Math.max(sax.MAX_BUFFER_LENGTH,10),maxActual=0,i=0,l=buffers.length;i<l;i++){var len=parser[buffers[i]].length;if(len>maxAllowed)switch(buffers[i]){case"textNode":closeText(parser);break;case"cdata":emitNode(parser,"oncdata",parser.cdata),parser.cdata="";break;case"script":emitNode(parser,"onscript",parser.script),parser.script="";break;default:error(parser,"Max buffer length exceeded: "+buffers[i])}maxActual=Math.max(maxActual,len)}var m=sax.MAX_BUFFER_LENGTH-maxActual;parser.bufferCheckPosition=m+parser.position}(this);return this},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var parser;closeText(parser=this),""!==parser.cdata&&(emitNode(parser,"oncdata",parser.cdata),parser.cdata=""),""!==parser.script&&(emitNode(parser,"onscript",parser.script),parser.script="")}};try{Stream=require("stream").Stream}catch(ex){Stream=function(){}}var streamWraps=sax.EVENTS.filter(function(ev){return"error"!==ev&&"end"!==ev});function SAXStream(strict,opt){if(!(this instanceof SAXStream))return new SAXStream(strict,opt);Stream.apply(this),this._parser=new SAXParser(strict,opt),this.writable=!0,this.readable=!0;var me=this;this._parser.onend=function(){me.emit("end")},this._parser.onerror=function(er){me.emit("error",er),me._parser.error=null},this._decoder=null,streamWraps.forEach(function(ev){Object.defineProperty(me,"on"+ev,{get:function(){return me._parser["on"+ev]},set:function(h){if(!h)return me.removeAllListeners(ev),me._parser["on"+ev]=h,h;me.on(ev,h)},enumerable:!0,configurable:!1})})}SAXStream.prototype=Object.create(Stream.prototype,{constructor:{value:SAXStream}}),SAXStream.prototype.write=function(data){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(data)){if(!this._decoder){var SD=require("string_decoder").StringDecoder;this._decoder=new SD("utf8")}data=this._decoder.write(data)}return this._parser.write(data.toString()),this.emit("data",data),!0},SAXStream.prototype.end=function(chunk){return chunk&&chunk.length&&this.write(chunk),this._parser.end(),!0},SAXStream.prototype.on=function(ev,handler){var me=this;return me._parser["on"+ev]||-1===streamWraps.indexOf(ev)||(me._parser["on"+ev]=function(){var args=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);args.splice(0,0,ev),me.emit.apply(me,args)}),Stream.prototype.on.call(me,ev,handler)};var CDATA="[CDATA[",DOCTYPE="DOCTYPE",XML_NAMESPACE="http://www.w3.org/XML/1998/namespace",XMLNS_NAMESPACE="http://www.w3.org/2000/xmlns/",rootNS={xml:XML_NAMESPACE,xmlns:XMLNS_NAMESPACE},nameStart=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameBody=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,entityStart=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,entityBody=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function isWhitespace(c){return" "===c||"\n"===c||"\r"===c||"\t"===c}function isQuote(c){return'"'===c||"'"===c}function isAttribEnd(c){return">"===c||isWhitespace(c)}function isMatch(regex,c){return regex.test(c)}function notMatch(regex,c){return!isMatch(regex,c)}var stringFromCharCode,floor,fromCodePoint,S=0;for(var s in sax.STATE={BEGIN:S++,BEGIN_WHITESPACE:S++,TEXT:S++,TEXT_ENTITY:S++,OPEN_WAKA:S++,SGML_DECL:S++,SGML_DECL_QUOTED:S++,DOCTYPE:S++,DOCTYPE_QUOTED:S++,DOCTYPE_DTD:S++,DOCTYPE_DTD_QUOTED:S++,COMMENT_STARTING:S++,COMMENT:S++,COMMENT_ENDING:S++,COMMENT_ENDED:S++,CDATA:S++,CDATA_ENDING:S++,CDATA_ENDING_2:S++,PROC_INST:S++,PROC_INST_BODY:S++,PROC_INST_ENDING:S++,OPEN_TAG:S++,OPEN_TAG_SLASH:S++,ATTRIB:S++,ATTRIB_NAME:S++,ATTRIB_NAME_SAW_WHITE:S++,ATTRIB_VALUE:S++,ATTRIB_VALUE_QUOTED:S++,ATTRIB_VALUE_CLOSED:S++,ATTRIB_VALUE_UNQUOTED:S++,ATTRIB_VALUE_ENTITY_Q:S++,ATTRIB_VALUE_ENTITY_U:S++,CLOSE_TAG:S++,CLOSE_TAG_SAW_WHITE:S++,SCRIPT:S++,SCRIPT_ENDING:S++},sax.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},sax.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(sax.ENTITIES).forEach(function(key){var e=sax.ENTITIES[key],s="number"==typeof e?String.fromCharCode(e):e;sax.ENTITIES[key]=s}),sax.STATE)sax.STATE[sax.STATE[s]]=s;function emit(parser,event,data){parser[event]&&parser[event](data)}function emitNode(parser,nodeType,data){parser.textNode&&closeText(parser),emit(parser,nodeType,data)}function closeText(parser){parser.textNode=textopts(parser.opt,parser.textNode),parser.textNode&&emit(parser,"ontext",parser.textNode),parser.textNode=""}function textopts(opt,text){return opt.trim&&(text=text.trim()),opt.normalize&&(text=text.replace(/\s+/g," ")),text}function error(parser,er){return closeText(parser),parser.trackPosition&&(er+="\nLine: "+parser.line+"\nColumn: "+parser.column+"\nChar: "+parser.c),er=new Error(er),parser.error=er,emit(parser,"onerror",er),parser}function end(parser){return parser.sawRoot&&!parser.closedRoot&&strictFail(parser,"Unclosed root tag"),parser.state!==S.BEGIN&&parser.state!==S.BEGIN_WHITESPACE&&parser.state!==S.TEXT&&error(parser,"Unexpected end"),closeText(parser),parser.c="",parser.closed=!0,emit(parser,"onend"),SAXParser.call(parser,parser.strict,parser.opt),parser}function strictFail(parser,message){if("object"!=typeof parser||!(parser instanceof SAXParser))throw new Error("bad call to strictFail");parser.strict&&error(parser,message)}function newTag(parser){parser.strict||(parser.tagName=parser.tagName[parser.looseCase]());var parent=parser.tags[parser.tags.length-1]||parser,tag=parser.tag={name:parser.tagName,attributes:{}};parser.opt.xmlns&&(tag.ns=parent.ns),parser.attribList.length=0,emitNode(parser,"onopentagstart",tag)}function qname(name,attribute){var qualName=name.indexOf(":")<0?["",name]:name.split(":"),prefix=qualName[0],local=qualName[1];return attribute&&"xmlns"===name&&(prefix="xmlns",local=""),{prefix:prefix,local:local}}function attrib(parser){if(parser.strict||(parser.attribName=parser.attribName[parser.looseCase]()),-1!==parser.attribList.indexOf(parser.attribName)||parser.tag.attributes.hasOwnProperty(parser.attribName))parser.attribName=parser.attribValue="";else{if(parser.opt.xmlns){var qn=qname(parser.attribName,!0),prefix=qn.prefix,local=qn.local;if("xmlns"===prefix)if("xml"===local&&parser.attribValue!==XML_NAMESPACE)strictFail(parser,"xml: prefix must be bound to "+XML_NAMESPACE+"\nActual: "+parser.attribValue);else if("xmlns"===local&&parser.attribValue!==XMLNS_NAMESPACE)strictFail(parser,"xmlns: prefix must be bound to "+XMLNS_NAMESPACE+"\nActual: "+parser.attribValue);else{var tag=parser.tag,parent=parser.tags[parser.tags.length-1]||parser;tag.ns===parent.ns&&(tag.ns=Object.create(parent.ns)),tag.ns[local]=parser.attribValue}parser.attribList.push([parser.attribName,parser.attribValue])}else parser.tag.attributes[parser.attribName]=parser.attribValue,emitNode(parser,"onattribute",{name:parser.attribName,value:parser.attribValue});parser.attribName=parser.attribValue=""}}function openTag(parser,selfClosing){if(parser.opt.xmlns){var tag=parser.tag,qn=qname(parser.tagName);tag.prefix=qn.prefix,tag.local=qn.local,tag.uri=tag.ns[qn.prefix]||"",tag.prefix&&!tag.uri&&(strictFail(parser,"Unbound namespace prefix: "+JSON.stringify(parser.tagName)),tag.uri=qn.prefix);var parent=parser.tags[parser.tags.length-1]||parser;tag.ns&&parent.ns!==tag.ns&&Object.keys(tag.ns).forEach(function(p){emitNode(parser,"onopennamespace",{prefix:p,uri:tag.ns[p]})});for(var i=0,l=parser.attribList.length;i<l;i++){var nv=parser.attribList[i],name=nv[0],value=nv[1],qualName=qname(name,!0),prefix=qualName.prefix,local=qualName.local,uri=""===prefix?"":tag.ns[prefix]||"",a={name:name,value:value,prefix:prefix,local:local,uri:uri};prefix&&"xmlns"!==prefix&&!uri&&(strictFail(parser,"Unbound namespace prefix: "+JSON.stringify(prefix)),a.uri=prefix),parser.tag.attributes[name]=a,emitNode(parser,"onattribute",a)}parser.attribList.length=0}parser.tag.isSelfClosing=!!selfClosing,parser.sawRoot=!0,parser.tags.push(parser.tag),emitNode(parser,"onopentag",parser.tag),selfClosing||(parser.noscript||"script"!==parser.tagName.toLowerCase()?parser.state=S.TEXT:parser.state=S.SCRIPT,parser.tag=null,parser.tagName=""),parser.attribName=parser.attribValue="",parser.attribList.length=0}function closeTag(parser){if(!parser.tagName)return strictFail(parser,"Weird empty close tag."),parser.textNode+="</>",void(parser.state=S.TEXT);if(parser.script){if("script"!==parser.tagName)return parser.script+="</"+parser.tagName+">",parser.tagName="",void(parser.state=S.SCRIPT);emitNode(parser,"onscript",parser.script),parser.script=""}var t=parser.tags.length,tagName=parser.tagName;parser.strict||(tagName=tagName[parser.looseCase]());for(var closeTo=tagName;t--;){if(parser.tags[t].name===closeTo)break;strictFail(parser,"Unexpected close tag")}if(t<0)return strictFail(parser,"Unmatched closing tag: "+parser.tagName),parser.textNode+="</"+parser.tagName+">",void(parser.state=S.TEXT);parser.tagName=tagName;for(var s=parser.tags.length;s-- >t;){var tag=parser.tag=parser.tags.pop();parser.tagName=parser.tag.name,emitNode(parser,"onclosetag",parser.tagName);var x={};for(var i in tag.ns)x[i]=tag.ns[i];var parent=parser.tags[parser.tags.length-1]||parser;parser.opt.xmlns&&tag.ns!==parent.ns&&Object.keys(tag.ns).forEach(function(p){var n=tag.ns[p];emitNode(parser,"onclosenamespace",{prefix:p,uri:n})})}0===t&&(parser.closedRoot=!0),parser.tagName=parser.attribValue=parser.attribName="",parser.attribList.length=0,parser.state=S.TEXT}function parseEntity(parser){var num,entity=parser.entity,entityLC=entity.toLowerCase(),numStr="";return parser.ENTITIES[entity]?parser.ENTITIES[entity]:parser.ENTITIES[entityLC]?parser.ENTITIES[entityLC]:("#"===(entity=entityLC).charAt(0)&&("x"===entity.charAt(1)?(entity=entity.slice(2),numStr=(num=parseInt(entity,16)).toString(16)):(entity=entity.slice(1),numStr=(num=parseInt(entity,10)).toString(10))),entity=entity.replace(/^0+/,""),isNaN(num)||numStr.toLowerCase()!==entity?(strictFail(parser,"Invalid character entity"),"&"+parser.entity+";"):String.fromCodePoint(num))}function beginWhiteSpace(parser,c){"<"===c?(parser.state=S.OPEN_WAKA,parser.startTagPosition=parser.position):isWhitespace(c)||(strictFail(parser,"Non-whitespace before first tag."),parser.textNode=c,parser.state=S.TEXT)}function charAt(chunk,i){var result="";return i<chunk.length&&(result=chunk.charAt(i)),result}S=sax.STATE,String.fromCodePoint||(stringFromCharCode=String.fromCharCode,floor=Math.floor,fromCodePoint=function(){var highSurrogate,lowSurrogate,codeUnits=[],index=-1,length=arguments.length;if(!length)return"";for(var result="";++index<length;){var codePoint=Number(arguments[index]);if(!isFinite(codePoint)||codePoint<0||codePoint>1114111||floor(codePoint)!==codePoint)throw RangeError("Invalid code point: "+codePoint);codePoint<=65535?codeUnits.push(codePoint):(highSurrogate=55296+((codePoint-=65536)>>10),lowSurrogate=codePoint%1024+56320,codeUnits.push(highSurrogate,lowSurrogate)),(index+1===length||codeUnits.length>16384)&&(result+=stringFromCharCode.apply(null,codeUnits),codeUnits.length=0)}return result},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:fromCodePoint,configurable:!0,writable:!0}):String.fromCodePoint=fromCodePoint)}("undefined"==typeof exports?this.sax={}:exports),function(window){class Application{static addDirectives(){zn.ng.directives[zn.ui.components.ng.textfield.tag]=zn.ui.components.ng.textfield.factory,zn.ng.directives[zn.ui.components.ng.textarea.tag]=zn.ui.components.ng.textarea.factory,zn.ng.directives[zn.ui.components.ng.button.tag]=zn.ui.components.ng.button.factory,zn.ng.directives[zn.ui.components.ng.calendar.tag]=zn.ui.components.ng.calendar.factory,zn.ng.directives[zn.ui.components.ng.checkboxfield.tag]=zn.ui.components.ng.checkboxfield.factory,zn.ng.directives[zn.ui.components.ng.datefield.tag]=zn.ui.components.ng.datefield.factory,zn.ng.directives[zn.ui.components.ng.dropdownfield.tag]=zn.ui.components.ng.dropdownfield.factory,zn.ng.directives[zn.ui.components.ng.radiogroup.tag]=zn.ui.components.ng.radiogroup.factory,zn.ng.directives[zn.ui.components.ng.popup.tag]=zn.ui.components.ng.popup.factory,zn.ng.directives[zn.ui.components.ng.dialog.tag]=zn.ui.components.ng.dialog.factory,zn.ng.directives[zn.ui.components.ng.list.tag]=zn.ui.components.ng.list.factory,zn.ng.directives[zn.ui.components.ng.table.tag]=zn.ui.components.ng.table.factory,zn.ng.directives[zn.ui.components.ng.draggable.tag]=zn.ui.components.ng.draggable.factory,zn.ng.directives[zn.ui.components.ng.editable.tag]=zn.ui.components.ng.editable.factory}}Application.addDirectives(),"apii".split(".").reduce((a,e)=>a[e]=a[e]||{},window).Application=Application}(window);